(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();function pc(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Oe={},Fr=[],Zt=()=>{},ol=()=>!1,gi=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),hc=t=>t.startsWith("onUpdate:"),lt=Object.assign,dc=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Pd=Object.prototype.hasOwnProperty,ye=(t,e)=>Pd.call(t,e),ce=Array.isArray,ya=t=>li(t)==="[object Map]",Xd=t=>li(t)==="[object Set]",oe=t=>typeof t=="function",Ie=t=>typeof t=="string",Xr=t=>typeof t=="symbol",ke=t=>t!==null&&typeof t=="object",cl=t=>(ke(t)||oe(t))&&oe(t.then)&&oe(t.catch),Id=Object.prototype.toString,li=t=>Id.call(t),Yd=t=>li(t).slice(8,-1),qd=t=>li(t)==="[object Object]",vc=t=>Ie(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Ta=pc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),pi=t=>{const e=Object.create(null);return(n=>e[n]||(e[n]=t(n)))},Qd=/-\w/g,zn=pi(t=>t.replace(Qd,e=>e.slice(1).toUpperCase())),Zd=/\B([A-Z])/g,xr=pi(t=>t.replace(Zd,"-$1").toLowerCase()),fl=pi(t=>t.charAt(0).toUpperCase()+t.slice(1)),Bi=pi(t=>t?`on${fl(t)}`:""),bn=(t,e)=>!Object.is(t,e),_i=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},ul=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},Jd=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Ff;const hi=()=>Ff||(Ff=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function yc(t){if(ce(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],a=Ie(r)?rv(r):yc(r);if(a)for(const s in a)e[s]=a[s]}return e}else if(Ie(t)||ke(t))return t}const ev=/;(?![^(]*\))/g,tv=/:([^]+)/,nv=/\/\*[^]*?\*\//g;function rv(t){const e={};return t.replace(nv,"").split(ev).forEach(n=>{if(n){const r=n.split(tv);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Tc(t){let e="";if(Ie(t))e=t;else if(ce(t))for(let n=0;n<t.length;n++){const r=Tc(t[n]);r&&(e+=r+" ")}else if(ke(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const av="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",sv=pc(av);function gl(t){return!!t||t===""}let yt;class iv{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=yt,!e&&yt&&(this.index=(yt.scopes||(yt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=yt;try{return yt=this,e()}finally{yt=n}}}on(){++this._on===1&&(this.prevScope=yt,yt=this)}off(){this._on>0&&--this._on===0&&(yt=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.parent=void 0}}}function ov(){return yt}let Re;const Ui=new WeakSet;class ll{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,yt&&yt.active&&yt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ui.has(this)&&(Ui.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||hl(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Bf(this),dl(this);const e=Re,n=bt;Re=this,bt=!0;try{return this.fn()}finally{vl(this),Re=e,bt=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Cc(e);this.deps=this.depsTail=void 0,Bf(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ui.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Do(this)&&this.run()}get dirty(){return Do(this)}}let pl=0,xa,Sa;function hl(t,e=!1){if(t.flags|=8,e){t.next=Sa,Sa=t;return}t.next=xa,xa=t}function xc(){pl++}function Sc(){if(--pl>0)return;if(Sa){let e=Sa;for(Sa=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;xa;){let e=xa;for(xa=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}function dl(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function vl(t){let e,n=t.depsTail,r=n;for(;r;){const a=r.prevDep;r.version===-1?(r===n&&(n=a),Cc(r),cv(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=a}t.deps=e,t.depsTail=n}function Do(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(yl(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function yl(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Va)||(t.globalVersion=Va,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Do(t))))return;t.flags|=2;const e=t.dep,n=Re,r=bt;Re=t,bt=!0;try{dl(t);const a=t.fn(t._value);(e.version===0||bn(a,t._value))&&(t.flags|=128,t._value=a,e.version++)}catch(a){throw e.version++,a}finally{Re=n,bt=r,vl(t),t.flags&=-3}}function Cc(t,e=!1){const{dep:n,prevSub:r,nextSub:a}=t;if(r&&(r.nextSub=a,t.prevSub=void 0),a&&(a.prevSub=r,t.nextSub=void 0),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let s=n.computed.deps;s;s=s.nextDep)Cc(s,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function cv(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let bt=!0;const Tl=[];function dn(){Tl.push(bt),bt=!1}function vn(){const t=Tl.pop();bt=t===void 0?!0:t}function Bf(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Re;Re=void 0;try{e()}finally{Re=n}}}let Va=0;class fv{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class wc{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Re||!bt||Re===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Re)n=this.activeLink=new fv(Re,this),Re.deps?(n.prevDep=Re.depsTail,Re.depsTail.nextDep=n,Re.depsTail=n):Re.deps=Re.depsTail=n,xl(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=Re.depsTail,n.nextDep=void 0,Re.depsTail.nextDep=n,Re.depsTail=n,Re.deps===n&&(Re.deps=r)}return n}trigger(e){this.version++,Va++,this.notify(e)}notify(e){xc();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Sc()}}}function xl(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)xl(r)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Lo=new WeakMap,ur=Symbol(""),mo=Symbol(""),Fa=Symbol("");function tt(t,e,n){if(bt&&Re){let r=Lo.get(t);r||Lo.set(t,r=new Map);let a=r.get(n);a||(r.set(n,a=new wc),a.map=r,a.key=n),a.track()}}function gn(t,e,n,r,a,s){const i=Lo.get(t);if(!i){Va++;return}const o=c=>{c&&c.trigger()};if(xc(),e==="clear")i.forEach(o);else{const c=ce(t),u=c&&vc(n);if(c&&n==="length"){const g=Number(r);i.forEach((f,l)=>{(l==="length"||l===Fa||!Xr(l)&&l>=g)&&o(f)})}else switch((n!==void 0||i.has(void 0))&&o(i.get(n)),u&&o(i.get(Fa)),e){case"add":c?u&&o(i.get("length")):(o(i.get(ur)),ya(t)&&o(i.get(mo)));break;case"delete":c||(o(i.get(ur)),ya(t)&&o(i.get(mo)));break;case"set":ya(t)&&o(i.get(ur));break}}Sc()}function wr(t){const e=ve(t);return e===t?e:(tt(e,"iterate",Fa),$t(t)?e:e.map(yn))}function Ec(t){return tt(t=ve(t),"iterate",Fa),t}function Fn(t,e){return Hn(t)?Br(t)?Ba(yn(e)):Ba(e):yn(e)}const uv={__proto__:null,[Symbol.iterator](){return Ni(this,Symbol.iterator,t=>Fn(this,t))},concat(...t){return wr(this).concat(...t.map(e=>ce(e)?wr(e):e))},entries(){return Ni(this,"entries",t=>(t[1]=Fn(this,t[1]),t))},every(t,e){return an(this,"every",t,e,void 0,arguments)},filter(t,e){return an(this,"filter",t,e,n=>n.map(r=>Fn(this,r)),arguments)},find(t,e){return an(this,"find",t,e,n=>Fn(this,n),arguments)},findIndex(t,e){return an(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return an(this,"findLast",t,e,n=>Fn(this,n),arguments)},findLastIndex(t,e){return an(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return an(this,"forEach",t,e,void 0,arguments)},includes(...t){return ki(this,"includes",t)},indexOf(...t){return ki(this,"indexOf",t)},join(t){return wr(this).join(t)},lastIndexOf(...t){return ki(this,"lastIndexOf",t)},map(t,e){return an(this,"map",t,e,void 0,arguments)},pop(){return Jr(this,"pop")},push(...t){return Jr(this,"push",t)},reduce(t,...e){return _f(this,"reduce",t,e)},reduceRight(t,...e){return _f(this,"reduceRight",t,e)},shift(){return Jr(this,"shift")},some(t,e){return an(this,"some",t,e,void 0,arguments)},splice(...t){return Jr(this,"splice",t)},toReversed(){return wr(this).toReversed()},toSorted(t){return wr(this).toSorted(t)},toSpliced(...t){return wr(this).toSpliced(...t)},unshift(...t){return Jr(this,"unshift",t)},values(){return Ni(this,"values",t=>Fn(this,t))}};function Ni(t,e,n){const r=Ec(t),a=r[e]();return r!==t&&!$t(t)&&(a._next=a.next,a.next=()=>{const s=a._next();return s.done||(s.value=n(s.value)),s}),a}const gv=Array.prototype;function an(t,e,n,r,a,s){const i=Ec(t),o=i!==t&&!$t(t),c=i[e];if(c!==gv[e]){const f=c.apply(t,s);return o?yn(f):f}let u=n;i!==t&&(o?u=function(f,l){return n.call(this,Fn(t,f),l,t)}:n.length>2&&(u=function(f,l){return n.call(this,f,l,t)}));const g=c.call(i,u,r);return o&&a?a(g):g}function _f(t,e,n,r){const a=Ec(t);let s=n;return a!==t&&($t(t)?n.length>3&&(s=function(i,o,c){return n.call(this,i,o,c,t)}):s=function(i,o,c){return n.call(this,i,Fn(t,o),c,t)}),a[e](s,...r)}function ki(t,e,n){const r=ve(t);tt(r,"iterate",Fa);const a=r[e](...n);return(a===-1||a===!1)&&Dc(n[0])?(n[0]=ve(n[0]),r[e](...n)):a}function Jr(t,e,n=[]){dn(),xc();const r=ve(t)[e].apply(t,n);return Sc(),vn(),r}const lv=pc("__proto__,__v_isRef,__isVue"),Sl=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Xr));function pv(t){Xr(t)||(t=String(t));const e=ve(this);return tt(e,"has",t),e.hasOwnProperty(t)}class Cl{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const a=this._isReadonly,s=this._isShallow;if(n==="__v_isReactive")return!a;if(n==="__v_isReadonly")return a;if(n==="__v_isShallow")return s;if(n==="__v_raw")return r===(a?s?Ev:Ol:s?Rl:El).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const i=ce(e);if(!a){let c;if(i&&(c=uv[n]))return c;if(n==="hasOwnProperty")return pv}const o=Reflect.get(e,n,nt(e)?e:r);if((Xr(n)?Sl.has(n):lv(n))||(a||tt(e,"get",n),s))return o;if(nt(o)){const c=i&&vc(n)?o:o.value;return a&&ke(c)?Fo(c):c}return ke(o)?a?Fo(o):Oc(o):o}}class wl extends Cl{constructor(e=!1){super(!1,e)}set(e,n,r,a){let s=e[n];const i=ce(e)&&vc(n);if(!this._isShallow){const u=Hn(s);if(!$t(r)&&!Hn(r)&&(s=ve(s),r=ve(r)),!i&&nt(s)&&!nt(r))return u||(s.value=r),!0}const o=i?Number(n)<e.length:ye(e,n),c=Reflect.set(e,n,r,nt(e)?e:a);return e===ve(a)&&(o?bn(r,s)&&gn(e,"set",n,r):gn(e,"add",n,r)),c}deleteProperty(e,n){const r=ye(e,n);e[n];const a=Reflect.deleteProperty(e,n);return a&&r&&gn(e,"delete",n,void 0),a}has(e,n){const r=Reflect.has(e,n);return(!Xr(n)||!Sl.has(n))&&tt(e,"has",n),r}ownKeys(e){return tt(e,"iterate",ce(e)?"length":ur),Reflect.ownKeys(e)}}class hv extends Cl{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const dv=new wl,vv=new hv,yv=new wl(!0);const Vo=t=>t,Za=t=>Reflect.getPrototypeOf(t);function Tv(t,e,n){return function(...r){const a=this.__v_raw,s=ve(a),i=ya(s),o=t==="entries"||t===Symbol.iterator&&i,c=t==="keys"&&i,u=a[t](...r),g=n?Vo:e?Ba:yn;return!e&&tt(s,"iterate",c?mo:ur),{next(){const{value:f,done:l}=u.next();return l?{value:f,done:l}:{value:o?[g(f[0]),g(f[1])]:g(f),done:l}},[Symbol.iterator](){return this}}}}function Ja(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function xv(t,e){const n={get(a){const s=this.__v_raw,i=ve(s),o=ve(a);t||(bn(a,o)&&tt(i,"get",a),tt(i,"get",o));const{has:c}=Za(i),u=e?Vo:t?Ba:yn;if(c.call(i,a))return u(s.get(a));if(c.call(i,o))return u(s.get(o));s!==i&&s.get(a)},get size(){const a=this.__v_raw;return!t&&tt(ve(a),"iterate",ur),a.size},has(a){const s=this.__v_raw,i=ve(s),o=ve(a);return t||(bn(a,o)&&tt(i,"has",a),tt(i,"has",o)),a===o?s.has(a):s.has(a)||s.has(o)},forEach(a,s){const i=this,o=i.__v_raw,c=ve(o),u=e?Vo:t?Ba:yn;return!t&&tt(c,"iterate",ur),o.forEach((g,f)=>a.call(s,u(g),u(f),i))}};return lt(n,t?{add:Ja("add"),set:Ja("set"),delete:Ja("delete"),clear:Ja("clear")}:{add(a){!e&&!$t(a)&&!Hn(a)&&(a=ve(a));const s=ve(this);return Za(s).has.call(s,a)||(s.add(a),gn(s,"add",a,a)),this},set(a,s){!e&&!$t(s)&&!Hn(s)&&(s=ve(s));const i=ve(this),{has:o,get:c}=Za(i);let u=o.call(i,a);u||(a=ve(a),u=o.call(i,a));const g=c.call(i,a);return i.set(a,s),u?bn(s,g)&&gn(i,"set",a,s):gn(i,"add",a,s),this},delete(a){const s=ve(this),{has:i,get:o}=Za(s);let c=i.call(s,a);c||(a=ve(a),c=i.call(s,a)),o&&o.call(s,a);const u=s.delete(a);return c&&gn(s,"delete",a,void 0),u},clear(){const a=ve(this),s=a.size!==0,i=a.clear();return s&&gn(a,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(a=>{n[a]=Tv(a,t,e)}),n}function Rc(t,e){const n=xv(t,e);return(r,a,s)=>a==="__v_isReactive"?!t:a==="__v_isReadonly"?t:a==="__v_raw"?r:Reflect.get(ye(n,a)&&a in r?n:r,a,s)}const Sv={get:Rc(!1,!1)},Cv={get:Rc(!1,!0)},wv={get:Rc(!0,!1)};const El=new WeakMap,Rl=new WeakMap,Ol=new WeakMap,Ev=new WeakMap;function Rv(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ov(t){return t.__v_skip||!Object.isExtensible(t)?0:Rv(Yd(t))}function Oc(t){return Hn(t)?t:Mc(t,!1,dv,Sv,El)}function Mv(t){return Mc(t,!1,yv,Cv,Rl)}function Fo(t){return Mc(t,!0,vv,wv,Ol)}function Mc(t,e,n,r,a){if(!ke(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=Ov(t);if(s===0)return t;const i=a.get(t);if(i)return i;const o=new Proxy(t,s===2?r:n);return a.set(t,o),o}function Br(t){return Hn(t)?Br(t.__v_raw):!!(t&&t.__v_isReactive)}function Hn(t){return!!(t&&t.__v_isReadonly)}function $t(t){return!!(t&&t.__v_isShallow)}function Dc(t){return t?!!t.__v_raw:!1}function ve(t){const e=t&&t.__v_raw;return e?ve(e):t}function Dv(t){return!ye(t,"__v_skip")&&Object.isExtensible(t)&&ul(t,"__v_skip",!0),t}const yn=t=>ke(t)?Oc(t):t,Ba=t=>ke(t)?Fo(t):t;function nt(t){return t?t.__v_isRef===!0:!1}function Uf(t){return Lv(t,!1)}function Lv(t,e){return nt(t)?t:new mv(t,e)}class mv{constructor(e,n){this.dep=new wc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:ve(e),this._value=n?e:yn(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,r=this.__v_isShallow||$t(e)||Hn(e);e=r?e:ve(e),bn(e,n)&&(this._rawValue=e,this._value=r?e:yn(e),this.dep.trigger())}}function Vv(t){return nt(t)?t.value:t}const Fv={get:(t,e,n)=>e==="__v_raw"?t:Vv(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const a=t[e];return nt(a)&&!nt(n)?(a.value=n,!0):Reflect.set(t,e,n,r)}};function Ml(t){return Br(t)?t:new Proxy(t,Fv)}class Bv{constructor(e,n,r){this.fn=e,this.setter=n,this._value=void 0,this.dep=new wc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Va-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Re!==this)return hl(this,!0),!0}get value(){const e=this.dep.track();return yl(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function _v(t,e,n=!1){let r,a;return oe(t)?r=t:(r=t.get,a=t.set),new Bv(r,a,n)}const es={},As=new WeakMap;let rr;function Uv(t,e=!1,n=rr){if(n){let r=As.get(n);r||As.set(n,r=[]),r.push(t)}}function Nv(t,e,n=Oe){const{immediate:r,deep:a,once:s,scheduler:i,augmentJob:o,call:c}=n,u=y=>a?y:$t(y)||a===!1||a===0?Nn(y,1):Nn(y);let g,f,l,p,v=!1,h=!1;if(nt(t)?(f=()=>t.value,v=$t(t)):Br(t)?(f=()=>u(t),v=!0):ce(t)?(h=!0,v=t.some(y=>Br(y)||$t(y)),f=()=>t.map(y=>{if(nt(y))return y.value;if(Br(y))return u(y);if(oe(y))return c?c(y,2):y()})):oe(t)?e?f=c?()=>c(t,2):t:f=()=>{if(l){dn();try{l()}finally{vn()}}const y=rr;rr=g;try{return c?c(t,3,[p]):t(p)}finally{rr=y}}:f=Zt,e&&a){const y=f,C=a===!0?1/0:a;f=()=>Nn(y(),C)}const d=ov(),T=()=>{g.stop(),d&&d.active&&dc(d.effects,g)};if(s&&e){const y=e;e=(...C)=>{y(...C),T()}}let S=h?new Array(t.length).fill(es):es;const x=y=>{if(!(!(g.flags&1)||!g.dirty&&!y))if(e){const C=g.run();if(a||v||(h?C.some((w,R)=>bn(w,S[R])):bn(C,S))){l&&l();const w=rr;rr=g;try{const R=[C,S===es?void 0:h&&S[0]===es?[]:S,p];S=C,c?c(e,3,R):e(...R)}finally{rr=w}}}else g.run()};return o&&o(x),g=new ll(f),g.scheduler=i?()=>i(x,!1):x,p=y=>Uv(y,!1,g),l=g.onStop=()=>{const y=As.get(g);if(y){if(c)c(y,4);else for(const C of y)C();As.delete(g)}},e?r?x(!0):S=g.run():i?i(x.bind(null,!0),!0):g.run(),T.pause=g.pause.bind(g),T.resume=g.resume.bind(g),T.stop=T,T}function Nn(t,e=1/0,n){if(e<=0||!ke(t)||t.__v_skip||(n=n||new Map,(n.get(t)||0)>=e))return t;if(n.set(t,e),e--,nt(t))Nn(t.value,e,n);else if(ce(t))for(let r=0;r<t.length;r++)Nn(t[r],e,n);else if(Xd(t)||ya(t))t.forEach(r=>{Nn(r,e,n)});else if(qd(t)){for(const r in t)Nn(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&Nn(t[r],e,n)}return t}function Ha(t,e,n,r){try{return r?t(...r):t()}catch(a){di(a,e,n)}}function tn(t,e,n,r){if(oe(t)){const a=Ha(t,e,n,r);return a&&cl(a)&&a.catch(s=>{di(s,e,n)}),a}if(ce(t)){const a=[];for(let s=0;s<t.length;s++)a.push(tn(t[s],e,n,r));return a}}function di(t,e,n,r=!0){const a=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:i}=e&&e.appContext.config||Oe;if(e){let o=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;o;){const g=o.ec;if(g){for(let f=0;f<g.length;f++)if(g[f](t,c,u)===!1)return}o=o.parent}if(s){dn(),Ha(s,null,10,[t,c,u]),vn();return}}kv(t,n,a,r,i)}function kv(t,e,n,r=!0,a=!1){if(a)throw t;console.error(t)}const ot=[];let Xt=-1;const _r=[];let Bn=null,Lr=0;const Dl=Promise.resolve();let js=null;function Gv(t){const e=js||Dl;return t?e.then(this?t.bind(this):t):e}function bv(t){let e=Xt+1,n=ot.length;for(;e<n;){const r=e+n>>>1,a=ot[r],s=_a(a);s<t||s===t&&a.flags&2?e=r+1:n=r}return e}function Lc(t){if(!(t.flags&1)){const e=_a(t),n=ot[ot.length-1];!n||!(t.flags&2)&&e>=_a(n)?ot.push(t):ot.splice(bv(e),0,t),t.flags|=1,Ll()}}function Ll(){js||(js=Dl.then(Vl))}function $v(t){ce(t)?_r.push(...t):Bn&&t.id===-1?Bn.splice(Lr+1,0,t):t.flags&1||(_r.push(t),t.flags|=1),Ll()}function Nf(t,e,n=Xt+1){for(;n<ot.length;n++){const r=ot[n];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;ot.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function ml(t){if(_r.length){const e=[...new Set(_r)].sort((n,r)=>_a(n)-_a(r));if(_r.length=0,Bn){Bn.push(...e);return}for(Bn=e,Lr=0;Lr<Bn.length;Lr++){const n=Bn[Lr];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Bn=null,Lr=0}}const _a=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Vl(t){try{for(Xt=0;Xt<ot.length;Xt++){const e=ot[Xt];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Ha(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Xt<ot.length;Xt++){const e=ot[Xt];e&&(e.flags&=-2)}Xt=-1,ot.length=0,ml(),js=null,(ot.length||_r.length)&&Vl()}}let Qt=null,Fl=null;function Ks(t){const e=Qt;return Qt=t,Fl=t&&t.type.__scopeId||null,e}function Wv(t,e=Qt,n){if(!e||t._n)return t;const r=(...a)=>{r._d&&Kf(-1);const s=Ks(e);let i;try{i=t(...a)}finally{Ks(s),r._d&&Kf(1)}return i};return r._n=!0,r._c=!0,r._d=!0,r}function Xn(t,e,n,r){const a=t.dirs,s=e&&e.dirs;for(let i=0;i<a.length;i++){const o=a[i];s&&(o.oldValue=s[i].value);let c=o.dir[r];c&&(dn(),tn(c,n,8,[t.el,o,t,e]),vn())}}const zv=Symbol("_vte"),Hv=t=>t.__isTeleport,Av=Symbol("_leaveCb");function mc(t,e){t.shapeFlag&6&&t.component?(t.transition=e,mc(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Bl(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const Ps=new WeakMap;function Ca(t,e,n,r,a=!1){if(ce(t)){t.forEach((v,h)=>Ca(v,e&&(ce(e)?e[h]:e),n,r,a));return}if(wa(r)&&!a){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Ca(t,e,n,r.component.subTree);return}const s=r.shapeFlag&4?_c(r.component):r.el,i=a?null:s,{i:o,r:c}=t,u=e&&e.r,g=o.refs===Oe?o.refs={}:o.refs,f=o.setupState,l=ve(f),p=f===Oe?ol:v=>ye(l,v);if(u!=null&&u!==c){if(kf(e),Ie(u))g[u]=null,p(u)&&(f[u]=null);else if(nt(u)){u.value=null;const v=e;v.k&&(g[v.k]=null)}}if(oe(c))Ha(c,o,12,[i,g]);else{const v=Ie(c),h=nt(c);if(v||h){const d=()=>{if(t.f){const T=v?p(c)?f[c]:g[c]:c.value;if(a)ce(T)&&dc(T,s);else if(ce(T))T.includes(s)||T.push(s);else if(v)g[c]=[s],p(c)&&(f[c]=g[c]);else{const S=[s];c.value=S,t.k&&(g[t.k]=S)}}else v?(g[c]=i,p(c)&&(f[c]=i)):h&&(c.value=i,t.k&&(g[t.k]=i))};if(i){const T=()=>{d(),Ps.delete(t)};T.id=-1,Ps.set(t,T),Ct(T,n)}else kf(t),d()}}}function kf(t){const e=Ps.get(t);e&&(e.flags|=8,Ps.delete(t))}hi().requestIdleCallback;hi().cancelIdleCallback;const wa=t=>!!t.type.__asyncLoader,_l=t=>t.type.__isKeepAlive;function jv(t,e){Ul(t,"a",e)}function Kv(t,e){Ul(t,"da",e)}function Ul(t,e,n=ft){const r=t.__wdc||(t.__wdc=()=>{let a=n;for(;a;){if(a.isDeactivated)return;a=a.parent}return t()});if(vi(e,r,n),n){let a=n.parent;for(;a&&a.parent;)_l(a.parent.vnode)&&Pv(r,e,n,a),a=a.parent}}function Pv(t,e,n,r){const a=vi(e,t,r,!0);Gl(()=>{dc(r[e],a)},n)}function vi(t,e,n=ft,r=!1){if(n){const a=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...i)=>{dn();const o=Aa(n),c=tn(e,n,t,i);return o(),vn(),c});return r?a.unshift(s):a.push(s),s}}const Sn=t=>(e,n=ft)=>{(!Na||t==="sp")&&vi(t,(...r)=>e(...r),n)},Xv=Sn("bm"),Nl=Sn("m"),Iv=Sn("bu"),Yv=Sn("u"),kl=Sn("bum"),Gl=Sn("um"),qv=Sn("sp"),Qv=Sn("rtg"),Zv=Sn("rtc");function Jv(t,e=ft){vi("ec",t,e)}const ey=Symbol.for("v-ndc"),Bo=t=>t?r0(t)?_c(t):Bo(t.parent):null,Ea=lt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Bo(t.parent),$root:t=>Bo(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>$l(t),$forceUpdate:t=>t.f||(t.f=()=>{Lc(t.update)}),$nextTick:t=>t.n||(t.n=Gv.bind(t.proxy)),$watch:t=>ly.bind(t)}),Gi=(t,e)=>t!==Oe&&!t.__isScriptSetup&&ye(t,e),ty={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:a,props:s,accessCache:i,type:o,appContext:c}=t;if(e[0]!=="$"){const l=i[e];if(l!==void 0)switch(l){case 1:return r[e];case 2:return a[e];case 4:return n[e];case 3:return s[e]}else{if(Gi(r,e))return i[e]=1,r[e];if(a!==Oe&&ye(a,e))return i[e]=2,a[e];if(ye(s,e))return i[e]=3,s[e];if(n!==Oe&&ye(n,e))return i[e]=4,n[e];_o&&(i[e]=0)}}const u=Ea[e];let g,f;if(u)return e==="$attrs"&&tt(t.attrs,"get",""),u(t);if((g=o.__cssModules)&&(g=g[e]))return g;if(n!==Oe&&ye(n,e))return i[e]=4,n[e];if(f=c.config.globalProperties,ye(f,e))return f[e]},set({_:t},e,n){const{data:r,setupState:a,ctx:s}=t;return Gi(a,e)?(a[e]=n,!0):r!==Oe&&ye(r,e)?(r[e]=n,!0):ye(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:a,props:s,type:i}},o){let c;return!!(n[o]||t!==Oe&&o[0]!=="$"&&ye(t,o)||Gi(e,o)||ye(s,o)||ye(r,o)||ye(Ea,o)||ye(a.config.globalProperties,o)||(c=i.__cssModules)&&c[o])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ye(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Gf(t){return ce(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let _o=!0;function ny(t){const e=$l(t),n=t.proxy,r=t.ctx;_o=!1,e.beforeCreate&&bf(e.beforeCreate,t,"bc");const{data:a,computed:s,methods:i,watch:o,provide:c,inject:u,created:g,beforeMount:f,mounted:l,beforeUpdate:p,updated:v,activated:h,deactivated:d,beforeDestroy:T,beforeUnmount:S,destroyed:x,unmounted:y,render:C,renderTracked:w,renderTriggered:R,errorCaptured:O,serverPrefetch:V,expose:L,inheritAttrs:m,components:F,directives:B,filters:_}=e;if(u&&ry(u,r,null),i)for(const A in i){const I=i[A];oe(I)&&(r[A]=I.bind(n))}if(a){const A=a.call(n,n);ke(A)&&(t.data=Oc(A))}if(_o=!0,s)for(const A in s){const I=s[A],k=oe(I)?I.bind(n,n):oe(I.get)?I.get.bind(n,n):Zt,Y=!oe(I)&&oe(I.set)?I.set.bind(n):Zt,te=Yy({get:k,set:Y});Object.defineProperty(r,A,{enumerable:!0,configurable:!0,get:()=>te.value,set:J=>te.value=J})}if(o)for(const A in o)bl(o[A],r,n,A);if(c){const A=oe(c)?c.call(n):c;Reflect.ownKeys(A).forEach(I=>{fy(I,A[I])})}g&&bf(g,t,"c");function z(A,I){ce(I)?I.forEach(k=>A(k.bind(n))):I&&A(I.bind(n))}if(z(Xv,f),z(Nl,l),z(Iv,p),z(Yv,v),z(jv,h),z(Kv,d),z(Jv,O),z(Zv,w),z(Qv,R),z(kl,S),z(Gl,y),z(qv,V),ce(L))if(L.length){const A=t.exposed||(t.exposed={});L.forEach(I=>{Object.defineProperty(A,I,{get:()=>n[I],set:k=>n[I]=k,enumerable:!0})})}else t.exposed||(t.exposed={});C&&t.render===Zt&&(t.render=C),m!=null&&(t.inheritAttrs=m),F&&(t.components=F),B&&(t.directives=B),V&&Bl(t)}function ry(t,e,n=Zt){ce(t)&&(t=Uo(t));for(const r in t){const a=t[r];let s;ke(a)?"default"in a?s=Rs(a.from||r,a.default,!0):s=Rs(a.from||r):s=Rs(a),nt(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:i=>s.value=i}):e[r]=s}}function bf(t,e,n){tn(ce(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function bl(t,e,n,r){let a=r.includes(".")?Hl(n,r):()=>n[r];if(Ie(t)){const s=e[t];oe(s)&&bi(a,s)}else if(oe(t))bi(a,t.bind(n));else if(ke(t))if(ce(t))t.forEach(s=>bl(s,e,n,r));else{const s=oe(t.handler)?t.handler.bind(n):e[t.handler];oe(s)&&bi(a,s,t)}}function $l(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:a,optionsCache:s,config:{optionMergeStrategies:i}}=t.appContext,o=s.get(e);let c;return o?c=o:!a.length&&!n&&!r?c=e:(c={},a.length&&a.forEach(u=>Xs(c,u,i,!0)),Xs(c,e,i)),ke(e)&&s.set(e,c),c}function Xs(t,e,n,r=!1){const{mixins:a,extends:s}=e;s&&Xs(t,s,n,!0),a&&a.forEach(i=>Xs(t,i,n,!0));for(const i in e)if(!(r&&i==="expose")){const o=ay[i]||n&&n[i];t[i]=o?o(t[i],e[i]):e[i]}return t}const ay={data:$f,props:Wf,emits:Wf,methods:ca,computed:ca,beforeCreate:it,created:it,beforeMount:it,mounted:it,beforeUpdate:it,updated:it,beforeDestroy:it,beforeUnmount:it,destroyed:it,unmounted:it,activated:it,deactivated:it,errorCaptured:it,serverPrefetch:it,components:ca,directives:ca,watch:iy,provide:$f,inject:sy};function $f(t,e){return e?t?function(){return lt(oe(t)?t.call(this,this):t,oe(e)?e.call(this,this):e)}:e:t}function sy(t,e){return ca(Uo(t),Uo(e))}function Uo(t){if(ce(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function it(t,e){return t?[...new Set([].concat(t,e))]:e}function ca(t,e){return t?lt(Object.create(null),t,e):e}function Wf(t,e){return t?ce(t)&&ce(e)?[...new Set([...t,...e])]:lt(Object.create(null),Gf(t),Gf(e??{})):e}function iy(t,e){if(!t)return e;if(!e)return t;const n=lt(Object.create(null),t);for(const r in e)n[r]=it(t[r],e[r]);return n}function Wl(){return{app:null,config:{isNativeTag:ol,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let oy=0;function cy(t,e){return function(r,a=null){oe(r)||(r=lt({},r)),a!=null&&!ke(a)&&(a=null);const s=Wl(),i=new WeakSet,o=[];let c=!1;const u=s.app={_uid:oy++,_component:r,_props:a,_container:null,_context:s,_instance:null,version:qy,get config(){return s.config},set config(g){},use(g,...f){return i.has(g)||(g&&oe(g.install)?(i.add(g),g.install(u,...f)):oe(g)&&(i.add(g),g(u,...f))),u},mixin(g){return s.mixins.includes(g)||s.mixins.push(g),u},component(g,f){return f?(s.components[g]=f,u):s.components[g]},directive(g,f){return f?(s.directives[g]=f,u):s.directives[g]},mount(g,f,l){if(!c){const p=u._ceVNode||$n(r,a);return p.appContext=s,l===!0?l="svg":l===!1&&(l=void 0),t(p,g,l),c=!0,u._container=g,g.__vue_app__=u,_c(p.component)}},onUnmount(g){o.push(g)},unmount(){c&&(tn(o,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(g,f){return s.provides[g]=f,u},runWithContext(g){const f=Ur;Ur=u;try{return g()}finally{Ur=f}}};return u}}let Ur=null;function fy(t,e){if(ft){let n=ft.provides;const r=ft.parent&&ft.parent.provides;r===n&&(n=ft.provides=Object.create(r)),n[t]=e}}function Rs(t,e,n=!1){const r=Ay();if(r||Ur){let a=Ur?Ur._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(a&&t in a)return a[t];if(arguments.length>1)return n&&oe(e)?e.call(r&&r.proxy):e}}const uy=Symbol.for("v-scx"),gy=()=>Rs(uy);function bi(t,e,n){return zl(t,e,n)}function zl(t,e,n=Oe){const{immediate:r,deep:a,flush:s,once:i}=n,o=lt({},n),c=e&&r||!e&&s!=="post";let u;if(Na){if(s==="sync"){const p=gy();u=p.__watcherHandles||(p.__watcherHandles=[])}else if(!c){const p=()=>{};return p.stop=Zt,p.resume=Zt,p.pause=Zt,p}}const g=ft;o.call=(p,v,h)=>tn(p,g,v,h);let f=!1;s==="post"?o.scheduler=p=>{Ct(p,g&&g.suspense)}:s!=="sync"&&(f=!0,o.scheduler=(p,v)=>{v?p():Lc(p)}),o.augmentJob=p=>{e&&(p.flags|=4),f&&(p.flags|=2,g&&(p.id=g.uid,p.i=g))};const l=Nv(t,e,o);return Na&&(u?u.push(l):c&&l()),l}function ly(t,e,n){const r=this.proxy,a=Ie(t)?t.includes(".")?Hl(r,t):()=>r[t]:t.bind(r,r);let s;oe(e)?s=e:(s=e.handler,n=e);const i=Aa(this),o=zl(a,s.bind(r),n);return i(),o}function Hl(t,e){const n=e.split(".");return()=>{let r=t;for(let a=0;a<n.length&&r;a++)r=r[n[a]];return r}}const py=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${zn(e)}Modifiers`]||t[`${xr(e)}Modifiers`];function hy(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Oe;let a=n;const s=e.startsWith("update:"),i=s&&py(r,e.slice(7));i&&(i.trim&&(a=n.map(g=>Ie(g)?g.trim():g)),i.number&&(a=n.map(Jd)));let o,c=r[o=Bi(e)]||r[o=Bi(zn(e))];!c&&s&&(c=r[o=Bi(xr(e))]),c&&tn(c,t,6,a);const u=r[o+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,tn(u,t,6,a)}}const dy=new WeakMap;function Al(t,e,n=!1){const r=n?dy:e.emitsCache,a=r.get(t);if(a!==void 0)return a;const s=t.emits;let i={},o=!1;if(!oe(t)){const c=u=>{const g=Al(u,e,!0);g&&(o=!0,lt(i,g))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!s&&!o?(ke(t)&&r.set(t,null),null):(ce(s)?s.forEach(c=>i[c]=null):lt(i,s),ke(t)&&r.set(t,i),i)}function yi(t,e){return!t||!gi(e)?!1:(e=e.slice(2).replace(/Once$/,""),ye(t,e[0].toLowerCase()+e.slice(1))||ye(t,xr(e))||ye(t,e))}function zf(t){const{type:e,vnode:n,proxy:r,withProxy:a,propsOptions:[s],slots:i,attrs:o,emit:c,render:u,renderCache:g,props:f,data:l,setupState:p,ctx:v,inheritAttrs:h}=t,d=Ks(t);let T,S;try{if(n.shapeFlag&4){const y=a||r,C=y;T=Yt(u.call(C,y,g,f,p,l,v)),S=o}else{const y=e;T=Yt(y.length>1?y(f,{attrs:o,slots:i,emit:c}):y(f,null)),S=e.props?o:vy(o)}}catch(y){Ra.length=0,di(y,t,1),T=$n(br)}let x=T;if(S&&h!==!1){const y=Object.keys(S),{shapeFlag:C}=x;y.length&&C&7&&(s&&y.some(hc)&&(S=yy(S,s)),x=$r(x,S,!1,!0))}return n.dirs&&(x=$r(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(n.dirs):n.dirs),n.transition&&mc(x,n.transition),T=x,Ks(d),T}const vy=t=>{let e;for(const n in t)(n==="class"||n==="style"||gi(n))&&((e||(e={}))[n]=t[n]);return e},yy=(t,e)=>{const n={};for(const r in t)(!hc(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function Ty(t,e,n){const{props:r,children:a,component:s}=t,{props:i,children:o,patchFlag:c}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?Hf(r,i,u):!!i;if(c&8){const g=e.dynamicProps;for(let f=0;f<g.length;f++){const l=g[f];if(i[l]!==r[l]&&!yi(u,l))return!0}}}else return(a||o)&&(!o||!o.$stable)?!0:r===i?!1:r?i?Hf(r,i,u):!0:!!i;return!1}function Hf(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let a=0;a<r.length;a++){const s=r[a];if(e[s]!==t[s]&&!yi(n,s))return!0}return!1}function xy({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const jl={},Kl=()=>Object.create(jl),Pl=t=>Object.getPrototypeOf(t)===jl;function Sy(t,e,n,r=!1){const a={},s=Kl();t.propsDefaults=Object.create(null),Xl(t,e,a,s);for(const i in t.propsOptions[0])i in a||(a[i]=void 0);n?t.props=r?a:Mv(a):t.type.props?t.props=a:t.props=s,t.attrs=s}function Cy(t,e,n,r){const{props:a,attrs:s,vnode:{patchFlag:i}}=t,o=ve(a),[c]=t.propsOptions;let u=!1;if((r||i>0)&&!(i&16)){if(i&8){const g=t.vnode.dynamicProps;for(let f=0;f<g.length;f++){let l=g[f];if(yi(t.emitsOptions,l))continue;const p=e[l];if(c)if(ye(s,l))p!==s[l]&&(s[l]=p,u=!0);else{const v=zn(l);a[v]=No(c,o,v,p,t,!1)}else p!==s[l]&&(s[l]=p,u=!0)}}}else{Xl(t,e,a,s)&&(u=!0);let g;for(const f in o)(!e||!ye(e,f)&&((g=xr(f))===f||!ye(e,g)))&&(c?n&&(n[f]!==void 0||n[g]!==void 0)&&(a[f]=No(c,o,f,void 0,t,!0)):delete a[f]);if(s!==o)for(const f in s)(!e||!ye(e,f))&&(delete s[f],u=!0)}u&&gn(t.attrs,"set","")}function Xl(t,e,n,r){const[a,s]=t.propsOptions;let i=!1,o;if(e)for(let c in e){if(Ta(c))continue;const u=e[c];let g;a&&ye(a,g=zn(c))?!s||!s.includes(g)?n[g]=u:(o||(o={}))[g]=u:yi(t.emitsOptions,c)||(!(c in r)||u!==r[c])&&(r[c]=u,i=!0)}if(s){const c=ve(n),u=o||Oe;for(let g=0;g<s.length;g++){const f=s[g];n[f]=No(a,c,f,u[f],t,!ye(u,f))}}return i}function No(t,e,n,r,a,s){const i=t[n];if(i!=null){const o=ye(i,"default");if(o&&r===void 0){const c=i.default;if(i.type!==Function&&!i.skipFactory&&oe(c)){const{propsDefaults:u}=a;if(n in u)r=u[n];else{const g=Aa(a);r=u[n]=c.call(null,e),g()}}else r=c;a.ce&&a.ce._setProp(n,r)}i[0]&&(s&&!o?r=!1:i[1]&&(r===""||r===xr(n))&&(r=!0))}return r}const wy=new WeakMap;function Il(t,e,n=!1){const r=n?wy:e.propsCache,a=r.get(t);if(a)return a;const s=t.props,i={},o=[];let c=!1;if(!oe(t)){const g=f=>{c=!0;const[l,p]=Il(f,e,!0);lt(i,l),p&&o.push(...p)};!n&&e.mixins.length&&e.mixins.forEach(g),t.extends&&g(t.extends),t.mixins&&t.mixins.forEach(g)}if(!s&&!c)return ke(t)&&r.set(t,Fr),Fr;if(ce(s))for(let g=0;g<s.length;g++){const f=zn(s[g]);Af(f)&&(i[f]=Oe)}else if(s)for(const g in s){const f=zn(g);if(Af(f)){const l=s[g],p=i[f]=ce(l)||oe(l)?{type:l}:lt({},l),v=p.type;let h=!1,d=!0;if(ce(v))for(let T=0;T<v.length;++T){const S=v[T],x=oe(S)&&S.name;if(x==="Boolean"){h=!0;break}else x==="String"&&(d=!1)}else h=oe(v)&&v.name==="Boolean";p[0]=h,p[1]=d,(h||ye(p,"default"))&&o.push(f)}}const u=[i,o];return ke(t)&&r.set(t,u),u}function Af(t){return t[0]!=="$"&&!Ta(t)}const Vc=t=>t==="_"||t==="_ctx"||t==="$stable",Fc=t=>ce(t)?t.map(Yt):[Yt(t)],Ey=(t,e,n)=>{if(e._n)return e;const r=Wv((...a)=>Fc(e(...a)),n);return r._c=!1,r},Yl=(t,e,n)=>{const r=t._ctx;for(const a in t){if(Vc(a))continue;const s=t[a];if(oe(s))e[a]=Ey(a,s,r);else if(s!=null){const i=Fc(s);e[a]=()=>i}}},ql=(t,e)=>{const n=Fc(e);t.slots.default=()=>n},Ql=(t,e,n)=>{for(const r in e)(n||!Vc(r))&&(t[r]=e[r])},Ry=(t,e,n)=>{const r=t.slots=Kl();if(t.vnode.shapeFlag&32){const a=e._;a?(Ql(r,e,n),n&&ul(r,"_",a,!0)):Yl(e,r)}else e&&ql(t,e)},Oy=(t,e,n)=>{const{vnode:r,slots:a}=t;let s=!0,i=Oe;if(r.shapeFlag&32){const o=e._;o?n&&o===1?s=!1:Ql(a,e,n):(s=!e.$stable,Yl(e,a)),i=e}else e&&(ql(t,e),i={default:1});if(s)for(const o in a)!Vc(o)&&i[o]==null&&delete a[o]},Ct=Vy;function My(t){return Dy(t)}function Dy(t,e){const n=hi();n.__VUE__=!0;const{insert:r,remove:a,patchProp:s,createElement:i,createText:o,createComment:c,setText:u,setElementText:g,parentNode:f,nextSibling:l,setScopeId:p=Zt,insertStaticContent:v}=t,h=(M,D,U,W=null,G=null,b=null,K=void 0,j=null,H=!!D.dynamicChildren)=>{if(M===D)return;M&&!ea(M,D)&&(W=$e(M),J(M,G,b,!0),M=null),D.patchFlag===-2&&(H=!1,D.dynamicChildren=null);const{type:$,ref:Z,shapeFlag:X}=D;switch($){case Ti:d(M,D,U,W);break;case br:T(M,D,U,W);break;case Os:M==null&&S(D,U,W,K);break;case fn:F(M,D,U,W,G,b,K,j,H);break;default:X&1?C(M,D,U,W,G,b,K,j,H):X&6?B(M,D,U,W,G,b,K,j,H):(X&64||X&128)&&$.process(M,D,U,W,G,b,K,j,H,je)}Z!=null&&G?Ca(Z,M&&M.ref,b,D||M,!D):Z==null&&M&&M.ref!=null&&Ca(M.ref,null,b,M,!0)},d=(M,D,U,W)=>{if(M==null)r(D.el=o(D.children),U,W);else{const G=D.el=M.el;D.children!==M.children&&u(G,D.children)}},T=(M,D,U,W)=>{M==null?r(D.el=c(D.children||""),U,W):D.el=M.el},S=(M,D,U,W)=>{[M.el,M.anchor]=v(M.children,D,U,W,M.el,M.anchor)},x=({el:M,anchor:D},U,W)=>{let G;for(;M&&M!==D;)G=l(M),r(M,U,W),M=G;r(D,U,W)},y=({el:M,anchor:D})=>{let U;for(;M&&M!==D;)U=l(M),a(M),M=U;a(D)},C=(M,D,U,W,G,b,K,j,H)=>{if(D.type==="svg"?K="svg":D.type==="math"&&(K="mathml"),M==null)w(D,U,W,G,b,K,j,H);else{const $=M.el&&M.el._isVueCE?M.el:null;try{$&&$._beginPatch(),V(M,D,G,b,K,j,H)}finally{$&&$._endPatch()}}},w=(M,D,U,W,G,b,K,j)=>{let H,$;const{props:Z,shapeFlag:X,transition:Q,dirs:ne}=M;if(H=M.el=i(M.type,b,Z&&Z.is,Z),X&8?g(H,M.children):X&16&&O(M.children,H,null,W,G,$i(M,b),K,j),ne&&Xn(M,null,W,"created"),R(H,M,M.scopeId,K,W),Z){for(const Ee in Z)Ee!=="value"&&!Ta(Ee)&&s(H,Ee,null,Z[Ee],b,W);"value"in Z&&s(H,"value",null,Z.value,b),($=Z.onVnodeBeforeMount)&&At($,W,M)}ne&&Xn(M,null,W,"beforeMount");const le=Ly(G,Q);le&&Q.beforeEnter(H),r(H,D,U),(($=Z&&Z.onVnodeMounted)||le||ne)&&Ct(()=>{$&&At($,W,M),le&&Q.enter(H),ne&&Xn(M,null,W,"mounted")},G)},R=(M,D,U,W,G)=>{if(U&&p(M,U),W)for(let b=0;b<W.length;b++)p(M,W[b]);if(G){let b=G.subTree;if(D===b||e0(b.type)&&(b.ssContent===D||b.ssFallback===D)){const K=G.vnode;R(M,K,K.scopeId,K.slotScopeIds,G.parent)}}},O=(M,D,U,W,G,b,K,j,H=0)=>{for(let $=H;$<M.length;$++){const Z=M[$]=j?_n(M[$]):Yt(M[$]);h(null,Z,D,U,W,G,b,K,j)}},V=(M,D,U,W,G,b,K)=>{const j=D.el=M.el;let{patchFlag:H,dynamicChildren:$,dirs:Z}=D;H|=M.patchFlag&16;const X=M.props||Oe,Q=D.props||Oe;let ne;if(U&&In(U,!1),(ne=Q.onVnodeBeforeUpdate)&&At(ne,U,D,M),Z&&Xn(D,M,U,"beforeUpdate"),U&&In(U,!0),(X.innerHTML&&Q.innerHTML==null||X.textContent&&Q.textContent==null)&&g(j,""),$?L(M.dynamicChildren,$,j,U,W,$i(D,G),b):K||I(M,D,j,null,U,W,$i(D,G),b,!1),H>0){if(H&16)m(j,X,Q,U,G);else if(H&2&&X.class!==Q.class&&s(j,"class",null,Q.class,G),H&4&&s(j,"style",X.style,Q.style,G),H&8){const le=D.dynamicProps;for(let Ee=0;Ee<le.length;Ee++){const Se=le[Ee],dt=X[Se],vt=Q[Se];(vt!==dt||Se==="value")&&s(j,Se,dt,vt,G,U)}}H&1&&M.children!==D.children&&g(j,D.children)}else!K&&$==null&&m(j,X,Q,U,G);((ne=Q.onVnodeUpdated)||Z)&&Ct(()=>{ne&&At(ne,U,D,M),Z&&Xn(D,M,U,"updated")},W)},L=(M,D,U,W,G,b,K)=>{for(let j=0;j<D.length;j++){const H=M[j],$=D[j],Z=H.el&&(H.type===fn||!ea(H,$)||H.shapeFlag&198)?f(H.el):U;h(H,$,Z,null,W,G,b,K,!0)}},m=(M,D,U,W,G)=>{if(D!==U){if(D!==Oe)for(const b in D)!Ta(b)&&!(b in U)&&s(M,b,D[b],null,G,W);for(const b in U){if(Ta(b))continue;const K=U[b],j=D[b];K!==j&&b!=="value"&&s(M,b,j,K,G,W)}"value"in U&&s(M,"value",D.value,U.value,G)}},F=(M,D,U,W,G,b,K,j,H)=>{const $=D.el=M?M.el:o(""),Z=D.anchor=M?M.anchor:o("");let{patchFlag:X,dynamicChildren:Q,slotScopeIds:ne}=D;ne&&(j=j?j.concat(ne):ne),M==null?(r($,U,W),r(Z,U,W),O(D.children||[],U,Z,G,b,K,j,H)):X>0&&X&64&&Q&&M.dynamicChildren?(L(M.dynamicChildren,Q,U,G,b,K,j),(D.key!=null||G&&D===G.subTree)&&Zl(M,D,!0)):I(M,D,U,Z,G,b,K,j,H)},B=(M,D,U,W,G,b,K,j,H)=>{D.slotScopeIds=j,M==null?D.shapeFlag&512?G.ctx.activate(D,U,W,K,H):_(D,U,W,G,b,K,H):P(M,D,H)},_=(M,D,U,W,G,b,K)=>{const j=M.component=Hy(M,W,G);if(_l(M)&&(j.ctx.renderer=je),jy(j,!1,K),j.asyncDep){if(G&&G.registerDep(j,z,K),!M.el){const H=j.subTree=$n(br);T(null,H,D,U),M.placeholder=H.el}}else z(j,M,D,U,G,b,K)},P=(M,D,U)=>{const W=D.component=M.component;if(Ty(M,D,U))if(W.asyncDep&&!W.asyncResolved){A(W,D,U);return}else W.next=D,W.update();else D.el=M.el,W.vnode=D},z=(M,D,U,W,G,b,K)=>{const j=()=>{if(M.isMounted){let{next:X,bu:Q,u:ne,parent:le,vnode:Ee}=M;{const zt=Jl(M);if(zt){X&&(X.el=Ee.el,A(M,X,K)),zt.asyncDep.then(()=>{M.isUnmounted||j()});return}}let Se=X,dt;In(M,!1),X?(X.el=Ee.el,A(M,X,K)):X=Ee,Q&&_i(Q),(dt=X.props&&X.props.onVnodeBeforeUpdate)&&At(dt,le,X,Ee),In(M,!0);const vt=zf(M),Wt=M.subTree;M.subTree=vt,h(Wt,vt,f(Wt.el),$e(Wt),M,G,b),X.el=vt.el,Se===null&&xy(M,vt.el),ne&&Ct(ne,G),(dt=X.props&&X.props.onVnodeUpdated)&&Ct(()=>At(dt,le,X,Ee),G)}else{let X;const{el:Q,props:ne}=D,{bm:le,m:Ee,parent:Se,root:dt,type:vt}=M,Wt=wa(D);In(M,!1),le&&_i(le),!Wt&&(X=ne&&ne.onVnodeBeforeMount)&&At(X,Se,D),In(M,!0);{dt.ce&&dt.ce._def.shadowRoot!==!1&&dt.ce._injectChildStyle(vt);const zt=M.subTree=zf(M);h(null,zt,U,W,M,G,b),D.el=zt.el}if(Ee&&Ct(Ee,G),!Wt&&(X=ne&&ne.onVnodeMounted)){const zt=D;Ct(()=>At(X,Se,zt),G)}(D.shapeFlag&256||Se&&wa(Se.vnode)&&Se.vnode.shapeFlag&256)&&M.a&&Ct(M.a,G),M.isMounted=!0,D=U=W=null}};M.scope.on();const H=M.effect=new ll(j);M.scope.off();const $=M.update=H.run.bind(H),Z=M.job=H.runIfDirty.bind(H);Z.i=M,Z.id=M.uid,H.scheduler=()=>Lc(Z),In(M,!0),$()},A=(M,D,U)=>{D.component=M;const W=M.vnode.props;M.vnode=D,M.next=null,Cy(M,D.props,W,U),Oy(M,D.children,U),dn(),Nf(M),vn()},I=(M,D,U,W,G,b,K,j,H=!1)=>{const $=M&&M.children,Z=M?M.shapeFlag:0,X=D.children,{patchFlag:Q,shapeFlag:ne}=D;if(Q>0){if(Q&128){Y($,X,U,W,G,b,K,j,H);return}else if(Q&256){k($,X,U,W,G,b,K,j,H);return}}ne&8?(Z&16&&Ce($,G,b),X!==$&&g(U,X)):Z&16?ne&16?Y($,X,U,W,G,b,K,j,H):Ce($,G,b,!0):(Z&8&&g(U,""),ne&16&&O(X,U,W,G,b,K,j,H))},k=(M,D,U,W,G,b,K,j,H)=>{M=M||Fr,D=D||Fr;const $=M.length,Z=D.length,X=Math.min($,Z);let Q;for(Q=0;Q<X;Q++){const ne=D[Q]=H?_n(D[Q]):Yt(D[Q]);h(M[Q],ne,U,null,G,b,K,j,H)}$>Z?Ce(M,G,b,!0,!1,X):O(D,U,W,G,b,K,j,H,X)},Y=(M,D,U,W,G,b,K,j,H)=>{let $=0;const Z=D.length;let X=M.length-1,Q=Z-1;for(;$<=X&&$<=Q;){const ne=M[$],le=D[$]=H?_n(D[$]):Yt(D[$]);if(ea(ne,le))h(ne,le,U,null,G,b,K,j,H);else break;$++}for(;$<=X&&$<=Q;){const ne=M[X],le=D[Q]=H?_n(D[Q]):Yt(D[Q]);if(ea(ne,le))h(ne,le,U,null,G,b,K,j,H);else break;X--,Q--}if($>X){if($<=Q){const ne=Q+1,le=ne<Z?D[ne].el:W;for(;$<=Q;)h(null,D[$]=H?_n(D[$]):Yt(D[$]),U,le,G,b,K,j,H),$++}}else if($>Q)for(;$<=X;)J(M[$],G,b,!0),$++;else{const ne=$,le=$,Ee=new Map;for($=le;$<=Q;$++){const St=D[$]=H?_n(D[$]):Yt(D[$]);St.key!=null&&Ee.set(St.key,$)}let Se,dt=0;const vt=Q-le+1;let Wt=!1,zt=0;const Zr=new Array(vt);for($=0;$<vt;$++)Zr[$]=0;for($=ne;$<=X;$++){const St=M[$];if(dt>=vt){J(St,G,b,!0);continue}let Ht;if(St.key!=null)Ht=Ee.get(St.key);else for(Se=le;Se<=Q;Se++)if(Zr[Se-le]===0&&ea(St,D[Se])){Ht=Se;break}Ht===void 0?J(St,G,b,!0):(Zr[Ht-le]=$+1,Ht>=zt?zt=Ht:Wt=!0,h(St,D[Ht],U,null,G,b,K,j,H),dt++)}const Lf=Wt?my(Zr):Fr;for(Se=Lf.length-1,$=vt-1;$>=0;$--){const St=le+$,Ht=D[St],mf=D[St+1],Vf=St+1<Z?mf.el||mf.placeholder:W;Zr[$]===0?h(null,Ht,U,Vf,G,b,K,j,H):Wt&&(Se<0||$!==Lf[Se]?te(Ht,U,Vf,2):Se--)}}},te=(M,D,U,W,G=null)=>{const{el:b,type:K,transition:j,children:H,shapeFlag:$}=M;if($&6){te(M.component.subTree,D,U,W);return}if($&128){M.suspense.move(D,U,W);return}if($&64){K.move(M,D,U,je);return}if(K===fn){r(b,D,U);for(let X=0;X<H.length;X++)te(H[X],D,U,W);r(M.anchor,D,U);return}if(K===Os){x(M,D,U);return}if(W!==2&&$&1&&j)if(W===0)j.beforeEnter(b),r(b,D,U),Ct(()=>j.enter(b),G);else{const{leave:X,delayLeave:Q,afterLeave:ne}=j,le=()=>{M.ctx.isUnmounted?a(b):r(b,D,U)},Ee=()=>{b._isLeaving&&b[Av](!0),X(b,()=>{le(),ne&&ne()})};Q?Q(b,le,Ee):Ee()}else r(b,D,U)},J=(M,D,U,W=!1,G=!1)=>{const{type:b,props:K,ref:j,children:H,dynamicChildren:$,shapeFlag:Z,patchFlag:X,dirs:Q,cacheIndex:ne}=M;if(X===-2&&(G=!1),j!=null&&(dn(),Ca(j,null,U,M,!0),vn()),ne!=null&&(D.renderCache[ne]=void 0),Z&256){D.ctx.deactivate(M);return}const le=Z&1&&Q,Ee=!wa(M);let Se;if(Ee&&(Se=K&&K.onVnodeBeforeUnmount)&&At(Se,D,M),Z&6)Ae(M.component,U,W);else{if(Z&128){M.suspense.unmount(U,W);return}le&&Xn(M,null,D,"beforeUnmount"),Z&64?M.type.remove(M,D,U,je,W):$&&!$.hasOnce&&(b!==fn||X>0&&X&64)?Ce($,D,U,!1,!0):(b===fn&&X&384||!G&&Z&16)&&Ce(H,D,U),W&&q(M)}(Ee&&(Se=K&&K.onVnodeUnmounted)||le)&&Ct(()=>{Se&&At(Se,D,M),le&&Xn(M,null,D,"unmounted")},U)},q=M=>{const{type:D,el:U,anchor:W,transition:G}=M;if(D===fn){ht(U,W);return}if(D===Os){y(M);return}const b=()=>{a(U),G&&!G.persisted&&G.afterLeave&&G.afterLeave()};if(M.shapeFlag&1&&G&&!G.persisted){const{leave:K,delayLeave:j}=G,H=()=>K(U,b);j?j(M.el,b,H):H()}else b()},ht=(M,D)=>{let U;for(;M!==D;)U=l(M),a(M),M=U;a(D)},Ae=(M,D,U)=>{const{bum:W,scope:G,job:b,subTree:K,um:j,m:H,a:$}=M;jf(H),jf($),W&&_i(W),G.stop(),b&&(b.flags|=8,J(K,M,D,U)),j&&Ct(j,D),Ct(()=>{M.isUnmounted=!0},D)},Ce=(M,D,U,W=!1,G=!1,b=0)=>{for(let K=b;K<M.length;K++)J(M[K],D,U,W,G)},$e=M=>{if(M.shapeFlag&6)return $e(M.component.subTree);if(M.shapeFlag&128)return M.suspense.next();const D=l(M.anchor||M.el),U=D&&D[zv];return U?l(U):D};let Ot=!1;const Je=(M,D,U)=>{M==null?D._vnode&&J(D._vnode,null,null,!0):h(D._vnode||null,M,D,null,null,null,U),D._vnode=M,Ot||(Ot=!0,Nf(),ml(),Ot=!1)},je={p:h,um:J,m:te,r:q,mt:_,mc:O,pc:I,pbc:L,n:$e,o:t};return{render:Je,hydrate:void 0,createApp:cy(Je)}}function $i({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function In({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Ly(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Zl(t,e,n=!1){const r=t.children,a=e.children;if(ce(r)&&ce(a))for(let s=0;s<r.length;s++){const i=r[s];let o=a[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=a[s]=_n(a[s]),o.el=i.el),!n&&o.patchFlag!==-2&&Zl(i,o)),o.type===Ti&&o.patchFlag!==-1&&(o.el=i.el),o.type===br&&!o.el&&(o.el=i.el)}}function my(t){const e=t.slice(),n=[0];let r,a,s,i,o;const c=t.length;for(r=0;r<c;r++){const u=t[r];if(u!==0){if(a=n[n.length-1],t[a]<u){e[r]=a,n.push(r);continue}for(s=0,i=n.length-1;s<i;)o=s+i>>1,t[n[o]]<u?s=o+1:i=o;u<t[n[s]]&&(s>0&&(e[r]=n[s-1]),n[s]=r)}}for(s=n.length,i=n[s-1];s-- >0;)n[s]=i,i=e[i];return n}function Jl(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Jl(e)}function jf(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const e0=t=>t.__isSuspense;function Vy(t,e){e&&e.pendingBranch?ce(t)?e.effects.push(...t):e.effects.push(t):$v(t)}const fn=Symbol.for("v-fgt"),Ti=Symbol.for("v-txt"),br=Symbol.for("v-cmt"),Os=Symbol.for("v-stc"),Ra=[];let wt=null;function Fy(t=!1){Ra.push(wt=t?null:[])}function By(){Ra.pop(),wt=Ra[Ra.length-1]||null}let Ua=1;function Kf(t,e=!1){Ua+=t,t<0&&wt&&e&&(wt.hasOnce=!0)}function _y(t){return t.dynamicChildren=Ua>0?wt||Fr:null,By(),Ua>0&&wt&&wt.push(t),t}function Uy(t,e,n,r,a,s){return _y(Ge(t,e,n,r,a,s,!0))}function t0(t){return t?t.__v_isVNode===!0:!1}function ea(t,e){return t.type===e.type&&t.key===e.key}const n0=({key:t})=>t??null,Ms=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Ie(t)||nt(t)||oe(t)?{i:Qt,r:t,k:e,f:!!n}:t:null);function Ge(t,e=null,n=null,r=0,a=null,s=t===fn?0:1,i=!1,o=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&n0(e),ref:e&&Ms(e),scopeId:Fl,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:a,dynamicChildren:null,appContext:null,ctx:Qt};return o?(Bc(c,n),s&128&&t.normalize(c)):n&&(c.shapeFlag|=Ie(n)?8:16),Ua>0&&!i&&wt&&(c.patchFlag>0||s&6)&&c.patchFlag!==32&&wt.push(c),c}const $n=Ny;function Ny(t,e=null,n=null,r=0,a=null,s=!1){if((!t||t===ey)&&(t=br),t0(t)){const o=$r(t,e,!0);return n&&Bc(o,n),Ua>0&&!s&&wt&&(o.shapeFlag&6?wt[wt.indexOf(t)]=o:wt.push(o)),o.patchFlag=-2,o}if(Iy(t)&&(t=t.__vccOpts),e){e=ky(e);let{class:o,style:c}=e;o&&!Ie(o)&&(e.class=Tc(o)),ke(c)&&(Dc(c)&&!ce(c)&&(c=lt({},c)),e.style=yc(c))}const i=Ie(t)?1:e0(t)?128:Hv(t)?64:ke(t)?4:oe(t)?2:0;return Ge(t,e,n,r,a,i,s,!0)}function ky(t){return t?Dc(t)||Pl(t)?lt({},t):t:null}function $r(t,e,n=!1,r=!1){const{props:a,ref:s,patchFlag:i,children:o,transition:c}=t,u=e?$y(a||{},e):a,g={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&n0(u),ref:e&&e.ref?n&&s?ce(s)?s.concat(Ms(e)):[s,Ms(e)]:Ms(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==fn?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&$r(t.ssContent),ssFallback:t.ssFallback&&$r(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&r&&mc(g,c.clone(g)),g}function Gy(t=" ",e=0){return $n(Ti,null,t,e)}function by(t,e){const n=$n(Os,null,t);return n.staticCount=e,n}function Yt(t){return t==null||typeof t=="boolean"?$n(br):ce(t)?$n(fn,null,t.slice()):t0(t)?_n(t):$n(Ti,null,String(t))}function _n(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:$r(t)}function Bc(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(ce(e))n=16;else if(typeof e=="object")if(r&65){const a=e.default;a&&(a._c&&(a._d=!1),Bc(t,a()),a._c&&(a._d=!0));return}else{n=32;const a=e._;!a&&!Pl(e)?e._ctx=Qt:a===3&&Qt&&(Qt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else oe(e)?(e={default:e,_ctx:Qt},n=32):(e=String(e),r&64?(n=16,e=[Gy(e)]):n=8);t.children=e,t.shapeFlag|=n}function $y(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const a in r)if(a==="class")e.class!==r.class&&(e.class=Tc([e.class,r.class]));else if(a==="style")e.style=yc([e.style,r.style]);else if(gi(a)){const s=e[a],i=r[a];i&&s!==i&&!(ce(s)&&s.includes(i))&&(e[a]=s?[].concat(s,i):i)}else a!==""&&(e[a]=r[a])}return e}function At(t,e,n,r=null){tn(t,e,7,[n,r])}const Wy=Wl();let zy=0;function Hy(t,e,n){const r=t.type,a=(e?e.appContext:t.appContext)||Wy,s={uid:zy++,vnode:t,type:r,parent:e,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new iv(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(a.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Il(r,a),emitsOptions:Al(r,a),emit:null,emitted:null,propsDefaults:Oe,inheritAttrs:r.inheritAttrs,ctx:Oe,data:Oe,props:Oe,attrs:Oe,slots:Oe,refs:Oe,setupState:Oe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=hy.bind(null,s),t.ce&&t.ce(s),s}let ft=null;const Ay=()=>ft||Qt;let Is,ko;{const t=hi(),e=(n,r)=>{let a;return(a=t[n])||(a=t[n]=[]),a.push(r),s=>{a.length>1?a.forEach(i=>i(s)):a[0](s)}};Is=e("__VUE_INSTANCE_SETTERS__",n=>ft=n),ko=e("__VUE_SSR_SETTERS__",n=>Na=n)}const Aa=t=>{const e=ft;return Is(t),t.scope.on(),()=>{t.scope.off(),Is(e)}},Pf=()=>{ft&&ft.scope.off(),Is(null)};function r0(t){return t.vnode.shapeFlag&4}let Na=!1;function jy(t,e=!1,n=!1){e&&ko(e);const{props:r,children:a}=t.vnode,s=r0(t);Sy(t,r,s,e),Ry(t,a,n||e);const i=s?Ky(t,e):void 0;return e&&ko(!1),i}function Ky(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,ty);const{setup:r}=n;if(r){dn();const a=t.setupContext=r.length>1?Xy(t):null,s=Aa(t),i=Ha(r,t,0,[t.props,a]),o=cl(i);if(vn(),s(),(o||t.sp)&&!wa(t)&&Bl(t),o){if(i.then(Pf,Pf),e)return i.then(c=>{Xf(t,c)}).catch(c=>{di(c,t,0)});t.asyncDep=i}else Xf(t,i)}else a0(t)}function Xf(t,e,n){oe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:ke(e)&&(t.setupState=Ml(e)),a0(t)}function a0(t,e,n){const r=t.type;t.render||(t.render=r.render||Zt);{const a=Aa(t);dn();try{ny(t)}finally{vn(),a()}}}const Py={get(t,e){return tt(t,"get",""),t[e]}};function Xy(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Py),slots:t.slots,emit:t.emit,expose:e}}function _c(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Ml(Dv(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Ea)return Ea[n](t)},has(e,n){return n in e||n in Ea}})):t.proxy}function Iy(t){return oe(t)&&"__vccOpts"in t}const Yy=(t,e)=>_v(t,e,Na),qy="3.5.25";let Go;const If=typeof window<"u"&&window.trustedTypes;if(If)try{Go=If.createPolicy("vue",{createHTML:t=>t})}catch{}const s0=Go?t=>Go.createHTML(t):t=>t,Qy="http://www.w3.org/2000/svg",Zy="http://www.w3.org/1998/Math/MathML",on=typeof document<"u"?document:null,Yf=on&&on.createElement("template"),Jy={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const a=e==="svg"?on.createElementNS(Qy,t):e==="mathml"?on.createElementNS(Zy,t):n?on.createElement(t,{is:n}):on.createElement(t);return t==="select"&&r&&r.multiple!=null&&a.setAttribute("multiple",r.multiple),a},createText:t=>on.createTextNode(t),createComment:t=>on.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>on.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,a,s){const i=n?n.previousSibling:e.lastChild;if(a&&(a===s||a.nextSibling))for(;e.insertBefore(a.cloneNode(!0),n),!(a===s||!(a=a.nextSibling)););else{Yf.innerHTML=s0(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const o=Yf.content;if(r==="svg"||r==="mathml"){const c=o.firstChild;for(;c.firstChild;)o.appendChild(c.firstChild);o.removeChild(c)}e.insertBefore(o,n)}return[i?i.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},eT=Symbol("_vtc");function tT(t,e,n){const r=t[eT];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const qf=Symbol("_vod"),nT=Symbol("_vsh"),rT=Symbol(""),aT=/(?:^|;)\s*display\s*:/;function sT(t,e,n){const r=t.style,a=Ie(n);let s=!1;if(n&&!a){if(e)if(Ie(e))for(const i of e.split(";")){const o=i.slice(0,i.indexOf(":")).trim();n[o]==null&&Ds(r,o,"")}else for(const i in e)n[i]==null&&Ds(r,i,"");for(const i in n)i==="display"&&(s=!0),Ds(r,i,n[i])}else if(a){if(e!==n){const i=r[rT];i&&(n+=";"+i),r.cssText=n,s=aT.test(n)}}else e&&t.removeAttribute("style");qf in t&&(t[qf]=s?r.display:"",t[nT]&&(r.display="none"))}const Qf=/\s*!important$/;function Ds(t,e,n){if(ce(n))n.forEach(r=>Ds(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=iT(t,e);Qf.test(n)?t.setProperty(xr(r),n.replace(Qf,""),"important"):t[r]=n}}const Zf=["Webkit","Moz","ms"],Wi={};function iT(t,e){const n=Wi[e];if(n)return n;let r=zn(e);if(r!=="filter"&&r in t)return Wi[e]=r;r=fl(r);for(let a=0;a<Zf.length;a++){const s=Zf[a]+r;if(s in t)return Wi[e]=s}return e}const Jf="http://www.w3.org/1999/xlink";function eu(t,e,n,r,a,s=sv(e)){r&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Jf,e.slice(6,e.length)):t.setAttributeNS(Jf,e,n):n==null||s&&!gl(n)?t.removeAttribute(e):t.setAttribute(e,s?"":Xr(n)?String(n):n)}function tu(t,e,n,r,a){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?s0(n):n);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,c=n==null?t.type==="checkbox"?"on":"":String(n);(o!==c||!("_value"in t))&&(t.value=c),n==null&&t.removeAttribute(e),t._value=n;return}let i=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=gl(n):n==null&&o==="string"?(n="",i=!0):o==="number"&&(n=0,i=!0)}try{t[e]=n}catch{}i&&t.removeAttribute(a||e)}function oT(t,e,n,r){t.addEventListener(e,n,r)}function cT(t,e,n,r){t.removeEventListener(e,n,r)}const nu=Symbol("_vei");function fT(t,e,n,r,a=null){const s=t[nu]||(t[nu]={}),i=s[e];if(r&&i)i.value=r;else{const[o,c]=uT(e);if(r){const u=s[e]=pT(r,a);oT(t,o,u,c)}else i&&(cT(t,o,i,c),s[e]=void 0)}}const ru=/(?:Once|Passive|Capture)$/;function uT(t){let e;if(ru.test(t)){e={};let r;for(;r=t.match(ru);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):xr(t.slice(2)),e]}let zi=0;const gT=Promise.resolve(),lT=()=>zi||(gT.then(()=>zi=0),zi=Date.now());function pT(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;tn(hT(r,n.value),e,5,[r])};return n.value=t,n.attached=lT(),n}function hT(t,e){if(ce(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>a=>!a._stopped&&r&&r(a))}else return e}const au=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,dT=(t,e,n,r,a,s)=>{const i=a==="svg";e==="class"?tT(t,r,i):e==="style"?sT(t,n,r):gi(e)?hc(e)||fT(t,e,n,r,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):vT(t,e,r,i))?(tu(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&eu(t,e,r,i,s,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Ie(r))?tu(t,zn(e),r,s,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),eu(t,e,r,i))};function vT(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&au(e)&&oe(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&t.tagName==="IFRAME"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const a=t.tagName;if(a==="IMG"||a==="VIDEO"||a==="CANVAS"||a==="SOURCE")return!1}return au(e)&&Ie(n)?!1:e in t}const yT=lt({patchProp:dT},Jy);let su;function TT(){return su||(su=My(yT))}const xT=((...t)=>{const e=TT().createApp(...t),{mount:n}=e;return e.mount=r=>{const a=CT(r);if(!a)return;const s=e._component;!oe(s)&&!s.render&&!s.template&&(s.template=a.innerHTML),a.nodeType===1&&(a.textContent="");const i=n(a,!1,ST(a));return a instanceof Element&&(a.removeAttribute("v-cloak"),a.setAttribute("data-v-app","")),i},e});function ST(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function CT(t){return Ie(t)?document.querySelector(t):t}const iu=document.querySelector("head");iu&&[16,32,96,160,196].forEach(t=>{const e=document.createElement("link");e.setAttribute("rel","icon"),e.setAttribute("href",`https://kitware.github.io/vtk-js/icon/favicon-${t}x${t}.png`),e.setAttribute("sizes",`${t}x${t}`),e.setAttribute("type","image/png"),iu.appendChild(e)});var ge=1e-6,Ye=typeof Float32Array<"u"?Float32Array:Array,wT=Math.PI/180;function ET(t){return t*wT}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function i0(){var t=new Ye(9);return Ye!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Uc(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function RT(t){var e=new Ye(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function OT(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function MT(t,e,n,r,a,s,i,o,c){var u=new Ye(9);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=a,u[5]=s,u[6]=i,u[7]=o,u[8]=c,u}function DT(t,e,n,r,a,s,i,o,c,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=s,t[5]=i,t[6]=o,t[7]=c,t[8]=u,t}function Kn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function o0(t,e){if(t===e){var n=e[1],r=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Nc(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],u=e[7],g=e[8],f=g*i-o*u,l=-g*s+o*c,p=u*s-i*c,v=n*f+r*l+a*p;return v?(v=1/v,t[0]=f*v,t[1]=(-g*r+a*u)*v,t[2]=(o*r-a*i)*v,t[3]=l*v,t[4]=(g*n-a*c)*v,t[5]=(-o*n+a*s)*v,t[6]=p*v,t[7]=(-u*n+r*c)*v,t[8]=(i*n-r*s)*v,t):null}function LT(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],u=e[7],g=e[8];return t[0]=i*g-o*u,t[1]=a*u-r*g,t[2]=r*o-a*i,t[3]=o*c-s*g,t[4]=n*g-a*c,t[5]=a*s-n*o,t[6]=s*u-i*c,t[7]=r*c-n*u,t[8]=n*i-r*s,t}function mT(t){var e=t[0],n=t[1],r=t[2],a=t[3],s=t[4],i=t[5],o=t[6],c=t[7],u=t[8];return e*(u*s-i*c)+n*(-u*a+i*o)+r*(c*a-s*o)}function c0(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=e[4],c=e[5],u=e[6],g=e[7],f=e[8],l=n[0],p=n[1],v=n[2],h=n[3],d=n[4],T=n[5],S=n[6],x=n[7],y=n[8];return t[0]=l*r+p*i+v*u,t[1]=l*a+p*o+v*g,t[2]=l*s+p*c+v*f,t[3]=h*r+d*i+T*u,t[4]=h*a+d*o+T*g,t[5]=h*s+d*c+T*f,t[6]=S*r+x*i+y*u,t[7]=S*a+x*o+y*g,t[8]=S*s+x*c+y*f,t}function VT(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=e[4],c=e[5],u=e[6],g=e[7],f=e[8],l=n[0],p=n[1];return t[0]=r,t[1]=a,t[2]=s,t[3]=i,t[4]=o,t[5]=c,t[6]=l*r+p*i+u,t[7]=l*a+p*o+g,t[8]=l*s+p*c+f,t}function FT(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=e[4],c=e[5],u=e[6],g=e[7],f=e[8],l=Math.sin(n),p=Math.cos(n);return t[0]=p*r+l*i,t[1]=p*a+l*o,t[2]=p*s+l*c,t[3]=p*i-l*r,t[4]=p*o-l*a,t[5]=p*c-l*s,t[6]=u,t[7]=g,t[8]=f,t}function BT(t,e,n){var r=n[0],a=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function _T(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function UT(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function NT(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function kT(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function GT(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=n+n,o=r+r,c=a+a,u=n*i,g=r*i,f=r*o,l=a*i,p=a*o,v=a*c,h=s*i,d=s*o,T=s*c;return t[0]=1-f-v,t[3]=g-T,t[6]=l+d,t[1]=g+T,t[4]=1-u-v,t[7]=p-h,t[2]=l-d,t[5]=p+h,t[8]=1-u-f,t}function bT(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],u=e[7],g=e[8],f=e[9],l=e[10],p=e[11],v=e[12],h=e[13],d=e[14],T=e[15],S=n*o-r*i,x=n*c-a*i,y=n*u-s*i,C=r*c-a*o,w=r*u-s*o,R=a*u-s*c,O=g*h-f*v,V=g*d-l*v,L=g*T-p*v,m=f*d-l*h,F=f*T-p*h,B=l*T-p*d,_=S*B-x*F+y*m+C*L-w*V+R*O;return _?(_=1/_,t[0]=(o*B-c*F+u*m)*_,t[1]=(c*L-i*B-u*V)*_,t[2]=(i*F-o*L+u*O)*_,t[3]=(a*F-r*B-s*m)*_,t[4]=(n*B-a*L+s*V)*_,t[5]=(r*L-n*F-s*O)*_,t[6]=(h*R-d*w+T*C)*_,t[7]=(d*y-v*R-T*x)*_,t[8]=(v*w-h*y+T*S)*_,t):null}function $T(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function WT(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function zT(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function HT(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function f0(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function AT(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function jT(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function KT(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function PT(t,e){var n=t[0],r=t[1],a=t[2],s=t[3],i=t[4],o=t[5],c=t[6],u=t[7],g=t[8],f=e[0],l=e[1],p=e[2],v=e[3],h=e[4],d=e[5],T=e[6],S=e[7],x=e[8];return Math.abs(n-f)<=ge*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-l)<=ge*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(a-p)<=ge*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-v)<=ge*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(i-h)<=ge*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-d)<=ge*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(c-T)<=ge*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(u-S)<=ge*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(g-x)<=ge*Math.max(1,Math.abs(g),Math.abs(x))}var XT=c0,IT=f0;const YT=Object.freeze(Object.defineProperty({__proto__:null,add:HT,adjoint:LT,clone:RT,copy:OT,create:i0,determinant:mT,equals:PT,exactEquals:KT,frob:zT,fromMat2d:kT,fromMat4:Uc,fromQuat:GT,fromRotation:UT,fromScaling:NT,fromTranslation:_T,fromValues:MT,identity:Kn,invert:Nc,mul:XT,multiply:c0,multiplyScalar:AT,multiplyScalarAndAdd:jT,normalFromMat4:bT,projection:$T,rotate:FT,scale:BT,set:DT,str:WT,sub:IT,subtract:f0,translate:VT,transpose:o0},Symbol.toStringTag,{value:"Module"}));function xi(){var t=new Ye(16);return Ye!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function qT(t){var e=new Ye(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function QT(t,e,n,r,a,s,i,o,c,u,g,f,l,p,v,h){var d=new Ye(16);return d[0]=t,d[1]=e,d[2]=n,d[3]=r,d[4]=a,d[5]=s,d[6]=i,d[7]=o,d[8]=c,d[9]=u,d[10]=g,d[11]=f,d[12]=l,d[13]=p,d[14]=v,d[15]=h,d}function ZT(t,e,n,r,a,s,i,o,c,u,g,f,l,p,v,h,d){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=s,t[5]=i,t[6]=o,t[7]=c,t[8]=u,t[9]=g,t[10]=f,t[11]=l,t[12]=p,t[13]=v,t[14]=h,t[15]=d,t}function ue(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function De(t,e){if(t===e){var n=e[1],r=e[2],a=e[3],s=e[6],i=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=a,t[13]=i,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ut(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],u=e[7],g=e[8],f=e[9],l=e[10],p=e[11],v=e[12],h=e[13],d=e[14],T=e[15],S=n*o-r*i,x=n*c-a*i,y=n*u-s*i,C=r*c-a*o,w=r*u-s*o,R=a*u-s*c,O=g*h-f*v,V=g*d-l*v,L=g*T-p*v,m=f*d-l*h,F=f*T-p*h,B=l*T-p*d,_=S*B-x*F+y*m+C*L-w*V+R*O;return _?(_=1/_,t[0]=(o*B-c*F+u*m)*_,t[1]=(a*F-r*B-s*m)*_,t[2]=(h*R-d*w+T*C)*_,t[3]=(l*w-f*R-p*C)*_,t[4]=(c*L-i*B-u*V)*_,t[5]=(n*B-a*L+s*V)*_,t[6]=(d*y-v*R-T*x)*_,t[7]=(g*R-l*y+p*x)*_,t[8]=(i*F-o*L+u*O)*_,t[9]=(r*L-n*F-s*O)*_,t[10]=(v*w-h*y+T*S)*_,t[11]=(f*y-g*w-p*S)*_,t[12]=(o*V-i*m-c*O)*_,t[13]=(n*m-r*V+a*O)*_,t[14]=(h*x-v*C-d*S)*_,t[15]=(g*C-f*x+l*S)*_,t):null}function JT(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],u=e[7],g=e[8],f=e[9],l=e[10],p=e[11],v=e[12],h=e[13],d=e[14],T=e[15];return t[0]=o*(l*T-p*d)-f*(c*T-u*d)+h*(c*p-u*l),t[1]=-(r*(l*T-p*d)-f*(a*T-s*d)+h*(a*p-s*l)),t[2]=r*(c*T-u*d)-o*(a*T-s*d)+h*(a*u-s*c),t[3]=-(r*(c*p-u*l)-o*(a*p-s*l)+f*(a*u-s*c)),t[4]=-(i*(l*T-p*d)-g*(c*T-u*d)+v*(c*p-u*l)),t[5]=n*(l*T-p*d)-g*(a*T-s*d)+v*(a*p-s*l),t[6]=-(n*(c*T-u*d)-i*(a*T-s*d)+v*(a*u-s*c)),t[7]=n*(c*p-u*l)-i*(a*p-s*l)+g*(a*u-s*c),t[8]=i*(f*T-p*h)-g*(o*T-u*h)+v*(o*p-u*f),t[9]=-(n*(f*T-p*h)-g*(r*T-s*h)+v*(r*p-s*f)),t[10]=n*(o*T-u*h)-i*(r*T-s*h)+v*(r*u-s*o),t[11]=-(n*(o*p-u*f)-i*(r*p-s*f)+g*(r*u-s*o)),t[12]=-(i*(f*d-l*h)-g*(o*d-c*h)+v*(o*l-c*f)),t[13]=n*(f*d-l*h)-g*(r*d-a*h)+v*(r*l-a*f),t[14]=-(n*(o*d-c*h)-i*(r*d-a*h)+v*(r*c-a*o)),t[15]=n*(o*l-c*f)-i*(r*l-a*f)+g*(r*c-a*o),t}function ex(t){var e=t[0],n=t[1],r=t[2],a=t[3],s=t[4],i=t[5],o=t[6],c=t[7],u=t[8],g=t[9],f=t[10],l=t[11],p=t[12],v=t[13],h=t[14],d=t[15],T=e*i-n*s,S=e*o-r*s,x=e*c-a*s,y=n*o-r*i,C=n*c-a*i,w=r*c-a*o,R=u*v-g*p,O=u*h-f*p,V=u*d-l*p,L=g*h-f*v,m=g*d-l*v,F=f*d-l*h;return T*F-S*m+x*L+y*V-C*O+w*R}function Ne(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=e[4],c=e[5],u=e[6],g=e[7],f=e[8],l=e[9],p=e[10],v=e[11],h=e[12],d=e[13],T=e[14],S=e[15],x=n[0],y=n[1],C=n[2],w=n[3];return t[0]=x*r+y*o+C*f+w*h,t[1]=x*a+y*c+C*l+w*d,t[2]=x*s+y*u+C*p+w*T,t[3]=x*i+y*g+C*v+w*S,x=n[4],y=n[5],C=n[6],w=n[7],t[4]=x*r+y*o+C*f+w*h,t[5]=x*a+y*c+C*l+w*d,t[6]=x*s+y*u+C*p+w*T,t[7]=x*i+y*g+C*v+w*S,x=n[8],y=n[9],C=n[10],w=n[11],t[8]=x*r+y*o+C*f+w*h,t[9]=x*a+y*c+C*l+w*d,t[10]=x*s+y*u+C*p+w*T,t[11]=x*i+y*g+C*v+w*S,x=n[12],y=n[13],C=n[14],w=n[15],t[12]=x*r+y*o+C*f+w*h,t[13]=x*a+y*c+C*l+w*d,t[14]=x*s+y*u+C*p+w*T,t[15]=x*i+y*g+C*v+w*S,t}function Ue(t,e,n){var r=n[0],a=n[1],s=n[2],i,o,c,u,g,f,l,p,v,h,d,T;return e===t?(t[12]=e[0]*r+e[4]*a+e[8]*s+e[12],t[13]=e[1]*r+e[5]*a+e[9]*s+e[13],t[14]=e[2]*r+e[6]*a+e[10]*s+e[14],t[15]=e[3]*r+e[7]*a+e[11]*s+e[15]):(i=e[0],o=e[1],c=e[2],u=e[3],g=e[4],f=e[5],l=e[6],p=e[7],v=e[8],h=e[9],d=e[10],T=e[11],t[0]=i,t[1]=o,t[2]=c,t[3]=u,t[4]=g,t[5]=f,t[6]=l,t[7]=p,t[8]=v,t[9]=h,t[10]=d,t[11]=T,t[12]=i*r+g*a+v*s+e[12],t[13]=o*r+f*a+h*s+e[13],t[14]=c*r+l*a+d*s+e[14],t[15]=u*r+p*a+T*s+e[15]),t}function pr(t,e,n){var r=n[0],a=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Bt(t,e,n,r){var a=r[0],s=r[1],i=r[2],o=Math.hypot(a,s,i),c,u,g,f,l,p,v,h,d,T,S,x,y,C,w,R,O,V,L,m,F,B,_,P;return o<ge?null:(o=1/o,a*=o,s*=o,i*=o,c=Math.sin(n),u=Math.cos(n),g=1-u,f=e[0],l=e[1],p=e[2],v=e[3],h=e[4],d=e[5],T=e[6],S=e[7],x=e[8],y=e[9],C=e[10],w=e[11],R=a*a*g+u,O=s*a*g+i*c,V=i*a*g-s*c,L=a*s*g-i*c,m=s*s*g+u,F=i*s*g+a*c,B=a*i*g+s*c,_=s*i*g-a*c,P=i*i*g+u,t[0]=f*R+h*O+x*V,t[1]=l*R+d*O+y*V,t[2]=p*R+T*O+C*V,t[3]=v*R+S*O+w*V,t[4]=f*L+h*m+x*F,t[5]=l*L+d*m+y*F,t[6]=p*L+T*m+C*F,t[7]=v*L+S*m+w*F,t[8]=f*B+h*_+x*P,t[9]=l*B+d*_+y*P,t[10]=p*B+T*_+C*P,t[11]=v*B+S*_+w*P,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function kc(t,e,n){var r=Math.sin(n),a=Math.cos(n),s=e[4],i=e[5],o=e[6],c=e[7],u=e[8],g=e[9],f=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*a+u*r,t[5]=i*a+g*r,t[6]=o*a+f*r,t[7]=c*a+l*r,t[8]=u*a-s*r,t[9]=g*a-i*r,t[10]=f*a-o*r,t[11]=l*a-c*r,t}function Gc(t,e,n){var r=Math.sin(n),a=Math.cos(n),s=e[0],i=e[1],o=e[2],c=e[3],u=e[8],g=e[9],f=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*a-u*r,t[1]=i*a-g*r,t[2]=o*a-f*r,t[3]=c*a-l*r,t[8]=s*r+u*a,t[9]=i*r+g*a,t[10]=o*r+f*a,t[11]=c*r+l*a,t}function bc(t,e,n){var r=Math.sin(n),a=Math.cos(n),s=e[0],i=e[1],o=e[2],c=e[3],u=e[4],g=e[5],f=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*a+u*r,t[1]=i*a+g*r,t[2]=o*a+f*r,t[3]=c*a+l*r,t[4]=u*a-s*r,t[5]=g*a-i*r,t[6]=f*a-o*r,t[7]=l*a-c*r,t}function u0(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function g0(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function l0(t,e,n){var r=n[0],a=n[1],s=n[2],i=Math.hypot(r,a,s),o,c,u;return i<ge?null:(i=1/i,r*=i,a*=i,s*=i,o=Math.sin(e),c=Math.cos(e),u=1-c,t[0]=r*r*u+c,t[1]=a*r*u+s*o,t[2]=s*r*u-a*o,t[3]=0,t[4]=r*a*u-s*o,t[5]=a*a*u+c,t[6]=s*a*u+r*o,t[7]=0,t[8]=r*s*u+a*o,t[9]=a*s*u-r*o,t[10]=s*s*u+c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function tx(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nx(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rx(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function p0(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=r+r,c=a+a,u=s+s,g=r*o,f=r*c,l=r*u,p=a*c,v=a*u,h=s*u,d=i*o,T=i*c,S=i*u;return t[0]=1-(p+h),t[1]=f+S,t[2]=l-T,t[3]=0,t[4]=f-S,t[5]=1-(g+h),t[6]=v+d,t[7]=0,t[8]=l+T,t[9]=v-d,t[10]=1-(g+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ax(t,e){var n=new Ye(3),r=-e[0],a=-e[1],s=-e[2],i=e[3],o=e[4],c=e[5],u=e[6],g=e[7],f=r*r+a*a+s*s+i*i;return f>0?(n[0]=(o*i+g*r+c*s-u*a)*2/f,n[1]=(c*i+g*a+u*r-o*s)*2/f,n[2]=(u*i+g*s+o*a-c*r)*2/f):(n[0]=(o*i+g*r+c*s-u*a)*2,n[1]=(c*i+g*a+u*r-o*s)*2,n[2]=(u*i+g*s+o*a-c*r)*2),p0(t,e,n),t}function sx(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function h0(t,e){var n=e[0],r=e[1],a=e[2],s=e[4],i=e[5],o=e[6],c=e[8],u=e[9],g=e[10];return t[0]=Math.hypot(n,r,a),t[1]=Math.hypot(s,i,o),t[2]=Math.hypot(c,u,g),t}function bo(t,e){var n=new Ye(3);h0(n,e);var r=1/n[0],a=1/n[1],s=1/n[2],i=e[0]*r,o=e[1]*a,c=e[2]*s,u=e[4]*r,g=e[5]*a,f=e[6]*s,l=e[8]*r,p=e[9]*a,v=e[10]*s,h=i+g+v,d=0;return h>0?(d=Math.sqrt(h+1)*2,t[3]=.25*d,t[0]=(f-p)/d,t[1]=(l-c)/d,t[2]=(o-u)/d):i>g&&i>v?(d=Math.sqrt(1+i-g-v)*2,t[3]=(f-p)/d,t[0]=.25*d,t[1]=(o+u)/d,t[2]=(l+c)/d):g>v?(d=Math.sqrt(1+g-i-v)*2,t[3]=(l-c)/d,t[0]=(o+u)/d,t[1]=.25*d,t[2]=(f+p)/d):(d=Math.sqrt(1+v-i-g)*2,t[3]=(o-u)/d,t[0]=(l+c)/d,t[1]=(f+p)/d,t[2]=.25*d),t}function d0(t,e,n,r){var a=e[0],s=e[1],i=e[2],o=e[3],c=a+a,u=s+s,g=i+i,f=a*c,l=a*u,p=a*g,v=s*u,h=s*g,d=i*g,T=o*c,S=o*u,x=o*g,y=r[0],C=r[1],w=r[2];return t[0]=(1-(v+d))*y,t[1]=(l+x)*y,t[2]=(p-S)*y,t[3]=0,t[4]=(l-x)*C,t[5]=(1-(f+d))*C,t[6]=(h+T)*C,t[7]=0,t[8]=(p+S)*w,t[9]=(h-T)*w,t[10]=(1-(f+v))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ix(t,e,n,r,a){var s=e[0],i=e[1],o=e[2],c=e[3],u=s+s,g=i+i,f=o+o,l=s*u,p=s*g,v=s*f,h=i*g,d=i*f,T=o*f,S=c*u,x=c*g,y=c*f,C=r[0],w=r[1],R=r[2],O=a[0],V=a[1],L=a[2],m=(1-(h+T))*C,F=(p+y)*C,B=(v-x)*C,_=(p-y)*w,P=(1-(l+T))*w,z=(d+S)*w,A=(v+x)*R,I=(d-S)*R,k=(1-(l+h))*R;return t[0]=m,t[1]=F,t[2]=B,t[3]=0,t[4]=_,t[5]=P,t[6]=z,t[7]=0,t[8]=A,t[9]=I,t[10]=k,t[11]=0,t[12]=n[0]+O-(m*O+_*V+A*L),t[13]=n[1]+V-(F*O+P*V+I*L),t[14]=n[2]+L-(B*O+z*V+k*L),t[15]=1,t}function Oa(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=n+n,o=r+r,c=a+a,u=n*i,g=r*i,f=r*o,l=a*i,p=a*o,v=a*c,h=s*i,d=s*o,T=s*c;return t[0]=1-f-v,t[1]=g+T,t[2]=l-d,t[3]=0,t[4]=g-T,t[5]=1-u-v,t[6]=p+h,t[7]=0,t[8]=l+d,t[9]=p-h,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ox(t,e,n,r,a,s,i){var o=1/(n-e),c=1/(a-r),u=1/(s-i);return t[0]=s*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*c,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(a+r)*c,t[10]=(i+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*s*2*u,t[15]=0,t}function v0(t,e,n,r,a){var s=1/Math.tan(e/2),i;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(i=1/(r-a),t[10]=(a+r)*i,t[14]=2*a*r*i):(t[10]=-1,t[14]=-2*r),t}var cx=v0;function fx(t,e,n,r,a){var s=1/Math.tan(e/2),i;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(i=1/(r-a),t[10]=a*i,t[14]=a*r*i):(t[10]=-1,t[14]=-r),t}function ux(t,e,n,r){var a=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),c=2/(i+o),u=2/(a+s);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((i-o)*c*.5),t[9]=(a-s)*u*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function y0(t,e,n,r,a,s,i){var o=1/(e-n),c=1/(r-a),u=1/(s-i);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*o,t[13]=(a+r)*c,t[14]=(i+s)*u,t[15]=1,t}var T0=y0;function gx(t,e,n,r,a,s,i){var o=1/(e-n),c=1/(r-a),u=1/(s-i);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+n)*o,t[13]=(a+r)*c,t[14]=s*u,t[15]=1,t}function x0(t,e,n,r){var a,s,i,o,c,u,g,f,l,p,v=e[0],h=e[1],d=e[2],T=r[0],S=r[1],x=r[2],y=n[0],C=n[1],w=n[2];return Math.abs(v-y)<ge&&Math.abs(h-C)<ge&&Math.abs(d-w)<ge?ue(t):(g=v-y,f=h-C,l=d-w,p=1/Math.hypot(g,f,l),g*=p,f*=p,l*=p,a=S*l-x*f,s=x*g-T*l,i=T*f-S*g,p=Math.hypot(a,s,i),p?(p=1/p,a*=p,s*=p,i*=p):(a=0,s=0,i=0),o=f*i-l*s,c=l*a-g*i,u=g*s-f*a,p=Math.hypot(o,c,u),p?(p=1/p,o*=p,c*=p,u*=p):(o=0,c=0,u=0),t[0]=a,t[1]=o,t[2]=g,t[3]=0,t[4]=s,t[5]=c,t[6]=f,t[7]=0,t[8]=i,t[9]=u,t[10]=l,t[11]=0,t[12]=-(a*v+s*h+i*d),t[13]=-(o*v+c*h+u*d),t[14]=-(g*v+f*h+l*d),t[15]=1,t)}function lx(t,e,n,r){var a=e[0],s=e[1],i=e[2],o=r[0],c=r[1],u=r[2],g=a-n[0],f=s-n[1],l=i-n[2],p=g*g+f*f+l*l;p>0&&(p=1/Math.sqrt(p),g*=p,f*=p,l*=p);var v=c*l-u*f,h=u*g-o*l,d=o*f-c*g;return p=v*v+h*h+d*d,p>0&&(p=1/Math.sqrt(p),v*=p,h*=p,d*=p),t[0]=v,t[1]=h,t[2]=d,t[3]=0,t[4]=f*d-l*h,t[5]=l*v-g*d,t[6]=g*h-f*v,t[7]=0,t[8]=g,t[9]=f,t[10]=l,t[11]=0,t[12]=a,t[13]=s,t[14]=i,t[15]=1,t}function px(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function hx(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function dx(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function S0(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function vx(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function yx(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function Tx(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function xx(t,e){var n=t[0],r=t[1],a=t[2],s=t[3],i=t[4],o=t[5],c=t[6],u=t[7],g=t[8],f=t[9],l=t[10],p=t[11],v=t[12],h=t[13],d=t[14],T=t[15],S=e[0],x=e[1],y=e[2],C=e[3],w=e[4],R=e[5],O=e[6],V=e[7],L=e[8],m=e[9],F=e[10],B=e[11],_=e[12],P=e[13],z=e[14],A=e[15];return Math.abs(n-S)<=ge*Math.max(1,Math.abs(n),Math.abs(S))&&Math.abs(r-x)<=ge*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(a-y)<=ge*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(s-C)<=ge*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(i-w)<=ge*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(o-R)<=ge*Math.max(1,Math.abs(o),Math.abs(R))&&Math.abs(c-O)<=ge*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(u-V)<=ge*Math.max(1,Math.abs(u),Math.abs(V))&&Math.abs(g-L)<=ge*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(f-m)<=ge*Math.max(1,Math.abs(f),Math.abs(m))&&Math.abs(l-F)<=ge*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(p-B)<=ge*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(v-_)<=ge*Math.max(1,Math.abs(v),Math.abs(_))&&Math.abs(h-P)<=ge*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(d-z)<=ge*Math.max(1,Math.abs(d),Math.abs(z))&&Math.abs(T-A)<=ge*Math.max(1,Math.abs(T),Math.abs(A))}var $o=Ne,Sx=S0;const Wo=Object.freeze(Object.defineProperty({__proto__:null,add:dx,adjoint:JT,clone:qT,copy:Qe,create:xi,determinant:ex,equals:xx,exactEquals:Tx,frob:hx,fromQuat:Oa,fromQuat2:ax,fromRotation:l0,fromRotationTranslation:p0,fromRotationTranslationScale:d0,fromRotationTranslationScaleOrigin:ix,fromScaling:g0,fromTranslation:u0,fromValues:QT,fromXRotation:tx,fromYRotation:nx,fromZRotation:rx,frustum:ox,getRotation:bo,getScaling:h0,getTranslation:sx,identity:ue,invert:ut,lookAt:x0,mul:$o,multiply:Ne,multiplyScalar:vx,multiplyScalarAndAdd:yx,ortho:T0,orthoNO:y0,orthoZO:gx,perspective:cx,perspectiveFromFieldOfView:ux,perspectiveNO:v0,perspectiveZO:fx,rotate:Bt,rotateX:kc,rotateY:Gc,rotateZ:bc,scale:pr,set:ZT,str:px,sub:Sx,subtract:S0,targetTo:lx,translate:Ue,transpose:De},Symbol.toStringTag,{value:"Module"}));function C0(){var t=new Ye(3);return Ye!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function zo(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function ou(t,e,n){var r=new Ye(3);return r[0]=t,r[1]=e,r[2]=n,r}function Cx(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function qt(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function fa(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Gn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ln(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function wx(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return Math.hypot(n,r,a)}function Ex(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Wn(t,e){var n=e[0],r=e[1],a=e[2],s=n*n+r*r+a*a;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function $c(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Nr(t,e,n){var r=e[0],a=e[1],s=e[2],i=n[0],o=n[1],c=n[2];return t[0]=a*c-s*o,t[1]=s*i-r*c,t[2]=r*o-a*i,t}function Te(t,e,n){var r=e[0],a=e[1],s=e[2],i=n[3]*r+n[7]*a+n[11]*s+n[15];return i=i||1,t[0]=(n[0]*r+n[4]*a+n[8]*s+n[12])/i,t[1]=(n[1]*r+n[5]*a+n[9]*s+n[13])/i,t[2]=(n[2]*r+n[6]*a+n[10]*s+n[14])/i,t}function cu(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function fu(t,e){var n=t[0],r=t[1],a=t[2],s=e[0],i=e[1],o=e[2];return Math.abs(n-s)<=ge*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-i)<=ge*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-o)<=ge*Math.max(1,Math.abs(a),Math.abs(o))}var Ho=Gn,Rx=wx,w0=zo;(function(){var t=C0();return function(e,n,r,a,s,i){var o,c;for(n||(n=3),r||(r=0),a?c=Math.min(a*n+r,e.length):c=e.length,o=r;o<c;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,i),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();function Ox(){var t=new Ye(4);return Ye!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Mx(t,e,n,r){var a=new Ye(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a}function Dx(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=n*n+r*r+a*a+s*s;return i>0&&(i=1/Math.sqrt(i)),t[0]=n*i,t[1]=r*i,t[2]=a*i,t[3]=s*i,t}function ta(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3];return t[0]=n[0]*r+n[4]*a+n[8]*s+n[12]*i,t[1]=n[1]*r+n[5]*a+n[9]*s+n[13]*i,t[2]=n[2]*r+n[6]*a+n[10]*s+n[14]*i,t[3]=n[3]*r+n[7]*a+n[11]*s+n[15]*i,t}(function(){var t=Ox();return function(e,n,r,a,s,i){var o,c;for(n||(n=4),r||(r=0),a?c=Math.min(a*n+r,e.length):c=e.length,o=r;o<c;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,i),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();function hr(){var t=new Ye(4);return Ye!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Wc(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Lx(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>ge?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function uu(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=n[0],c=n[1],u=n[2],g=n[3];return t[0]=r*g+i*o+a*u-s*c,t[1]=a*g+i*c+s*o-r*u,t[2]=s*g+i*u+r*c-a*o,t[3]=i*g-r*o-a*c-s*u,t}function Ls(t,e,n,r){var a=e[0],s=e[1],i=e[2],o=e[3],c=n[0],u=n[1],g=n[2],f=n[3],l,p,v,h,d;return p=a*c+s*u+i*g+o*f,p<0&&(p=-p,c=-c,u=-u,g=-g,f=-f),1-p>ge?(l=Math.acos(p),v=Math.sin(l),h=Math.sin((1-r)*l)/v,d=Math.sin(r*l)/v):(h=1-r,d=r),t[0]=h*a+d*c,t[1]=h*s+d*u,t[2]=h*i+d*g,t[3]=h*o+d*f,t}function mx(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Vx(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[a*3+a]&&(a=2);var s=(a+1)%3,i=(a+2)%3;r=Math.sqrt(e[a*3+a]-e[s*3+s]-e[i*3+i]+1),t[a]=.5*r,r=.5/r,t[3]=(e[s*3+i]-e[i*3+s])*r,t[s]=(e[s*3+a]+e[a*3+s])*r,t[i]=(e[i*3+a]+e[a*3+i])*r}return t}var gu=Mx,E0=Dx;(function(){var t=C0(),e=ou(1,0,0),n=ou(0,1,0);return function(r,a,s){var i=$c(a,s);return i<-.999999?(Nr(t,e,a),w0(t)<1e-6&&Nr(t,n,a),Wn(t,t),Wc(r,t,Math.PI),r):i>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Nr(t,a,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+i,E0(r,r))}})();(function(){var t=hr(),e=hr();return function(n,r,a,s,i,o){return Ls(t,r,i,o),Ls(e,a,s,o),Ls(n,t,e,2*o*(1-o)),n}})();(function(){var t=i0();return function(e,n,r,a){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],E0(e,Vx(e,t))}})();var na=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Si(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Fx(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var Hi,lu;function Bx(){return lu||(lu=1,Hi=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,a,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(a=r;a--!==0;)if(!t(e[a],n[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(a=r;a--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[a]))return!1;for(a=r;a--!==0;){var i=s[a];if(!t(e[i],n[i]))return!1}return!0}return e!==e&&n!==n}),Hi}var _x=Bx();const R0=Si(_x);var Ai,pu;function O0(){if(pu)return Ai;pu=1;var t=Object.prototype.toString;return Ai=function(n){var r=t.call(n),a=r==="[object Arguments]";return a||(a=r!=="[object Array]"&&n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t.call(n.callee)==="[object Function]"),a},Ai}var ji,hu;function Ux(){if(hu)return ji;hu=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=O0(),a=Object.prototype.propertyIsEnumerable,s=!a.call({toString:null},"toString"),i=a.call(function(){},"prototype"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(l){var p=l.constructor;return p&&p.prototype===l},u={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},g=(function(){if(typeof window>"u")return!1;for(var l in window)try{if(!u["$"+l]&&e.call(window,l)&&window[l]!==null&&typeof window[l]=="object")try{c(window[l])}catch{return!0}}catch{return!0}return!1})(),f=function(l){if(typeof window>"u"||!g)return c(l);try{return c(l)}catch{return!1}};t=function(p){var v=p!==null&&typeof p=="object",h=n.call(p)==="[object Function]",d=r(p),T=v&&n.call(p)==="[object String]",S=[];if(!v&&!h&&!d)throw new TypeError("Object.keys called on a non-object");var x=i&&h;if(T&&p.length>0&&!e.call(p,0))for(var y=0;y<p.length;++y)S.push(String(y));if(d&&p.length>0)for(var C=0;C<p.length;++C)S.push(String(C));else for(var w in p)!(x&&w==="prototype")&&e.call(p,w)&&S.push(String(w));if(s)for(var R=f(p),O=0;O<o.length;++O)!(R&&o[O]==="constructor")&&e.call(p,o[O])&&S.push(o[O]);return S}}return ji=t,ji}var Ki,du;function Nx(){if(du)return Ki;du=1;var t=Array.prototype.slice,e=O0(),n=Object.keys,r=n?function(i){return n(i)}:Ux(),a=Object.keys;return r.shim=function(){if(Object.keys){var i=(function(){var o=Object.keys(arguments);return o&&o.length===arguments.length})(1,2);i||(Object.keys=function(c){return e(c)?a(t.call(c)):a(c)})}else Object.keys=r;return Object.keys||r},Ki=r,Ki}var Pi,vu;function M0(){if(vu)return Pi;vu=1;var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return Pi=t,Pi}var Xi,yu;function kx(){return yu||(yu=1,Xi=SyntaxError),Xi}var Ii,Tu;function Gx(){return Tu||(Tu=1,Ii=TypeError),Ii}var Yi,xu;function bx(){return xu||(xu=1,Yi=Object.getOwnPropertyDescriptor),Yi}var qi,Su;function $x(){if(Su)return qi;Su=1;var t=bx();if(t)try{t([],"length")}catch{t=null}return qi=t,qi}var Qi,Cu;function Wx(){if(Cu)return Qi;Cu=1;var t=M0(),e=kx(),n=Gx(),r=$x();return Qi=function(s,i,o){if(!s||typeof s!="object"&&typeof s!="function")throw new n("`obj` must be an object or a function`");if(typeof i!="string"&&typeof i!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var c=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,g=arguments.length>5?arguments[5]:null,f=arguments.length>6?arguments[6]:!1,l=!!r&&r(s,i);if(t)t(s,i,{configurable:g===null&&l?l.configurable:!g,enumerable:c===null&&l?l.enumerable:!c,value:o,writable:u===null&&l?l.writable:!u});else if(f||!c&&!u&&!g)s[i]=o;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Qi}var Zi,wu;function zx(){if(wu)return Zi;wu=1;var t=M0(),e=function(){return!!t};return e.hasArrayLengthDefineBug=function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},Zi=e,Zi}var Ji,Eu;function D0(){if(Eu)return Ji;Eu=1;var t=Nx(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,r=Array.prototype.concat,a=Wx(),s=function(u){return typeof u=="function"&&n.call(u)==="[object Function]"},i=zx()(),o=function(u,g,f,l){if(g in u){if(l===!0){if(u[g]===f)return}else if(!s(l)||!l())return}i?a(u,g,f,!0):a(u,g,f)},c=function(u,g){var f=arguments.length>2?arguments[2]:{},l=t(g);e&&(l=r.call(l,Object.getOwnPropertySymbols(g)));for(var p=0;p<l.length;p+=1)o(u,l[p],g[l[p]],f[l[p]])};return c.supportsDescriptors=!!i,Ji=c,Ji}var ra={exports:{}},Ru;function L0(){return Ru||(Ru=1,typeof self<"u"?ra.exports=self:typeof window<"u"?ra.exports=window:ra.exports=Function("return this")()),ra.exports}var eo,Ou;function m0(){if(Ou)return eo;Ou=1;var t=L0();return eo=function(){return typeof na!="object"||!na||na.Math!==Math||na.Array!==Array?t:na},eo}var to,Mu;function Hx(){if(Mu)return to;Mu=1;var t=D0(),e=m0();return to=function(){var r=e();if(t.supportsDescriptors){var a=Object.getOwnPropertyDescriptor(r,"globalThis");(!a||a.configurable&&(a.enumerable||!a.writable||globalThis!==r))&&Object.defineProperty(r,"globalThis",{configurable:!0,enumerable:!1,value:r,writable:!0})}else(typeof globalThis!="object"||globalThis!==r)&&(r.globalThis=r);return r},to}var no,Du;function Ax(){if(Du)return no;Du=1;var t=D0(),e=L0(),n=m0(),r=Hx(),a=n(),s=function(){return a};return t(s,{getPolyfill:n,implementation:e,shim:r}),no=s,no}var jx=Ax();const Kx=Si(jx),Ut=Kx(),V0={vtkObject:()=>null};function Gt(t){if(t==null||t.isA)return t;if(!t.vtkClass)return Ut.console&&Ut.console.error&&Ut.console.error("Invalid VTK object"),null;const e=V0[t.vtkClass];if(!e)return Ut.console&&Ut.console.error&&Ut.console.error(`No vtk class found for Object of type ${t.vtkClass}`),null;const n={...t};Object.keys(n).forEach(a=>{n[a]&&typeof n[a]=="object"&&n[a].vtkClass&&(n[a]=Gt(n[a]))});const r=e(n);return r&&r.modified&&r.modified(),r}function Px(t,e){V0[t]=e}Gt.register=Px;class ro extends Array{push(){for(let e=0;e<arguments.length;e++)this.includes(arguments[e])||super.push(arguments[e]);return this.length}}let Ao=0;const F0=t=>{throw new Error(`Named parameter '${t}' is missing`)},B0=Symbol("void");function Xx(){return Ao}const _0={};function ir(){}const Ix=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];Ix.forEach(t=>{_0[t]=ir});Ut.console=console.hasOwnProperty("log")?console:_0;const An={debug:ir,error:Ut.console.error||ir,info:Ut.console.info||ir,log:Ut.console.log||ir,warn:Ut.console.warn||ir};function U0(t,e){An[t]&&(An[t]=e||ir)}function N0(){An.log(...arguments)}function k0(){An.info(...arguments)}function Ys(){An.debug(...arguments)}function ie(){An.error(...arguments)}function Ci(){An.warn(...arguments)}const Lu={};function G0(t){Lu[t]||(An.error(t),Lu[t]=!0)}const Ze=Object.create(null);Ze.Float32Array=Float32Array;Ze.Float64Array=Float64Array;Ze.Uint8Array=Uint8Array;Ze.Int8Array=Int8Array;Ze.Uint16Array=Uint16Array;Ze.Int16Array=Int16Array;Ze.Uint32Array=Uint32Array;Ze.Int32Array=Int32Array;Ze.Uint8ClampedArray=Uint8ClampedArray;try{Ze.BigInt64Array=BigInt64Array,Ze.BigUint64Array=BigUint64Array}catch{}function Ir(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return new(Ze[t]||Float64Array)(...n)}function zc(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return(Ze[t]||Float64Array).from(...n)}function wi(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Fe(t){return wi(t[0]==="_"?t.slice(1):t)}function b0(t){return t.charAt(0).toLowerCase()+t.slice(1)}function $0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;const r=["TB","GB","MB","KB"];let a=Number(t),s="B";for(;a>n;)a/=n,s=r.pop();return`${a.toFixed(e)} ${s}`}function W0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";const n=[];let r=t;for(;r>1e3;)n.push(`000${r%1e3}`.slice(-3)),r=Math.floor(r/1e3);return r>0&&n.push(r),n.reverse(),n.join(e)}function z0(t){Object.keys(t).forEach(e=>{Array.isArray(t[e])&&(t[e]=[].concat(t[e]))})}function Yx(t){return Object.values(Ze).some(e=>t instanceof e)}function qx(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return!1}function Qx(t,e){return Object.keys(t).find(n=>t[n]===e)}function H0(t){return t&&t.isA?t.getState():t}function Hc(t){setTimeout(t,0)}function A0(t,e){const n=performance.now();t.finally(()=>{const r=performance.now()-n;e(r)})}function qe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};z0(e);const n=[];if(Number.isInteger(e.mtime)||(e.mtime=++Ao),!("classHierarchy"in e))e.classHierarchy=new ro("vtkObject");else if(!(e.classHierarchy instanceof ro)){const s=new ro;for(let i=0;i<e.classHierarchy.length;i++)s.push(e.classHierarchy[i]);e.classHierarchy=s}function r(s){n[s]=null}function a(s){function i(){r(s)}return Object.freeze({unsubscribe:i})}return t.isDeleted=()=>!!e.deleted,t.modified=s=>{if(e.deleted){ie("instance deleted - cannot call any method");return}s&&s<t.getMTime()||(e.mtime=++Ao,n.forEach(i=>i&&i(t)))},t.onModified=s=>{if(e.deleted)return ie("instance deleted - cannot call any method"),null;const i=n.length;return n.push(s),a(i)},t.getMTime=()=>e.mtime,t.isA=s=>{let i=e.classHierarchy.length;for(;i--;)if(e.classHierarchy[i]===s)return!0;return!1},t.getClassName=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.classHierarchy[e.classHierarchy.length-1-s]},t.set=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,c=!1;return Object.keys(s).forEach(u=>{const g=o?null:t[`set${wi(u)}`];g&&Array.isArray(s[u])&&g.length>1?c=g(...s[u])||c:g?c=g(s[u])||c:(["mtime"].indexOf(u)===-1&&!i&&Ci(`Warning: Set value to model directly ${u}, ${s[u]}`),c=e[u]!==s[u]||c,e[u]=s[u])}),c},t.get=function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];if(!i.length)return e;const c={};return i.forEach(u=>{c[u]=e[u]}),c},t.getReferenceByName=s=>e[s],t.delete=()=>{Object.keys(e).forEach(s=>delete e[s]),n.forEach((s,i)=>r(i)),e.deleted=!0},t.getState=()=>{if(e.deleted)return null;const s={...e,vtkClass:t.getClassName()};Object.keys(s).forEach(o=>{s[o]===null||s[o]===void 0||o[0]==="_"?delete s[o]:s[o].isA?s[o]=s[o].getState():Array.isArray(s[o])?s[o]=s[o].map(H0):Yx(s[o])&&(s[o]=Array.from(s[o]))});const i={};return Object.keys(s).sort().forEach(o=>{i[o]=s[o]}),i.mtime&&delete i.mtime,i},t.shallowCopy=function(s){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(s.getClassName()!==t.getClassName())throw new Error(`Cannot ShallowCopy ${s.getClassName()} into ${t.getClassName()}`);const o=s.get(),c=Object.keys(e).sort();Object.keys(o).sort().forEach(g=>{const f=c.indexOf(g);f===-1?i&&Ys(`add ${g} in shallowCopy`):c.splice(f,1),e[g]=o[g]}),c.length&&i&&Ys(`Untouched keys: ${c.join(", ")}`),t.modified()},t.toJSON=function(){return t.getState()},t}const Zx={object(t,e,n){return function(){return{...e[n.name]}}}};function pt(t,e,n){n.forEach(r=>{if(typeof r=="object"){const a=Zx[r.type];a?t[`get${Fe(r.name)}`]=a(t,e,r):t[`get${Fe(r.name)}`]=()=>e[r.name]}else t[`get${Fe(r)}`]=()=>e[r]})}const j0={enum(t,e,n){const r=`_on${Fe(n.name)}Changed`;return a=>{if(typeof a=="string"){if(n.enum[a]!==void 0)return e[n.name]!==n.enum[a]?(e[n.name]=n.enum[a],t.modified(),!0):!1;throw ie(`Set Enum with invalid argument ${n}, ${a}`),new RangeError("Set Enum with invalid string argument")}if(typeof a=="number"){if(e[n.name]!==a){if(Object.keys(n.enum).map(s=>n.enum[s]).indexOf(a)!==-1){const s=e[n.name];return e[n.name]=a,e[r]?.(t,e,a,s),t.modified(),!0}throw ie(`Set Enum outside numeric range ${n}, ${a}`),new RangeError("Set Enum outside numeric range")}return!1}throw ie(`Set Enum with invalid argument (String/Number) ${n}, ${a}`),new TypeError("Set Enum with invalid argument (String/Number)")}},object(t,e,n){n.params?.length===1&&Ci('Setter of type "object" with a single "param" field is not supported');const r=`_on${Fe(n.name)}Changed`;return function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];let o;if(s.length>1&&n.params?.length?o=n.params.reduce((c,u,g)=>Object.assign(c,{[u]:s[g]}),{}):o=s[0],!R0(e[n.name],o)){const c=e[n.name];return e[n.name]=o,e[r]?.(t,e,o,c),t.modified(),!0}return!1}}};function mu(t){if(typeof t=="object"){const e=j0[t.type];if(e)return(n,r)=>e(n,r,t);throw ie(`No setter for field ${t}`),new TypeError("No setter for field")}return function(n,r){const a=`_on${Fe(t)}Changed`;return function(i){if(r.deleted)return ie("instance deleted - cannot call any method"),!1;if(r[t]!==i){const o=r[t.name];return r[t]=i,r[a]?.(n,r,i,o),n.modified(),!0}return!1}}}function ja(t,e,n){n.forEach(r=>{typeof r=="object"?t[`set${Fe(r.name)}`]=mu(r)(t,e):t[`set${Fe(r)}`]=mu(r)(t,e)})}function He(t,e,n){pt(t,e,n),ja(t,e,n)}function Yr(t,e,n){n.forEach(r=>{t[`get${Fe(r)}`]=()=>e[r]?Array.from(e[r]):e[r],t[`get${Fe(r)}ByReference`]=()=>e[r]})}function Ac(t,e,n,r){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;n.forEach(s=>{if(e[s]&&r&&e[s].length!==r)throw new RangeError(`Invalid initial number of values for array (${s})`);const i=`_on${Fe(s)}Changed`;t[`set${Fe(s)}`]=function(){if(e.deleted)return ie("instance deleted - cannot call any method"),!1;for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];let g=c,f,l=!1;if(g.length===1&&(g[0]==null||g[0].length>=0)&&(g=g[0],l=!0),g==null)f=e[s]!==g;else{if(r&&g.length!==r)if(g.length<r&&a!==void 0)for(g=Array.from(g),l=!1;g.length<r;)g.push(a);else throw new RangeError(`Invalid number of values for array setter (${s})`);f=e[s]==null||e[s].length!==g.length;for(let p=0;!f&&p<g.length;++p)f=e[s][p]!==g[p];f&&l&&(g=Array.from(g))}if(f){const p=e[s.name];e[s]=g,e[i]?.(t,e,g,p),t.modified()}return f},t[`set${Fe(s)}From`]=o=>{const c=e[s];o.forEach((u,g)=>{c[g]=u})}})}function jc(t,e,n,r){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;Yr(t,e,n),Ac(t,e,n,r,a)}function Ka(t,e,n){for(let r=0;r<n.length;r++){const a=n[r];e[a]!==void 0&&(e[`_${a}`]=e[a],delete e[a])}}function K0(t,e,n,r){e.inputData?e.inputData=e.inputData.map(Gt):e.inputData=[],e.inputConnection?e.inputConnection=e.inputConnection.map(Gt):e.inputConnection=[],e.output?e.output=e.output.map(Gt):e.output=[],e.inputArrayToProcess?e.inputArrayToProcess=e.inputArrayToProcess.map(Gt):e.inputArrayToProcess=[],e.numberOfInputs=n;function a(p){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){ie("instance deleted - cannot call any method");return}if(v>=e.numberOfInputs){ie(`algorithm ${t.getClassName()} only has ${e.numberOfInputs} input ports. To add more input ports, use addInputData()`);return}(e.inputData[v]!==p||e.inputConnection[v])&&(e.inputData[v]=p,e.inputConnection[v]=null,t.modified&&t.modified())}function s(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[p]&&(e.inputData[p]=e.inputConnection[p]()),e.inputData[p]}function i(p){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){ie("instance deleted - cannot call any method");return}if(v>=e.numberOfInputs){let h=`algorithm ${t.getClassName()} only has `;h+=`${e.numberOfInputs}`,h+=" input ports. To add more input ports, use addInputConnection()",ie(h);return}e.inputData[v]=null,e.inputConnection[v]=p}function o(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[p]}function c(){let p=e.numberOfInputs;for(;p&&!e.inputData[p-1]&&!e.inputConnection[p-1];)p--;return p===e.numberOfInputs&&e.numberOfInputs++,p}function u(p){if(e.deleted){ie("instance deleted - cannot call any method");return}i(p,c())}function g(p){if(e.deleted){ie("instance deleted - cannot call any method");return}a(p,c())}function f(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.deleted?(ie("instance deleted - cannot call any method"),null):(t.shouldUpdate()&&t.update(),e.output[p])}t.shouldUpdate=()=>{const p=t.getMTime();let v=1/0,h=r;for(;h--;){if(!e.output[h]||e.output[h].isDeleted())return!0;const d=e.output[h].getMTime();if(d<p)return!0;d<v&&(v=d)}for(h=e.numberOfInputs;h--;)if(e.inputConnection[h]?.filter.shouldUpdate()||t.getInputData(h)?.getMTime()>v)return!0;return!1};function l(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const v=()=>f(p);return v.filter=t,v}if(e.numberOfInputs){let p=e.numberOfInputs;for(;p--;)e.inputData.push(null),e.inputConnection.push(null);t.setInputData=a,t.setInputConnection=i,t.addInputData=g,t.addInputConnection=u,t.getInputData=s,t.getInputConnection=o}r&&(t.getOutputData=f,t.getOutputPort=l),t.update=()=>{const p=[];if(e.numberOfInputs){let v=0;for(;v<e.numberOfInputs;)p[v]=t.getInputData(v),v++}t.requestData&&!t.isDeleted()&&t.shouldUpdate()&&t.requestData(p,e.output)},t.getNumberOfInputPorts=()=>e.numberOfInputs,t.getNumberOfOutputPorts=()=>r||e.output.length,t.getInputArrayToProcess=p=>{const v=e.inputArrayToProcess[p],h=e.inputData[p];return v&&h?h[`get${v.fieldAssociation}`]().getArray(v.arrayName):null},t.setInputArrayToProcess=function(p,v,h){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";for(;e.inputArrayToProcess.length<p;)e.inputArrayToProcess.push(null);e.inputArrayToProcess[p]={arrayName:v,fieldAssociation:h,attributeType:d}}}const Kc=Symbol("Event abort");function P0(t,e,n){const r=[],a=t.delete;let s=1;function i(u){for(let g=0;g<r.length;++g){const[f]=r[g];if(f===u){r.splice(g,1);return}}}function o(u){function g(){i(u)}return Object.freeze({unsubscribe:g})}function c(){if(e.deleted){ie("instance deleted - cannot call any method");return}const u=r.slice();for(let g=0;g<u.length;++g){const[,f,l]=u[g];if(f){if(l<0)setTimeout(()=>f.apply(t,arguments),1-l);else if(f.apply(t,arguments)===Kc)break}}}t[`invoke${Fe(n)}`]=c,t[`on${Fe(n)}`]=function(u){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!u.apply)return console.error(`Invalid callback for event ${n}`),null;if(e.deleted)return ie("instance deleted - cannot call any method"),null;const f=s++;return r.push([f,u,g]),r.sort((l,p)=>p[2]-l[2]),o(f)},t.delete=()=>{a(),r.forEach(u=>{let[g]=u;return i(g)})}}function we(t,e){const n=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a={},s={};return t(s,a,r),Object.freeze(s)};return e&&Gt.register(e,n),n}function X0(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return e.filter(i=>!!i).map(i=>i(...a))}}function Pc(t){return t&&t.isA&&t.isA("vtkObject")}function qs(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(Pc(t)){if(r.indexOf(t)>=0)return n;r.push(t);const a=e(t);a!==void 0&&n.push(a);const s=t.get();Object.keys(s).forEach(i=>{const o=s[i];Array.isArray(o)?o.forEach(c=>{qs(c,e,n,r)}):qs(o,e,n,r)})}return n}function I0(t,e,n){var r=this;let a;const s=function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];const u=r,g=()=>{a=null,n||t.apply(u,o)},f=n&&!a;clearTimeout(a),a=setTimeout(g,e),f&&t.apply(u,o)};return s.cancel=()=>clearTimeout(a),s}function Y0(t,e){let n=!1,r=null;function a(){n=!1,r!==null&&(s(...r),r=null)}function s(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];if(n){r=o;return}n=!0,t(...o),setTimeout(a,e)}return s}function Xc(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};e.keystore=Object.assign(e.keystore||{},n),t.setKey=(r,a)=>{e.keystore[r]=a},t.getKey=r=>e.keystore[r],t.getAllKeys=()=>Object.keys(e.keystore),t.deleteKey=r=>delete e.keystore[r],t.clearKeystore=()=>t.getAllKeys().forEach(r=>delete e.keystore[r])}let Jx=1;const ts="__root__";function q0(t,e){Xc(t,e);const n=t.delete;e.proxyId=`${Jx++}`,e.ui=JSON.parse(JSON.stringify(e.ui||[])),pt(t,e,["proxyId","proxyGroup","proxyName"]),He(t,e,["proxyManager"]);const r={},a={};function s(u,g){a[g]||(a[g]=[]);const f=a[g];for(let l=0;l<u.length;l++)f.push(u[l].name),r[u[l].name]=u[l],u[l].children&&u[l].children.length&&s(u[l].children,u[l].name)}s(e.ui,ts),t.updateUI=u=>{e.ui=JSON.parse(JSON.stringify(u||[])),Object.keys(r).forEach(g=>delete r[g]),Object.keys(a).forEach(g=>delete a[g]),s(e.ui,ts),t.modified()};function i(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ts;return a[u]}t.updateProxyProperty=(u,g)=>{const f=r[u];f?Object.assign(f,g):r[u]={...g}},t.activate=()=>{if(e.proxyManager){const u=`setActive${Fe(t.getProxyGroup().slice(0,-1))}`;e.proxyManager[u]&&e.proxyManager[u](t)}},e.propertyLinkSubscribers={},t.registerPropertyLinkForGC=(u,g)=>{g in e.propertyLinkSubscribers||(e.propertyLinkSubscribers[g]=[]),e.propertyLinkSubscribers[g].push(u)},t.gcPropertyLinks=u=>{const g=e.propertyLinkSubscribers[u]||[];for(;g.length;)g.pop().unbind(t)},e.propertyLinkMap={},t.getPropertyLink=function(u){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.propertyLinkMap[u])return e.propertyLinkMap[u];let f=null;const l=[];let p=0,v=!1;function h(y){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(v)return null;const w=[];let R=null;for(p=l.length;p--;){const V=l[p];V.instance===y?R=V:w.push(V)}if(!R)return null;const O=R.instance[`get${Fe(R.propertyName)}`]();if(!qx(O,f)||C){for(f=O,v=!0;w.length;){const V=w.pop();V.instance.set({[V.propertyName]:f})}v=!1}return e.propertyLinkMap[u].persistent&&(e.propertyLinkMap[u].value=O),O}function d(y,C){const w=[];for(p=l.length;p--;){const R=l[p];R.instance===y&&(R.propertyName===C||C===void 0)&&(R.subscription.unsubscribe(),w.push(p))}for(;w.length;)l.splice(w.pop(),1)}function T(y,C){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const R=y.onModified(h),O=l[0];return l.push({instance:y,propertyName:C,subscription:R}),w&&(e.propertyLinkMap[u].persistent&&e.propertyLinkMap[u].value!==void 0?y.set({[C]:e.propertyLinkMap[u].value}):O&&h(O.instance,!0)),{unsubscribe:()=>d(y,C)}}function S(){for(;l.length;)l.pop().subscription.unsubscribe()}const x={bind:T,unbind:d,unsubscribe:S,persistent:g};return e.propertyLinkMap[u]=x,x};function o(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ts;const g=[],f=e.proxyId,l=i(u)||[];for(let p=0;p<l.length;p++){const v=l[p],h=t[`get${Fe(v)}`],d=h?h():void 0,T={id:f,name:v,value:d},S=o(v);S.length&&(T.children=S),g.push(T)}return g}t.listPropertyNames=()=>o().map(u=>u.name),t.getPropertyByName=u=>o().find(g=>g.name===u),t.getPropertyDomainByName=u=>(r[u]||{}).domain,t.getProxySection=()=>({id:e.proxyId,name:e.proxyGroup,ui:e.ui,properties:o()}),t.delete=()=>{const u=Object.keys(e.propertyLinkMap);let g=u.length;for(;g--;)e.propertyLinkMap[u[g]].unsubscribe();Object.keys(e.propertyLinkSubscribers).forEach(t.gcPropertyLinks),n()},t.getState=()=>null;function c(){if(e.links)for(let u=0;u<e.links.length;u++){const{link:g,property:f,persistent:l,updateOnBind:p,type:v}=e.links[u];if(v==="application"){const h=e.proxyManager.getPropertyLink(g,l);t.registerPropertyLinkForGC(h,"application"),h.bind(t,f,p)}}}Hc(c)}function Q0(t,e,n){const r=t.delete,a=[],s=Object.keys(n);let i=s.length;for(;i--;){const o=s[i],{modelKey:c,property:u,modified:g=!0}=n[o],f=Fe(u),l=Fe(o);t[`get${l}`]=e[c][`get${f}`],t[`set${l}`]=e[c][`set${f}`],g&&a.push(e[c].onModified(t.modified))}t.delete=()=>{for(;a.length;)a.pop().unsubscribe();r()}}function Z0(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e.this=t;function a(o){const c=Object.keys(o);let u=c.length;for(;u--;){const g=c[u];e[g].set(o[g])}}const s=Object.keys(r);let i=s.length;for(;i--;){const o=s[i];e[o]=r[o];const c=n[o];t[`set${Fe(o)}`]=u=>{if(u!==e[o]){e[o]=u;const g=c[u];a(g),t.modified()}}}s.length&&pt(t,e,s)}const Vu=10,Fu=40,Bu=800;function J0(t){let e=0,n=0,r=0,a=0;return"detail"in t&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=n,n=0),r=e*Vu,a=n*Vu,"deltaY"in t&&(a=t.deltaY),"deltaX"in t&&(r=t.deltaX),(r||a)&&t.deltaMode&&(t.deltaMode===1?(r*=Fu,a*=Fu):(r*=Bu,a*=Bu)),r&&!e&&(e=r<1?-1:1),a&&!n&&(n=a<1?-1:1),{spinX:e,spinY:n||e,pixelX:r,pixelY:a||r}}var E={algo:K0,capitalize:wi,chain:X0,debounce:I0,enumToString:Qx,event:P0,EVENT_ABORT:Kc,formatBytesToProperUnit:$0,formatNumbersWithThousandSeparator:W0,get:pt,getArray:Yr,getCurrentGlobalMTime:Xx,getStateArrayMapFunc:H0,isVtkObject:Pc,keystore:Xc,measurePromiseExecution:A0,moveToProtected:Ka,newInstance:we,newTypedArray:Ir,newTypedArrayFrom:zc,normalizeWheel:J0,obj:qe,proxy:q0,proxyPropertyMapping:Q0,proxyPropertyState:Z0,safeArrays:z0,set:ja,setArray:Ac,setGet:He,setGetArray:jc,setImmediate:Hc,setLoggerFunction:U0,throttle:Y0,traverseInstanceTree:qs,TYPED_ARRAYS:Ze,uncapitalize:b0,VOID:B0,vtkDebugMacro:Ys,vtkErrorMacro:ie,vtkInfoMacro:k0,vtkLogMacro:N0,vtkOnceErrorMacro:G0,vtkWarningMacro:Ci,objectSetterMap:j0,requiredParam:F0},nn=Object.freeze({__proto__:null,requiredParam:F0,VOID:B0,setLoggerFunction:U0,vtkLogMacro:N0,vtkInfoMacro:k0,vtkDebugMacro:Ys,vtkErrorMacro:ie,vtkWarningMacro:Ci,vtkOnceErrorMacro:G0,TYPED_ARRAYS:Ze,newTypedArray:Ir,newTypedArrayFrom:zc,capitalize:wi,_capitalize:Fe,uncapitalize:b0,formatBytesToProperUnit:$0,formatNumbersWithThousandSeparator:W0,setImmediateVTK:Hc,measurePromiseExecution:A0,obj:qe,get:pt,set:ja,setGet:He,getArray:Yr,setArray:Ac,setGetArray:jc,moveToProtected:Ka,algo:K0,EVENT_ABORT:Kc,event:P0,newInstance:we,chain:X0,isVtkObject:Pc,traverseInstanceTree:qs,debounce:I0,throttle:Y0,keystore:Xc,proxy:q0,proxyPropertyMapping:Q0,proxyPropertyState:Z0,normalizeWheel:J0,default:E});const{vtkErrorMacro:eS}=E,tS=["Build","Render"];function nS(t,e){e.classHierarchy.push("vtkViewNode");function n(a,s){for(let i=0;i<e.children.length;++i){const o=(s+1+i)%e.children.length;if(e.children[o]===a)return e.children[o]=e.children[s],e.children[s]=a,!0}return!1}t.build=a=>{},t.render=a=>{},t.traverse=a=>{const s=a.getTraverseOperation(),i=t[s];if(i){i(a);return}t.apply(a,!0);for(let o=0;o<e.children.length;o++)e.children[o].traverse(a);t.apply(a,!1)},t.apply=(a,s)=>{const i=t[a.getOperation()];i&&i(s,a)},t.getViewNodeFor=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(s&&s.renderable===a)return s;if(e.renderable===a)return t;for(let i=0;i<e.children.length;++i){const c=e.children[i].getViewNodeFor(a);if(c)return c}},t.getFirstAncestorOfType=a=>e._parent?e._parent.isA(a)?e._parent:e._parent.getFirstAncestorOfType(a):null,t.getLastAncestorOfType=a=>{if(!e._parent)return null;const s=e._parent.getLastAncestorOfType(a);return s||(e._parent.isA(a)?e._parent:null)},t.addMissingNode=a=>{if(!a)return;const s=e._renderableChildMap.get(a);if(s!==void 0)return s.setVisited(!0),s;const i=t.createViewNode(a);if(i)return i.setParent(t),i.setVisited(!0),e._renderableChildMap.set(a,i),e.children.push(i),i},t.addMissingNodes=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!a||!a.length)return;let i;for(let o=0;o<a.length;++o){const c=a[o],u=t.addMissingNode(c);s&&u!==void 0&&(i===void 0?i=e.children.lastIndexOf(u):e.children[i]!==u&&n(e.children,u),i++)}},t.addMissingChildren=a=>{if(!(!a||!a.length))for(let s=0;s<a.length;++s){const i=a[s];if(e.children.indexOf(i)===-1){i.setParent(t),e.children.push(i);const c=i.getRenderable();c&&e._renderableChildMap.set(c,i)}i.setVisited(!0)}},t.removeNode=a=>{const s=e.children.findIndex(o=>o===a);if(s<0)return!1;const i=a.getRenderable();return i&&e._renderableChildMap.delete(i),a.delete(),e.children.splice(s,1),!0},t.prepareNodes=()=>{for(let a=0;a<e.children.length;++a)e.children[a].setVisited(!1)},t.setVisited=a=>{e.visited=a},t.removeUnusedNodes=()=>{let a=0;for(let s=0;s<e.children.length;++s){const i=e.children[s];if(i.getVisited())e.children[a++]=i,i.setVisited(!1);else{const c=i.getRenderable();c&&e._renderableChildMap.delete(c),i.delete()}}e.children.length=a},t.createViewNode=a=>{if(!e.myFactory)return eS("Cannot create view nodes without my own factory"),null;const s=e.myFactory.createNode(a);return s&&s.setRenderable(a),s};const r=t.delete;t.delete=()=>{for(let a=0;a<e.children.length;a++)e.children[a].delete();r()}}const rS={renderable:null,myFactory:null,children:[],visited:!1};function ep(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rS,n),E.obj(t,e),E.event(t,e,"event"),e._renderableChildMap=new Map,E.get(t,e,["visited"]),E.setGet(t,e,["_parent","renderable","myFactory"]),E.getArray(t,e,["children"]),E.moveToProtected(t,e,["parent"]),nS(t,e)}const aS=E.newInstance(ep,"vtkViewNode");var Be={newInstance:aS,extend:ep,PASS_TYPES:tS};function sS(t,e){e.overrides||(e.overrides={}),e.classHierarchy.push("vtkViewNodeFactory"),t.createNode=n=>{if(n.isDeleted())return null;let r=0,a=n.getClassName(r++),s=!1;const i=Object.keys(e.overrides);for(;a&&!s;)i.indexOf(a)!==-1?s=!0:a=n.getClassName(r++);if(!s)return null;const o=e.overrides[a]();return o.setMyFactory(t),o}}const iS={};function tp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iS,n),E.obj(t,e),sS(t,e)}const oS=E.newInstance(tp,"vtkViewNodeFactory");var np={newInstance:oS,extend:tp};const rp=Object.create(null);function Ft(t,e){rp[t]=e}function cS(t,e){e.classHierarchy.push("vtkOpenGLViewNodeFactory")}const fS={};function ap(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fS,n),e.overrides=rp,np.extend(t,e,n),cS(t,e)}const uS=E.newInstance(ap,"vtkOpenGLViewNodeFactory");var gS={newInstance:uS,extend:ap};function lS(t,e){e.classHierarchy.push("vtkOpenGLCamera"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext())},t.opaquePass=n=>{if(n){const r=e._openGLRenderer.getTiledSizeAndOrigin();e.context.viewport(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize),e.context.scissor(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize)}},t.translucentPass=t.opaquePass,t.zBufferPass=t.opaquePass,t.opaqueZBufferPass=t.opaquePass,t.volumePass=t.opaquePass,t.getKeyMatrices=n=>{if(n!==e.lastRenderer||e._openGLRenderWindow.getMTime()>e.keyMatrixTime.getMTime()||t.getMTime()>e.keyMatrixTime.getMTime()||n.getMTime()>e.keyMatrixTime.getMTime()||e.renderable.getMTime()>e.keyMatrixTime.getMTime()){Qe(e.keyMatrices.wcvc,e.renderable.getViewMatrix()),Uc(e.keyMatrices.normalMatrix,e.keyMatrices.wcvc),Nc(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),De(e.keyMatrices.wcvc,e.keyMatrices.wcvc);const r=e._openGLRenderer.getAspectRatio();Qe(e.keyMatrices.vcpc,e.renderable.getProjectionMatrix(r,-1,1)),De(e.keyMatrices.vcpc,e.keyMatrices.vcpc),Ne(e.keyMatrices.wcpc,e.keyMatrices.vcpc,e.keyMatrices.wcvc),e.keyMatrixTime.modified(),e.lastRenderer=n}return e.keyMatrices}}const pS={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function hS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pS,n),Be.extend(t,e,n),e.keyMatrixTime={},qe(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(9),vcpc:new Float64Array(16),wcvc:new Float64Array(16),wcpc:new Float64Array(16)},He(t,e,["context","keyMatrixTime"]),lS(t,e)}const dS=we(hS);Ft("vtkCamera",dS);const{vtkDebugMacro:vS}=nn;function yS(t,e){e.classHierarchy.push("vtkOpenGLRenderer"),t.buildPass=n=>{if(n){if(!e.renderable)return;t.updateLights(),t.prepareNodes(),t.addMissingNode(e.renderable.getActiveCamera()),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps(),!0),t.removeUnusedNodes()}},t.updateLights=()=>{let n=0;const r=e.renderable.getLightsByReference();for(let a=0;a<r.length;++a)r[a].getSwitch()>0&&n++;return n||(vS("No lights are on, creating one."),e.renderable.createLight()),n},t.zBufferPass=n=>{if(n){let r=0;const a=e.context;e.renderable.getTransparent()||(e.context.clearColor(1,0,0,1),r|=a.COLOR_BUFFER_BIT),e.renderable.getPreserveDepthBuffer()||(a.clearDepth(1),r|=a.DEPTH_BUFFER_BIT,e.context.depthMask(!0));const s=t.getTiledSizeAndOrigin();a.enable(a.SCISSOR_TEST),a.scissor(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize),a.viewport(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize),a.colorMask(!0,!0,!0,!0),r&&a.clear(r),a.enable(a.DEPTH_TEST)}},t.opaqueZBufferPass=n=>t.zBufferPass(n),t.cameraPass=n=>{n&&t.clear()},t.getAspectRatio=()=>{const n=e._parent.getSizeByReference(),r=e.renderable.getViewportByReference();return n[0]*(r[2]-r[0])/((r[3]-r[1])*n[1])},t.getTiledSizeAndOrigin=()=>{const n=e.renderable.getViewportByReference(),r=[0,0,1,1],a=n[0]-r[0],s=n[1]-r[1],i=e._parent.normalizedDisplayToDisplay(a,s),o=Math.round(i[0]),c=Math.round(i[1]),u=n[2]-r[0],g=n[3]-r[1],f=e._parent.normalizedDisplayToDisplay(u,g);let l=Math.round(f[0])-o,p=Math.round(f[1])-c;return l<0&&(l=0),p<0&&(p=0),{usize:l,vsize:p,lowerLeftU:o,lowerLeftV:c}},t.clear=()=>{let n=0;const r=e.context;if(!e.renderable.getTransparent()){const s=e.renderable.getBackgroundByReference();r.clearColor(s[0],s[1],s[2],s[3]),n|=r.COLOR_BUFFER_BIT}e.renderable.getPreserveDepthBuffer()||(r.clearDepth(1),n|=r.DEPTH_BUFFER_BIT,r.depthMask(!0)),r.colorMask(!0,!0,!0,!0);const a=t.getTiledSizeAndOrigin();r.enable(r.SCISSOR_TEST),r.scissor(a.lowerLeftU,a.lowerLeftV,a.usize,a.vsize),r.viewport(a.lowerLeftU,a.lowerLeftV,a.usize,a.vsize),n&&r.clear(n),r.enable(r.DEPTH_TEST)},t.releaseGraphicsResources=()=>{e.selector!==null&&e.selector.releaseGraphicsResources(),e.renderable&&e.renderable.getViewProps().forEach(n=>{n.modified()})},t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))}}const TS={context:null,_openGLRenderWindow:null,selector:null};function xS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TS,n),Be.extend(t,e,n),pt(t,e,["shaderCache"]),He(t,e,["selector"]),Ka(t,e,["openGLRenderWindow"]),yS(t,e)}const SS=we(xS,"vtkOpenGLRenderer");Ft("vtkRenderer",SS);function CS(t,e){e.classHierarchy.push("vtkOpenGLActor"),t.buildPass=n=>{if(n){e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(let r=0;r<e.children.length;r++){const a=e.children[r];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.traverseZBufferPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseOpaqueZBufferPass=n=>t.traverseOpaquePass(n),t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.activateTextures=()=>{if(e.ogltextures){e.activeTextures=[];for(let n=0;n<e.ogltextures.length;n++){const r=e.ogltextures[n];r.render(),r.getHandle()&&e.activeTextures.push(r)}}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.zBufferPass=(n,r)=>t.opaquePass(n,r),t.opaqueZBufferPass=(n,r)=>t.opaquePass(n,r),t.opaquePass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=(n,r)=>{if(n)e.context.depthMask(e._openGLRenderer.getSelector()&&e.renderable.getNestedPickable()),t.activateTextures();else if(e.activeTextures)for(let a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),Qe(e.keyMatrices.mcwc,e.renderable.getMatrix()),De(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.renderable.getIsIdentity()?Kn(e.keyMatrices.normalMatrix):(Uc(e.keyMatrices.normalMatrix,e.keyMatrices.mcwc),Nc(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),o0(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),e.keyMatrixTime.modified()),e.keyMatrices)}const wS={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function ES(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wS,n),Be.extend(t,e,n),e.keyMatrixTime={},qe(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:Kn(new Float64Array(9)),mcwc:ue(new Float64Array(16))},He(t,e,["context"]),pt(t,e,["activeTextures"]),CS(t,e)}const RS=we(ES);Ft("vtkActor",RS);function OS(t,e){e.classHierarchy.push("vtkOpenGLActor2D"),t.buildPass=n=>{if(n){if(!e.renderable)return;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(let r=0;r<e.children.length;r++){const a=e.children[r];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementOverlayActorCount()}},t.traverseOpaquePass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseOverlayPass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.activateTextures=()=>{if(e.ogltextures){e.activeTextures=[];for(let n=0;n<e.ogltextures.length;n++){const r=e.ogltextures[n];r.render(),r.getHandle()&&e.activeTextures.push(r)}}},t.opaquePass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=(n,r)=>{if(n)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(let a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.overlayPass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()}}const MS={context:null,activeTextures:null};function DS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MS,n),Be.extend(t,e,n),He(t,e,["context"]),pt(t,e,["activeTextures"]),OS(t,e)}const LS=we(DS);Ft("vtkActor2D",LS);function ms(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function mS(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function sp(t){let e,n,r;t.length!==2?(e=ms,n=(o,c)=>ms(t(o),c),r=(o,c)=>t(o)-c):(e=t===ms||t===mS?t:VS,n=t,r=t);function a(o,c,u=0,g=o.length){if(u<g){if(e(c,c)!==0)return g;do{const f=u+g>>>1;n(o[f],c)<0?u=f+1:g=f}while(u<g)}return u}function s(o,c,u=0,g=o.length){if(u<g){if(e(c,c)!==0)return g;do{const f=u+g>>>1;n(o[f],c)<=0?u=f+1:g=f}while(u<g)}return u}function i(o,c,u=0,g=o.length){const f=a(o,c,u,g-1);return f>u&&r(o[f-1],c)>-r(o[f],c)?f-1:f}return{left:a,center:i,right:s}}function VS(){return 0}function FS(t){return t===null?NaN:+t}const BS=sp(ms),_S=BS.right;sp(FS).center;const US=Math.sqrt(50),NS=Math.sqrt(10),kS=Math.sqrt(2);function Qs(t,e,n){const r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),s=r/Math.pow(10,a),i=s>=US?10:s>=NS?5:s>=kS?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/i,o=Math.round(t*u),c=Math.round(e*u),o/u<t&&++o,c/u>e&&--c,u=-u):(u=Math.pow(10,a)*i,o=Math.round(t/u),c=Math.round(e/u),o*u<t&&++o,c*u>e&&--c),c<o&&.5<=n&&n<2?Qs(t,e,n*2):[o,c,u]}function GS(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[a,s,i]=r?Qs(e,t,n):Qs(t,e,n);if(!(s>=a))return[];const o=s-a+1,c=new Array(o);if(r)if(i<0)for(let u=0;u<o;++u)c[u]=(s-u)/-i;else for(let u=0;u<o;++u)c[u]=(s-u)*i;else if(i<0)for(let u=0;u<o;++u)c[u]=(a+u)/-i;else for(let u=0;u<o;++u)c[u]=(a+u)*i;return c}function jo(t,e,n){return e=+e,t=+t,n=+n,Qs(t,e,n)[2]}function bS(t,e,n){e=+e,t=+t,n=+n;const r=e<t,a=r?jo(e,t,n):jo(t,e,n);return(r?-1:1)*(a<0?1/-a:a)}function $S(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Ic(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ip(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Pa(){}var ka=.7,Zs=1/ka,kr="\\s*([+-]?\\d+)\\s*",Ga="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Jt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",WS=/^#([0-9a-f]{3,8})$/,zS=new RegExp(`^rgb\\(${kr},${kr},${kr}\\)$`),HS=new RegExp(`^rgb\\(${Jt},${Jt},${Jt}\\)$`),AS=new RegExp(`^rgba\\(${kr},${kr},${kr},${Ga}\\)$`),jS=new RegExp(`^rgba\\(${Jt},${Jt},${Jt},${Ga}\\)$`),KS=new RegExp(`^hsl\\(${Ga},${Jt},${Jt}\\)$`),PS=new RegExp(`^hsla\\(${Ga},${Jt},${Jt},${Ga}\\)$`),_u={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ic(Pa,ba,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Uu,formatHex:Uu,formatHex8:XS,formatHsl:IS,formatRgb:Nu,toString:Nu});function Uu(){return this.rgb().formatHex()}function XS(){return this.rgb().formatHex8()}function IS(){return op(this).formatHsl()}function Nu(){return this.rgb().formatRgb()}function ba(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=WS.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ku(e):n===3?new xt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ns(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ns(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=zS.exec(t))?new xt(e[1],e[2],e[3],1):(e=HS.exec(t))?new xt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=AS.exec(t))?ns(e[1],e[2],e[3],e[4]):(e=jS.exec(t))?ns(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=KS.exec(t))?$u(e[1],e[2]/100,e[3]/100,1):(e=PS.exec(t))?$u(e[1],e[2]/100,e[3]/100,e[4]):_u.hasOwnProperty(t)?ku(_u[t]):t==="transparent"?new xt(NaN,NaN,NaN,0):null}function ku(t){return new xt(t>>16&255,t>>8&255,t&255,1)}function ns(t,e,n,r){return r<=0&&(t=e=n=NaN),new xt(t,e,n,r)}function YS(t){return t instanceof Pa||(t=ba(t)),t?(t=t.rgb(),new xt(t.r,t.g,t.b,t.opacity)):new xt}function Ko(t,e,n,r){return arguments.length===1?YS(t):new xt(t,e,n,r??1)}function xt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Ic(xt,Ko,ip(Pa,{brighter(t){return t=t==null?Zs:Math.pow(Zs,t),new xt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ka:Math.pow(ka,t),new xt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new xt(gr(this.r),gr(this.g),gr(this.b),Js(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gu,formatHex:Gu,formatHex8:qS,formatRgb:bu,toString:bu}));function Gu(){return`#${fr(this.r)}${fr(this.g)}${fr(this.b)}`}function qS(){return`#${fr(this.r)}${fr(this.g)}${fr(this.b)}${fr((isNaN(this.opacity)?1:this.opacity)*255)}`}function bu(){const t=Js(this.opacity);return`${t===1?"rgb(":"rgba("}${gr(this.r)}, ${gr(this.g)}, ${gr(this.b)}${t===1?")":`, ${t})`}`}function Js(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function gr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function fr(t){return t=gr(t),(t<16?"0":"")+t.toString(16)}function $u(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Nt(t,e,n,r)}function op(t){if(t instanceof Nt)return new Nt(t.h,t.s,t.l,t.opacity);if(t instanceof Pa||(t=ba(t)),!t)return new Nt;if(t instanceof Nt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),i=NaN,o=s-a,c=(s+a)/2;return o?(e===s?i=(n-r)/o+(n<r)*6:n===s?i=(r-e)/o+2:i=(e-n)/o+4,o/=c<.5?s+a:2-s-a,i*=60):o=c>0&&c<1?0:i,new Nt(i,o,c,t.opacity)}function QS(t,e,n,r){return arguments.length===1?op(t):new Nt(t,e,n,r??1)}function Nt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Ic(Nt,QS,ip(Pa,{brighter(t){return t=t==null?Zs:Math.pow(Zs,t),new Nt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ka:Math.pow(ka,t),new Nt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new xt(ao(t>=240?t-240:t+120,a,r),ao(t,a,r),ao(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new Nt(Wu(this.h),rs(this.s),rs(this.l),Js(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Js(this.opacity);return`${t===1?"hsl(":"hsla("}${Wu(this.h)}, ${rs(this.s)*100}%, ${rs(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Wu(t){return t=(t||0)%360,t<0?t+360:t}function rs(t){return Math.max(0,Math.min(1,t||0))}function ao(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Yc=t=>()=>t;function ZS(t,e){return function(n){return t+n*e}}function JS(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function e2(t){return(t=+t)==1?cp:function(e,n){return n-e?JS(e,n,t):Yc(isNaN(e)?n:e)}}function cp(t,e){var n=e-t;return n?ZS(t,n):Yc(isNaN(t)?e:t)}const zu=(function t(e){var n=e2(e);function r(a,s){var i=n((a=Ko(a)).r,(s=Ko(s)).r),o=n(a.g,s.g),c=n(a.b,s.b),u=cp(a.opacity,s.opacity);return function(g){return a.r=i(g),a.g=o(g),a.b=c(g),a.opacity=u(g),a+""}}return r.gamma=t,r})(1);function t2(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),a;return function(s){for(a=0;a<n;++a)r[a]=t[a]*(1-s)+e[a]*s;return r}}function n2(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function r2(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,a=new Array(r),s=new Array(n),i;for(i=0;i<r;++i)a[i]=qc(t[i],e[i]);for(;i<n;++i)s[i]=e[i];return function(o){for(i=0;i<r;++i)s[i]=a[i](o);return s}}function a2(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function ei(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function s2(t,e){var n={},r={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?n[a]=qc(t[a],e[a]):r[a]=e[a];return function(s){for(a in n)r[a]=n[a](s);return r}}var Po=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,so=new RegExp(Po.source,"g");function i2(t){return function(){return t}}function o2(t){return function(e){return t(e)+""}}function c2(t,e){var n=Po.lastIndex=so.lastIndex=0,r,a,s,i=-1,o=[],c=[];for(t=t+"",e=e+"";(r=Po.exec(t))&&(a=so.exec(e));)(s=a.index)>n&&(s=e.slice(n,s),o[i]?o[i]+=s:o[++i]=s),(r=r[0])===(a=a[0])?o[i]?o[i]+=a:o[++i]=a:(o[++i]=null,c.push({i,x:ei(r,a)})),n=so.lastIndex;return n<e.length&&(s=e.slice(n),o[i]?o[i]+=s:o[++i]=s),o.length<2?c[0]?o2(c[0].x):i2(e):(e=c.length,function(u){for(var g=0,f;g<e;++g)o[(f=c[g]).i]=f.x(u);return o.join("")})}function qc(t,e){var n=typeof e,r;return e==null||n==="boolean"?Yc(e):(n==="number"?ei:n==="string"?(r=ba(e))?(e=r,zu):c2:e instanceof ba?zu:e instanceof Date?a2:n2(e)?t2:Array.isArray(e)?r2:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?s2:ei)(t,e)}function f2(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function u2(t){return function(){return t}}function g2(t){return+t}var Hu=[0,1];function mr(t){return t}function Xo(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:u2(isNaN(e)?NaN:.5)}function l2(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function p2(t,e,n){var r=t[0],a=t[1],s=e[0],i=e[1];return a<r?(r=Xo(a,r),s=n(i,s)):(r=Xo(r,a),s=n(s,i)),function(o){return s(r(o))}}function h2(t,e,n){var r=Math.min(t.length,e.length)-1,a=new Array(r),s=new Array(r),i=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++i<r;)a[i]=Xo(t[i],t[i+1]),s[i]=n(e[i],e[i+1]);return function(o){var c=_S(t,o,1,r)-1;return s[c](a[c](o))}}function d2(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function v2(){var t=Hu,e=Hu,n=qc,r,a,s,i=mr,o,c,u;function g(){var l=Math.min(t.length,e.length);return i!==mr&&(i=l2(t[0],t[l-1])),o=l>2?h2:p2,c=u=null,f}function f(l){return l==null||isNaN(l=+l)?s:(c||(c=o(t.map(r),e,n)))(r(i(l)))}return f.invert=function(l){return i(a((u||(u=o(e,t.map(r),ei)))(l)))},f.domain=function(l){return arguments.length?(t=Array.from(l,g2),g()):t.slice()},f.range=function(l){return arguments.length?(e=Array.from(l),g()):e.slice()},f.rangeRound=function(l){return e=Array.from(l),n=f2,g()},f.clamp=function(l){return arguments.length?(i=l?!0:mr,g()):i!==mr},f.interpolate=function(l){return arguments.length?(n=l,g()):n},f.unknown=function(l){return arguments.length?(s=l,f):s},function(l,p){return r=l,a=p,g()}}function y2(){return v2()(mr,mr)}function T2(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ti(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Wr(t){return t=ti(Math.abs(t)),t?t[1]:NaN}function x2(t,e){return function(n,r){for(var a=n.length,s=[],i=0,o=t[0],c=0;a>0&&o>0&&(c+o+1>r&&(o=Math.max(1,r-c)),s.push(n.substring(a-=o,a+o)),!((c+=o+1)>r));)o=t[i=(i+1)%t.length];return s.reverse().join(e)}}function S2(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var C2=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ni(t){if(!(e=C2.exec(t)))throw new Error("invalid format: "+t);var e;return new Qc({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ni.prototype=Qc.prototype;function Qc(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Qc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function w2(t){e:for(var e=t.length,n=1,r=-1,a;n<e;++n)switch(t[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(a+1):t}var fp;function E2(t,e){var n=ti(t,e);if(!n)return t+"";var r=n[0],a=n[1],s=a-(fp=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=r.length;return s===i?r:s>i?r+new Array(s-i+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+ti(t,Math.max(0,e+s-1))[0]}function Au(t,e){var n=ti(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const ju={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:T2,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Au(t*100,e),r:Au,s:E2,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ku(t){return t}var Pu=Array.prototype.map,Xu=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function R2(t){var e=t.grouping===void 0||t.thousands===void 0?Ku:x2(Pu.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?Ku:S2(Pu.call(t.numerals,String)),i=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f){f=ni(f);var l=f.fill,p=f.align,v=f.sign,h=f.symbol,d=f.zero,T=f.width,S=f.comma,x=f.precision,y=f.trim,C=f.type;C==="n"?(S=!0,C="g"):ju[C]||(x===void 0&&(x=12),y=!0,C="g"),(d||l==="0"&&p==="=")&&(d=!0,l="0",p="=");var w=h==="$"?n:h==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",R=h==="$"?r:/[%p]/.test(C)?i:"",O=ju[C],V=/[defgprs%]/.test(C);x=x===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function L(m){var F=w,B=R,_,P,z;if(C==="c")B=O(m)+B,m="";else{m=+m;var A=m<0||1/m<0;if(m=isNaN(m)?c:O(Math.abs(m),x),y&&(m=w2(m)),A&&+m==0&&v!=="+"&&(A=!1),F=(A?v==="("?v:o:v==="-"||v==="("?"":v)+F,B=(C==="s"?Xu[8+fp/3]:"")+B+(A&&v==="("?")":""),V){for(_=-1,P=m.length;++_<P;)if(z=m.charCodeAt(_),48>z||z>57){B=(z===46?a+m.slice(_+1):m.slice(_))+B,m=m.slice(0,_);break}}}S&&!d&&(m=e(m,1/0));var I=F.length+m.length+B.length,k=I<T?new Array(T-I+1).join(l):"";switch(S&&d&&(m=e(k+m,k.length?T-B.length:1/0),k=""),p){case"<":m=F+m+B+k;break;case"=":m=F+k+m+B;break;case"^":m=k.slice(0,I=k.length>>1)+F+m+B+k.slice(I);break;default:m=k+F+m+B;break}return s(m)}return L.toString=function(){return f+""},L}function g(f,l){var p=u((f=ni(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(Wr(l)/3)))*3,h=Math.pow(10,-v),d=Xu[8+v/3];return function(T){return p(h*T)+d}}return{format:u,formatPrefix:g}}var as,up,gp;O2({thousands:",",grouping:[3],currency:["$",""]});function O2(t){return as=R2(t),up=as.format,gp=as.formatPrefix,as}function M2(t){return Math.max(0,-Wr(Math.abs(t)))}function D2(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Wr(e)/3)))*3-Wr(Math.abs(t)))}function L2(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Wr(e)-Wr(t))+1}function m2(t,e,n,r){var a=bS(t,e,n),s;switch(r=ni(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=D2(a,i))&&(r.precision=s),gp(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=L2(a,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=M2(a))&&(r.precision=s-(r.type==="%")*2);break}}return up(r)}function V2(t){var e=t.domain;return t.ticks=function(n){var r=e();return GS(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var a=e();return m2(a[0],a[a.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),a=0,s=r.length-1,i=r[a],o=r[s],c,u,g=10;for(o<i&&(u=i,i=o,o=u,u=a,a=s,s=u);g-- >0;){if(u=jo(i,o,n),u===c)return r[a]=i,r[s]=o,e(r);if(u>0)i=Math.floor(i/u)*u,o=Math.ceil(o/u)*u;else if(u<0)i=Math.ceil(i*u)/u,o=Math.floor(o*u)/u;else break;c=u}return t},t}function Zc(){var t=y2();return t.copy=function(){return d2(t,Zc())},$S.apply(t,arguments),V2(t)}var Vs={exports:{}},F2=Vs.exports,Iu;function B2(){return Iu||(Iu=1,(function(t){(function(e,n,r){function a(c){var u=this,g=o();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=g(" "),u.s1=g(" "),u.s2=g(" "),u.s0-=g(c),u.s0<0&&(u.s0+=1),u.s1-=g(c),u.s1<0&&(u.s1+=1),u.s2-=g(c),u.s2<0&&(u.s2+=1),g=null}function s(c,u){return u.c=c.c,u.s0=c.s0,u.s1=c.s1,u.s2=c.s2,u}function i(c,u){var g=new a(c),f=u&&u.state,l=g.next;return l.int32=function(){return g.next()*4294967296|0},l.double=function(){return l()+(l()*2097152|0)*11102230246251565e-32},l.quick=l,f&&(typeof f=="object"&&s(f,g),l.state=function(){return s(g,{})}),l}function o(){var c=4022871197,u=function(g){g=String(g);for(var f=0;f<g.length;f++){c+=g.charCodeAt(f);var l=.02519603282416938*c;c=l>>>0,l-=c,l*=c,c=l>>>0,l-=c,c+=l*4294967296}return(c>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(F2,t)})(Vs)),Vs.exports}var Fs={exports:{}},_2=Fs.exports,Yu;function U2(){return Yu||(Yu=1,(function(t){(function(e,n,r){function a(o){var c=this,u="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var f=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^f^f>>>8},o===(o|0)?c.x=o:u+=o;for(var g=0;g<u.length+64;g++)c.x^=u.charCodeAt(g)|0,c.next()}function s(o,c){return c.x=o.x,c.y=o.y,c.z=o.z,c.w=o.w,c}function i(o,c){var u=new a(o),g=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var l=u.next()>>>11,p=(u.next()>>>0)/4294967296,v=(l+p)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,g&&(typeof g=="object"&&s(g,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=i:this.xor128=i})(_2,t)})(Fs)),Fs.exports}var Bs={exports:{}},N2=Bs.exports,qu;function k2(){return qu||(qu=1,(function(t){(function(e,n,r){function a(o){var c=this,u="";c.next=function(){var f=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(f^f<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,o===(o|0)?c.x=o:u+=o;for(var g=0;g<u.length+64;g++)c.x^=u.charCodeAt(g)|0,g==u.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function s(o,c){return c.x=o.x,c.y=o.y,c.z=o.z,c.w=o.w,c.v=o.v,c.d=o.d,c}function i(o,c){var u=new a(o),g=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var l=u.next()>>>11,p=(u.next()>>>0)/4294967296,v=(l+p)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,g&&(typeof g=="object"&&s(g,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=i:this.xorwow=i})(N2,t)})(Bs)),Bs.exports}var _s={exports:{}},G2=_s.exports,Qu;function b2(){return Qu||(Qu=1,(function(t){(function(e,n,r){function a(o){var c=this;c.next=function(){var g=c.x,f=c.i,l,p;return l=g[f],l^=l>>>7,p=l^l<<24,l=g[f+1&7],p^=l^l>>>10,l=g[f+3&7],p^=l^l>>>3,l=g[f+4&7],p^=l^l<<7,l=g[f+7&7],l=l^l<<13,p^=l^l<<9,g[f]=p,c.i=f+1&7,p};function u(g,f){var l,p=[];if(f===(f|0))p[0]=f;else for(f=""+f,l=0;l<f.length;++l)p[l&7]=p[l&7]<<15^f.charCodeAt(l)+p[l+1&7]<<13;for(;p.length<8;)p.push(0);for(l=0;l<8&&p[l]===0;++l);for(l==8?p[7]=-1:p[l],g.x=p,g.i=0,l=256;l>0;--l)g.next()}u(c,o)}function s(o,c){return c.x=o.x.slice(),c.i=o.i,c}function i(o,c){o==null&&(o=+new Date);var u=new a(o),g=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var l=u.next()>>>11,p=(u.next()>>>0)/4294967296,v=(l+p)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,g&&(g.x&&s(g,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=i:this.xorshift7=i})(G2,t)})(_s)),_s.exports}var Us={exports:{}},$2=Us.exports,Zu;function W2(){return Zu||(Zu=1,(function(t){(function(e,n,r){function a(o){var c=this;c.next=function(){var g=c.w,f=c.X,l=c.i,p,v;return c.w=g=g+1640531527|0,v=f[l+34&127],p=f[l=l+1&127],v^=v<<13,p^=p<<17,v^=v>>>15,p^=p>>>12,v=f[l]=v^p,c.i=l,v+(g^g>>>16)|0};function u(g,f){var l,p,v,h,d,T=[],S=128;for(f===(f|0)?(p=f,f=null):(f=f+"\0",p=0,S=Math.max(S,f.length)),v=0,h=-32;h<S;++h)f&&(p^=f.charCodeAt((h+32)%f.length)),h===0&&(d=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,h>=0&&(d=d+1640531527|0,l=T[h&127]^=p+d,v=l==0?v+1:0);for(v>=128&&(T[(f&&f.length||0)&127]=-1),v=127,h=512;h>0;--h)p=T[v+34&127],l=T[v=v+1&127],p^=p<<13,l^=l<<17,p^=p>>>15,l^=l>>>12,T[v]=p^l;g.w=d,g.X=T,g.i=v}u(c,o)}function s(o,c){return c.i=o.i,c.w=o.w,c.X=o.X.slice(),c}function i(o,c){o==null&&(o=+new Date);var u=new a(o),g=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var l=u.next()>>>11,p=(u.next()>>>0)/4294967296,v=(l+p)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,g&&(g.X&&s(g,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=i:this.xor4096=i})($2,t)})(Us)),Us.exports}var Ns={exports:{}},z2=Ns.exports,Ju;function H2(){return Ju||(Ju=1,(function(t){(function(e,n,r){function a(o){var c=this,u="";c.next=function(){var f=c.b,l=c.c,p=c.d,v=c.a;return f=f<<25^f>>>7^l,l=l-p|0,p=p<<24^p>>>8^v,v=v-f|0,c.b=f=f<<20^f>>>12^l,c.c=l=l-p|0,c.d=p<<16^l>>>16^v,c.a=v-f|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,o===Math.floor(o)?(c.a=o/4294967296|0,c.b=o|0):u+=o;for(var g=0;g<u.length+20;g++)c.b^=u.charCodeAt(g)|0,c.next()}function s(o,c){return c.a=o.a,c.b=o.b,c.c=o.c,c.d=o.d,c}function i(o,c){var u=new a(o),g=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var l=u.next()>>>11,p=(u.next()>>>0)/4294967296,v=(l+p)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,g&&(typeof g=="object"&&s(g,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=i:this.tychei=i})(z2,t)})(Ns)),Ns.exports}var ks={exports:{}};const A2={},j2=Object.freeze(Object.defineProperty({__proto__:null,default:A2},Symbol.toStringTag,{value:"Module"})),K2=Fx(j2);var P2=ks.exports,eg;function X2(){return eg||(eg=1,(function(t){(function(e,n,r){var a=256,s=6,i=52,o="random",c=r.pow(a,s),u=r.pow(2,i),g=u*2,f=a-1,l;function p(y,C,w){var R=[];C=C==!0?{entropy:!0}:C||{};var O=T(d(C.entropy?[y,x(n)]:y??S(),3),R),V=new v(R),L=function(){for(var m=V.g(s),F=c,B=0;m<u;)m=(m+B)*a,F*=a,B=V.g(1);for(;m>=g;)m/=2,F/=2,B>>>=1;return(m+B)/F};return L.int32=function(){return V.g(4)|0},L.quick=function(){return V.g(4)/4294967296},L.double=L,T(x(V.S),n),(C.pass||w||function(m,F,B,_){return _&&(_.S&&h(_,V),m.state=function(){return h(V,{})}),B?(r[o]=m,F):m})(L,O,"global"in C?C.global:this==r,C.state)}function v(y){var C,w=y.length,R=this,O=0,V=R.i=R.j=0,L=R.S=[];for(w||(y=[w++]);O<a;)L[O]=O++;for(O=0;O<a;O++)L[O]=L[V=f&V+y[O%w]+(C=L[O])],L[V]=C;(R.g=function(m){for(var F,B=0,_=R.i,P=R.j,z=R.S;m--;)F=z[_=f&_+1],B=B*a+z[f&(z[_]=z[P=f&P+F])+(z[P]=F)];return R.i=_,R.j=P,B})(a)}function h(y,C){return C.i=y.i,C.j=y.j,C.S=y.S.slice(),C}function d(y,C){var w=[],R=typeof y,O;if(C&&R=="object")for(O in y)try{w.push(d(y[O],C-1))}catch{}return w.length?w:R=="string"?y:y+"\0"}function T(y,C){for(var w=y+"",R,O=0;O<w.length;)C[f&O]=f&(R^=C[f&O]*19)+w.charCodeAt(O++);return x(C)}function S(){try{var y;return l&&(y=l.randomBytes)?y=y(a):(y=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(y)),x(y)}catch{var C=e.navigator,w=C&&C.plugins;return[+new Date,e,w,e.screen,x(n)]}}function x(y){return String.fromCharCode.apply(0,y)}if(T(r.random(),n),t.exports){t.exports=p;try{l=K2}catch{}}else r["seed"+o]=p})(typeof self<"u"?self:P2,[],Math)})(ks)),ks.exports}var io,tg;function I2(){if(tg)return io;tg=1;var t=B2(),e=U2(),n=k2(),r=b2(),a=W2(),s=H2(),i=X2();return i.alea=t,i.xor128=e,i.xorwow=n,i.xorshift7=r,i.xor4096=a,i.tychei=s,io=i,io}var Y2=I2();const q2=Si(Y2),lp=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Q2=[1,0,0,0,1,0,0,0,1],Jc=1e-6,ef=1e-12,{vtkErrorMacro:pp,vtkWarningMacro:dr}=E;let hp=0;const ng=20;function Xa(t){return()=>pp(`vtkMath::${t} - NOT IMPLEMENTED`)}function Ma(t,e,n,r){let a;for(let s=0;s<e;s++)a=t[n*e+s],t[n*e+s]=t[r*e+s],t[r*e+s]=a}function ua(t,e,n,r){let a;for(let s=0;s<e;s++)a=t[s*e+n],t[s*e+n]=t[s*e+r],t[s*e+r]=a}function Me(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3;const e=Array(t);for(let n=0;n<t;++n)e[n]=0;return e}const Z2=()=>Math.PI;function J2(t,e){return e>1023?t*2**1023*2**(e-1023):e<-1074?t*2**-1074*2**(e+1074):t*2**e}function Ve(t){return t/180*Math.PI}function zr(t){return t*180/Math.PI}const{round:ga,floor:eC,ceil:tC,min:nC,max:rC}=Math;function aC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=1/0;for(let a=e,s=t.length;a<s;a+=n)t[a]<r&&(r=t[a]);return r}function sC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=-1/0;for(let a=e,s=t.length;a<s;a+=n)r<t[a]&&(r=t[a]);return r}function iC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=1/0,a=-1/0;for(let s=e,i=t.length;s<i;s+=n)t[s]<r&&(r=t[s]),a<t[s]&&(a=t[s]);return[r,a]}const oC=Xa("ceilLog2"),cC=Xa("factorial");function mt(t){let e=1;for(;e<t;)e*=2;return e}function la(t){return t===mt(t)}function fC(t,e){let n=1;for(let r=1;r<=e;++r)n*=(t-r+1)/r;return Math.floor(n)}function uC(t,e){if(t<e)return 0;const n=Me(e);for(let r=0;r<e;++r)n[r]=r;return n}function gC(t,e,n){let r=0;for(let a=e-1;a>=0;--a)if(n[a]<t-e+a){let s=n[a]+1;for(;a<e;)n[a++]=s++;r=1;break}return r}function lC(t){q2(`${t}`,{global:!0}),hp=t}function pC(){return hp}function hC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:1)-t;return t+n*Math.random()}const dC=Xa("gaussian");function Hr(t,e,n){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n}function ze(t,e,n){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n}function dp(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t}function vp(t,e){return t[0]*=e,t[1]*=e,t}function Io(t,e,n,r){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r}function vC(t,e,n,r){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r}function ee(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function yC(t,e,n){n[0]=t[0]*e[0],n[1]=t[0]*e[1],n[2]=t[0]*e[2],n[3]=t[1]*e[0],n[4]=t[1]*e[1],n[5]=t[1]*e[2],n[6]=t[2]*e[0],n[7]=t[2]*e[1],n[8]=t[2]*e[2]}function gt(t,e,n){const r=t[1]*e[2]-t[2]*e[1],a=t[2]*e[0]-t[0]*e[2],s=t[0]*e[1]-t[1]*e[0];return n[0]=r,n[1]=a,n[2]=s,n}function Et(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(e){case 1:return Math.abs(t);case 2:return Math.sqrt(t[0]*t[0]+t[1]*t[1]);case 3:return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);default:{let n=0;for(let r=0;r<e;r++)n+=t[r]*t[r];return Math.sqrt(n)}}}function Rt(t){const e=Et(t);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e),e}function TC(t){const e=Et(t,3);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e,t[3]/=e),e}function xC(t,e,n,r){const a=t[0]*t[0],s=t[1]*t[1],i=t[2]*t[2],o=Math.sqrt(a+s+i);let c,u,g;a>s&&a>i?(c=0,u=1,g=2):s>i?(c=1,u=2,g=0):(c=2,u=0,g=1);const f=t[c]/o,l=t[u]/o,p=t[g]/o,v=Math.sqrt(f*f+p*p);if(r!==0){const h=Math.sin(r),d=Math.cos(r);e&&(e[c]=(p*d-f*l*h)/v,e[u]=h*v,e[g]=(-(f*d)-l*p*h)/v),n&&(n[c]=(-(p*h)-f*l*d)/v,n[u]=d*v,n[g]=(f*h-l*p*d)/v)}else e&&(e[c]=p/v,e[u]=0,e[g]=-f/v),n&&(n[c]=-f*l/v,n[u]=v,n[g]=-l*p/v)}function SC(t,e,n){const r=ee(e,e);if(r===0)return n[0]=0,n[1]=0,n[2]=0,!1;const a=ee(t,e)/r;for(let s=0;s<3;s++)n[s]=e[s];return dp(n,a),!0}function Yo(t,e){return t[0]*e[0]+t[1]*e[1]}function CC(t,e,n){const r=Yo(e,e);if(r===0)return n[0]=0,n[1]=0,!1;const a=Yo(t,e)/r;for(let s=0;s<2;s++)n[s]=e[s];return vp(n,a),!0}function Tt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])+(t[2]-e[2])*(t[2]-e[2])}function wC(t,e){const n=[0,0,0];return gt(t,e,n),Math.atan2(Et(n),ee(t,e))}function EC(t,e,n){const r=Math.abs(t-n);return 1/Math.sqrt(2*Math.PI*e)*Math.exp(-(r**2)/(2*e))}function RC(t,e,n){const r=Math.abs(t-n);return Math.exp(-(r**2)/(2*e))}function OC(t,e,n){n[0]=t[0]*e[0],n[1]=t[0]*e[1],n[2]=t[1]*e[0],n[3]=t[1]*e[1]}function yp(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Tp(t){const e=yp(t);return e!==0&&(t[0]/=e,t[1]/=e),e}function me(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===2?e[0][0]*e[1][1]-e[1][0]*e[0][1]:e.length===4?e[0]*e[3]-e[1]*e[2]:Number.NaN}function MC(t,e){let n,r,a;const s=[0,0,0];for(let i=0;i<3;i++)a=Math.abs(t[i*3]),(r=Math.abs(t[i*3+1]))>a&&(a=r),(r=Math.abs(t[i*3+2]))>a&&(a=r),s[i]=1/a;a=s[0]*Math.abs(t[0]),n=0,(r=s[1]*Math.abs(t[3]))>=a&&(a=r,n=1),(r=s[2]*Math.abs(t[6]))>=a&&(n=2),n!==0&&(Ma(t,3,n,0),s[n]=s[0]),e[0]=n,t[3]/=t[0],t[6]/=t[0],t[4]-=t[3]*t[1],t[7]-=t[6]*t[1],a=s[1]*Math.abs(t[4]),n=1,(r=s[2]*Math.abs(t[7]))>=a&&(n=2,Ma(t,3,1,2),s[2]=s[1]),e[1]=n,t[7]/=t[4],t[5]-=t[3]*t[2],t[8]-=t[6]*t[2]+t[7]*t[5],e[2]=2}function DC(t,e,n){let r=n[e[0]];n[e[0]]=n[0],n[0]=r,r=n[e[1]],n[e[1]]=n[1],n[1]=r-t[3]*n[0],r=n[e[2]],n[e[2]]=n[2],n[2]=r-t[6]*n[0]-t[7]*n[1],n[2]/=t[8],n[1]=(n[1]-t[5]*n[2])/t[4],n[0]=(n[0]-t[1]*n[1]-t[2]*n[2])/t[0]}function LC(t,e,n){const r=t[0],a=t[1],s=t[2],i=t[3],o=t[4],c=t[5],u=t[6],g=t[7],f=t[8],l=+me(o,g,c,f),p=-me(i,u,c,f),v=+me(i,u,o,g),h=-me(a,g,s,f),d=+me(r,u,s,f),T=-me(r,u,a,g),S=+me(a,o,s,c),x=-me(r,i,s,c),y=+me(r,i,a,o),C=r*l+a*p+s*v,w=l*e[0]+h*e[1]+S*e[2],R=p*e[0]+d*e[1]+x*e[2],O=v*e[0]+T*e[1]+y*e[2];n[0]=w/C,n[1]=R/C,n[2]=O/C}function mC(t,e,n){const r=t[0]*e[0]+t[1]*e[1]+t[2]*e[2],a=t[3]*e[0]+t[4]*e[1]+t[5]*e[2],s=t[6]*e[0]+t[7]*e[1]+t[8]*e[2];n[0]=r,n[1]=a,n[2]=s}function qo(t,e,n){const r=[...t],a=[...e];for(let s=0;s<3;s++)n[s]=r[0]*a[s]+r[1]*a[s+3]+r[2]*a[s+6],n[s+3]=r[3]*a[s]+r[4]*a[s+3]+r[5]*a[s+6],n[s+6]=r[6]*a[s]+r[7]*a[s+3]+r[8]*a[s+6]}function VC(t,e,n,r,a,s,i){r!==a&&pp("Number of columns of A must match number of rows of B.");const o=[...t],c=[...e];for(let u=0;u<n;u++)for(let g=0;g<s;g++){i[u*s+g]=0;for(let f=0;f<r;f++)i[u*s+g]+=o[u*r+f]*c[g+s*f]}}function Gr(t,e){let n;n=t[3],e[3]=t[1],e[1]=n,n=t[6],e[6]=t[2],e[2]=n,n=t[7],e[7]=t[5],e[5]=n,e[0]=t[0],e[4]=t[4],e[8]=t[8]}function FC(t,e){const n=t[0],r=t[1],a=t[2],s=t[3],i=t[4],o=t[5],c=t[6],u=t[7],g=t[8],f=+me(i,u,o,g),l=-me(s,c,o,g),p=+me(s,c,i,u),v=-me(r,u,a,g),h=+me(n,c,a,g),d=-me(n,c,r,u),T=+me(r,i,a,o),S=-me(n,s,a,o),x=+me(n,s,r,i),y=n*f+r*l+a*p;y===0&&dr("Matrix has 0 determinant"),e[0]=f/y,e[3]=l/y,e[6]=p/y,e[1]=v/y,e[4]=h/y,e[7]=d/y,e[2]=T/y,e[5]=S/y,e[8]=x/y}function Ei(t){return t[0]*t[4]*t[8]+t[3]*t[7]*t[2]+t[6]*t[1]*t[5]-t[0]*t[7]*t[5]-t[3]*t[1]*t[8]-t[6]*t[4]*t[2]}function xp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jc;if(t.length!==e.length)return!1;function r(a,s){return Math.abs(a-e[s])<=n}return t.every(r)}const Ar=xp;function Sp(t){for(let e=0;e<3;e++)t[e*3]=t[e*3+1]=t[e*3+2]=0,t[e*3+e]=1}function Cp(t,e){for(let n=0;n<t;n++){for(let r=0;r<t;r++)e[n*t+r]=0;e[n*t+n]=1}return e}function BC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jc;return Ar(t,lp,e)}function _C(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jc;return Ar(t,Q2,e)}function wp(t,e){const n=t[0]*t[0],r=t[0]*t[1],a=t[0]*t[2],s=t[0]*t[3],i=t[1]*t[1],o=t[2]*t[2],c=t[3]*t[3],u=t[1]*t[2],g=t[1]*t[3],f=t[2]*t[3],l=i+o+c;let p=1/(n+l);const v=(n-l)*p;p*=2,e[0]=i*p+v,e[3]=(u+s)*p,e[6]=(g-a)*p,e[1]=(u-s)*p,e[4]=o*p+v,e[7]=(f+r)*p,e[2]=(g+a)*p,e[5]=(f-r)*p,e[8]=c*p+v}function Gs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!`${t}`.includes("e"))return+`${Math.round(`${t}e+${e}`)}e-${e}`;const n=`${t}`.split("e");let r="";return+n[1]+e>0&&(r="+"),+`${Math.round(`${+n[0]}e${r}${+n[1]+e}`)}e-${e}`}function Qo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e[0]=Gs(t[0],n),e[1]=Gs(t[1],n),e[2]=Gs(t[2],n),e}function Ia(t,e,n,r){let a,s,i,o,c,u,g,f,l,p,v,h,d,T,S,x;const y=Me(e),C=Me(e),w=(O,V,L)=>{T=O[V],d=O[L],O[V]=T-h*(d+T*p),O[L]=d+h*(T-d*p)};for(Cp(e,r),c=0;c<e;c++)y[c]=n[c]=t[c+c*e],C[c]=0;for(a=0;a<ng;a++){for(v=0,c=0;c<e-1;c++)for(o=c+1;o<e;o++)v+=Math.abs(t[c*e+o]);if(v===0)break;for(a<3?g=.2*v/(e*e):g=0,c=0;c<e-1;c++)for(o=c+1;o<e;o++)if(T=100*Math.abs(t[c*e+o]),a>3&&Math.abs(n[c])+T===Math.abs(n[c])&&Math.abs(n[o])+T===Math.abs(n[o]))t[c*e+o]=0;else if(Math.abs(t[c*e+o])>g){for(d=n[o]-n[c],Math.abs(d)+T===Math.abs(d)?l=t[c*e+o]/d:(f=.5*d/t[c*e+o],l=1/(Math.abs(f)+Math.sqrt(1+f*f)),f<0&&(l=-l)),S=1/Math.sqrt(1+l*l),h=l*S,p=h/(1+S),d=l*t[c*e+o],C[c]-=d,C[o]+=d,n[c]-=d,n[o]+=d,t[c*e+o]=0,s=0;s<=c-1;s++)w(t,s*e+c,s*e+o);for(s=c+1;s<=o-1;s++)w(t,c*e+s,s*e+o);for(s=o+1;s<e;s++)w(t,c*e+s,o*e+s);for(s=0;s<e;s++)w(r,s*e+c,s*e+o)}for(c=0;c<e;c++)y[c]+=C[c],n[c]=y[c],C[c]=0}if(a>=ng)return dr("vtkMath::Jacobi: Error extracting eigenfunctions"),0;for(s=0;s<e-1;s++){for(i=s,x=n[i],a=s+1;a<e;a++)(n[a]>=x||Math.abs(n[a]-x)<ef)&&(i=a,x=n[i]);i!==s&&(n[i]=n[s],n[s]=x,ua(r,e,s,i))}const R=(e>>1)+(e&1);for(u=0,a=0;a<e*e;a++)r[a]>=0&&u++;if(u<R)for(a=0;a<e;a++)r[a*e+s]*=-1;return 1}function Ep(t,e){const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];n[0]=t[0]+t[4]+t[8],n[5]=t[0]-t[4]-t[8],n[10]=-t[0]+t[4]-t[8],n[15]=-t[0]-t[4]+t[8],n[1]=n[4]=t[7]-t[5],n[2]=n[8]=t[2]-t[6],n[3]=n[12]=t[3]-t[1],n[6]=n[9]=t[3]+t[1],n[7]=n[13]=t[2]+t[6],n[11]=n[14]=t[7]+t[5];const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=[0,0,0,0],s=[...n];Ia(s,4,a,r),e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12]}function UC(t,e,n){const r=t[0]*e[0],a=t[0]*e[1],s=t[0]*e[2],i=t[0]*e[3],o=t[1]*e[0],c=t[1]*e[1],u=t[1]*e[2],g=t[1]*e[3],f=t[2]*e[0],l=t[2]*e[1],p=t[2]*e[2],v=t[2]*e[3],h=t[3]*e[0],d=t[3]*e[1],T=t[3]*e[2],S=t[3]*e[3];n[0]=r-c-p-S,n[1]=a+o+v-T,n[2]=s-g+f+d,n[3]=i+u-l+h}function Rp(t,e){for(let l=0;l<9;l++)e[l]=t[l];const n=Me(3),r=Me(3);let a;for(let l=0;l<3;l++){const p=Math.abs(e[l*3]),v=Math.abs(e[l*3+1]),h=Math.abs(e[l*3+2]);a=v>p?v:p,a=h>a?h:a,n[l]=1,a!==0&&(n[l]/=a)}const s=Math.abs(e[0])*n[0],i=Math.abs(e[3])*n[1],o=Math.abs(e[6])*n[2];r[0]=0,a=s,i>=a&&(a=i,r[0]=1),o>=a&&(r[0]=2),r[0]!==0&&(ua(e,3,r[0],0),n[r[0]]=n[0]);const c=Math.abs(e[4])*n[1],u=Math.abs(e[7])*n[2];r[1]=1,a=c,u>=a&&(r[1]=2,ua(e,3,1,2)),r[2]=2;let g=0;if(Ei(e)<0){g=1;for(let l=0;l<9;l++)e[l]=-e[l]}const f=Me(4);if(Ep(e,f),wp(f,e),g)for(let l=0;l<9;l++)e[l]=-e[l];r[1]!==1&&ua(e,3,r[1],1),r[0]!==0&&ua(e,3,r[0],0)}function Op(t,e,n){let r,a,s,i,o,c;const u=[...t];if(Ia(u,3,e,n),e[0]===e[1]&&e[0]===e[2]){Sp(n);return}for(Gr(n,n),r=0;r<3;r++)if(e[(r+1)%3]===e[(r+2)%3]){for(c=Math.abs(n[r*3]),i=0,a=1;a<3;a++)c<(o=Math.abs(n[r*3+a]))&&(c=o,i=a);i!==r&&(o=e[i],e[i]=e[r],e[r]=o,Ma(n,3,r,i)),n[i*3+i]<0&&(n[i*3]=-n[i*3],n[i*3+1]=-n[i*3+1],n[i*3+2]=-n[i*3+2]),a=(i+1)%3,s=(i+2)%3,n[a*3]=0,n[a*3+1]=0,n[a*3+2]=0,n[a*3+a]=1;const g=gt([n[i*3],n[i*3+1],n[i*3+2]],[n[a*3],n[a*3+1],n[a*3+2]],[]);Rt(g);const f=gt(g,[n[i*3],n[i*3+1],n[i*3+2]],[]);for(let l=0;l<3;l++)n[s*3+l]=g[l],n[a*3+l]=f[l];Gr(n,n);return}for(c=Math.abs(n[0]),i=0,r=1;r<3;r++)c<(o=Math.abs(n[r*3]))&&(c=o,i=r);if(i!==0){const g=e[i];e[i]=e[0],e[0]=g,Ma(n,3,i,0)}if(Math.abs(n[4])<Math.abs(n[7])){const g=e[2];e[2]=e[1],e[1]=g,Ma(n,3,1,2)}for(r=0;r<2;r++)n[r*3+r]<0&&(n[r*3]=-n[r*3],n[r*3+1]=-n[r*3+1],n[r*3+2]=-n[r*3+2]);Ei(n)<0&&(n[6]=-n[6],n[7]=-n[7],n[8]=-n[8]),Gr(n,n)}function NC(t,e,n,r){let a;const s=[...t],i=Ei(s);if(i<0)for(a=0;a<9;a++)s[a]=-s[a];Rp(s,e),Gr(s,s),qo(s,e,r),Op(r,n,r),qo(e,r,e),Gr(r,r),i<0&&(n[0]=-n[0],n[1]=-n[1],n[2]=-n[2])}function tf(t,e,n){let r,a,s,i,o=0,c,u,g;const f=Me(n);for(r=0;r<n;r++){for(i=0,a=0;a<n;a++)(g=Math.abs(t[r*n+a]))>i&&(i=g);if(i===0)return dr("Unable to factor linear system"),0;f[r]=1/i}for(a=0;a<n;a++){for(r=0;r<a;r++){for(c=t[r*n+a],s=0;s<r;s++)c-=t[r*n+s]*t[s*n+a];t[r*n+a]=c}for(i=0,r=a;r<n;r++){for(c=t[r*n+a],s=0;s<a;s++)c-=t[r*n+s]*t[s*n+a];t[r*n+a]=c,(u=f[r]*Math.abs(c))>=i&&(i=u,o=r)}if(a!==o){for(s=0;s<n;s++)u=t[o*n+s],t[o*n+s]=t[a*n+s],t[a*n+s]=u;f[o]=f[a]}if(e[a]=o,Math.abs(t[a*n+a])<=ef)return dr("Unable to factor linear system"),0;if(a!==n-1)for(u=1/t[a*n+a],r=a+1;r<n;r++)t[r*n+a]*=u}return 1}function nf(t,e,n,r){let a,s,i,o,c;for(i=-1,a=0;a<r;a++){if(o=e[a],c=n[o],n[o]=n[a],i>=0)for(s=i;s<=a-1;s++)c-=t[a*r+s]*n[s];else c!==0&&(i=a);n[a]=c}for(a=r-1;a>=0;a--){for(c=n[a],s=a+1;s<r;s++)c-=t[a*r+s]*n[s];n[a]=c/t[a*r+a]}}function Mp(t,e,n){if(n===2){const a=Me(2),s=me(t[0],t[1],t[2],t[3]);return s===0?0:(a[0]=(t[3]*e[0]-t[1]*e[1])/s,a[1]=(-(t[2]*e[0])+t[0]*e[1])/s,e[0]=a[0],e[1]=a[1],1)}if(n===1)return t[0]===0?0:(e[0]/=t[0],1);const r=Me(n);return tf(t,r,n)===0?0:(nf(t,r,e,n),1)}function rf(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;const s=r||Me(n),i=a||Me(n);if(tf(t,s,n)===0)return null;for(let o=0;o<n;o++){for(let c=0;c<n;c++)i[c]=0;i[o]=1,nf(t,s,i,n);for(let c=0;c<n;c++)e[c*n+o]=i[c]}return e}function kC(t,e){let n=+Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let a=0;a<e;a++)for(let s=a;s<e;s++)Math.abs(t[a*e+s])>r&&(r=Math.abs(t[a*e+s]));for(let a=0;a<e;a++)Math.abs(t[a*e+a])<n&&(n=Math.abs(t[a*e+a]));return n===0?Number.MAX_VALUE:r/n}function GC(t,e,n){return Ia(t,3,e,n)}function Zo(t,e,n,r){if(t<n)return dr("Insufficient number of samples. Underdetermined."),0;let a,s,i;const o=Me(n*n),c=Me(n),u=Me(n*n);for(i=0;i<t;i++)for(a=0;a<n;a++)for(s=a;s<n;s++)o[a*n+s]+=e[i*n+a]*e[i*n+s];for(a=0;a<n;a++)for(s=0;s<a;s++)o[a*n+s]=o[s*n+a];for(Ia(o,n,c,u),a=0;a<n;a++)r[a]=u[a*n+n-1];return 1}function bC(t,e,n,r,a,s){let i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!0;if(t<n||t<a)return dr("Insufficient number of samples. Underdetermined."),0;const o=Me(a);let c=1,u,g=0,f,l,p,v=0;if(i){for(l=0;l<a;l++)o[l]=1;for(f=0;f<t;f++)for(l=0;l<a;l++)Math.abs(r[f*a+l])>ef&&(c=0,o[l]=0);if(c&&a===1)return dr("Detected homogeneous system (Y=0), calling SolveHomogeneousLeastSquares()"),Zo(t,e,n,s);if(c)v=1;else for(l=0;l<a;l++)o[l]&&(v=1)}v&&(u=Me(n),g=Zo(t,e,n,u));const h=Me(n*n),d=Me(n*n),T=Me(n*a);for(p=0;p<t;p++)for(f=0;f<n;f++){for(l=f;l<n;l++)h[f*n+l]+=e[p*n+f]*e[p*n+l];for(l=0;l<a;l++)T[f*a+l]+=e[p*n+f]*r[p*a+l]}for(f=0;f<n;f++)for(l=0;l<f;l++)h[f*n+l]=h[l*n+f];const S=rf(h,d,n);if(S)for(f=0;f<n;f++)for(l=0;l<a;l++)for(s[f*a+l]=0,p=0;p<n;p++)s[f*a+l]+=d[f*n+p]*T[p*a+l];if(v){for(l=0;l<a;l++)if(o[l])for(f=0;f<n;f++)s[f*a+l]=u[f*a]}return v?g&&S:S}function $C(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,.5,1];switch(t.length){case 3:return e[0]=parseInt(t[0],16)*17/255,e[1]=parseInt(t[1],16)*17/255,e[2]=parseInt(t[2],16)*17/255,e;case 4:return e[0]=parseInt(t[1],16)*17/255,e[1]=parseInt(t[2],16)*17/255,e[2]=parseInt(t[3],16)*17/255,e;case 6:return e[0]=parseInt(t.substr(0,2),16)/255,e[1]=parseInt(t.substr(2,2),16)/255,e[2]=parseInt(t.substr(4,2),16)/255,e;case 7:return e[0]=parseInt(t.substr(1,2),16)/255,e[1]=parseInt(t.substr(3,2),16)/255,e[2]=parseInt(t.substr(5,2),16)/255,e;case 9:return e[0]=parseInt(t.substr(1,2),16)/255,e[1]=parseInt(t.substr(3,2),16)/255,e[2]=parseInt(t.substr(5,2),16)/255,e[3]=parseInt(t.substr(7,2),16)/255,e;default:return e}}function WC(t,e){let n,r;const[a,s,i]=t,o=1/3,c=1/6,u=2/3;let g=a,f=a;s>g?g=s:s<f&&(f=s),i>g?g=i:i<f&&(f=i);const l=g;l>0?r=(g-f)/g:r=0,r>0?(a===g?n=c*(s-i)/(g-f):s===g?n=o+c*(i-a)/(g-f):n=u+c*(a-s)/(g-f),n<0&&(n+=1)):n=0,e[0]=n,e[1]=r,e[2]=l}function Dp(t,e){const[n,r,a]=t,s=1/3,i=1/6,o=2/3,c=5/6;let u,g,f;n>i&&n<=s?(g=1,u=(s-n)/i,f=0):n>s&&n<=.5?(g=1,f=(n-s)/i,u=0):n>.5&&n<=o?(f=1,g=(o-n)/i,u=0):n>o&&n<=c?(f=1,u=(n-o)/i,g=0):n>c&&n<=1?(u=1,f=(1-n)/i,g=0):(u=1,g=n/i,f=0),u=r*u+(1-r),g=r*g+(1-r),f=r*f+(1-r),u*=a,g*=a,f*=a,e[0]=u,e[1]=g,e[2]=f}function Lp(t,e){const[n,r,a]=t;let s=(n+16)/116,i=r/500+s,o=s-a/200;s**3>.008856?s**=3:s=(s-16/116)/7.787,i**3>.008856?i**=3:i=(i-16/116)/7.787,o**3>.008856?o**=3:o=(o-16/116)/7.787;const c=.9505,u=1,g=1.089;e[0]=c*i,e[1]=u*s,e[2]=g*o}function mp(t,e){const[n,r,a]=t,s=.9505,i=1,o=1.089;let c=n/s,u=r/i,g=a/o;c>.008856?c**=1/3:c=7.787*c+16/116,u>.008856?u**=1/3:u=7.787*u+16/116,g>.008856?g**=1/3:g=7.787*g+16/116,e[0]=116*u-16,e[1]=500*(c-u),e[2]=200*(u-g)}function Vp(t,e){const[n,r,a]=t;let s=n*3.2406+r*-1.5372+a*-.4986,i=n*-.9689+r*1.8758+a*.0415,o=n*.0557+r*-.204+a*1.057;s>.0031308?s=1.055*s**(1/2.4)-.055:s*=12.92,i>.0031308?i=1.055*i**(1/2.4)-.055:i*=12.92,o>.0031308?o=1.055*o**(1/2.4)-.055:o*=12.92;let c=s;c<i&&(c=i),c<o&&(c=o),c>1&&(s/=c,i/=c,o/=c),s<0&&(s=0),i<0&&(i=0),o<0&&(o=0),e[0]=s,e[1]=i,e[2]=o}function Fp(t,e){let[n,r,a]=t;n>.04045?n=((n+.055)/1.055)**2.4:n/=12.92,r>.04045?r=((r+.055)/1.055)**2.4:r/=12.92,a>.04045?a=((a+.055)/1.055)**2.4:a/=12.92,e[0]=n*.4124+r*.3576+a*.1805,e[1]=n*.2126+r*.7152+a*.0722,e[2]=n*.0193+r*.1192+a*.9505}function zC(t,e){const n=[0,0,0];Fp(t,n),mp(n,e)}function HC(t,e){const n=[0,0,0];Lp(t,n),Vp(n,e)}function af(t){return t[0]=1,t[1]=-1,t[2]=1,t[3]=-1,t[4]=1,t[5]=-1,t}function bs(t){return!(t[1]-t[0]<0)}function AC(t,e,n){return n[0]=Math.min(t[0],e[0]),n[1]=Math.max(t[0],e[0]),n[2]=Math.min(t[1],e[1]),n[3]=Math.max(t[1],e[1]),n[4]=Math.min(t[2],e[2]),n[5]=Math.max(t[2],e[2]),n}function $s(t,e,n){return t<e?e:t>n?n:t}function Jo(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return r[0]=$s(t[0],e[0],n[0]),r[1]=$s(t[1],e[1],n[1]),r[2]=$s(t[2],e[2],n[2]),r}function jC(t,e){let n=0;return e[0]!==e[1]&&(t<e[0]?n=e[0]:t>e[1]?n=e[1]:n=t,n=(n-e[0])/(e[1]-e[0])),n}const KC=Xa("GetScalarTypeFittingRange"),PC=Xa("GetAdjustedScalarRange");function XC(t,e){if(!t||!e)return 0;for(let n=0;n<6;n+=2)if(t[n]<e[n]||t[n]>e[n+1]||t[n+1]<e[n]||t[n+1]>e[n+1])return 0;return 1}function IC(t,e,n){if(!t||!e)return 0;for(let r=0;r<6;r+=2)if(t[r]+n[r/2]<e[r]||t[r]-n[r/2]>e[r+1]||t[r+1]+n[r/2]<e[r]||t[r+1]-n[r/2]>e[r+1])return 0;return 1}function YC(t,e,n){if(!t||!e||!n)return 0;for(let r=0;r<3;r++)if(t[r]+n[r]<e[2*r]||t[r]-n[r]>e[2*r+1])return 0;return 1}function qC(t,e,n,r){const a=Me(3),s=Me(3),i=Me(3),o=Me(3),c=Me(3),u=Me(3);for(let y=0;y<3;++y)a[y]=t[y]-e[y],s[y]=e[y]-n[y],i[y]=n[y]-t[y],o[y]=-a[y],c[y]=-s[y],u[y]=-i[y];const g=Et(o),f=Et(c),l=Et(i),p=Me(3);gt(a,s,p);const v=Et(p),h=g*f*l/(2*v),d=2*v*v,T=f*f*ee(a,u)/d,S=l*l*ee(o,s)/d,x=g*g*ee(i,c)/d;for(let y=0;y<3;++y)r[y]=T*t[y]+S*e[y]+x*n[y];return h}const QC=1/0,ZC=-1/0,JC=t=>!Number.isFinite(t),{isFinite:ew,isNaN:ec}=Number,Bp=ec;function Ri(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}function tw(t){let e=-1,n=-1;for(let r=0;r<t.length;r++){const a=Math.abs(t[r]);a>e&&(n=r,e=a)}return n}function nw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;const n=new Array(e),r=new Array(e);for(let s=0;s<e;++s)n[s]=s,r[s]=s;for(let s=e-1;s>0;s--){let i=-1/0,o=0,c=0;for(let u=0;u<=s;++u){const g=n[u];for(let f=0;f<=s;++f){const l=r[f],p=Math.abs(t[g+e*l]);p>i&&(i=p,o=u,c=f)}}[n[s],n[o]]=[n[o],n[s]],[r[s],r[c]]=[r[c],r[s]]}const a=new Array(e*e).fill(0);for(let s=0;s<e;++s){const i=n[s]+e*r[s];a[i]=t[i]<0?-1:1}return a}function _p(t){const e=Math.floor(t*255);return e>15?e.toString(16):`0${e.toString(16)}`}function rw(t){return`${arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#"}${t.map(_p).join("")}`}function ss(t){return Math.round(t*255)}function aw(t){return t.length===3?`rgb(${t.map(ss).join(", ")})`:`rgba(${ss(t[0]||0)}, ${ss(t[1]||0)}, ${ss(t[2]||0)}, ${t[3]||0})`}var tc={Pi:Z2,ldexp:J2,radiansFromDegrees:Ve,degreesFromRadians:zr,round:ga,floor:eC,ceil:tC,ceilLog2:oC,min:nC,max:rC,arrayMin:aC,arrayMax:sC,arrayRange:iC,isPowerOfTwo:la,nearestPowerOfTwo:mt,factorial:cC,binomial:fC,beginCombination:uC,nextCombination:gC,randomSeed:lC,getSeed:pC,random:hC,gaussian:dC,add:Hr,subtract:ze,multiplyScalar:dp,multiplyScalar2D:vp,multiplyAccumulate:Io,multiplyAccumulate2D:vC,dot:ee,outer:yC,cross:gt,norm:Et,normalize:Rt,perpendiculars:xC,projectVector:SC,projectVector2D:CC,distance2BetweenPoints:Tt,angleBetweenVectors:wC,gaussianAmplitude:EC,gaussianWeight:RC,dot2D:Yo,outer2D:OC,norm2D:yp,normalize2D:Tp,determinant2x2:me,LUFactor3x3:MC,LUSolve3x3:DC,linearSolve3x3:LC,multiply3x3_vect3:mC,multiply3x3_mat3:qo,multiplyMatrix:VC,transpose3x3:Gr,invert3x3:FC,identity3x3:Sp,identity:Cp,isIdentity:BC,isIdentity3x3:_C,determinant3x3:Ei,quaternionToMatrix3x3:wp,areEquals:xp,areMatricesEqual:Ar,roundNumber:Gs,roundVector:Qo,matrix3x3ToQuaternion:Ep,multiplyQuaternion:UC,orthogonalize3x3:Rp,diagonalize3x3:Op,singularValueDecomposition3x3:NC,solveLinearSystem:Mp,invertMatrix:rf,luFactorLinearSystem:tf,luSolveLinearSystem:nf,estimateMatrixCondition:kC,jacobi:GC,jacobiN:Ia,solveHomogeneousLeastSquares:Zo,solveLeastSquares:bC,hex2float:$C,rgb2hsv:WC,hsv2rgb:Dp,lab2xyz:Lp,xyz2lab:mp,xyz2rgb:Vp,rgb2xyz:Fp,rgb2lab:zC,lab2rgb:HC,uninitializeBounds:af,areBoundsInitialized:bs,computeBoundsFromPoints:AC,clampValue:$s,clampVector:Jo,clampAndNormalizeValue:jC,getScalarTypeFittingRange:KC,getAdjustedScalarRange:PC,extentIsWithinOtherExtent:XC,boundsIsWithinOtherBounds:IC,pointIsWithinBounds:YC,solve3PointCircle:qC,inf:QC,negInf:ZC,isInf:JC,isNan:ec,isNaN:ec,isFinite:ew,createUninitializedBounds:Ri,getMajorAxisIndex:tw,getSparseOrthogonalMatrix:nw,floatToHex2:_p,floatRGB2HexCode:rw,float2CssRGBA:aw};function sw(t,e){e.classHierarchy.push("vtkImplicitFunction"),t.functionValue=n=>{if(!e.transform)return t.evaluateFunction(n);const r=[];return e.transform.transformPoint(n,r),t.evaluateFunction(r)},t.evaluateFunction=n=>{E.vtkErrorMacro("not implemented")}}const iw={};function Up(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iw,n),E.obj(t,e),E.setGet(t,e,["transform"]),sw(t,e)}const ow=E.newInstance(Up,"vtkImplicitFunction");var cw={newInstance:ow,extend:Up};const nc=1e-6,Np="coincide",kp="disjoint";function fw(t,e,n){return t[0]*(n[0]-e[0])+t[1]*(n[1]-e[1])+t[2]*(n[2]-e[2])}function Gp(t,e,n){const r=n[0]*(t[0]-e[0])+n[1]*(t[1]-e[1])+n[2]*(t[2]-e[2]);return Math.abs(r)}function bp(t,e,n,r){const a=[];ze(t,e,a);const s=ee(n,a);r[0]=t[0]-s*n[0],r[1]=t[1]-s*n[1],r[2]=t[2]-s*n[2]}function $p(t,e,n){const r=ee(t,e);let a=ee(e,e);return a===0&&(a=1),n[0]=t[0]-r*e[0]/a,n[1]=t[1]-r*e[1]/a,n[2]=t[2]-r*e[2]/a,n}function Wp(t,e,n,r){const a=[];ze(t,e,a);const s=ee(n,a),i=ee(n,n);i!==0?(r[0]=t[0]-s*n[0]/i,r[1]=t[1]-s*n[1]/i,r[2]=t[2]-s*n[2]/i):(r[0]=t[0],r[1]=t[1],r[2]=t[2])}function zp(t,e,n,r){const a={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},s=[],i=[];ze(e,t,s),ze(n,t,i);const o=ee(r,i),c=ee(r,s);let u,g;return c<0?u=-c:u=c,o<0?g=-o*nc:g=o*nc,u<=g||(a.t=o/c,a.x[0]=t[0]+a.t*s[0],a.x[1]=t[1]+a.t*s[1],a.x[2]=t[2]+a.t*s[2],a.intersection=!0,a.betweenPoints=a.t>=0&&a.t<=1),a}function Hp(t,e,n,r){const a={intersection:!1,l0:[],l1:[],error:null},s=[];gt(e,r,s);const i=s.map(f=>Math.abs(f));if(i[0]+i[1]+i[2]<nc){const f=[];return ze(t,n,f),ee(e,f)===0?a.error=Np:a.error=kp,a}let o;i[0]>i[1]&&i[0]>i[2]?o="x":i[1]>i[2]?o="y":o="z";const c=[],u=-ee(e,t),g=-ee(r,n);switch(o){case"x":c[0]=0,c[1]=(g*e[2]-u*r[2])/s[0],c[2]=(u*r[1]-g*e[1])/s[0];break;case"y":c[0]=(u*r[2]-g*e[2])/s[1],c[1]=0,c[2]=(g*e[0]-u*r[0])/s[1];break;case"z":c[0]=(g*e[1]-u*r[1])/s[2],c[1]=(u*r[0]-g*e[0])/s[2],c[2]=0;break}return a.l0=c,Hr(c,s,a.l1),a.intersection=!0,a}const uw={evaluate:fw,distanceToPlane:Gp,projectPoint:bp,projectVector:$p,generalizedProjectPoint:Wp,intersectWithLine:zp,intersectWithPlane:Hp,DISJOINT:kp,COINCIDE:Np};function gw(t,e){e.classHierarchy.push("vtkPlane"),t.distanceToPlane=n=>Gp(n,e.origin,e.normal),t.projectPoint=(n,r)=>{bp(n,e.origin,e.normal,r)},t.projectVector=(n,r)=>$p(n,e.normal,r),t.push=n=>{if(n!==0)for(let r=0;r<3;r++)e.origin[r]+=n*e.normal[r]},t.generalizedProjectPoint=(n,r)=>{Wp(n,e.origin,e.normal,r)},t.evaluateFunction=(n,r,a)=>Array.isArray(n)?e.normal[0]*(n[0]-e.origin[0])+e.normal[1]*(n[1]-e.origin[1])+e.normal[2]*(n[2]-e.origin[2]):e.normal[0]*(n-e.origin[0])+e.normal[1]*(r-e.origin[1])+e.normal[2]*(a-e.origin[2]),t.evaluateGradient=n=>[e.normal[0],e.normal[1],e.normal[2]],t.intersectWithLine=(n,r)=>zp(n,r,e.origin,e.normal),t.intersectWithPlane=(n,r)=>Hp(n,r,e.origin,e.normal)}const lw={normal:[0,0,1],origin:[0,0,0]};function Ap(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lw,n),cw.extend(t,e,n),E.setGetArray(t,e,["normal","origin"],3),gw(t,e)}const pw=E.newInstance(Ap,"vtkPlane");var jn={newInstance:pw,extend:Ap,...uw};const Oi=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function jp(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function Tn(t){return t?.length>=6&&t[0]<=t[1]&&t[2]<=t[3]&&t[4]<=t[5]}function sf(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function of(t){return sf(t,Oi)}function ri(t,e,n,r){const[a,s,i,o,c,u]=t;return t[0]=a<e?a:e,t[1]=s>e?s:e,t[2]=i<n?i:n,t[3]=o>n?o:n,t[4]=c<r?c:r,t[5]=u>r?u:r,t}function cf(t,e){if(e.length===0)return t;if(Array.isArray(e[0]))for(let n=0;n<e.length;++n)ri(t,...e[n]);else for(let n=0;n<e.length;n+=3)ri(t,...e.slice(n,n+3));return t}function Kp(t,e,n,r,a,s,i){const[o,c,u,g,f,l]=t;return i===void 0?(t[0]=Math.min(e[0],o),t[1]=Math.max(e[1],c),t[2]=Math.min(e[2],u),t[3]=Math.max(e[3],g),t[4]=Math.min(e[4],f),t[5]=Math.max(e[5],l)):(t[0]=Math.min(e,o),t[1]=Math.max(n,c),t[2]=Math.min(r,u),t[3]=Math.max(a,g),t[4]=Math.min(s,f),t[5]=Math.max(i,l)),t}function Pp(t,e,n,r){const[a,s,i,o,c,u]=t;return t[0]=e,t[1]=e>s?e:s,t[2]=n,t[3]=n>o?n:o,t[4]=r,t[5]=r>u?r:u,a!==e||i!==n||c!==r}function Xp(t,e,n,r){const[a,s,i,o,c,u]=t;return t[0]=e<a?e:a,t[1]=e,t[2]=n<i?n:i,t[3]=n,t[4]=r<c?r:c,t[5]=r,s!==e||o!==n||u!==r}function ff(t,e){return e==null?hw(t):(t[0]-=e,t[1]+=e,t[2]-=e,t[3]+=e,t[4]-=e,t[5]+=e,t)}function hw(t){const e=[0,0,0];let n=-1,r=0,a=0;for(let s=0;s<3;++s)a=t[s*2+1]-t[s*2],a>r&&(r=a,n=s),e[s]=a>0?1:0;if(n<0)return ff(t,.5);for(let s=0;s<3;++s)if(!e[s]){const i=.005*r;t[s*2]-=i,t[s*2+1]+=i}return t}function uf(t,e,n,r){return Tn(t)?(e>=0?(t[0]*=e,t[1]*=e):(t[0]=e*t[1],t[1]=e*t[0]),n>=0?(t[2]*=n,t[3]*=n):(t[2]=n*t[3],t[3]=n*t[2]),r>=0?(t[4]*=r,t[5]*=r):(t[4]=r*t[5],t[5]=r*t[4]),!0):!1}function gf(t){return[.5*(t[0]+t[1]),.5*(t[2]+t[3]),.5*(t[4]+t[5])]}function dw(t,e,n,r){if(!Tn(t))return!1;const a=gf(t);return t[0]-=a[0],t[1]-=a[0],t[2]-=a[1],t[3]-=a[1],t[4]-=a[2],t[5]-=a[2],uf(t,e,n,r),t[0]+=a[0],t[1]+=a[0],t[2]+=a[1],t[3]+=a[1],t[4]+=a[2],t[5]+=a[2],!0}function Da(t,e){return t[e*2+1]-t[e*2]}function Ya(t){return[Da(t,0),Da(t,1),Da(t,2)]}function Ip(t){return t.slice(0,2)}function Yp(t){return t.slice(2,4)}function qp(t){return t.slice(4,6)}function Qp(t){const e=Ya(t);return e[0]>e[1]?e[0]>e[2]?e[0]:e[2]:e[1]>e[2]?e[1]:e[2]}function lf(t){if(Tn(t)){const e=Ya(t);return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]}return null}function Zp(t){const e=lf(t);return e!==null?Math.sqrt(e):null}function Mi(t){return[t[0],t[2],t[4]]}function Di(t){return[t[1],t[3],t[5]]}function is(t,e){return t<=0&&e>=0||t>=0&&e<=0}function pf(t,e){return e[0]=[t[0],t[2],t[4]],e[1]=[t[0],t[2],t[5]],e[2]=[t[0],t[3],t[4]],e[3]=[t[0],t[3],t[5]],e[4]=[t[1],t[2],t[4]],e[5]=[t[1],t[2],t[5]],e[6]=[t[1],t[3],t[4]],e[7]=[t[1],t[3],t[5]],e}function Jp(t,e,n){return e[0]=t[0],e[1]=t[2],e[2]=t[4],n[0]=t[1],n[1]=t[3],n[2]=t[5],e}function eh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const r=pf(t,[]);for(let a=0;a<r.length;++a)Te(r[a],r[a],e);return of(n),cf(n,r)}function th(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=.5*(t[1]-t[0]),e[1]=.5*(t[3]-t[2]),e[2]=.5*(t[5]-t[4]),e}function nh(t,e,n,r){const a=[].concat(Oi),s=t.getData();for(let i=0;i<s.length;i+=3){const o=[s[i],s[i+1],s[i+2]],c=ee(o,e);a[0]=Math.min(c,a[0]),a[1]=Math.max(c,a[1]);const u=ee(o,n);a[2]=Math.min(u,a[2]),a[3]=Math.max(u,a[3]);const g=ee(o,r);a[4]=Math.min(g,a[4]),a[5]=Math.max(g,a[5])}return a}function rh(t,e,n,r,a){let s=!0;const i=[];let o=0;const c=[],u=[0,0,0],g=0,f=1,l=2;for(let p=0;p<3;p++)e[p]<t[2*p]?(i[p]=f,u[p]=t[2*p],s=!1):e[p]>t[2*p+1]?(i[p]=g,u[p]=t[2*p+1],s=!1):i[p]=l;if(s)return r[0]=e[0],r[1]=e[1],r[2]=e[2],a[0]=0,1;for(let p=0;p<3;p++)i[p]!==l&&n[p]!==0?c[p]=(u[p]-e[p])/n[p]:c[p]=-1;for(let p=0;p<3;p++)c[o]<c[p]&&(o=p);if(c[o]>1||c[o]<0)return 0;a[0]=c[o];for(let p=0;p<3;p++)if(o!==p){if(r[p]=e[p]+c[o]*n[p],r[p]<t[2*p]||r[p]>t[2*p+1])return 0}else r[p]=u[p];return 1}function ah(t,e,n){const r=[];let a=0,s=1,i=1;for(let o=4;o<=5;++o){r[2]=t[o];for(let c=2;c<=3;++c){r[1]=t[c];for(let u=0;u<=1;++u)if(r[0]=t[u],a=jn.evaluate(n,e,r),i&&(s=a>=0?1:-1,i=0),a===0||s>0&&a<0||s<0&&a>0)return 1}}return 0}function sh(t,e){if(!(Tn(t)&&Tn(e)))return!1;const n=[0,0,0,0,0,0];let r;for(let a=0;a<3;a++)if(r=!1,e[a*2]>=t[a*2]&&e[a*2]<=t[a*2+1]?(r=!0,n[a*2]=e[a*2]):t[a*2]>=e[a*2]&&t[a*2]<=e[a*2+1]&&(r=!0,n[a*2]=t[a*2]),e[a*2+1]>=t[a*2]&&e[a*2+1]<=t[a*2+1]?(r=!0,n[a*2+1]=e[2*a+1]):t[a*2+1]>=e[a*2]&&t[a*2+1]<=e[a*2+1]&&(r=!0,n[a*2+1]=t[a*2+1]),!r)return!1;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],!0}function ai(t,e){if(!(Tn(t)&&Tn(e)))return!1;for(let n=0;n<3;n++)if(!(e[n*2]>=t[n*2]&&e[n*2]<=t[n*2+1])&&!(t[n*2]>=e[n*2]&&t[n*2]<=e[n*2+1])&&!(e[n*2+1]>=t[n*2]&&e[n*2+1]<=t[n*2+1])&&!(t[n*2+1]>=e[n*2]&&t[n*2+1]<=e[n*2+1]))return!1;return!0}function si(t,e,n,r){return!(e<t[0]||e>t[1]||n<t[2]||n>t[3]||r<t[4]||r>t[5])}function vw(t,e){return!(!ai(t,e)||!si(t,...Mi(e))||!si(t,...Di(e)))}function ih(t,e,n){const r=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],a=[0,0,0,0,0,0,0,0];let s=0;for(let f=0;f<2;f++)for(let l=2;l<4;l++)for(let p=4;p<6;p++){const v=[t[f],t[l],t[p]];a[s++]=jn.evaluate(n,e,v)}let i=2;for(;i--&&!(is(a[r[i][0]],a[r[i][4]])&&is(a[r[i][1]],a[r[i][5]])&&is(a[r[i][2]],a[r[i][6]])&&is(a[r[i][3]],a[r[i][7]])););if(i<0)return!1;const o=Math.sign(n[i]),c=Math.abs((t[i*2+1]-t[i*2])*n[i]);let u=o>0?1:0;for(let f=0;f<4;f++){if(c===0)continue;const l=Math.abs(a[r[i][f]])/c;o>0&&l<u&&(u=l),o<0&&l>u&&(u=l)}const g=(1-u)*t[i*2]+u*t[i*2+1];return o>0?t[i*2]=g:t[i*2+1]=g,!0}function oh(t,e){for(let r=0;r<3;++r)e[r]=e[r]<1?1:e[r];let n=e[0]*e[1]*e[2];for(;n>t;){for(let r=0;r<3;++r)e[r]=e[r]>1?e[r]-1:1;n=e[0]*e[1]*e[2]}}function ch(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];e=e<=0?1:e;let a=0;const s=[0,0,0];let i=-1,o=0;const c=Ya(t),u=c[0]+c[1]+c[2],g=u*(.001/3);for(let h=0;h<3;++h)c[h]>o&&(i=h,o=c[h]),c[h]>g?(s[h]=1,a++):s[h]=0;const f=Mi(t),l=Di(t);if(a<1)return n[0]=1,n[1]=1,n[2]=1,r[0]=f[0]-.5,r[1]=l[0]+.5,r[2]=f[1]-.5,r[3]=l[1]+.5,r[4]=f[2]-.5,r[5]=l[2]+.5,1;let p=e;p/=s[0]?c[0]/u:1,p/=s[1]?c[1]/u:1,p/=s[2]?c[2]/u:1,p**=1/a;for(let h=0;h<3;++h)n[h]=s[h]?Math.floor(p*c[h]/u):1,n[h]=n[h]<1?1:n[h];oh(e,n);const v=.5*c[i]/n[i];for(let h=0;h<3;++h)s[h]?(r[2*h]=f[h],r[2*h+1]=l[h]):(r[2*h]=f[h]-v,r[2*h+1]=l[h]+v);return n[0]*n[1]*n[2]}function fh(t,e){if(t[0]>=e[0]&&t[0]<=e[1]&&t[1]>=e[2]&&t[1]<=e[3]&&t[2]>=e[4]&&t[2]<=e[5])return 0;const n=[0,0,0];return t[0]<e[0]?n[0]=e[0]-t[0]:t[0]>e[1]&&(n[0]=t[0]-e[1]),t[1]<e[2]?n[1]=e[2]-t[1]:t[1]>e[3]&&(n[1]=t[1]-e[3]),t[2]<e[4]?n[2]=e[4]-t[2]:t[2]>e[5]&&(n[2]=t[2]-e[5]),ee(n,n)}class yw{constructor(e){this.bounds=e,this.bounds||(this.bounds=new Float64Array(Oi))}getBounds(){return this.bounds}equals(e){return jp(this.bounds,e)}isValid(){return Tn(this.bounds)}setBounds(e){return sf(this.bounds,e)}reset(){return of(this.bounds)}addPoint(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return ri(this.bounds,...n)}addPoints(e){return cf(this.bounds,e)}addBounds(e,n,r,a,s,i){return Kp(this.bounds,e,n,r,a,s,i)}setMinPoint(e,n,r){return Pp(this.bounds,e,n,r)}setMaxPoint(e,n,r){return Xp(this.bounds,e,n,r)}inflate(e){return ff(this.bounds,e)}scale(e,n,r){return uf(this.bounds,e,n,r)}getCenter(){return gf(this.bounds)}getLength(e){return Da(this.bounds,e)}getLengths(){return Ya(this.bounds)}getMaxLength(){return Qp(this.bounds)}getDiagonalLength(){return Zp(this.bounds)}getDiagonalLength2(){return lf(this.bounds)}getMinPoint(){return Mi(this.bounds)}getMaxPoint(){return Di(this.bounds)}getXRange(){return Ip(this.bounds)}getYRange(){return Yp(this.bounds)}getZRange(){return qp(this.bounds)}getCorners(e){return pf(this.bounds,e)}computeCornerPoints(e,n){return Jp(this.bounds,e,n)}computeLocalBounds(e,n,r){return nh(this.bounds,e,n,r)}transformBounds(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return eh(this.bounds,e,n)}computeScale3(e){return th(this.bounds,e)}cutWithPlane(e,n){return ih(this.bounds,e,n)}intersectBox(e,n,r,a){return rh(this.bounds,e,n,r,a)}intersectPlane(e,n){return ah(this.bounds,e,n)}intersect(e){return sh(this.bounds,e)}intersects(e){return ai(this.bounds,e)}containsPoint(e,n,r){return si(this.bounds,e,n,r)}contains(e){return ai(this.bounds,e)}computeDivisions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return ch(this.bounds,e,n,r)}distance2ToBounds(e){return fh(e,this.bounds)}}function Tw(t){const e=t&&t.bounds;return new yw(e)}const xw={equals:jp,isValid:Tn,setBounds:sf,reset:of,addPoint:ri,addPoints:cf,addBounds:Kp,setMinPoint:Pp,setMaxPoint:Xp,inflate:ff,scale:uf,scaleAboutCenter:dw,getCenter:gf,getLength:Da,getLengths:Ya,getMaxLength:Qp,getDiagonalLength:Zp,getDiagonalLength2:lf,getMinPoint:Mi,getMaxPoint:Di,getXRange:Ip,getYRange:Yp,getZRange:qp,getCorners:pf,computeCornerPoints:Jp,computeLocalBounds:nh,transformBounds:eh,computeScale3:th,cutWithPlane:ih,intersectBox:rh,intersectPlane:ah,intersect:sh,intersects:ai,containsPoint:si,contains:vw,computeDivisions:ch,clampDivisions:oh,distance2ToBounds:fh,INIT_BOUNDS:Oi};var pe={newInstance:Tw,...xw};const Sw={DISPLAY:0,WORLD:1};var uh={CoordinateSystem:Sw};const{CoordinateSystem:rc}=uh;function rg(t){return()=>E.vtkErrorMacro(`vtkProp::${t} - NOT IMPLEMENTED`)}function Cw(t,e){e.classHierarchy.push("vtkProp"),t.getMTime=()=>{let n=e.mtime;for(let r=0;r<e.textures.length;++r){const a=e.textures[r].getMTime();a>n&&(n=a)}return n},t.processSelectorPixelBuffers=(n,r)=>{},t.getNestedProps=()=>null,t.getActors=()=>[],t.getActors2D=()=>[],t.getVolumes=()=>[],t.pick=rg("pick"),t.hasKey=rg("hasKey"),t.getNestedVisibility=()=>e.visibility&&(!e._parentProp||e._parentProp.getNestedVisibility()),t.getNestedPickable=()=>e.pickable&&(!e._parentProp||e._parentProp.getNestedPickable()),t.getNestedDragable=()=>e.dragable&&(!e._parentProp||e._parentProp.getNestedDragable()),t.getRedrawMTime=()=>e.mtime,t.setEstimatedRenderTime=n=>{e.estimatedRenderTime=n,e.savedEstimatedRenderTime=n},t.restoreEstimatedRenderTime=()=>{e.estimatedRenderTime=e.savedEstimatedRenderTime},t.addEstimatedRenderTime=n=>{e.estimatedRenderTime+=n},t.setAllocatedRenderTime=n=>{e.allocatedRenderTime=n,e.savedEstimatedRenderTime=e.estimatedRenderTime,e.estimatedRenderTime=0},t.getSupportsSelection=()=>!1,t.getTextures=()=>e.textures,t.hasTexture=n=>e.textures.indexOf(n)!==-1,t.addTexture=n=>{n&&!t.hasTexture(n)&&(e.textures=e.textures.concat(n),t.modified())},t.removeTexture=n=>{const r=e.textures.filter(a=>a!==n);e.textures.length!==r.length&&(e.textures=r,t.modified())},t.removeAllTextures=()=>{e.textures=[],t.modified()},t.setCoordinateSystemToWorld=()=>t.setCoordinateSystem(rc.WORLD),t.setCoordinateSystemToDisplay=()=>t.setCoordinateSystem(rc.DISPLAY)}const ww={allocatedRenderTime:10,coordinateSystem:rc.WORLD,dragable:!0,estimatedRenderTime:0,paths:null,pickable:!0,renderTimeMultiplier:1,savedEstimatedRenderTime:0,textures:[],useBounds:!0,visibility:!0};function gh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ww,n),E.obj(t,e),E.get(t,e,["estimatedRenderTime","allocatedRenderTime"]),E.setGet(t,e,["_parentProp","coordinateSystem","dragable","pickable","renderTimeMultiplier","useBounds","visibility"]),E.moveToProtected(t,e,["parentProp"]),Cw(t,e)}const Ew=E.newInstance(gh,"vtkProp");var qa={newInstance:Ew,extend:gh,...uh};const Rw=1e-6;function Ow(t,e){e.classHierarchy.push("vtkProp3D"),t.addPosition=r=>{e.position=e.position.map((a,s)=>a+r[s]),t.modified()},t.getOrientationWXYZ=()=>{const r=hr();bo(r,e.rotation);const a=new Float64Array(3),s=Lx(a,r);return[zr(s),a[0],a[1],a[2]]},t.getOrientationQuaternion=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return bo(r,e.rotation)},t.rotateX=r=>{r!==0&&(kc(e.rotation,e.rotation,Ve(r)),t.modified())},t.rotateY=r=>{r!==0&&(Gc(e.rotation,e.rotation,Ve(r)),t.modified())},t.rotateZ=r=>{r!==0&&(bc(e.rotation,e.rotation,Ve(r)),t.modified())},t.rotateWXYZ=(r,a,s,i)=>{if(r===0||a===0&&s===0&&i===0)return;const o=Ve(r),c=hr();Wc(c,[a,s,i],o);const u=new Float64Array(16);Oa(u,c),Ne(e.rotation,e.rotation,u),t.modified()},t.rotateQuaternion=r=>{if(Math.abs(r[3])>=1-Rw)return;const a=Oa(new Float64Array(16),r);Ne(e.rotation,e.rotation,a),t.modified()},t.setOrientation=(r,a,s)=>r===e.orientation[0]&&a===e.orientation[1]&&s===e.orientation[2]?!1:(e.orientation=[r,a,s],ue(e.rotation),t.rotateZ(s),t.rotateX(r),t.rotateY(a),t.modified(),!0),t.setOrientationFromQuaternion=r=>{const a=xi();return Oa(a,r),Ar(a,e.rotation)?!1:(e.rotation=a,t.modified(),!0)},t.setUserMatrix=r=>Ar(e.userMatrix,r)?!1:(Qe(e.userMatrix,r),t.modified(),!0),t.getMatrix=()=>(t.computeMatrix(),e.matrix),t.computeMatrix=()=>{if(t.getMTime()>e.matrixMTime.getMTime()){ue(e.matrix),e.userMatrix&&Ne(e.matrix,e.matrix,e.userMatrix),Ue(e.matrix,e.matrix,e.origin),Ue(e.matrix,e.matrix,e.position),Ne(e.matrix,e.matrix,e.rotation),pr(e.matrix,e.matrix,e.scale),Ue(e.matrix,e.matrix,[-e.origin[0],-e.origin[1],-e.origin[2]]),De(e.matrix,e.matrix),e.isIdentity=!0;for(let r=0;r<4;++r)for(let a=0;a<4;++a)(r===a?1:0)!==e.matrix[r+a*4]&&(e.isIdentity=!1);e.matrixMTime.modified()}},t.getBoundsByReference=()=>{if(e.mapper===null)return e.bounds;const r=e.mapper.getBounds();if(!r||r.length!==6)return r;if(r[0]>r[1])return e.mapperBounds=r,e.bounds=[...pe.INIT_BOUNDS],e.boundsMTime.modified(),r;if(!e.mapperBounds||!r.every((a,s)=>r[s]===e.mapperBounds[s])||t.getMTime()>e.boundsMTime.getMTime()){E.vtkDebugMacro("Recomputing bounds..."),e.mapperBounds=r,t.computeMatrix();const a=new Float64Array(16);De(a,e.matrix),pe.transformBounds(r,a,e.bounds),e.boundsMTime.modified()}return e.bounds},t.getBounds=()=>{const r=t.getBoundsByReference();try{return[...r]}catch{return r}},t.getCenter=()=>pe.getCenter(e.bounds),t.getLength=()=>pe.getLength(e.bounds),t.getXRange=()=>pe.getXRange(e.bounds),t.getYRange=()=>pe.getYRange(e.bounds),t.getZRange=()=>pe.getZRange(e.bounds),t.getUserMatrix=()=>e.userMatrix;function n(){t.computeMatrix()}t.onModified(n),t.getProperty=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.properties[r]==null&&(e.properties[r]=t.makeProperty?.()),e.properties[r]},t.getProperties=()=>(e.properties.length===0&&(e.properties[0]=t.makeProperty?.()),e.properties),t.setProperty=(r,a)=>{const s=Number.isInteger(r),[i,o]=s?[r,a]:[0,r];return e.properties[i]===o?!1:(e.properties[i]=o,!0)},t.getMTime=()=>{let r=e.mtime;return e.properties.forEach(a=>{if(a!==null){const s=a.getMTime();r=s>r?s:r}}),r}}const Mw={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[...pe.INIT_BOUNDS],properties:[],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function lh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Mw,n),qa.extend(t,e,n),e.matrixMTime={},E.obj(e.matrixMTime),E.get(t,e,["isIdentity"]),E.getArray(t,e,["orientation"]),E.setGetArray(t,e,["origin","position","scale"],3),E.setGet(t,e,["properties"]),e.matrix=ue(new Float64Array(16)),e.rotation=ue(new Float64Array(16)),e.userMatrix=ue(new Float64Array(16)),e.transform=null,Ow(t,e)}const Dw=E.newInstance(lh,"vtkProp3D");var Lw={newInstance:Dw,extend:lh};const ph={FLAT:0,GOURAUD:1,PHONG:2},Vt={POINTS:0,WIREFRAME:1,SURFACE:2},mw=ph;var hh={Shading:ph,Representation:Vt,Interpolation:mw};const{Representation:pa,Interpolation:ha}=hh;function ag(t){return()=>E.vtkErrorMacro(`vtkProperty::${t} - NOT IMPLEMENTED`)}function Vw(t,e){e.classHierarchy.push("vtkProperty"),t.setColor=(n,r,a)=>{Array.isArray(n)?(e.color[0]!==n[0]||e.color[1]!==n[1]||e.color[2]!==n[2])&&(e.color[0]=n[0],e.color[1]=n[1],e.color[2]=n[2],t.modified()):(e.color[0]!==n||e.color[1]!==r||e.color[2]!==a)&&(e.color[0]=n,e.color[1]=r,e.color[2]=a,t.modified()),t.setDiffuseColor(e.color),t.setAmbientColor(e.color),t.setSpecularColor(e.color)},t.computeCompositeColor=ag("ComputeCompositeColor"),t.getColor=()=>{let n=0;e.ambient+e.diffuse+e.specular>0&&(n=1/(e.ambient+e.diffuse+e.specular));for(let r=0;r<3;r++)e.color[r]=n*(e.ambient*e.ambientColor[r]+e.diffuse*e.diffuseColor[r]+e.specular*e.specularColor[r]);return[].concat(e.color)},t.setSpecularPower=n=>{const r=1/Math.max(1,n);(e.roughness!==r||e.specularPower!==n)&&(e.specularPower=n,e.roughness=r,t.modified())},t.addShaderVariable=ag("AddShaderVariable"),t.setInterpolationToFlat=()=>t.setInterpolation(ha.FLAT),t.setInterpolationToGouraud=()=>t.setInterpolation(ha.GOURAUD),t.setInterpolationToPhong=()=>t.setInterpolation(ha.PHONG),t.getInterpolationAsString=()=>E.enumToString(ha,e.interpolation),t.setRepresentationToWireframe=()=>t.setRepresentation(pa.WIREFRAME),t.setRepresentationToSurface=()=>t.setRepresentation(pa.SURFACE),t.setRepresentationToPoints=()=>t.setRepresentation(pa.POINTS),t.getRepresentationAsString=()=>E.enumToString(pa,e.representation)}const Fw={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,metallic:0,roughness:.6,normalStrength:1,emission:1,baseIOR:1.45,specular:0,specularPower:1,opacity:1,interpolation:ha.GOURAUD,representation:pa.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null,ORMTexture:null,RMTexture:null};function Bw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Fw,n),E.obj(t,e),E.setGet(t,e,["lighting","interpolation","ambient","diffuse","metallic","roughness","normalStrength","emission","baseIOR","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation","diffuseTexture","metallicTexture","roughnessTexture","normalTexture","ambientOcclusionTexture","emissionTexture","ORMTexture","RMTexture"]),E.setGetArray(t,e,["ambientColor","specularColor","diffuseColor","edgeColor"],3),Vw(t,e)}const _w=E.newInstance(Bw,"vtkProperty");var qr={newInstance:_w,...hh};function Uw(t,e){e.classHierarchy.push("vtkActor");const n={...t};t.getActors=()=>[t],t.getIsOpaque=()=>{if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.properties[0]||t.getProperty();let r=e.properties[0].getOpacity()>=1;return r=r&&(!e.texture||!e.texture.isTranslucent()),r=r&&(!e.mapper||e.mapper.getIsOpaque()),r},t.hasTranslucentPolygonalGeometry=()=>e.mapper===null?!1:(e.properties[0]||t.getProperty(),!t.getIsOpaque()),t.makeProperty=qr.newInstance,t.getMTime=()=>{let r=n.getMTime();if(e.backfaceProperty!==null){const a=e.backfaceProperty.getMTime();r=a>r?a:r}return r},t.getRedrawMTime=()=>{let r=e.mtime;if(e.mapper!==null){let a=e.mapper.getMTime();r=a>r?a:r,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),a=e.mapper.getInput().getMTime(),r=a>r?a:r)}return r},t.getSupportsSelection=()=>e.mapper?e.mapper.getSupportsSelection():!1,t.processSelectorPixelBuffers=(r,a)=>{e.mapper&&e.mapper.processSelectorPixelBuffers&&e.mapper.processSelectorPixelBuffers(r,a)}}const Nw={mapper:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1};function dh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Nw,n),Lw.extend(t,e,n),e.boundsMTime={},E.obj(e.boundsMTime),E.setGet(t,e,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),Uw(t,e)}const kw=E.newInstance(dh,"vtkActor");var vr={newInstance:kw,extend:dh};const vh={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Pe={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",UNSIGNED_CHAR_CLAMPED:"Uint8ClampedArray",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},Gw=Pe.FLOAT;var yh={DefaultDataType:Gw,DataTypeByteSize:vh,VtkDataTypes:Pe};const{vtkErrorMacro:bw}=nn,{DefaultDataType:$w}=yh,Ww=1e-6;function ac(t,e,n){const r=t.length;let a=Number.MAX_VALUE,s=-Number.MAX_VALUE,i,o;for(o=e;o<r;o+=n)if(!Number.isNaN(t[o])){a=t[o],s=a;break}for(;o<r;o+=n)i=t[o],i<a?a=i:i>s&&(s=i);return{min:a,max:s}}function zw(){let t=Number.MAX_VALUE,e=-Number.MAX_VALUE,n=0,r=0;return{add(a){t>a&&(t=a),e<a&&(e=a),n++,r+=a},get(){return{min:t,max:e,count:n,sum:r,mean:r/n}},getRange(){return{min:t,max:e}}}}function Th(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(e<0&&n>1){const a=t.length/n,s=new Float64Array(a);for(let i=0,o=0;i<a;++i){for(let c=o+n;o<c;++o)s[i]+=t[o]*t[o];s[i]**=.5}return ac(s,0,1)}return ac(t,e<0?0:e,n)}function sg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=t||[];for(;n.length<=e;)n.push(null);return n}function hf(t){return Object.prototype.toString.call(t).slice(8,-1)}function Hw(t){const e=t.getNumberOfComponents();let n=0;const r=new Array(e);for(let a=0;a<t.getNumberOfTuples();++a){t.getTuple(a,r);const s=Et(r,e);s>n&&(n=s)}return n}const Aw={computeRange:Th,createRangeHelper:zw,fastComputeRange:ac,getDataType:hf,getMaxNorm:Hw};function jw(t,e){e.classHierarchy.push("vtkDataArray");function n(r){if(r<0)return!1;const a=t.getNumberOfComponents(),s=e.values.length/(a>0?a:1);if(r===s)return!0;if(r>s){const i=e.values;return e.values=Ir(e.dataType,(r+s)*a),e.values.set(i),!0}return e.size>r*a&&(e.size=r*a,t.dataChange()),!0}t.dataChange=()=>{e.ranges=null,t.modified()},t.allocate=r=>{n(t.getNumberOfTuples()+r)},t.resize=r=>{n(r);const a=r*t.getNumberOfComponents();return e.size!==a?(e.size=a,t.dataChange(),!0):!1},t.initialize=()=>(t.resize(0),t),t.getElementComponentSize=()=>e.values.BYTES_PER_ELEMENT,t.getComponent=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[r*e.numberOfComponents+a]},t.setComponent=(r,a,s)=>{s!==e.values[r*e.numberOfComponents+a]&&(e.values[r*e.numberOfComponents+a]=s,t.dataChange())},t.getValue=r=>{const a=r/e.numberOfComponents,s=r%e.numberOfComponents;return t.getComponent(a,s)},t.setValue=(r,a)=>{const s=r/e.numberOfComponents,i=r%e.numberOfComponents;t.setComponent(s,i,a)},t.getData=()=>e.size===e.values.length?e.values:e.values.subarray(0,e.size),t.getRange=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,a=r;a<0&&(a=e.numberOfComponents===1?0:e.numberOfComponents);let s=null;return e.ranges||(e.ranges=sg(e.ranges,e.numberOfComponents)),s=e.ranges[a],s?(e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple):(s=Th(t.getData(),r,e.numberOfComponents),e.ranges[a]=s,e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple)},t.setRange=(r,a)=>{e.ranges||(e.ranges=sg(e.ranges,e.numberOfComponents));const s={min:r.min,max:r.max};return e.ranges[a]=s,e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple},t.getRanges=function(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0))return structuredClone(e.ranges);const a=[];for(let s=0;s<e.numberOfComponents;s++){const[i,o]=t.getRange(s),c={min:i,max:o};a.push(c)}if(e.numberOfComponents>1){const[s,i]=t.getRange(-1),o={min:s,max:i};a.push(o)}return a},t.setTuple=(r,a)=>{const s=r*e.numberOfComponents;for(let i=0;i<e.numberOfComponents;i++)e.values[s+i]=a[i]},t.setTuples=(r,a)=>{let s=r*e.numberOfComponents;const i=Math.min(a.length,e.size-s);for(let o=0;o<i;)e.values[s++]=a[o++]},t.insertTuple=(r,a)=>(e.size<=r*e.numberOfComponents&&(e.size=(r+1)*e.numberOfComponents,n(r+1)),t.setTuple(r,a),r),t.insertTuples=(r,a)=>{const s=r+a.length/e.numberOfComponents;return e.size<s*e.numberOfComponents&&(e.size=s*e.numberOfComponents,n(s)),t.setTuples(r,a),s},t.insertNextTuple=r=>{const a=e.size/e.numberOfComponents;return t.insertTuple(a,r)},t.insertNextTuples=r=>{const a=e.size/e.numberOfComponents;return t.insertTuples(a,r)},t.findTuple=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ww;for(let s=0;s<e.size;s+=e.numberOfComponents)if(Math.abs(r[0]-e.values[s])<=a){let i=!0;for(let o=1;o<e.numberOfComponents;++o)if(Math.abs(r[o]-e.values[s+o])>a){i=!1;break}if(i)return s/e.numberOfComponents}return-1},t.getTuple=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const s=e.numberOfComponents||1,i=r*s;switch(s){case 4:a[3]=e.values[i+3];case 3:a[2]=e.values[i+2];case 2:a[1]=e.values[i+1];case 1:a[0]=e.values[i];break;default:for(let o=s-1;o>=0;--o)a[o]=e.values[i+o]}return a},t.getTuples=(r,a)=>{const s=(r??0)*e.numberOfComponents,i=(a??t.getNumberOfTuples())*e.numberOfComponents,o=t.getData().subarray(s,i);return o.length>0?o:null},t.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*e.numberOfComponents},t.getNumberOfComponents=()=>e.numberOfComponents,t.getNumberOfValues=()=>e.size,t.getNumberOfTuples=()=>e.size/e.numberOfComponents,t.getDataType=()=>e.dataType,t.newClone=()=>Sh({empty:!0,name:e.name,dataType:e.dataType,numberOfComponents:e.numberOfComponents}),t.getName=()=>(e.name||(t.modified(),e.name=`vtkDataArray${t.getMTime()}`),e.name),t.setData=(r,a)=>{e.values=r,e.size=r.length,e.dataType=hf(r),a&&(e.numberOfComponents=a),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),t.dataChange()},t.getState=()=>{if(e.deleted)return null;const r={...e,vtkClass:t.getClassName()};r.values=Array.from(r.values),delete r.buffer,Object.keys(r).forEach(s=>{r[s]||delete r[s]});const a={};return Object.keys(r).sort().forEach(s=>{a[s]=r[s]}),a.mtime&&delete a.mtime,a},t.deepCopy=r=>{const a=t.getDataType(),s=e.values;t.shallowCopy(r),e.ranges=structuredClone(r.getRanges()),s?.length>=r.getNumberOfValues()&&a===r.getDataType()?(s.set(r.getData()),e.values=s,t.dataChange()):t.setData(r.getData().slice())},t.interpolateTuple=(r,a,s,i,o,c)=>{const u=e.numberOfComponents||1;(u!==a.getNumberOfComponents()||u!==i.getNumberOfComponents())&&bw("numberOfComponents must match");const g=a.getTuple(s),f=i.getTuple(o),l=[];switch(l.length=u,u){case 4:l[3]=g[3]+(f[3]-g[3])*c;case 3:l[2]=g[2]+(f[2]-g[2])*c;case 2:l[1]=g[1]+(f[1]-g[1])*c;case 1:l[0]=g[0]+(f[0]-g[0])*c;break;default:for(let p=0;p<u;p++)l[p]=g[p]+(f[p]-g[p])*c}return t.insertTuple(r,l)}}const Kw={name:"",numberOfComponents:1,dataType:$w,rangeTuple:[0,0]};function xh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,Kw,n),Array.isArray(n.values)&&n.dataType===void 0&&console.warn("vtkDataArray.newInstance: no dataType provided, converting to Float32Array"),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(e.values?Array.isArray(e.values)&&(e.values=zc(e.dataType,e.values)):e.values=Ir(e.dataType,e.size),e.values&&(e.size=e.size??e.values.length,e.dataType=hf(e.values)),qe(t,e),ja(t,e,["name","numberOfComponents"]),e.size%e.numberOfComponents!==0)throw new RangeError("model.size is not a multiple of model.numberOfComponents");jw(t,e)}const Sh=we(xh,"vtkDataArray");var xe={newInstance:Sh,extend:xh,...Aw,...yh};function Pw(t,e){e.classHierarchy.push("vtkAbstractMapper"),t.update=()=>{t.getInputData()},t.addClippingPlane=n=>n.isA("vtkPlane")?e.clippingPlanes.includes(n)?!1:(e.clippingPlanes.push(n),t.modified(),!0):!1,t.getNumberOfClippingPlanes=()=>e.clippingPlanes.length,t.removeAllClippingPlanes=()=>e.clippingPlanes.length===0?!1:(e.clippingPlanes.length=0,t.modified(),!0),t.removeClippingPlane=n=>{const r=e.clippingPlanes.indexOf(n);return r===-1?!1:(e.clippingPlanes.splice(r,1),t.modified(),!0)},t.getClippingPlanes=()=>e.clippingPlanes,t.setClippingPlanes=n=>{if(n)if(!Array.isArray(n))t.addClippingPlane(n);else{const r=n.length;for(let a=0;a<r&&a<6;a++)t.addClippingPlane(n[a])}},t.getClippingPlaneInDataCoords=(n,r,a)=>{const s=e.clippingPlanes,i=n;if(s){const o=s.length;if(r>=0&&r<o){const c=s[r],u=c.getNormal(),g=c.getOrigin(),f=u[0],l=u[1],p=u[2],v=-(f*g[0]+l*g[1]+p*g[2]);a[0]=f*i[0]+l*i[4]+p*i[8]+v*i[12],a[1]=f*i[1]+l*i[5]+p*i[9]+v*i[13],a[2]=f*i[2]+l*i[6]+p*i[10]+v*i[14],a[3]=f*i[3]+l*i[7]+p*i[11]+v*i[15];return}}E.vtkErrorMacro(`Clipping plane index ${r} is out of range.`)}}const Xw={clippingPlanes:[]};function Iw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Xw,n),E.obj(t,e),E.algo(t,e,1,0),e.clippingPlanes||(e.clippingPlanes=[]),Pw(t,e)}var Yw={extend:Iw};function qw(t,e){t.getBounds=()=>(E.vtkErrorMacro("vtkAbstractMapper3D.getBounds - NOT IMPLEMENTED"),Ri()),t.getCenter=()=>{const n=t.getBounds();return e.center=pe.isValid(n)?pe.getCenter(n):null,e.center?.slice()},t.getLength=()=>{const n=t.getBounds();return pe.getDiagonalLength(n)}}const Qw=t=>({bounds:[...pe.INIT_BOUNDS],center:[0,0,0],viewSpecificProperties:{},...t});function Zw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Qw(n)),Yw.extend(t,e,n),E.setGet(t,e,["viewSpecificProperties"]),qw(t,e)}var Jw={extend:Zw};const{vtkErrorMacro:ig,vtkWarningMacro:eE}=E;function tE(t,e){e.classHierarchy.push("vtkFieldData");const n=t.getState;e.arrays&&(e.arrays=e.arrays.map(r=>({data:Gt(r.data)}))),t.initialize=()=>{t.initializeFields(),t.copyAllOn(),t.clearFieldFlags()},t.initializeFields=()=>{e.arrays=[],e.copyFieldFlags={},t.modified()},t.copyStructure=r=>{t.initializeFields(),e.copyFieldFlags=r.getCopyFieldFlags().map(a=>a),e.arrays=r.getArrays().map(a=>({data:a}))},t.getNumberOfArrays=()=>e.arrays.length,t.getNumberOfActiveArrays=()=>e.arrays.length,t.addArray=r=>{const a=r.getName(),{array:s,index:i}=t.getArrayWithIndex(a);return s!=null?(e.arrays[i]={data:r},i):(e.arrays=[].concat(e.arrays,{data:r}),e.arrays.length-1)},t.removeAllArrays=()=>{e.arrays=[]},t.removeArray=r=>{const a=e.arrays.findIndex(s=>s.data.getName()===r);return t.removeArrayByIndex(a)},t.removeArrayByIndex=r=>r!==-1&&r<e.arrays.length?(e.arrays.splice(r,1),!0):!1,t.getArrays=()=>e.arrays.map(r=>r.data),t.getArray=r=>typeof r=="number"?t.getArrayByIndex(r):t.getArrayByName(r),t.getArrayByName=r=>e.arrays.reduce((a,s,i)=>s.data.getName()===r?s.data:a,null),t.getArrayWithIndex=r=>{const a=e.arrays.findIndex(s=>s.data.getName()===r);return{array:a!==-1?e.arrays[a].data:null,index:a}},t.getArrayByIndex=r=>r>=0&&r<e.arrays.length?e.arrays[r].data:null,t.hasArray=r=>t.getArrayWithIndex(r).index>=0,t.getArrayName=r=>{const a=e.arrays[r];return a?a.data.getName():""},t.getCopyFieldFlags=()=>e.copyFieldFlags,t.getFlag=r=>e.copyFieldFlags[r],t.passData=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;r.getArrays().forEach(i=>{const o=t.getFlag(i.getName());if(o!==!1&&!(e.doCopyAllOff&&o!==!0)&&i){let c=t.getArrayByName(i.getName());if(c)if(i.getNumberOfComponents()===c.getNumberOfComponents())if(a>-1&&a<i.getNumberOfTuples()){const u=s>-1?s:a;c.insertTuple(u,i.getTuple(a))}else c.insertTuples(0,i.getTuples());else ig("Unhandled case in passData");else if(a<0||a>i.getNumberOfTuples())t.addArray(i),r.getAttributes(i).forEach(u=>{t.setAttribute(i,u)});else{const u=i.getNumberOfComponents();let g=i.getNumberOfValues();const f=s>-1?s:a;g<=f*u&&(g=(f+1)*u),c=xe.newInstance({name:i.getName(),dataType:i.getDataType(),numberOfComponents:u,values:E.newTypedArray(i.getDataType(),g),size:0}),c.insertTuple(f,i.getTuple(a)),t.addArray(c),r.getAttributes(i).forEach(l=>{t.setAttribute(c,l)})}}})},t.interpolateData=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;r.getArrays().forEach(c=>{const u=t.getFlag(c.getName());if(u!==!1&&!(e.doCopyAllOff&&u!==!0)&&c){let g=t.getArrayByName(c.getName());if(g)if(c.getNumberOfComponents()===g.getNumberOfComponents())if(a>-1&&a<c.getNumberOfTuples()){const f=i>-1?i:a;g.interpolateTuple(f,c,a,c,s,o),eE("Unexpected case in interpolateData")}else g.insertTuples(c.getTuples());else ig("Unhandled case in interpolateData");else if(a<0||s<0||a>c.getNumberOfTuples())t.addArray(c),r.getAttributes(c).forEach(f=>{t.setAttribute(c,f)});else{const f=c.getNumberOfComponents();let l=c.getNumberOfValues();const p=i>-1?i:a;l<=p*f&&(l=(p+1)*f),g=xe.newInstance({name:c.getName(),dataType:c.getDataType(),numberOfComponents:f,values:E.newTypedArray(c.getDataType(),l),size:0}),g.interpolateTuple(p,c,a,c,s,o),t.addArray(g),r.getAttributes(c).forEach(v=>{t.setAttribute(g,v)})}}})},t.copyFieldOn=r=>{e.copyFieldFlags[r]=!0},t.copyFieldOff=r=>{e.copyFieldFlags[r]=!1},t.copyAllOn=()=>{(!e.doCopyAllOn||e.doCopyAllOff)&&(e.doCopyAllOn=!0,e.doCopyAllOff=!1,t.modified())},t.copyAllOff=()=>{(e.doCopyAllOn||!e.doCopyAllOff)&&(e.doCopyAllOn=!1,e.doCopyAllOff=!0,t.modified())},t.clearFieldFlags=()=>{e.copyFieldFlags={}},t.deepCopy=r=>{e.arrays=r.getArrays().map(a=>{const s=a.newClone();return s.deepCopy(a),{data:s}})},t.copyFlags=r=>r.getCopyFieldFlags().map(a=>a),t.reset=()=>e.arrays.forEach(r=>r.data.reset()),t.getMTime=()=>e.arrays.reduce((r,a)=>a.data.getMTime()>r?a.data.getMTime():r,e.mtime),t.getNumberOfComponents=()=>e.arrays.reduce((r,a)=>r+a.data.getNumberOfComponents(),0),t.getNumberOfTuples=()=>e.arrays.length>0?e.arrays[0].getNumberOfTuples():0,t.getState=()=>{const r=n();return r&&(r.arrays=e.arrays.map(a=>({data:a.data.getState()}))),r}}const nE={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function Ch(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nE,n),E.obj(t,e),tE(t,e)}const rE=E.newInstance(Ch,"vtkFieldData");var aE={newInstance:rE,extend:Ch};const sE={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},iE={MAX:0,EXACT:1,NOLIMIT:2},oE={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},cE={DUPLICATEPOINT:1,HIDDENPOINT:2},fE={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},uE="vtkGhostType",gE={DEFAULT:0,SINGLE:1,DOUBLE:2};var wh={AttributeCopyOperations:fE,AttributeLimitTypes:iE,AttributeTypes:sE,CellGhostTypes:oE,DesiredOutputPrecision:gE,PointGhostTypes:cE,ghostArrayName:uE};const{AttributeTypes:En,AttributeCopyOperations:Yn}=wh,{vtkWarningMacro:os}=E;function lE(t,e){const n=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function r(i){let o=n.find(c=>En[c.toUpperCase()]===i||typeof i!="number"&&c.toLowerCase()===i.toLowerCase());return typeof o>"u"&&(o=null),o}e.classHierarchy.push("vtkDataSetAttributes");const a={...t};t.checkNumberOfComponents=i=>!0,t.setAttribute=(i,o)=>{const c=r(o);if(i&&c.toUpperCase()==="PEDIGREEIDS"&&!i.isA("vtkDataArray"))return os(`Cannot set attribute ${c}. The attribute must be a vtkDataArray.`),-1;if(i&&!t.checkNumberOfComponents(i,c))return os(`Cannot set attribute ${c}. Incorrect number of components.`),-1;let u=e[`active${c}`];if(u>=0&&u<e.arrays.length){if(e.arrays[u]===i)return u;t.removeArrayByIndex(u)}return i?(u=t.addArray(i),e[`active${c}`]=u):e[`active${c}`]=-1,t.modified(),e[`active${c}`]},t.getAttributes=i=>n.filter(o=>t[`get${o}`]()===i),t.setActiveAttributeByName=(i,o)=>t.setActiveAttributeByIndex(t.getArrayWithIndex(i).index,o),t.setActiveAttributeByIndex=(i,o)=>{const c=r(o);if(i>=0&&i<e.arrays.length){if(c.toUpperCase()!=="PEDIGREEIDS"){const u=t.getArrayByIndex(i);if(!u.isA("vtkDataArray"))return os(`Cannot set attribute ${c}. Only vtkDataArray subclasses can be set as active attributes.`),-1;if(!t.checkNumberOfComponents(u,c))return os(`Cannot set attribute ${c}. Incorrect number of components.`),-1}return e[`active${c}`]=i,t.modified(),i}return i===-1&&(e[`active${c}`]=i,t.modified()),-1},t.getActiveAttribute=i=>{const o=r(i);return t[`get${o}`]()},t.removeAllArrays=()=>{n.forEach(i=>{e[`active${i}`]=-1}),a.removeAllArrays()},t.removeArrayByIndex=i=>(i!==-1&&n.forEach(o=>{i===e[`active${o}`]?e[`active${o}`]=-1:i<e[`active${o}`]&&(e[`active${o}`]-=1)}),a.removeArrayByIndex(i)),n.forEach(i=>{const o=`active${i}`;t[`get${i}`]=()=>t.getArrayByIndex(e[o]),t[`set${i}`]=c=>t.setAttribute(c,i),t[`setActive${i}`]=c=>t.setActiveAttributeByIndex(t.getArrayWithIndex(c).index,i),t[`copy${i}Off`]=()=>{const c=i.toUpperCase();e.copyAttributeFlags[Yn.PASSDATA][En[c]]=!1},t[`copy${i}On`]=()=>{const c=i.toUpperCase();e.copyAttributeFlags[Yn.PASSDATA][En[c]]=!0}}),t.initializeAttributeCopyFlags=()=>{e.copyAttributeFlags=[],Object.keys(Yn).filter(i=>i!=="ALLCOPY").forEach(i=>{e.copyAttributeFlags[Yn[i]]=Object.keys(En).filter(o=>o!=="NUM_ATTRIBUTES").reduce((o,c)=>(o[En[c]]=!0,o),[])}),e.copyAttributeFlags[Yn.COPYTUPLE][En.GLOBALIDS]=!1,e.copyAttributeFlags[Yn.INTERPOLATE][En.GLOBALIDS]=!1,e.copyAttributeFlags[Yn.COPYTUPLE][En.PEDIGREEIDS]=!1},t.initialize=E.chain(t.initialize,t.initializeAttributeCopyFlags),e.dataArrays&&Object.keys(e.dataArrays).length&&Object.keys(e.dataArrays).forEach(i=>{!e.dataArrays[i].ref&&e.dataArrays[i].type==="vtkDataArray"&&t.addArray(xe.newInstance(e.dataArrays[i]))});const s=t.shallowCopy;t.shallowCopy=(i,o)=>{s(i,o),e.arrays=i.getArrays().map(c=>{const u=c.newClone();return u.shallowCopy(c,o),{data:u}})},t.initializeAttributeCopyFlags()}const pE={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function Eh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pE,n),aE.extend(t,e,n),E.setGet(t,e,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),e.arrays||(e.arrays={}),lE(t,e)}const hE=E.newInstance(Eh,"vtkDataSetAttributes");var og={newInstance:hE,extend:Eh,...wh};const dE={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},vE={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7};var yE={FieldDataTypes:dE,FieldAssociations:vE};const da=["pointData","cellData","fieldData"];function TE(t,e){e.classHierarchy.push("vtkDataSet"),da.forEach(a=>{e[a]?e[a]=Gt(e[a]):e[a]=og.newInstance()}),t.computeBounds=()=>{if(e.modifiedTime&&e.computeTime&&e.modifiedTime>e.computeTime||!e.computeTime){const a=t.getPoints();a?.getNumberOfPoints()?pe.setBounds(e.bounds,a.getBoundsByReference()):e.bounds=tc.createUninitializedBounds(),e.computeTime=E.getCurrentGlobalMTime()}},t.getLength2=()=>{const a=t.getBoundsByReference();return!a||a.length!==6?0:pe.getDiagonalLength2(a)},t.getLength=()=>Math.sqrt(t.getLength2()),t.getCenter=()=>{const a=t.getBoundsByReference();return!a||a.length!==6?[0,0,0]:pe.getCenter(a)},t.getCellBounds=a=>{const s=t.getCell(a);return s?s.getBounds():tc.createUninitializedBounds()},t.getBounds=E.chain(()=>t.computeBounds,t.getBounds),t.getBoundsByReference=E.chain(()=>t.computeBounds,t.getBoundsByReference);const n=t.shallowCopy;t.shallowCopy=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(a,s),da.forEach(i=>{e[i]=og.newInstance(),e[i].shallowCopy(a.getReferenceByName(i))})};const r=t.getMTime;t.getMTime=()=>da.reduce((a,s)=>Math.max(a,e[s]?.getMTime()??a),r()),t.initialize=()=>(da.forEach(a=>e[a]?.initialize()),t)}const xE={};function Rh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xE,n),E.obj(t,e),E.setGet(t,e,da),E.getArray(t,e,["bounds"],6),TE(t,e)}const SE=E.newInstance(Rh,"vtkDataSet");var Sr={newInstance:SE,extend:Rh,...yE};const Lt={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9};var Oh={StructuredType:Lt};const{StructuredType:sn}=Oh;function CE(t){let e=0;for(let n=0;n<3;++n)t[n*2]<t[n*2+1]&&e++;return t[0]>t[1]||t[2]>t[3]||t[4]>t[5]?sn.EMPTY:e===3?sn.XYZ_GRID:e===2?t[0]===t[1]?sn.YZ_PLANE:t[2]===t[3]?sn.XZ_PLANE:sn.XY_PLANE:e===1?t[0]<t[1]?sn.X_LINE:t[2]<t[3]?sn.Y_LINE:sn.Z_LINE:sn.SINGLE_POINT}var wE={getDataDescriptionFromExtent:CE,...Oh};const{vtkErrorMacro:qn}=E;function EE(t,e){e.classHierarchy.push("vtkImageData"),t.setExtent=function(){if(e.deleted)return qn("instance deleted - cannot call any method"),!1;for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const i=a.length===1?a[0]:a;if(i.length!==6)return!1;const o=e.extent.some((c,u)=>c!==i[u]);return o&&(e.extent=i.slice(),e.dataDescription=wE.getDataDescriptionFromExtent(e.extent),t.modified()),o},t.setDimensions=function(){let r,a,s;if(e.deleted){qn("instance deleted - cannot call any method");return}if(arguments.length===1){const i=arguments.length<=0?void 0:arguments[0];r=i[0],a=i[1],s=i[2]}else if(arguments.length===3)r=arguments.length<=0?void 0:arguments[0],a=arguments.length<=1?void 0:arguments[1],s=arguments.length<=2?void 0:arguments[2];else{qn("Bad dimension specification");return}t.setExtent(0,r-1,0,a-1,0,s-1)},t.getDimensions=()=>[e.extent[1]-e.extent[0]+1,e.extent[3]-e.extent[2]+1,e.extent[5]-e.extent[4]+1],t.getNumberOfCells=()=>{const r=t.getDimensions();let a=1;for(let s=0;s<3;s++){if(r[s]===0)return 0;r[s]>1&&(a*=r[s]-1)}return a},t.getNumberOfPoints=()=>{const r=t.getDimensions();return r[0]*r[1]*r[2]},t.getPoint=r=>{const a=t.getDimensions();if(a[0]===0||a[1]===0||a[2]===0)return qn("Requesting a point from an empty image."),null;const s=new Float64Array(3);switch(e.dataDescription){case Lt.EMPTY:return null;case Lt.SINGLE_POINT:break;case Lt.X_LINE:s[0]=r;break;case Lt.Y_LINE:s[1]=r;break;case Lt.Z_LINE:s[2]=r;break;case Lt.XY_PLANE:s[0]=r%a[0],s[1]=r/a[0];break;case Lt.YZ_PLANE:s[1]=r%a[1],s[2]=r/a[1];break;case Lt.XZ_PLANE:s[0]=r%a[0],s[2]=r/a[0];break;case Lt.XYZ_GRID:s[0]=r%a[0],s[1]=r/a[0]%a[1],s[2]=r/(a[0]*a[1]);break;default:qn("Invalid dataDescription");break}const i=[0,0,0];return t.indexToWorld(s,i),i},t.getBounds=()=>t.extentToBounds(t.getSpatialExtent()),t.extentToBounds=r=>pe.transformBounds(r,e.indexToWorld),t.getSpatialExtent=()=>pe.inflate([...e.extent],.5),t.computeTransforms=()=>{u0(e.indexToWorld,e.origin),e.indexToWorld[0]=e.direction[0],e.indexToWorld[1]=e.direction[1],e.indexToWorld[2]=e.direction[2],e.indexToWorld[4]=e.direction[3],e.indexToWorld[5]=e.direction[4],e.indexToWorld[6]=e.direction[5],e.indexToWorld[8]=e.direction[6],e.indexToWorld[9]=e.direction[7],e.indexToWorld[10]=e.direction[8],pr(e.indexToWorld,e.indexToWorld,e.spacing),ut(e.worldToIndex,e.indexToWorld)},t.indexToWorld=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Te(a,r,e.indexToWorld),a},t.indexToWorldVec3=t.indexToWorld,t.worldToIndex=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Te(a,r,e.worldToIndex),a},t.worldToIndexVec3=t.worldToIndex,t.indexToWorldBounds=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return pe.transformBounds(r,e.indexToWorld,a)},t.worldToIndexBounds=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return pe.transformBounds(r,e.worldToIndex,a)},e._onOriginChanged=t.computeTransforms,e._onDirectionChanged=t.computeTransforms,e._onSpacingChanged=t.computeTransforms,t.computeTransforms(),t.getCenter=()=>pe.getCenter(t.getBounds()),t.computeHistogram=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const s=[0,0,0,0,0,0];t.worldToIndexBounds(r,s);const i=[0,0,0],o=[0,0,0];pe.computeCornerPoints(s,i,o),Qo(i,i),Qo(o,o);const c=t.getDimensions();Jo(i,[0,0,0],[c[0]-1,c[1]-1,c[2]-1],i),Jo(o,[0,0,0],[c[0]-1,c[1]-1,c[2]-1],o);const u=c[0],g=c[0]*c[1],f=t.getPointData().getScalars().getData();let l=-1/0,p=1/0,v=0,h=0,d=0;for(let y=i[2];y<=o[2];y++)for(let C=i[1];C<=o[1];C++){let w=i[0]+C*u+y*g;for(let R=i[0];R<=o[0];R++){if(!a||a([R,C,y],s)){const O=f[w];O>l&&(l=O),O<p&&(p=O),v+=O*O,h+=O,d+=1}++w}}const T=d>0?h/d:0,S=d?Math.abs(v/d-T*T):0,x=Math.sqrt(S);return{minimum:p,maximum:l,average:T,variance:S,sigma:x,count:d}},t.computeIncrements=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const s=[];let i=a;for(let o=0;o<3;++o)s[o]=i,i*=r[o*2+1]-r[o*2]+1;return s},t.computeOffsetIndex=r=>{let[a,s,i]=r;const o=t.getExtent(),c=t.getPointData().getScalars().getNumberOfComponents(),u=t.computeIncrements(o,c);return Math.floor((Math.round(a)-o[0])*u[0]+(Math.round(s)-o[2])*u[1]+(Math.round(i)-o[4])*u[2])},t.getOffsetIndexFromWorld=r=>{const a=t.getExtent(),s=t.worldToIndex(r);for(let i=0;i<3;++i)if(s[i]<a[i*2]||s[i]>a[i*2+1])return qn(`GetScalarPointer: Pixel ${s} is not in memory. Current extent = ${a}`),NaN;return t.computeOffsetIndex(s)},t.getScalarValueFromWorld=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=t.getPointData().getScalars().getNumberOfComponents();if(a<0||a>=s)return qn(`GetScalarPointer: Scalar Component ${a} is not within bounds. Current Scalar numberOfComponents: ${s}`),NaN;const i=t.getOffsetIndexFromWorld(r);return Number.isNaN(i)?i:t.getPointData().getScalars().getComponent(i,a)};const n=t.initialize;t.initialize=()=>(t.set({direction:Kn(e.direction),spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:Lt.EMPTY}),n())}const RE={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:Lt.EMPTY};function Mh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RE,n),Sr.extend(t,e,n),e.direction?Array.isArray(e.direction)&&(e.direction=new Float64Array(e.direction.slice(0,9))):e.direction=Kn(new Float64Array(9)),e.indexToWorld=new Float64Array(16),e.worldToIndex=new Float64Array(16),E.get(t,e,["indexToWorld","worldToIndex"]),E.setGetArray(t,e,["origin","spacing"],3),E.setGetArray(t,e,["direction"],9),E.getArray(t,e,["extent"],6),EE(t,e)}const OE=E.newInstance(Mh,"vtkImageData");var ME={newInstance:OE,extend:Mh};const DE={MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},sc={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4},LE={LINEAR:0,LOG10:1};var df={VectorMode:DE,ScalarMappingTarget:sc,Scale:LE};const mE={DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},VE={DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5},FE={BY_ID:0,BY_NAME:1};var vf={ColorMode:mE,GetArray:FE,ScalarMode:VE};const{ScalarMappingTarget:cg,Scale:BE,VectorMode:Pt}=df,{VtkDataTypes:Rn}=xe,{ColorMode:cs}=vf,{vtkErrorMacro:fg}=E;function _E(t){return t}function ug(t){return Math.floor(t*255+.5)}function UE(t,e){e.classHierarchy.push("vtkScalarsToColors"),t.setVectorModeToMagnitude=()=>t.setVectorMode(Pt.MAGNITUDE),t.setVectorModeToComponent=()=>t.setVectorMode(Pt.COMPONENT),t.setVectorModeToRGBColors=()=>t.setVectorMode(Pt.RGBCOLORS),t.build=()=>{},t.isOpaque=()=>!0,t.setAnnotations=(n,r)=>{if(!(n&&!r||!n&&r)){if(n&&r&&n.length!==r.length){fg("Values and annotations do not have the same number of tuples so ignoring");return}if(e.annotationArray=[],r&&n){const a=r.length;for(let s=0;s<a;s++)e.annotationArray.push({value:n[s],annotation:String(r[s])})}t.updateAnnotatedValueMap(),t.modified()}},t.setAnnotation=(n,r)=>{let a=t.checkForAnnotatedValue(n),s=!1;return a>=0?e.annotationArray[a].annotation!==r&&(e.annotationArray[a].annotation=r,s=!0):(e.annotationArray.push({value:n,annotation:r}),a=e.annotationArray.length-1,s=!0),s&&(t.updateAnnotatedValueMap(),t.modified()),a},t.getNumberOfAnnotatedValues=()=>e.annotationArray.length,t.getAnnotatedValue=n=>n<0||n>=e.annotationArray.length?null:e.annotationArray[n].value,t.getAnnotation=n=>e.annotationArray[n]===void 0?null:e.annotationArray[n].annotation,t.getAnnotatedValueIndex=n=>e.annotationArray.length?t.checkForAnnotatedValue(n):-1,t.removeAnnotation=n=>{const r=t.checkForAnnotatedValue(n),a=r>=0;return a&&(e.annotationArray.splice(r,1),t.updateAnnotatedValueMap(),t.modified()),a},t.resetAnnotations=()=>{e.annotationArray=[],e.annotatedValueMap=[],t.modified()},t.getAnnotationColor=(n,r)=>{if(e.indexedLookup){const a=t.getAnnotatedValueIndex(n);t.getIndexedColor(a,r)}else t.getColor(parseFloat(n),r),r[3]=1},t.checkForAnnotatedValue=n=>t.getAnnotatedValueIndexInternal(n),t.getAnnotatedValueIndexInternal=n=>{if(e.annotatedValueMap[n]!==void 0){const r=e.annotationArray.length;return e.annotatedValueMap[n]%r}return-1},t.getIndexedColor=(n,r)=>{r[0]=0,r[1]=0,r[2]=0,r[3]=0},t.updateAnnotatedValueMap=()=>{e.annotatedValueMap=[];const n=e.annotationArray.length;for(let r=0;r<n;r++)e.annotatedValueMap[e.annotationArray[r].value]=r},t.mapScalars=(n,r,a)=>{const s=n.getNumberOfComponents();let i=null;if(r===cs.DEFAULT&&(n.getDataType()===Rn.UNSIGNED_CHAR||n.getDataType()===Rn.UNSIGNED_CHAR_CLAMPED)||r===cs.DIRECT_SCALARS&&n)i=t.convertToRGBA(n,s,n.getNumberOfTuples());else{const o={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:Rn.UNSIGNED_CHAR},c=E.newTypedArray(o.dataType,4*n.getNumberOfTuples());o.values=c,o.size=c.length,i=xe.newInstance(o);let u=a;u<0&&s>1?t.mapVectorsThroughTable(n,i,cg.RGBA,-1,-1):(u<0&&(u=0),u>=s&&(u=s-1),t.mapScalarsThroughTable(n,i,cg.RGBA,u))}return i},t.mapVectorsToMagnitude=(n,r,a)=>{const s=n.getNumberOfTuples(),i=n.getNumberOfComponents(),o=r.getData(),c=n.getData();for(let u=0;u<s;u++){let g=0;for(let f=0;f<a;f++)g+=c[u*i+f]*c[u*i+f];o[u]=Math.sqrt(g)}},t.mapVectorsThroughTable=(n,r,a,s,i)=>{let o=t.getVectorMode(),c=i,u=s;const g=n.getNumberOfComponents();o===Pt.COMPONENT?(u===-1&&(u=t.getVectorComponent()),u<0&&(u=0),u>=g&&(u=g-1)):(c===-1&&(c=t.getVectorSize()),c<=0?(u=0,c=g):(u<0&&(u=0),u>=g&&(u=g-1),u+c>g&&(c=g-u)),o===Pt.MAGNITUDE&&(g===1||c===1)&&(o=Pt.COMPONENT));let f=0;switch(u>0&&(f=u),o){case Pt.COMPONENT:{t.mapScalarsThroughTable(n,r,a,f);break}case Pt.RGBCOLORS:break;case Pt.MAGNITUDE:default:{const l=xe.newInstance({numberOfComponents:1,values:new Float32Array(n.getNumberOfTuples())});t.mapVectorsToMagnitude(n,l,c),t.mapScalarsThroughTable(l,r,a,0);break}}},t.luminanceToRGBA=(n,r,a,s)=>{const i=s(a),o=r.getData(),c=n.getData(),u=o.length,g=0,f=1;let l=0;for(let p=g;p<u;p+=f){const v=s(o[p]);c[l*4]=v,c[l*4+1]=v,c[l*4+2]=v,c[l*4+3]=i,l++}},t.luminanceAlphaToRGBA=(n,r,a,s)=>{const i=r.getData(),o=n.getData(),c=i.length,u=0,g=2;let f=0;for(let l=u;l<c;l+=g){const p=s(i[l]);o[f]=p,o[f+1]=p,o[f+2]=p,o[f+3]=s(i[l+1])*a,f+=4}},t.rGBToRGBA=(n,r,a,s)=>{const i=ug(a),o=r.getData(),c=n.getData(),u=o.length,g=0,f=3;let l=0;for(let p=g;p<u;p+=f)c[l*4]=s(o[p]),c[l*4+1]=s(o[p+1]),c[l*4+2]=s(o[p+2]),c[l*4+3]=i,l++},t.rGBAToRGBA=(n,r,a,s)=>{const i=r.getData(),o=n.getData(),c=i.length,u=0,g=4;let f=0;for(let l=u;l<c;l+=g)o[f*4]=s(i[l]),o[f*4+1]=s(i[l+1]),o[f*4+2]=s(i[l+2]),o[f*4+3]=s(i[l+3])*a,f++},t.convertToRGBA=(n,r,a)=>{let{alpha:s}=e;if(r===4&&s>=1&&n.getDataType()===Rn.UNSIGNED_CHAR)return n;const i=xe.newInstance({numberOfComponents:4,empty:!0,size:4*a,dataType:Rn.UNSIGNED_CHAR});if(a<=0)return i;s=s>0?s:0,s=s<1?s:1;let o=_E;switch((n.getDataType()===Rn.FLOAT||n.getDataType()===Rn.DOUBLE)&&(o=ug),r){case 1:t.luminanceToRGBA(i,n,s,o);break;case 2:t.luminanceAlphaToRGBA(i,n,o);break;case 3:t.rGBToRGBA(i,n,s,o);break;case 4:t.rGBAToRGBA(i,n,s,o);break;default:return fg("Cannot convert colors"),null}return i},t.usingLogScale=()=>!1,t.getNumberOfAvailableColors=()=>256*256*256,t.setRange=(n,r)=>t.setMappingRange(n,r),t.getRange=()=>t.getMappingRange(),t.areScalarsOpaque=(n,r,a)=>{if(!n)return t.isOpaque();const s=n.getNumberOfComponents();return r===cs.DEFAULT&&n.getDataType()===Rn.UNSIGNED_CHAR||r===cs.DIRECT_SCALARS?s===3||s===1?e.alpha>=1:n.getRange(s-1)[0]===255:!0}}const NE={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:Pt.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1,scale:BE.LINEAR};function Dh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,NE,n),E.obj(t,e),e.mappingRange=[0,255],e.annotationArray=[],e.annotatedValueMap=[],E.setGet(t,e,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),E.setArray(t,e,["mappingRange"],2),E.getArray(t,e,["mappingRange"]),UE(t,e)}const kE=E.newInstance(Dh,"vtkScalarsToColors");var Lh={newInstance:kE,extend:Dh,...df};const{vtkErrorMacro:gg}=E,lg=0,pg=1,oo=2;function GE(t,e){e.classHierarchy.push("vtkLookupTable"),t.isOpaque=()=>{if(e.opaqueFlagBuildTime.getMTime()<t.getMTime()){let n=!0;e.nanColor[3]<1&&(n=0),e.useBelowRangeColor&&e.belowRangeColor[3]<1&&(n=0),e.useAboveRangeColor&&e.aboveRangeColor[3]<1&&(n=0);for(let r=3;r<e.table.length&&n;r+=4)e.table[r]<255&&(n=!1);e.opaqueFlag=n,e.opaqueFlagBuildTime.modified()}return e.opaqueFlag},t.usingLogScale=()=>!1,t.getNumberOfAvailableColors=()=>e.table.length/4-3,t.linearIndexLookup=(n,r)=>{let a=0;const s=Number(n);return s<r.range[0]?a=r.maxIndex+lg+1.5:s>r.range[1]?a=r.maxIndex+pg+1.5:(a=(s+r.shift)*r.scale,a=a<r.maxIndex?a:r.maxIndex),Math.floor(a)},t.linearLookup=(n,r,a)=>{let s=0;Bp(n)?s=Math.floor(a.maxIndex+1.5+oo):s=t.linearIndexLookup(n,a);const i=4*s;return r.slice(i,i+4)},t.indexedLookupFunction=(n,r,a)=>{let s=t.getAnnotatedValueIndexInternal(n);s===-1&&(s=e.numberOfColors+oo);const i=4*s;return[r[i],r[i+1],r[i+2],r[i+3]]},t.lookupShiftAndScale=(n,r)=>{r.shift=-n[0],r.scale=Number.MAX_VALUE,n[1]>n[0]&&(r.scale=(r.maxIndex+1)/(n[1]-n[0]))},t.mapScalarsThroughTable=(n,r,a,s)=>{let i=t.linearLookup;e.indexedLookup&&(i=t.indexedLookupFunction);const o=t.getMappingRange(),c={maxIndex:t.getNumberOfColors()-1,range:o,shift:0,scale:0};t.lookupShiftAndScale(o,c);const u=t.getAlpha(),g=n.getNumberOfTuples(),f=n.getNumberOfComponents(),l=r.getData(),p=n.getData();if(u>=1){if(a===sc.RGBA)for(let v=0;v<g;v++){const h=i(p[v*f+s],e.table,c);l[v*4]=h[0],l[v*4+1]=h[1],l[v*4+2]=h[2],l[v*4+3]=h[3]}}else if(a===sc.RGBA)for(let v=0;v<g;v++){const h=i(p[v*f+s],e.table,c);l[v*4]=h[0],l[v*4+1]=h[1],l[v*4+2]=h[2],l[v*4+3]=Math.floor(h[3]*u+.5)}},t.forceBuild=()=>{let n=0,r=0,a=0,s=0;const i=e.numberOfColors-1;i&&(n=(e.hueRange[1]-e.hueRange[0])/i,r=(e.saturationRange[1]-e.saturationRange[0])/i,a=(e.valueRange[1]-e.valueRange[0])/i,s=(e.alphaRange[1]-e.alphaRange[0])/i),e.table.length=4*i+16;const o=[],c=[];for(let u=0;u<=i;u++)o[0]=e.hueRange[0]+u*n,o[1]=e.saturationRange[0]+u*r,o[2]=e.valueRange[0]+u*a,Dp(o,c),c[3]=e.alphaRange[0]+u*s,e.table[u*4]=c[0]*255+.5,e.table[u*4+1]=c[1]*255+.5,e.table[u*4+2]=c[2]*255+.5,e.table[u*4+3]=c[3]*255+.5;t.buildSpecialColors(),e.buildTime.modified()},t.setTable=n=>{if(Array.isArray(n)){const a=n[0].length;e.numberOfColors=n.length;const s=4-a;let i=0;for(let o=0;o<e.numberOfColors;o++)e.table[o*4]=255,e.table[o*4+1]=255,e.table[o*4+2]=255,e.table[o*4+3]=255;for(let o=0;o<n.length;o++){const c=n[o];for(let u=0;u<a;u++)e.table[i++]=c[u];i+=s}return t.buildSpecialColors(),e.insertTime.modified(),t.modified(),!0}if(n.getNumberOfComponents()!==4)return gg("Expected 4 components for RGBA colors"),!1;if(n.getDataType()!==Pe.UNSIGNED_CHAR)return gg("Expected unsigned char values for RGBA colors"),!1;e.numberOfColors=n.getNumberOfTuples();const r=n.getData();e.table.length=r.length;for(let a=0;a<r.length;a++)e.table[a]=r[a];return t.buildSpecialColors(),e.insertTime.modified(),t.modified(),!0},t.buildSpecialColors=()=>{const{numberOfColors:n}=e,r=e.table;let a=(n+lg)*4;e.useBelowRangeColor||n===0?(r[a]=e.belowRangeColor[0]*255+.5,r[a+1]=e.belowRangeColor[1]*255+.5,r[a+2]=e.belowRangeColor[2]*255+.5,r[a+3]=e.belowRangeColor[3]*255+.5):(r[a]=r[0],r[a+1]=r[1],r[a+2]=r[2],r[a+3]=r[3]),a=(n+pg)*4,e.useAboveRangeColor||n===0?(r[a]=e.aboveRangeColor[0]*255+.5,r[a+1]=e.aboveRangeColor[1]*255+.5,r[a+2]=e.aboveRangeColor[2]*255+.5,r[a+3]=e.aboveRangeColor[3]*255+.5):(r[a]=r[4*(n-1)+0],r[a+1]=r[4*(n-1)+1],r[a+2]=r[4*(n-1)+2],r[a+3]=r[4*(n-1)+3]),a=(n+oo)*4,r[a]=e.nanColor[0]*255+.5,r[a+1]=e.nanColor[1]*255+.5,r[a+2]=e.nanColor[2]*255+.5,r[a+3]=e.nanColor[3]*255+.5},t.build=()=>{(e.table.length<1||t.getMTime()>e.buildTime.getMTime()&&e.insertTime.getMTime()<=e.buildTime.getMTime())&&t.forceBuild()},e.table.length>0&&(t.buildSpecialColors(),e.insertTime.modified())}const bE={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function mh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bE,n),Lh.extend(t,e,n),e.table||(e.table=[]),e.buildTime={},E.obj(e.buildTime),e.opaqueFlagBuildTime={},E.obj(e.opaqueFlagBuildTime,{mtime:0}),e.insertTime={},E.obj(e.insertTime,{mtime:0}),E.get(t,e,["buildTime"]),E.setGet(t,e,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),E.setArray(t,e,["alphaRange","hueRange","saturationRange","valueRange"],2),E.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),E.getArray(t,e,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),GE(t,e)}const $E=E.newInstance(mh,"vtkLookupTable");var WE={newInstance:$E,extend:mh};const Pn={Off:0,PolygonOffset:1};let ic=Pn.PolygonOffset,ii=Pn.Off;const zE=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function HE(){return ic}function AE(t){const e=ic===t;return ic=t,e}function jE(){return ii}function Li(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const e=ii===t;return ii=t,e}function KE(){return Li(Pn.Off)}function PE(){return Li(Pn.Off)}function XE(){return Li(Pn.PolygonOffset)}function IE(){return zE[ii]}var oc={Resolve:Pn,getResolveCoincidentTopologyAsString:IE,getResolveCoincidentTopologyPolygonOffsetFaces:HE,getResolveCoincidentTopology:jE,setResolveCoincidentTopology:Li,setResolveCoincidentTopologyPolygonOffsetFaces:AE,setResolveCoincidentTopologyToDefault:KE,setResolveCoincidentTopologyToOff:PE,setResolveCoincidentTopologyToPolygonOffset:XE};function Vh(t,e,n){n.forEach(r=>{t[`get${r.method}`]=()=>e[r.key],t[`set${r.method}`]=E.objectSetterMap.object(t,e,{name:r.key,params:["factor","offset"]})})}const yf=["Polygon","Line","Point"],YE={Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},qE=()=>{},or={modified:qE};Vh(or,YE,yf.map(t=>({key:t,method:`ResolveCoincidentTopology${t}OffsetParameters`})));function QE(t,e){e.resolveCoincidentTopology===void 0&&(e.resolveCoincidentTopology=!1),E.setGet(t,e,["resolveCoincidentTopology"]),e.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys(oc).forEach(n=>{t[n]=oc[n]}),Object.keys(or).filter(n=>n!=="modified").forEach(n=>{t[n]=or[n]}),Vh(t,e.topologyOffset,yf.map(n=>({key:n,method:`RelativeCoincidentTopology${n}OffsetParameters`}))),t.getCoincidentTopologyPolygonOffsetParameters=()=>{const n=or.getResolveCoincidentTopologyPolygonOffsetParameters(),r=t.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}},t.getCoincidentTopologyLineOffsetParameters=()=>{const n=or.getResolveCoincidentTopologyLineOffsetParameters(),r=t.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}},t.getCoincidentTopologyPointOffsetParameter=()=>{const n=or.getResolveCoincidentTopologyPointOffsetParameters(),r=t.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}}}var Fh={implementCoincidentTopologyMethods:QE,staticOffsetAPI:or,otherStaticMethods:oc,CATEGORIES:yf,Resolve:Pn};const ct={MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,ID_HIGH24:3,MAX_KNOWN_PASS:3};var Bh={PassTypes:ct};const{FieldAssociations:hg}=Sr,{staticOffsetAPI:ZE,otherStaticMethods:JE}=Fh,{ColorMode:fs,ScalarMode:Qn,GetArray:co}=vf,{VectorMode:eR}=df,{VtkDataTypes:tR}=xe;function aa(t){return()=>E.vtkErrorMacro(`vtkMapper::${t} - NOT IMPLEMENTED`)}function nR(t,e){const n=t[1]%2===0?1:-1;if(t[0]+=n,t[0]>=e[0]||t[0]<0){const r=t[2]%2===0?1:-1;t[0]-=n,t[1]+=r,(t[1]>=e[1]||t[1]<0)&&(t[1]-=r,t[2]++)}}function rR(t,e){return t[0]+e[0]*(t[1]+e[1]*t[2])}function dg(t,e,n){const r=Math.floor(e),a=r%(2*n[0]);let s,i;a<n[0]?(t[0]=a,s=1,i=t[0]===n[0]-1):(t[0]=2*n[0]-1-a,s=-1,i=t[0]===0);const o=Math.floor(r/n[0]),c=o%(2*n[1]);let u,g;c<n[1]?(t[1]=c,u=1,g=t[1]===n[1]-1):(t[1]=2*n[1]-1-c,u=-1,g=t[1]===0),t[2]=Math.floor(o/n[1]);const f=e-r;i?g?t[2]+=f:t[1]+=u*f:t[0]+=s*f,t[0]=(t[0]+.5)/n[0],t[1]=(t[1]+.5)/n[1],t[2]=(t[2]+.5)/n[2]}const vg=new WeakMap;function aR(t,e,n,r,a,s,i){const o=new Array(arguments.length);for(let F=0;F<arguments.length;++F){const B=arguments[F];o[F]=B.getMTime?.()??B}const c=o.join("/"),u=vg.get(t);if(u&&u.stringHash===c)return u.textureCoordinates;const g=(n[1]-n[0])/(a-1),[f,l]=[n[0]-g,n[1]+g],p=f-.5*g,v=1/(l-f+g),h=f,d=(a+1)/(l-f),T=t.getData(),S=t.getNumberOfTuples(),x=t.getNumberOfComponents(),y=e<0||e>=x,C=s[2]<=1?2:3,w=xe.newInstance({numberOfComponents:C,values:new Float32Array(S*C)}),R=w.getData(),O=[0,0,0];dg(O,a+2,s);let V=0,L=0;const m=[.5,.5,.5];for(let F=0;F<S;++F){let B;if(y){let _=0;for(let P=0;P<x;++P){const z=Number(T[V+P]);_+=z*z}B=Math.sqrt(_)}else B=Number(T[V+e]);if(r&&(B=Math.log10(B)),V+=x,Bp(B))m[0]=O[0],m[1]=O[1],m[2]=O[2];else if(i){let _=(B-h)*d;_<1?_=0:_>a&&(_=a+1),dg(m,_,s)}else{m[1]=.49;const _=(B-p)*v;_>1e3?m[0]=1e3:_<-1e3?m[0]=-1e3:m[0]=_}for(let _=0;_<C;++_)R[L++]=m[_]}return vg.set(t,{stringHash:c,textureCoordinates:w}),w}function sR(t,e){e.classHierarchy.push("vtkMapper"),t.getBounds=()=>{const n=t.getInputData();return n?(e.static||t.update(),e.bounds=n.getBounds()):e.bounds=Ri(),e.bounds},t.setForceCompileOnly=n=>{e.forceCompileOnly=n},t.setSelectionWebGLIdsToVTKIds=n=>{e.selectionWebGLIdsToVTKIds=n},t.createDefaultLookupTable=()=>{e.lookupTable=WE.newInstance()},t.getColorModeAsString=()=>E.enumToString(fs,e.colorMode),t.setColorModeToDefault=()=>t.setColorMode(0),t.setColorModeToMapScalars=()=>t.setColorMode(1),t.setColorModeToDirectScalars=()=>t.setColorMode(2),t.getScalarModeAsString=()=>E.enumToString(Qn,e.scalarMode),t.setScalarModeToDefault=()=>t.setScalarMode(0),t.setScalarModeToUsePointData=()=>t.setScalarMode(1),t.setScalarModeToUseCellData=()=>t.setScalarMode(2),t.setScalarModeToUsePointFieldData=()=>t.setScalarMode(3),t.setScalarModeToUseCellFieldData=()=>t.setScalarMode(4),t.setScalarModeToUseFieldData=()=>t.setScalarMode(5),t.getAbstractScalars=(n,r,a,s,i)=>{if(!n||!e.scalarVisibility)return{scalars:null,cellFlag:!1};let o=null,c=!1;if(r===Qn.DEFAULT)o=n.getPointData().getScalars(),o||(o=n.getCellData().getScalars(),c=!0);else if(r===Qn.USE_POINT_DATA)o=n.getPointData().getScalars();else if(r===Qn.USE_CELL_DATA)o=n.getCellData().getScalars(),c=!0;else if(r===Qn.USE_POINT_FIELD_DATA){const u=n.getPointData();a===co.BY_ID?o=u.getArrayByIndex(s):o=u.getArrayByName(i)}else if(r===Qn.USE_CELL_FIELD_DATA){const u=n.getCellData();c=!0,a===co.BY_ID?o=u.getArrayByIndex(s):o=u.getArrayByName(i)}else if(r===Qn.USE_FIELD_DATA){const u=n.getFieldData();a===co.BY_ID?o=u.getArrayByIndex(s):o=u.getArrayByName(i)}return{scalars:o,cellFlag:c}},t.mapScalars=(n,r)=>{const{scalars:a,cellFlag:s}=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName);if(e.areScalarsMappedFromCells=s,!a){e.colorCoordinates=null,e.colorTextureMap=null,e.colorMapColors=null;return}const i=`${t.getMTime()}${a.getMTime()}${r}`;if(e.colorBuildString!==i){if(e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]),t.canUseTextureMapForColoring(a,s))e.mapScalarsToTexture(a,s,r);else{e.colorCoordinates=null,e.colorTextureMap=null;const o=t.getLookupTable();o&&(o.build(),e.colorMapColors=o.mapScalars(a,e.colorMode,e.fieldDataTupleId))}e.colorBuildString=`${t.getMTime()}${a.getMTime()}${r}`}},e.mapScalarsToTexture=(n,r,a)=>{const s=e.lookupTable.getRange(),i=e.lookupTable.usingLogScale(),o=e.lookupTable.getAlpha(),c=i?[Math.log10(s[0]),Math.log10(s[1])]:s;if(e.colorMapColors=null,e.colorTextureMap==null||t.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getAlpha()!==a){e.lookupTable.setAlpha(a),e.colorTextureMap=null,e.lookupTable.build();const g=e.lookupTable.getNumberOfAvailableColors(),f=2048,l=f**3-3,v=4096-2,h=2,d=r?l:v;e.numberOfColorsInRange=Math.min(Math.max(g,h),d);const T=e.numberOfColorsInRange+3,S=e.numberOfColorsInRange+2,x=r?[Math.min(Math.ceil(T/f**0),f),Math.min(Math.ceil(T/f**1),f),Math.min(Math.ceil(T/f**2),f)]:[S,2,1],y=x[0]*x[1]*x[2],C=new Float64Array(y);C.fill(NaN);const w=e.numberOfColorsInRange,R=w+2,O=[0,0,0],V=c[0],L=c[1]-c[0];for(let B=0;B<R;++B){const _=rR(O,x),P=V+L*(B-1)/(w-1),z=i?10**P:P;C[_]=z,nR(O,x)}const m=xe.newInstance({numberOfComponents:1,values:C}),F=e.lookupTable.mapScalars(m,e.colorMode,0);e.colorTextureMap=ME.newInstance(),e.colorTextureMap.setDimensions(x),e.colorTextureMap.getPointData().setScalars(F),e.lookupTable.setAlpha(o)}const u=e.lookupTable.getVectorMode()===eR.MAGNITUDE&&n.getNumberOfComponents()>1?-1:e.lookupTable.getVectorComponent();e.colorCoordinates=aR(n,u,c,i,e.numberOfColorsInRange,e.colorTextureMap.getDimensions(),r)},t.getIsOpaque=()=>{const n=t.getInputData(),a=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!e.scalarVisibility||a==null)return!0;const s=t.getLookupTable();return s?(s.build(),s.areScalarsOpaque(a,e.colorMode,-1)):!0},t.canUseTextureMapForColoring=(n,r)=>r&&e.colorMode!==fs.DIRECT_SCALARS?!0:!(!e.interpolateScalarsBeforeMapping||e.lookupTable&&e.lookupTable.getIndexedLookup()||!n||e.colorMode===fs.DEFAULT&&n.getDataType()===tR.UNSIGNED_CHAR||e.colorMode===fs.DIRECT_SCALARS),t.clearColorArrays=()=>{e.colorMapColors=null,e.colorCoordinates=null,e.colorTextureMap=null},t.getLookupTable=()=>(e.lookupTable||t.createDefaultLookupTable(),e.lookupTable),t.getMTime=()=>{let n=e.mtime;if(e.lookupTable!==null){const r=e.lookupTable.getMTime();n=r>n?r:n}return n},t.getPrimitiveCount=()=>{const n=t.getInputData();return{points:n.getPoints().getNumberOfValues()/3,verts:n.getVerts().getNumberOfValues()-n.getVerts().getNumberOfCells(),lines:n.getLines().getNumberOfValues()-2*n.getLines().getNumberOfCells(),triangles:n.getPolys().getNumberOfValues()-3*n.getPolys().getNumberOfCells()}},t.acquireInvertibleLookupTable=aa("AcquireInvertibleLookupTable"),t.valueToColor=aa("ValueToColor"),t.colorToValue=aa("ColorToValue"),t.useInvertibleColorFor=aa("UseInvertibleColorFor"),t.clearInvertibleColor=aa("ClearInvertibleColor"),t.processSelectorPixelBuffers=(n,r)=>{if(!n||!e.selectionWebGLIdsToVTKIds||!e.populateSelectionSettings)return;const a=n.getRawPixelBuffer(ct.ID_LOW24),s=n.getRawPixelBuffer(ct.ID_HIGH24),i=n.getCurrentPass(),o=n.getFieldAssociation();let c=null;o===hg.FIELD_ASSOCIATION_POINTS?c=e.selectionWebGLIdsToVTKIds.points:o===hg.FIELD_ASSOCIATION_CELLS&&(c=e.selectionWebGLIdsToVTKIds.cells),c&&r.forEach(u=>{if(i===ct.ID_LOW24){let g=0;s&&(g+=s[u],g*=256),g+=a[u+2],g*=256,g+=a[u+1],g*=256,g+=a[u];const f=c[g],l=n.getPixelBuffer(ct.ID_LOW24);l[u]=f&255,l[u+1]=(f&65280)>>8,l[u+2]=(f&16711680)>>16}else if(i===ct.ID_HIGH24&&s){let g=0;g+=s[u],g*=256,g+=a[u+2],g*=256,g+=a[u+1],g*=256,g+=a[u];const f=c[g],l=n.getPixelBuffer(ct.ID_HIGH24);l[u]=(f&4278190080)>>24}})}}const iR={colorMapColors:null,areScalarsMappedFromCells:!1,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,populateSelectionSettings:!0,selectionWebGLIdsToVTKIds:null,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,numberOfColorsInRange:0,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,customShaderAttributes:[]};function _h(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iR,n),Jw.extend(t,e,n),E.get(t,e,["areScalarsMappedFromCells","colorCoordinates","colorMapColors","colorTextureMap","numberOfColorsInRange","selectionWebGLIdsToVTKIds"]),E.setGet(t,e,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","populateSelectionSettings","renderTime","scalarMode","scalarVisibility","static","useLookupTableScalarRange","customShaderAttributes"]),E.setGetArray(t,e,["scalarRange"],2),Fh.implementCoincidentTopologyMethods(t,e),sR(t,e)}const oR=E.newInstance(_h,"vtkMapper");var yr={newInstance:oR,extend:_h,...ZE,...JE,...vf};const{isVtkObject:cR}=E;function Uh(t){let e=0;return t.filter((n,r)=>r===e?(e+=n+1,!0):!1)}function Nh(t){let e=0;for(let n=0;n<t.length;)n+=t[n]+1,e++;return e}const fR={extractCellSizes:Uh,getNumberOfCells:Nh};function uR(t,e){e.classHierarchy.push("vtkCellArray");const n={...t};t.getNumberOfCells=r=>(e.numberOfCells!==void 0&&!r||(e.cellSizes?e.numberOfCells=e.cellSizes.length:e.numberOfCells=Nh(t.getData())),e.numberOfCells),t.getCellSizes=r=>(e.cellSizes!==void 0&&!r||(e.cellSizes=Uh(t.getData())),e.cellSizes),t.resize=r=>{const a=t.getNumberOfTuples();n.resize(r);const s=t.getNumberOfTuples();s<a&&(s===0?(e.numberOfCells=0,e.cellSizes=[]):(e.numberOfCells=void 0,e.cellSizes=void 0))},t.setData=r=>{n.setData(r,1),e.numberOfCells=void 0,e.cellSizes=void 0},t.getCell=r=>{let a=r;const s=e.values[a++];return e.values.subarray(a,a+s)},t.insertNextCell=r=>{let a;cR(r)?a=r.getPointsIds():a=r;const s=t.getNumberOfCells();return t.insertNextTuples([a.length,...a]),++e.numberOfCells,e.cellSizes!=null&&e.cellSizes.push(a.length),s},t.getMaxCellSize=()=>t.getCellSizes().reduce((r,a)=>Math.max(r,a),0)}function gR(t){return{empty:!0,numberOfComponents:1,dataType:Pe.UNSIGNED_INT,...t}}function kh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};xe.extend(t,e,gR(n)),uR(t,e)}const lR=E.newInstance(kh,"vtkCellArray");var yg={newInstance:lR,extend:kh,...fR};const{vtkErrorMacro:pR}=E;function hR(t,e){let n=0;e.classHierarchy.push("vtkPoints"),t.getNumberOfPoints=t.getNumberOfTuples,t.setNumberOfPoints=function(s){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;t.getNumberOfPoints()!==s&&(e.size=s*i,e.values=E.newTypedArray(e.dataType,e.size),t.setNumberOfComponents(i),t.modified())},t.setPoint=function(s){for(var i=arguments.length,o=new Array(i>1?i-1:0),c=1;c<i;c++)o[c-1]=arguments[c];t.setTuple(s,o)},t.getPoint=t.getTuple,t.findPoint=t.findTuple,t.insertNextPoint=(s,i,o)=>t.insertNextTuple([s,i,o]),t.insertPoint=(s,i)=>t.insertTuple(s,i);const r=t.getBounds;t.getBounds=()=>(n<e.mtime&&t.computeBounds(),r());const a=t.getBoundsByReference;t.getBoundsByReference=()=>(n<e.mtime&&t.computeBounds(),a()),t.computeBounds=()=>{if(t.getNumberOfComponents()===3){const s=t.getRange(0);e.bounds[0]=s[0],e.bounds[1]=s[1];const i=t.getRange(1);e.bounds[2]=i[0],e.bounds[3]=i[1];const o=t.getRange(2);e.bounds[4]=o[0],e.bounds[5]=o[1]}else if(t.getNumberOfComponents()===2){const s=t.getRange(0);e.bounds[0]=s[0],e.bounds[1]=s[1];const i=t.getRange(1);e.bounds[2]=i[0],e.bounds[3]=i[1],e.bounds[4]=0,e.bounds[5]=0}else pR(`getBounds called on an array with components of ${t.getNumberOfComponents()}`),af(e.bounds);n=E.getCurrentGlobalMTime()},t.setNumberOfComponents(e.numberOfComponents<2?3:e.numberOfComponents)}const dR={empty:!0,numberOfComponents:3,dataType:Pe.FLOAT,bounds:[1,-1,1,-1,1,-1]};function Gh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dR,n),xe.extend(t,e,n),E.getArray(t,e,["bounds"],6),hR(t,e)}const vR=E.newInstance(Gh,"vtkPoints");var $a={newInstance:vR,extend:Gh};function yR(t,e){e.classHierarchy.push("vtkCell"),t.initialize=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(r){e.pointsIds=r;let a=e.points.getData();a.length!==3*e.pointsIds.length&&(a=E.newTypedArray(n.getDataType(),3*e.pointsIds.length));const s=n.getData();e.pointsIds.forEach((i,o)=>{let c=3*i,u=3*o;a[u]=s[c],a[++u]=s[++c],a[++u]=s[++c]}),e.points.setData(a)}else{e.points=n,e.pointsIds=new Array(n.getNumberOfPoints());for(let a=n.getNumberOfPoints()-1;a>=0;--a)e.pointsIds[a]=a}},t.getBounds=()=>e.points.getBounds(),t.getLength2=()=>{const n=pe.getLengths(t.getBounds());return n[0]*n[0]+n[1]*n[1]+n[2]*n[2]},t.getParametricDistance=n=>{let r,a=0;for(let s=0;s<3;s++)n[s]<0?r=-n[s]:n[s]>1?r=n[s]-1:r=0,r>a&&(a=r);return a},t.getNumberOfPoints=()=>e.points.getNumberOfPoints(),t.deepCopy=n=>{n.initialize(e.points,e.pointsIds)},t.getCellDimension=()=>{},t.intersectWithLine=(n,r,a,s,i,o,c)=>{},t.evaluatePosition=(n,r,a,s,i,o)=>{E.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}const TR={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function bh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TR,n),E.obj(t,e),e.points||(e.points=$a.newInstance()),E.get(t,e,["points","pointsIds"]),yR(t,e)}const xR=E.newInstance(bh,"vtkCell");var Tr={newInstance:xR,extend:bh};function SR(t,e){let n=e;for(e>=t.array.length&&(n+=t.array.length);n>t.array.length;)t.array.push({ncells:0,cells:null});t.array.length=n}function CR(t,e){e.classHierarchy.push("vtkCellLinks"),t.buildLinks=n=>{const r=n.getPoints().getNumberOfPoints(),a=n.getNumberOfCells(),s=new Uint32Array(r);if(n.isA("vtkPolyData")){for(let i=0;i<a;++i){const{cellPointIds:o}=n.getCellPoints(i);o.forEach(c=>{t.incrementLinkCount(c)})}t.allocateLinks(r),e.maxId=r-1;for(let i=0;i<a;++i){const{cellPointIds:o}=n.getCellPoints(i);o.forEach(c=>{t.insertCellReference(c,s[c]++,i)})}}else{for(let i=0;i<a;i++)Tr.newInstance().getPointsIds().forEach(c=>{t.incrementLinkCount(c)});t.allocateLinks(r),e.maxId=r-1;for(let i=0;i<a;++i)Tr.newInstance().getPointsIds().forEach(c=>{t.insertCellReference(c,s[c]++,i)})}},t.allocate=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.array=Array(n).fill().map(()=>({ncells:0,cells:null})),e.extend=r,e.maxId=-1},t.initialize=()=>{e.array=null},t.getLink=n=>e.array[n],t.getNcells=n=>e.array[n].ncells,t.getCells=n=>e.array[n].cells,t.insertNextPoint=n=>{e.array.push({ncells:n,cells:Array(n)}),++e.maxId},t.insertNextCellReference=(n,r)=>{e.array[n].cells[e.array[n].ncells++]=r},t.deletePoint=n=>{e.array[n].ncells=0,e.array[n].cells=null},t.removeCellReference=(n,r)=>{e.array[r].cells=e.array[r].cells.filter(a=>a!==n),e.array[r].ncells=e.array[r].cells.length},t.addCellReference=(n,r)=>{e.array[r].cells[e.array[r].ncells++]=n},t.resizeCellList=(n,r)=>{e.array[n].cells.length=r},t.squeeze=()=>{SR(e,e.maxId+1)},t.reset=()=>{e.maxId=-1},t.deepCopy=n=>{e.array=[...n.array],e.extend=n.extend,e.maxId=n.maxId},t.incrementLinkCount=n=>{++e.array[n].ncells},t.allocateLinks=n=>{for(let r=0;r<n;++r)e.array[r].cells=new Array(e.array[r].ncells)},t.insertCellReference=(n,r,a)=>{e.array[n].cells[r]=a}}const wR={array:null,maxId:0,extend:0};function $h(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wR,n),E.obj(t,e),CR(t,e)}const ER=E.newInstance($h,"vtkCellLinks");var RR={newInstance:ER,extend:$h};const he={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_QUAD:9,VTK_QUADRATIC_EDGE:21,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42},cc=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function OR(t){return t<cc.length?cc[t]:"UnknownClass"}function MR(t){return cc.findIndex(t)}function DR(t){return t<he.VTK_QUADRATIC_EDGE||t===he.VTK_CONVEX_POINT_SET||t===he.VTK_POLYHEDRON}function LR(t){return t===he.VTK_TRIANGLE_STRIP||t===he.VTK_POLY_LINE||t===he.VTK_POLY_VERTEX}const mR={getClassNameFromTypeId:OR,getTypeIdFromClassName:MR,isLinear:DR,hasSubCells:LR};function VR(t,e){e.classHierarchy.push("vtkCellTypes"),t.allocate=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.size=n>0?n:1,e.extend=r>0?r:1,e.maxId=-1,e.typeArray=new Uint8Array(n),e.locationArray=new Uint32Array(n)},t.insertCell=(n,r,a)=>{e.typeArray[n]=r,e.locationArray[n]=a,n>e.maxId&&(e.maxId=n)},t.insertNextCell=(n,r)=>(t.insertCell(++e.maxId,n,r),e.maxId),t.setCellTypes=(n,r,a)=>{e.size=n,e.typeArray=r,e.locationArray=a,e.maxId=n-1},t.getCellLocation=n=>e.locationArray[n],t.deleteCell=n=>{e.typeArray[n]=he.VTK_EMPTY_CELL},t.getNumberOfTypes=()=>e.maxId+1,t.isType=n=>{const r=t.getNumberOfTypes();for(let a=0;a<r;++a)if(n===t.getCellType(a))return!0;return!1},t.insertNextType=n=>t.insertNextCell(n,-1),t.getCellType=n=>e.typeArray[n],t.reset=()=>{e.maxId=-1},t.deepCopy=n=>{t.allocate(n.getSize(),n.getExtend()),e.typeArray.set(n.getTypeArray()),e.locationArray.set(n.getLocationArray()),e.maxId=n.getMaxId()}}const FR={size:0,maxId:-1,extend:1e3};function Wh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,FR,n),E.obj(t,e),E.get(t,e,["size","maxId","extend"]),E.getArray(t,e,["typeArray","locationArray"]),VR(t,e)}const BR=E.newInstance(Wh,"vtkCellTypes");var _R={newInstance:BR,extend:Wh,...mR};const zh={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2};var Hh={IntersectionState:zh};const{IntersectionState:Ws}=Hh;function Vr(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;const a={t:Number.MIN_VALUE,distance:0},s=[];let i;s[0]=n[0]-e[0],s[1]=n[1]-e[1],s[2]=n[2]-e[2];const o=s[0]*(t[0]-e[0])+s[1]*(t[1]-e[1])+s[2]*(t[2]-e[2]),c=ee(s,s);let u=1e-5*o;return c!==0&&(a.t=o/c),u<0&&(u=-u),-u<c&&c<u||c<=0||a.t<0?i=e:a.t>1?i=n:(i=s,s[0]=e[0]+a.t*s[0],s[1]=e[1]+a.t*s[1],s[2]=e[2]+a.t*s[2]),r&&(r[0]=i[0],r[1]=i[1],r[2]=i[2]),a.distance=Tt(i,t),a}function Ah(t,e,n,r,a,s){const i=[],o=[],c=[];a[0]=0,s[0]=0,ze(e,t,i),ze(r,n,o),ze(n,t,c);const u=[ee(i,i),-ee(i,o),-ee(i,o),ee(o,o)],g=[];if(g[0]=ee(i,c),g[1]=-ee(o,c),Mp(u,g,2)===0){let f=Number.MAX_VALUE;const l=[t,e,n,r],p=[n,n,t,t],v=[r,r,e,e];s[0],s[0],a[0],a[0],a[0],a[0],s[0],s[0];let h;for(let d=0;d<4;d++)h=Vr(l[d],p[d],v[d]),h.distance<f&&(f=h.distance,h.t);return Ws.ON_LINE}return a[0]=g[0],s[0]=g[1],a[0]>=0&&a[0]<=1&&s[0]>=0&&s[0]<=1?Ws.YES_INTERSECTION:Ws.NO_INTERSECTION}const UR={distanceToLine:Vr,intersection:Ah};function NR(t,e){e.classHierarchy.push("vtkLine");function n(r){return r>=0&&r<=1}t.getCellDimension=()=>1,t.intersectWithLine=(r,a,s,i,o)=>{const c={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};o[1]=0,o[2]=0;const u=[],g=[],f=[];e.points.getPoint(0,g),e.points.getPoint(1,f);const l=[],p=[],v=Ah(r,a,g,f,l,p);if(c.t=l[0],c.betweenPoints=n(c.t),o[0]=p[0],v===Ws.YES_INTERSECTION){for(let h=0;h<3;h++)i[h]=g[h]+o[0]*(f[h]-g[h]),u[h]=r[h]+c.t*(a[h]-r[h]);if(Tt(i,u)<=s*s)return c.intersect=1,c}else{let h;if(c.t<0)return h=Vr(r,g,f,i),h.distance<=s*s&&(c.t=0,c.intersect=1,c.betweenPoints=!0),c;if(c.t>1)return h=Vr(a,g,f,i),h.distance<=s*s&&(c.t=1,c.intersect=1,c.betweenPoints=!0),c;if(o[0]<0)return o[0]=0,h=Vr(g,r,a,i),c.t=h.t,h.distance<=s*s&&(c.intersect=1),c;if(o[0]>1)return o[0]=1,h=Vr(f,r,a,i),c.t=h.t,h.distance<=s*s&&(c.intersect=1),c}return c},t.evaluateLocation=(r,a,s)=>{const i=[],o=[];e.points.getPoint(0,i),e.points.getPoint(1,o);for(let c=0;c<3;c++)a[c]=i[c]+r[0]*(o[c]-i[c]);s[0]=1-r[0],s[1]=r[0]},t.evaluateOrientation=(r,a,s)=>e.orientations?(Ls(a,e.orientations[0],e.orientations[1],r[0]),s[0]=1-r[0],s[1]=r[0],!0):!1}const kR={orientations:null};function jh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kR,n),Tr.extend(t,e,n),E.setGet(t,e,["orientations"]),NR(t,e)}const GR=E.newInstance(jh,"vtkLine");var et={newInstance:GR,extend:jh,...UR,...Hh};function bR(t,e){e.classHierarchy.push("vtkPointSet"),e.points?e.points=Gt(e.points):e.points=$a.newInstance(),t.getNumberOfPoints=()=>e.points.getNumberOfPoints(),t.getBounds=()=>e.points.getBounds(),t.computeBounds=()=>{t.getBounds()};const n=t.shallowCopy;t.shallowCopy=function(s){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(s,i),e.points=$a.newInstance(),e.points.shallowCopy(s.getPoints())};const r=t.getMTime;t.getMTime=()=>{const s=r();return Math.max(s,e.points?.getMTime()??s)};const a=t.initialize;t.initialize=()=>(e.points?.initialize(),a())}const $R={};function Kh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$R,n),Sr.extend(t,e,n),E.setGet(t,e,["points"]),bR(t,e)}const WR=E.newInstance(Kh,"vtkPointSet");var zR={newInstance:WR,extend:Kh};function HR(t,e){e.classHierarchy.push("vtkPolyLine");const n=et.newInstance();n.getPoints().setNumberOfPoints(2),t.getCellDimension=()=>1,t.intersectWithLine=(r,a,s,i,o,c,u)=>{const g={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null},f=t.getNumberOfPoints()-1;let l=Number.MAX_VALUE;for(let p=0;p<f;p++){const v=[0,0,0];n.getPoints().getData().set(e.points.getData().subarray(3*p,3*(p+2)));const h=n.intersectWithLine(s,i,o,c,u);if(h.intersect===1&&h.t<=g.t+o&&h.t>=r&&h.t<=a){g.intersect=1;const d=n.getParametricDistance(v);if(d<l||d===l&&h.t<g.t){g.subId=p,g.t=h.t,l=d;for(let T=0;T<3;T++)c[T],v[T]}}}return g},t.evaluateLocation=(r,a,s,i)=>(n.getPoints().getData().set(e.points.getData().subarray(3*r,3*(r+2))),n.evaluateLocation(a,s,i)),t.evaluateOrientation=(r,a,s,i)=>(e.orientations?n.setOrientations([e.orientations[r],e.orientations[r+1]]):n.setOrientations(null),n.evaluateOrientation(a,s,i)),t.getDistancesToFirstPoint=()=>{const r=e.distancesTime.getMTime();if(r<e.points.getMTime()||r<t.getMTime()){const a=t.getNumberOfPoints();if(e.distances?e.distances.length=a:e.distances=new Array(a),a>0){const s=new Array(3),i=new Array(3);let o=0;e.distances[0]=o,e.points.getPoint(0,s);for(let c=1;c<a;++c)e.points.getPoint(c,i),o+=e.distanceFunction(s,i),e.distances[c]=o,Cx(s,i)}e.distancesTime.modified()}return e.distances},t.findPointIdAtDistanceFromFirstPoint=r=>{const a=t.getDistancesToFirstPoint();if(a.length<2)return-1;let s=0,i=a.length-1;if(r<a[s]||r>a[i]||a[i]===0)return-1;for(;i-s>1;){const o=Math.floor((s+i)/2);a[o]<=r?s=o:i=o}return s}}const AR={orientations:null,distanceFunction:Rx};function Ph(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AR,n),Tr.extend(t,e,n),E.setGet(t,e,["orientations","distanceFunction"]),e.distancesTime={},E.obj(e.distancesTime,{mtime:0}),HR(t,e)}const jR=E.newInstance(Ph,"vtkPolyLine");var KR={newInstance:jR,extend:Ph};function PR(t,e){e.classHierarchy.push("vtkPriorityQueue"),t.push=(n,r)=>{const a=e.elements.findIndex(s=>s.priority>n);e.elements.splice(a,0,{priority:n,element:r})},t.pop=()=>e.elements.length>0?e.elements.shift().element:null,t.deleteById=n=>{e.elements=e.elements.filter(r=>{let{element:a}=r;return a.id!==n})},t.length=()=>e.elements.length}const XR={elements:[]};function Xh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XR,n),E.obj(t,e),PR(t,e)}const IR=E.newInstance(Xh,"vtkPriorityQueue");var YR={newInstance:IR,extend:Xh};const us=1e-6,Tg=11920929e-14,qR=1e-8,ar={FAILURE:-1,OUTSIDE:0,INSIDE:1,INTERSECTION:2,ON_LINE:3};function xg(t,e,n,r,a){return(r[t]-n[t])*(a[e]-n[e])-(a[t]-n[t])*(r[e]-n[e])}function QR(t,e,n,r){if(t[0]<n[0]||t[0]>n[1]||t[1]<n[2]||t[1]>n[3]||t[2]<n[4]||t[2]>n[5])return ar.OUTSIDE;if(Rt(r)<=Tg)return ar.FAILURE;let a=qR*((n[1]-n[0])*(n[1]-n[0])+(n[3]-n[2])*(n[3]-n[2])+(n[5]-n[4])*(n[5]-n[4]));a*=a,a=a===0?Tg:a;const s=[],i=[];for(let g=0;g<e.length;){if(s[0]=e[g++],s[1]=e[g++],s[2]=e[g++],Tt(t,s)<=a)return ar.INSIDE;const{distance:f,t:l}=et.distanceToLine(t,s,i);if(f<=a&&l>0&&l<1)return ar.INSIDE}let o,c;Math.abs(r[0])>Math.abs(r[1])?Math.abs(r[0])>Math.abs(r[2])?(o=1,c=2):(o=0,c=1):Math.abs(r[1])>Math.abs(r[2])?(o=0,c=2):(o=0,c=1);let u=0;for(let g=0;g<e.length;)s[0]=e[g++],s[1]=e[g++],s[2]=e[g++],g<e.length?(i[0]=e[g],i[1]=e[g+1],i[2]=e[g+2]):(i[0]=e[0],i[1]=e[1],i[2]=e[2]),s[c]<=t[c]?i[c]>t[c]&&xg(o,c,s,i,t)>0&&++u:i[c]<=t[c]&&xg(o,c,s,i,t)<0&&--u;return u===0?ar.OUTSIDE:ar.INSIDE}function ZR(t,e,n){const r=t.length,a=[];e.getPoint(t[0],a),n[0]=a[0],n[1]=a[0],n[2]=a[1],n[3]=a[1],n[4]=a[2],n[5]=a[2];for(let i=1;i<r;i++)e.getPoint(t[i],a),pe.addPoint(n,...a);const s=pe.getLengths(n);return ee(s,s)}function JR(t,e,n){n.length=3,n[0]=0,n[1]=0,n[2]=0;const r=[];let a=[],s=[];const i=[],o=[];e.getPoint(t[0],r),e.getPoint(t[1],a);for(let c=2;c<t.length;c++){e.getPoint(t[c],s),ze(s,a,i),ze(r,a,o);const u=[0,0,0];gt(i,o,u),Hr(n,u,n),[a,s]=[s,a]}return Rt(n)}function eO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,0];n[0]=0,n[1]=0,n[2]=0;const r=t.length,a=[];for(let s=0;s<r;s++)e.getPoint(t[s],a),n[0]+=a[0],n[1]+=a[1],n[2]+=a[2];return n[0]/=r,n[1]/=r,n[2]/=r,n}const tO={PolygonWithPointIntersectionState:ar,pointInPolygon:QR,getBounds:ZR,getNormal:JR,computeCentroid:eO};function nO(t,e){e.classHierarchy.push("vtkPolygon");function n(){const o=[0,0,0],c=[0,0,0];e.normal=[0,0,0];const u=[...e.firstPoint.point];let g=e.firstPoint;for(let f=0;f<e.pointCount;f++){ze(g.point,u,o),ze(g.next.point,u,c);const l=[0,0,0];gt(o,c,l),Hr(e.normal,l,e.normal),g=g.next}return Rt(e.normal)}function r(o){const c=[0,0,0],u=[0,0,0],g=[0,0,0],f=[0,0,0];ze(o.point,o.previous.point,c),ze(o.next.point,o.point,u),ze(o.previous.point,o.next.point,g),gt(c,u,f);const l=ee(f,e.normal);if(l<=0)return-1;const p=Et(c)+Et(u)+Et(g);return p*p/l}function a(o){if(e.pointCount<=3)return!0;const c=o.previous,u=o.next,g=[0,0,0];ze(u.point,c.point,g);const f=[0,0,0];if(gt(g,e.normal,f),Rt(f),Et(f)===0)return!1;let l=jn.evaluate(f,c.point,u.next.point),p=l>us?1:l<-us?-1:0,v=p<0?1:0;for(let h=u.next.next;h.id!==c.id;h=h.next){const d=h.previous;l=jn.evaluate(f,c.point,h.point);const T=l>us?1:l<-us?-1:0;if(T!==p){if(v||(v=T<=0?1:0),et.intersection(c.point,u.point,h.point,d.point,[0],[0])===zh.YES_INTERSECTION)return!1;p=T}}return v===1}function s(o,c){e.pointCount-=1;const u=o.previous,g=o.next;e.tris=e.tris.concat(o.point),e.tris=e.tris.concat(g.point),e.tris=e.tris.concat(u.point),u.next=g,g.previous=u,c.deleteById(u.id),c.deleteById(g.id);const f=r(u);f>0&&c.push(f,u);const l=r(g);l>0&&c.push(l,g),o.id===e.firstPoint.id&&(e.firstPoint=g)}function i(){n();const o=YR.newInstance();let c=e.firstPoint;for(let u=0;u<e.pointCount;u++){const g=r(c);g>0&&o.push(g,c),c=c.next}for(;e.pointCount>2&&o.length()>0;)if(e.pointCount===o.length()){const u=o.pop();s(u,o)}else{const u=o.pop();a(u)&&s(u,o)}return e.pointCount<=2}t.triangulate=()=>e.firstPoint?i():null,t.setPoints=o=>{e.pointCount=o.length,e.firstPoint={id:0,point:o[0],next:null,previous:null};let c=e.firstPoint;for(let u=1;u<e.pointCount;u++)c.next={id:u,point:o[u],next:null,previous:c},c=c.next;e.firstPoint.previous=c,c.next=e.firstPoint},t.getPointArray=()=>e.tris}const rO={firstPoint:null,pointCount:0,tris:[]};function Ih(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rO,n),E.obj(t,e),nO(t,e)}const aO=E.newInstance(Ih,"vtkPolygon");var sO={newInstance:aO,extend:Ih,...tO};function Tf(t,e,n,r){const a=n[0]-e[0],s=n[1]-e[1],i=n[2]-e[2],o=t[0]-e[0],c=t[1]-e[1],u=t[2]-e[2];r[0]=s*u-i*c,r[1]=i*o-a*u,r[2]=a*c-s*o}function Wa(t,e,n,r){Tf(t,e,n,r);const a=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);a!==0&&(r[0]/=a,r[1]/=a,r[2]/=a)}function Yh(t){t[0]=-1,t[1]=1,t[2]=0,t[3]=-1,t[4]=0,t[5]=1}function iO(t,e,n,r,a,s){let i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,o=!1;const c=[],u=[],g=[],f=[],l=[];Wa(t,e,n,f),Wa(r,a,s,l);const p=-ee(f,t),v=-ee(l,r),h=[ee(l,t)+v,ee(l,e)+v,ee(l,n)+v];if(h[0]*h[1]>i&&h[0]*h[2]>i)return{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g};const d=[ee(f,r)+p,ee(f,a)+p,ee(f,s)+p];if(d[0]*d[1]>i&&d[0]*d[2]>i)return{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g};if(Math.abs(f[0]-l[0])<1e-9&&Math.abs(f[1]-l[1])<1e-9&&Math.abs(f[2]-l[2])<1e-9&&Math.abs(p-v)<1e-9)return o=!0,{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g};const T=[t,e,n],S=[r,a,s],x=ee(f,l),y=(p-v*x)/(x*x-1),C=(v-p*x)/(x*x-1),w=[y*f[0]+C*l[0],y*f[1]+C*l[1],y*f[2]+C*l[2]],R=gt(f,l,[]);Rt(R);let O=0,V=0;const L=[],m=[];let F=50,B=50;for(let z=0;z<3;z++){const A=z,I=(z+1)%3,k=jn.intersectWithLine(T[A],T[I],r,l);k.intersection&&k.t>0-i&&k.t<1+i&&(k.t<1+i&&k.t>1-i&&(F=O),L[O++]=ee(k.x,R)-ee(w,R));const Y=jn.intersectWithLine(S[A],S[I],t,f);Y.intersection&&Y.t>0-i&&Y.t<1+i&&(Y.t<1+i&&Y.t>1-i&&(B=V),m[V++]=ee(Y.x,R)-ee(w,R))}if(O>2){O--;const z=L[2];L[2]=L[F],L[F]=z}if(V>2){V--;const z=m[2];m[2]=m[B],m[B]=z}if(O!==2||V!==2)return{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g};if(Number.isNaN(L[0])||Number.isNaN(L[1])||Number.isNaN(m[0])||Number.isNaN(m[1]))return{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g};if(L[0]>L[1]){const z=L[1];L[1]=L[0],L[0]=z}if(m[0]>m[1]){const z=m[1];m[1]=m[0],m[0]=z}let _,P;return L[1]<m[0]||m[1]<L[0]?{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g}:(L[0]<m[0]?L[1]<m[1]?(g[0]=2,g[1]=1,_=m[0],P=L[1]):(g[0]=2,g[1]=2,_=m[0],P=m[1]):L[1]<m[1]?(g[0]=1,g[1]=1,_=L[0],P=L[1]):(g[0]=1,g[1]=2,_=L[0],P=m[1]),Io(w,R,_,c),Io(w,R,P,u),{intersect:!0,coplanar:o,pt1:c,pt2:u,surfaceId:g})}const oO={computeNormalDirection:Tf,computeNormal:Wa,interpolationDerivs:Yh,intersectWithTriangle:iO};function cO(t,e){e.classHierarchy.push("vtkTriangle"),t.getCellDimension=()=>2,t.intersectWithLine=(n,r,a,s,i)=>{const o={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};i[2]=0;const c=[],u=a*a,g=[],f=[],l=[];e.points.getPoint(0,g),e.points.getPoint(1,f),e.points.getPoint(2,l);const p=[],v=[];if(Wa(g,f,l,p),p[0]!==0||p[1]!==0||p[2]!==0){const x=jn.intersectWithLine(n,r,g,p);if(o.betweenPoints=x.betweenPoints,o.t=x.t,s[0]=x.x[0],s[1]=x.x[1],s[2]=x.x[2],!x.intersection)return i[0]=0,i[1]=0,o.intersect=0,o;const y=t.evaluatePosition(s,c,i,v);if(y.evaluation>=0)return y.dist2<=u?(o.intersect=1,o):(o.intersect=y.evaluation,o)}const h=Tt(g,f),d=Tt(f,l),T=Tt(l,g);e.line||(e.line=et.newInstance()),h>d&&h>T?(e.line.getPoints().setPoint(0,g),e.line.getPoints().setPoint(1,f)):d>T&&d>h?(e.line.getPoints().setPoint(0,f),e.line.getPoints().setPoint(1,l)):(e.line.getPoints().setPoint(0,l),e.line.getPoints().setPoint(1,g));const S=e.line.intersectWithLine(n,r,a,s,i);if(o.betweenPoints=S.betweenPoints,o.t=S.t,S.intersect){const x=[],y=[],C=[];for(let w=0;w<3;w++)x[w]=g[w]-l[w],y[w]=f[w]-l[w],C[w]=s[w]-l[w];return i[0]=ee(C,x)/T,i[1]=ee(C,y)/d,o.intersect=1,o}return i[0]=0,i[1]=0,o.intersect=0,o},t.evaluatePosition=(n,r,a,s)=>{const i={subId:0,dist2:0,evaluation:-1};let o,c;const u=[],g=[],f=[],l=[];let p;const v=[],h=[],d=[];let T=0,S=0;const x=[];let y,C,w,R=[];const O=[],V=[],L=[];i.subId=0,a[2]=0,e.points.getPoint(1,u),e.points.getPoint(2,g),e.points.getPoint(0,f),Tf(u,g,f,l),jn.generalizedProjectPoint(n,u,l,L);let m=0;for(o=0;o<3;o++)l[o]<0?p=-l[o]:p=l[o],p>m&&(m=p,S=o);for(c=0,o=0;o<3;o++)o!==S&&(x[c++]=o);for(o=0;o<2;o++)v[o]=L[x[o]]-f[x[o]],h[o]=u[x[o]]-f[x[o]],d[o]=g[x[o]]-f[x[o]];if(T=me(h,d),T===0)return a[0]=0,a[1]=0,i.evaluation=-1,i;if(a[0]=me(v,d)/T,a[1]=me(h,v)/T,s[0]=1-(a[0]+a[1]),s[1]=a[0],s[2]=a[1],s[0]>=0&&s[0]<=1&&s[1]>=0&&s[1]<=1&&s[2]>=0&&s[2]<=1)r&&(i.dist2=Tt(L,n),r[0]=L[0],r[1]=L[1],r[2]=L[2]),i.evaluation=1;else{let F;if(r){if(s[1]<0&&s[2]<0)for(y=Tt(n,f),C=et.distanceToLine(n,u,f,F,O),w=et.distanceToLine(n,f,g,F,V),y<C?(i.dist2=y,R=f):(i.dist2=C,R=O),w<i.dist2&&(i.dist2=w,R=V),o=0;o<3;o++)r[o]=R[o];else if(s[2]<0&&s[0]<0)for(y=Tt(n,u),C=et.distanceToLine(n,u,f,F,O),w=et.distanceToLine(n,u,g,F,V),y<C?(i.dist2=y,R=u):(i.dist2=C,R=O),w<i.dist2&&(i.dist2=w,R=V),o=0;o<3;o++)r[o]=R[o];else if(s[1]<0&&s[0]<0)for(y=Tt(n,g),C=et.distanceToLine(n,g,f,F,O),w=et.distanceToLine(n,u,g,F,V),y<C?(i.dist2=y,R=g):(i.dist2=C,R=O),w<i.dist2&&(i.dist2=w,R=V),o=0;o<3;o++)r[o]=R[o];else if(s[0]<0){const B=et.distanceToLine(n,u,g,r);i.dist2=B.distance}else if(s[1]<0){const B=et.distanceToLine(n,g,f,r);i.dist2=B.distance}else if(s[2]<0){const B=et.distanceToLine(n,u,f,r);i.dist2=B.distance}}i.evaluation=0}return i},t.evaluateLocation=(n,r,a)=>{const s=[],i=[],o=[];e.points.getPoint(0,s),e.points.getPoint(1,i),e.points.getPoint(2,o);const c=1-n[0]-n[1];for(let u=0;u<3;u++)r[u]=s[u]*c+i[u]*n[0]+o[u]*n[1];a[0]=c,a[1]=n[0],a[2]=n[1]},t.getParametricDistance=n=>{let r,a=0;const s=[];s[0]=n[0],s[1]=n[1],s[2]=1-n[0]-n[1];for(let i=0;i<3;i++)s[i]<0?r=-s[i]:s[i]>1?r=s[i]-1:r=0,r>a&&(a=r);return a},t.derivatives=(n,r,a,s,i)=>{const o=e.points.getPoint(0),c=e.points.getPoint(1),u=e.points.getPoint(2),g=[],f=[],l=[],p=[];Wa(o,c,u,g),ze(c,o,f),ze(u,o,p),gt(g,f,l);const v=Rt(f);if(v<=0||Rt(l)<=0){for(let C=0;C<s;C++)for(let w=0;w<3;w++)i[C*s+w]=0;return}const h=[0,0],d=[v,0],T=[ee(p,f),ee(p,l)],S=new Array(6);Yh(S);const x=[d[0]-h[0],d[1]-h[1],T[0]-h[0],T[1]-h[1]],y=E.newTypedArray(Ze.Float64Array,4);rf(x,y,2);for(let C=0;C<s;C++){let w=0,R=0;for(let L=0;L<3;L++)w+=S[L]*a[s*L+C],R+=S[3+L]*a[s*L+C];const O=w*y[0]+R*y[1],V=w*y[2]+R*y[3];i[3*C]=O*f[0]+V*l[0],i[3*C+1]=O*f[1]+V*l[1],i[3*C+2]=O*f[2]+V*l[2]}},t.cellBoundary=(n,r,a)=>{const s=r[0]-r[1],i=.5*(1-r[0])-r[1],o=2*r[0]+r[1]-1;return s>=0&&i>=0?(a[0]=e.pointsIds[0],a[1]=e.pointsIds[1]):i<0&&o>=0?(a[0]=e.pointsIds[1],a[1]=e.pointsIds[2]):(a[0]=e.pointsIds[2],a[1]=e.pointsIds[0]),!(r[0]<0||r[1]<0||r[0]>1||r[1]>1||1-r[0]-r[1]<0)}}const fO={};function qh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fO,n),Tr.extend(t,e,n),cO(t,e)}const uO=E.newInstance(qh,"vtkTriangle");var mi={newInstance:uO,extend:qh,...oO};function Sg(){return{intersected:!1,subId:-1,x:[0,0,0],pCoords:[0,0,0],t:-1}}function gO(t,e){e.classHierarchy.push("vtkQuad"),t.getCellDimension=()=>2,t.getCellType=()=>he.VTK_QUAD,t.getNumberOfEdges=()=>4,t.getNumberOfFaces=()=>0,t.intersectWithLine=(n,r,a,s,i)=>{let o={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1},c;const u=e.points.getPoint(0,[]),g=e.points.getPoint(1,[]),f=e.points.getPoint(2,[]),l=e.points.getPoint(3,[]),p=Tt(u,f),v=Tt(g,l);if(p===v){let w,R=0,O=0;for(let V=0;V<4;V++)w=e.pointsIds[V],w>R&&(R=w,O=V);O===0||O===2?c=0:c=1}else p<v?c=0:c=1;let h=null;e.triangle?h=e.triangle.getPoints():(e.triangle=mi.newInstance(),h=$a.newInstance(),h.setNumberOfPoints(3),e.triangle.initialize(h));let d;const T=Sg();let S;const x=Sg();let y,C;switch(c){case 0:h.setPoint(0,...u),h.setPoint(1,...g),h.setPoint(2,...f),d=e.triangle.intersectWithLine(n,r,a,T.x,T.pCoords),h.setPoint(0,...f),h.setPoint(1,...l),h.setPoint(2,...u),S=e.triangle.intersectWithLine(n,r,a,x.x,x.pCoords),y=d.intersect&&S.intersect?d.t<=S.t:d.intersect,C=d.intersect&&S.intersect?S.t<d.t:S.intersect,y?(o=d,s[0]=T.x[0],s[1]=T.x[1],s[2]=T.x[2],i[0]=T.pCoords[0]+T.pCoords[1],i[1]=T.pCoords[1],i[2]=T.pCoords[2]):C&&(o=S,s[0]=x.x[0],s[1]=x.x[1],s[2]=x.x[2],i[0]=1-(x.pCoords[0]+x.pCoords[1]),i[1]=1-x.pCoords[1],i[2]=x.pCoords[2]);break;case 1:h.setPoint(0,...u),h.setPoint(1,...g),h.setPoint(2,...l),d=e.triangle.intersectWithLine(n,r,a,T.x,T.pCoords),h.setPoint(0,...f),h.setPoint(1,...l),h.setPoint(2,...g),S=e.triangle.intersectWithLine(n,r,a,x.x,x.pCoords),y=d.intersect&&S.intersect?d.t<=S.t:d.intersect,C=d.intersect&&S.intersect?S.t<d.t:S.intersect,y?(o=d,s[0]=T.x[0],s[1]=T.x[1],s[2]=T.x[2],i[0]=T.pCoords[0],i[1]=T.pCoords[1],i[2]=T.pCoords[2]):C&&(o=S,s[0]=x.x[0],s[1]=x.x[1],s[2]=x.x[2],i[0]=1-x.pCoords[0],i[1]=1-x.pCoords[1],i[2]=x.pCoords[2]);break}return o},t.interpolationFunctions=(n,r)=>{const a=1-n[0],s=1-n[1];r[0]=a*s,r[1]=n[0]*s,r[2]=n[0]*n[1],r[3]=a*n[1]},t.evaluateLocation=(n,r,a)=>{const s=[];t.interpolationFunctions(n,a),r[0]=0,r[1]=0,r[2]=0;for(let i=0;i<4;i++){e.points.getPoint(i,s);for(let o=0;o<3;o++)r[o]+=s[o]*a[i]}}}const lO={};function Qh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lO,n),Tr.extend(t,e,n),gO(t,e)}const pO=E.newInstance(Qh,"vtkQuad");var hO={newInstance:pO,extend:Qh};const{vtkErrorMacro:Zh}=E;function Cg(t){return()=>Zh(`vtkTriangleStrip.${t} - NOT IMPLEMENTED`)}function dO(t,e){if(!Array.isArray(t)||t.length<3){Zh("decomposeStrip - Invalid points array");return}let n=t[0],r=t[1];for(let a=0;a<t.length-2;a++){const s=t[a+2];a%2?e.insertNextCell([r,n,s]):e.insertNextCell([n,r,s]),n=r,r=s}}const vO={decomposeStrip:dO};function yO(t,e){e.classHierarchy.push("vtkTriangleStrip");const n=t.initialize;t.initialize=(r,a)=>{e.triangle.initialize(r,a),n(r,a)},t.getCellType=()=>he.VTK_TRIANGLE_STRIP,t.getCellDimension=()=>2,t.getNumberOfEdges=()=>e.pointsIds.length,t.getNumberOfFaces=()=>0,t.evaluatePosition=(r,a,s,i,o)=>{const c=[0,0,0];let u=Number.MAX_VALUE,g=0;const f=[],l=[],p=[];s[2]=0,l[0]=0,l[1]=0,l[2]=0;const v=e.triangle.getPoints();v.setNumberOfPoints(3);const d=e.triangle.getPointsIds().length;for(let T=0;T<d;T++)o[T]=0;for(let T=0;T<d-2;T++){const S=[];v.getPoint(T,S);const x=[];v.getPoint(T+1,x);const y=[];v.getPoint(T+2,y),v.setData(Float32Array.from([...S,...x,...y]),3);const C=e.triangle.evaluatePosition(r,p,c,f),w=C.dist2;C.evaluation>=0&&(w<u||w===u&&g===0)&&(g=C,a&&(a[0]=p[0],a[1]=p[1],a[2]=p[2]),s[0]=c[0],s[1]=c[1],u=w,l[0]=f[0],l[1]=f[1],l[2]=f[2])}return i[0]=u,o[0]=l[0],o[1]=l[1],o[2]=l[2],g},t.evaluateLocation=(r,a,s,i)=>{const o=[[0,1,2],[1,0,2]],c=r%2,u=e.pointsIds.length;for(let v=0;v<u;v++)i[v]=0;const g=1-a[0]-a[1];i[r]=g,i[r+1]=a[0],i[r+2]=a[1];const f=[];e.points.getPoint(r+o[c][0],f);const l=[];e.points.getPoint(r+o[c][1],l);const p=[];e.points.getPoint(r+o[c][2],p);for(let v=0;v<3;v++)s[v]=f[v]*i[r]+l[v]*i[r+1]+p[v]*i[r+2]},t.cellBoundary=(r,a,s)=>{const i=[[0,1,2],[1,0,2]],o=r%2,c=e.triangle.getPointsIds();return c[0]=e.pointsIds[i[o][0]],c[1]=e.pointsIds[i[o][1]],c[2]=e.pointsIds[i[o][2]],e.triangle.cellBoundary(0,a,s)},t.getEdge=r=>{let a,s;const i=e.pointsIds.length;return r===0?(a=0,s=1):r===i-1?(a=r-1,s=r):(a=r-1,s=r+1),e.line.getPointsIds()[0]=e.pointsIds[a],e.line.getPointsIds()[1]=e.pointsIds[s],e.line.getPoints().setPoint(0,e.points.getPoint(a)),e.line.getPoints().setPoint(1,e.points.getPoint(s)),e.line},t.intersectWithLine=(r,a,s,i,o)=>{const c=e.pointsIds.length-2,u=e.triangle.getPoints();u.setNumberOfPoints(3);for(let g=0;g<c;g++){const f=[];e.points.getPoint(e.pointsIds[g],f);const l=[];e.points.getPoint(e.pointsIds[g+1],l);const p=[];e.points.getPoint(e.pointsIds[g+2],p),u.setData(Float32Array.from([...f,...l,...p]),3);const v=e.triangle.intersectWithLine(r,a,s,i,o);if(v.intersect)return v}return!1},t.triangulate=()=>{const r=e.points.getNumberOfPoints()-2;e.tris=new Array(3*r);const a=[[0,1,2],[1,0,2]];for(let s=0;s<r;s++){const i=s%2;for(let o=0;o<3;o++)e.tris[s*3+o]=s+a[i][o]}return!0},t.getPointArray=()=>e.tris,t.derivatives=(r,a,s,i,o)=>{const c=[];e.points.getPoint(r,c);const u=[];e.points.getPoint(r+1,u);const g=[];e.points.getPoint(r+2,g);const f=e.triangle.getPoints();f.setPoint(0,...c),f.setPoint(1,...u),f.setPoint(2,...g),e.triangle.derivatives(0,a,s,i,o)},t.getParametricCenter=r=>(r[0]=.333333,r[1]=.333333,r[2]=0,Math.floor((e.pointsIds.length-2)/2)),t.contour=(r,a,s,i,o,c,u,g,f,l,p)=>Cg("contour")(),t.clip=(r,a,s,i,o,c,u,g,f,l)=>Cg("clip")()}const TO={line:null,triangle:null,tris:null};function Jh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TO,n),Tr.extend(t,e,n),e.line||(e.line=et.newInstance()),e.triangle||(e.triangle=mi.newInstance()),yO(t,e)}const xO=E.newInstance(Jh,"vtkTriangleStrip");var SO={newInstance:xO,extend:Jh,...vO};const Er=["verts","lines","polys","strips"],{vtkWarningMacro:wg}=E,CO={[he.VTK_LINE]:et,[he.VTK_QUAD]:hO,[he.VTK_POLY_LINE]:et,[he.VTK_TRIANGLE]:mi,[he.VTK_TRIANGLE_STRIP]:SO,[he.VTK_POLY_LINE]:KR,[he.VTK_POLYGON]:sO};function wO(t,e){e.classHierarchy.push("vtkPolyData");function n(o){return o.replace(/(?:^\w|[A-Z]|\b\w)/g,c=>c.toUpperCase()).replace(/\s+/g,"")}function r(){e.cells=void 0,e.links=void 0}Er.forEach(o=>{t[`getNumberOf${n(o)}`]=()=>e[o].getNumberOfCells(),e[o]?e[o]=Gt(e[o]):e[o]=yg.newInstance(),e[`_on${n(o)}Changed`]=r}),t.getNumberOfCells=()=>Er.reduce((o,c)=>o+e[c].getNumberOfCells(),0);const a=t.shallowCopy;t.shallowCopy=function(o){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;a(o,c),Er.forEach(u=>{e[u]=yg.newInstance(),e[u].shallowCopy(o.getReferenceByName(u))})};const s=t.getMTime;t.getMTime=()=>Er.reduce((o,c)=>Math.max(o,e[c]?.getMTime()??o),s());const i=t.initialize;t.initialize=()=>(Er.forEach(o=>e[o]?.initialize()),r(),i()),t.buildCells=()=>{const o=t.getNumberOfVerts(),c=t.getNumberOfLines(),u=t.getNumberOfPolys(),g=t.getNumberOfStrips(),f=o+c+u+g,l=new Uint8Array(f);let p=l;const v=new Uint32Array(f);let h=v;if(o){let d=0;e.verts.getCellSizes().forEach((T,S)=>{h[S]=d,p[S]=T>1?he.VTK_POLY_VERTEX:he.VTK_VERTEX,d+=T+1}),h=h.subarray(o),p=p.subarray(o)}if(c){let d=0;e.lines.getCellSizes().forEach((T,S)=>{h[S]=d,p[S]=T>2?he.VTK_POLY_LINE:he.VTK_LINE,T===1&&wg("Building VTK_LINE ",S," with only one point, but VTK_LINE needs at least two points. Check the input."),d+=T+1}),h=h.subarray(c),p=p.subarray(c)}if(u){let d=0;e.polys.getCellSizes().forEach((T,S)=>{switch(h[S]=d,T){case 3:p[S]=he.VTK_TRIANGLE;break;case 4:p[S]=he.VTK_QUAD;break;default:p[S]=he.VTK_POLYGON;break}T<3&&wg("Building VTK_TRIANGLE ",S," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),d+=T+1}),h+=h.subarray(u),p+=p.subarray(u)}if(g){let d=0;p.fill(he.VTK_TRIANGLE_STRIP,0,g),e.strips.getCellSizes().forEach((T,S)=>{h[S]=d,d+=T+1})}e.cells=_R.newInstance(),e.cells.setCellTypes(f,l,v)},t.buildLinks=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;e.cells==null&&t.buildCells(),e.links=RR.newInstance(),o>0?e.links.allocate(o):e.links.allocate(t.getPoints().getNumberOfPoints()),e.links.buildLinks(t)},t.getCellType=o=>e.cells.getCellType(o),t.getCellPoints=o=>{const c=t.getCellType(o);let u=null;switch(c){case he.VTK_VERTEX:case he.VTK_POLY_VERTEX:u=e.verts;break;case he.VTK_LINE:case he.VTK_POLY_LINE:u=e.lines;break;case he.VTK_TRIANGLE:case he.VTK_QUAD:case he.VTK_POLYGON:u=e.polys;break;case he.VTK_TRIANGLE_STRIP:u=e.strips;break;default:return u=null,{type:0,cellPointIds:null}}const g=e.cells.getCellLocation(o),f=u.getCell(g);return{cellType:c,cellPointIds:f}},t.getPointCells=o=>e.links.getCells(o),t.getCellEdgeNeighbors=(o,c,u)=>{const g=e.links.getLink(c),f=e.links.getLink(u);return g.cells.filter(l=>l!==o&&f.cells.indexOf(l)!==-1)},t.getCell=function(o){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const u=t.getCellPoints(o),g=c||CO[u.cellType].newInstance();return g.initialize(t.getPoints(),u.cellPointIds),g},t.getMaxCellSize=()=>Er.reduce((o,c)=>Math.max(o,e[c]?.getMaxCellSize?.()??0),0)}const EO={};function e1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,EO,n),zR.extend(t,e,n),E.get(t,e,["cells","links"]),E.setGet(t,e,["verts","lines","polys","strips"]),wO(t,e)}const RO=E.newInstance(e1,"vtkPolyData");var xn={newInstance:RO,extend:e1};function OO(t,e){e.classHierarchy.push("vtkTexture"),t.imageLoaded=()=>{e.image.removeEventListener("load",t.imageLoaded),e.imageLoaded=!0,t.modified()},t.setJsImageData=n=>{e.jsImageData!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null,e.imageBitmap=null),e.jsImageData=n,e.imageLoaded=!0,t.modified())},t.setImageBitmap=n=>{e.imageBitmap!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null,e.jsImageData=null),e.imageBitmap=n,e.imageLoaded=!0,t.modified())},t.setCanvas=n=>{e.canvas!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.imageBitmap=null,e.jsImageData=null),e.canvas=n,t.modified())},t.setImage=n=>{e.image!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.canvas=null,e.jsImageData=null,e.imageBitmap=null),e.image=n,e.imageLoaded=!1,n.complete?t.imageLoaded():n.addEventListener("load",t.imageLoaded),t.modified())},t.getDimensionality=()=>{let n=0,r=0,a=1;if(t.getInputData()){const i=t.getInputData();n=i.getDimensions()[0],r=i.getDimensions()[1],a=i.getDimensions()[2]}return e.jsImageData&&(n=e.jsImageData.width,r=e.jsImageData.height),e.canvas&&(n=e.canvas.width,r=e.canvas.height),e.image&&(n=e.image.width,r=e.image.height),e.imageBitmap&&(n=e.imageBitmap.width,r=e.imageBitmap.height),(n>1)+(r>1)+(a>1)},t.getInputAsJsImageData=()=>{if(!e.imageLoaded||t.getInputData())return null;if(e.jsImageData)return e.jsImageData;if(e.imageBitmap)return e.imageBitmap;if(e.canvas)return e.canvas.getContext("2d").getImageData(0,0,e.canvas.width,e.canvas.height);if(e.image){const n=e.image.width,r=e.image.height,s=new OffscreenCanvas(n,r).getContext("2d");return s.translate(0,r),s.scale(1,-1),s.drawImage(e.image,0,0,n,r),s.getImageData(0,0,n,r)}return null}}const MO=(t,e,n)=>{const a=t.createShaderModule({code:`
    @group(0) @binding(0) var inputTexture: texture_2d<f32>;
    @group(0) @binding(1) var outputTexture: texture_storage_2d<rgba8unorm, write>;

    @compute @workgroup_size(8, 8)
    fn main(@builtin(global_invocation_id) global_id: vec3<u32>) {
      let texelCoord = vec2<i32>(global_id.xy);
      let outputSize = textureDimensions(outputTexture);

      if (texelCoord.x >= i32(outputSize.x) || texelCoord.y >= i32(outputSize.y)) {
        return;
      }

      let inputSize = textureDimensions(inputTexture);
      let scale = vec2<f32>(inputSize) / vec2<f32>(outputSize);

      // Compute the floating-point source coordinate
      let srcCoord = (vec2<f32>(texelCoord) + 0.5) * scale - 0.5;

      // Get integer coordinates for the four surrounding texels
      let x0 = i32(floor(srcCoord.x));
      let x1 = min(x0 + 1, i32(inputSize.x) - 1);
      let y0 = i32(floor(srcCoord.y));
      let y1 = min(y0 + 1, i32(inputSize.y) - 1);

      // Compute the weights
      let wx = srcCoord.x - f32(x0);
      let wy = srcCoord.y - f32(y0);

      // Fetch the four texels
      let c00 = textureLoad(inputTexture, vec2<i32>(x0, y0), 0);
      let c10 = textureLoad(inputTexture, vec2<i32>(x1, y0), 0);
      let c01 = textureLoad(inputTexture, vec2<i32>(x0, y1), 0);
      let c11 = textureLoad(inputTexture, vec2<i32>(x1, y1), 0);

      // Bilinear interpolation
      let color = mix(
        mix(c00, c10, wx),
        mix(c01, c11, wx),
        wy
      );

      textureStore(outputTexture, texelCoord, color);
    }
  `}),s=t.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,texture:{sampleType:"float"}},{binding:1,visibility:GPUShaderStage.COMPUTE,storageTexture:{format:"rgba8unorm",access:"write-only"}},{binding:2,visibility:GPUShaderStage.COMPUTE,sampler:{type:"filtering"}}]}),i=t.createPipelineLayout({bindGroupLayouts:[s]}),o=t.createComputePipeline({label:"ComputeMipmapPipeline",layout:i,compute:{module:a,entryPoint:"main"}}),c=t.createSampler({magFilter:"linear",minFilter:"linear"});for(let u=1;u<n;u++){const g=e.createView({baseMipLevel:u-1,mipLevelCount:1}),f=e.createView({baseMipLevel:u,mipLevelCount:1}),l=t.createBindGroup({layout:o.getBindGroupLayout(0),entries:[{binding:0,resource:g},{binding:1,resource:f},{binding:2,resource:c}]}),p=t.createCommandEncoder({label:"MipmapGenerateCommandEncoder"}),v=p.beginComputePass();v.setPipeline(o),v.setBindGroup(0,l);const h=Math.max(1,e.width>>u),d=Math.max(1,e.height>>u),T=Math.ceil(h/8),S=Math.ceil(d/8);v.dispatchWorkgroups(T,S),v.end(),t.queue.submit([p.finish()])}},DO={image:null,canvas:null,jsImageData:null,imageBitmap:null,imageLoaded:!1,repeat:!1,interpolate:!1,edgeClamp:!1,mipLevel:0,resizable:!1};function t1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,DO,n),E.obj(t,e),E.algo(t,e,6,0),E.get(t,e,["canvas","image","jsImageData","imageBitmap","imageLoaded","resizable"]),E.setGet(t,e,["repeat","edgeClamp","interpolate","mipLevel"]),OO(t,e)}const LO=E.newInstance(t1,"vtkTexture"),mO={generateMipmaps:MO};var za={newInstance:LO,extend:t1,...mO};const VO=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],Eg=[[8,7,11,3],[9,1,10,5],[4,9,0,8],[2,11,6,10],[0,3,2,1],[4,5,6,7]],gs=[[0,1],[1,3],[2,3],[0,2],[4,5],[5,7],[6,7],[4,6],[0,4],[1,5],[3,7],[2,6]],Rg=[0,1,0,1,0,1,0,1,2,2,2,2],Le=[[1,2],[1,2],[0,2],[0,2],[0,1],[0,1]],re=new Float64Array(3),ls=new Float64Array(3),de=new Float64Array(3),cr=new Float64Array(3),Zn=new Float64Array(3),ps=new Float64Array(3),fo=new Float64Array(16);function uo(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font=`${e.fontStyle} ${e.fontSize}px ${e.fontFamily}`}function n1(t){const e=[],n=[];for(let r=0;r<3;r++){const a=Zc().domain([t[r*2],t[r*2+1]]);e[r]=a.ticks(5);const s=a.tickFormat(5);n[r]=e[r].map(s)}return{ticks:e,tickStrings:n}}function FO(t,e){e.classHierarchy.push("vtkCubeAxesActorHelper"),t.setRenderable=n=>{e.renderable!==n&&(e.renderable=n,e.tmActor.addTexture(e.renderable.getTmTexture()),e.tmActor.setProperty(n.getProperty()),e.tmActor.setParentProp(n),t.modified())},t.createPolyDataForOneLabel=(n,r,a,s,i,o,c)=>{const u=e.renderable.get_tmAtlas().get(n);if(!u)return;const g=e.renderable.getTextPolyData().getPoints().getData(),f=e.lastSize;re[0]=g[r*3],re[1]=g[r*3+1],re[2]=g[r*3+2],Te(de,re,a),de[0]+=.1,Te(ls,de,s),Gn(Zn,ls,re),de[0]-=.1,de[1]+=.1,Te(ls,de,s),Gn(ps,ls,re);for(let v=0;v<3;v++)Zn[v]/=.5*.1*f[0],ps[v]/=.5*.1*f[1];let l=c.ptIdx,p=c.cellIdx;re[0]=g[r*3],re[1]=g[r*3+1],re[2]=g[r*3+2],i[0]<-.5?Ln(de,Zn,i[0]*o-u.width):i[0]>.5?Ln(de,Zn,i[0]*o):Ln(de,Zn,i[0]*o-u.width/2),fa(re,re,de),Ln(de,ps,i[1]*o-u.height/2),fa(re,re,de),c.points[l*3]=re[0],c.points[l*3+1]=re[1],c.points[l*3+2]=re[2],c.tcoords[l*2]=u.tcoords[0],c.tcoords[l*2+1]=u.tcoords[1],l++,Ln(de,Zn,u.width),fa(re,re,de),c.points[l*3]=re[0],c.points[l*3+1]=re[1],c.points[l*3+2]=re[2],c.tcoords[l*2]=u.tcoords[2],c.tcoords[l*2+1]=u.tcoords[3],l++,Ln(de,ps,u.height),fa(re,re,de),c.points[l*3]=re[0],c.points[l*3+1]=re[1],c.points[l*3+2]=re[2],c.tcoords[l*2]=u.tcoords[4],c.tcoords[l*2+1]=u.tcoords[5],l++,Ln(de,Zn,u.width),Gn(re,re,de),c.points[l*3]=re[0],c.points[l*3+1]=re[1],c.points[l*3+2]=re[2],c.tcoords[l*2]=u.tcoords[6],c.tcoords[l*2+1]=u.tcoords[7],l++,c.polys[p*4]=3,c.polys[p*4+1]=l-4,c.polys[p*4+2]=l-3,c.polys[p*4+3]=l-2,p++,c.polys[p*4]=3,c.polys[p*4+1]=l-4,c.polys[p*4+2]=l-2,c.polys[p*4+3]=l-1,c.ptIdx+=4,c.cellIdx+=2},t.updateTexturePolyData=()=>{const n=e.camera.getCompositeProjectionMatrix(e.lastAspectRatio,-1,1);De(n,n);const r=e.renderable.getTextValues().length,a=r*4,s=r*2,i=new Float64Array(a*3),o=new Uint16Array(s*4),c=new Float32Array(a*2);ut(fo,n);const u={ptIdx:0,cellIdx:0,polys:o,points:i,tcoords:c};let g=0,f=0,l=0;const p=e.renderable.getTextPolyData().getPoints().getData(),v=e.renderable.getTextValues();for(;g<p.length/3;){re[0]=p[g*3],re[1]=p[g*3+1],re[2]=p[g*3+2],Te(de,re,n),re[0]=p[g*3+3],re[1]=p[g*3+4],re[2]=p[g*3+5],Te(cr,re,n),Gn(de,de,cr);const d=[de[0],de[1]];Tp(d),t.createPolyDataForOneLabel(v[f],g,n,fo,d,e.renderable.getAxisTitlePixelOffset(),u),g+=2,f++;for(let T=0;T<e.renderable.getTickCounts()[l];T++)t.createPolyDataForOneLabel(v[f],g,n,fo,d,e.renderable.getTickLabelPixelOffset(),u),g++,f++;l++}const h=xe.newInstance({numberOfComponents:2,values:c,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(h),e.tmPolyData.getPoints().setData(i,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(o,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updateAPISpecificData=(n,r,a)=>{(e.lastSize[0]!==n[0]||e.lastSize[1]!==n[1])&&(e.lastSize[0]=n[0],e.lastSize[1]=n[1],e.lastAspectRatio=n[0]/n[1],e.forceUpdate=!0),e.camera=r,t.updateTexturePolyData()}}const BO=E.newInstance(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},n),E.obj(t,e),e.tmPolyData=xn.newInstance(),e.tmMapper=yr.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmActor=vr.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),E.setGet(t,e,["renderable"]),E.get(t,e,["lastSize","lastAspectRatio","axisTextStyle","tickTextStyle","tmActor","ticks"]),e.forceUpdate=!1,e.lastRedrawTime={},E.obj(e.lastRedrawTime,{mtime:0}),e.lastRebuildTime={},E.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.lastTickBounds=[],FO(t,e)},"vtkCubeAxesActorHelper");function _O(t,e){e.classHierarchy.push("vtkCubeAxesActor"),t.setCamera=r=>{e.camera!==r&&(e.cameraModifiedSub&&(e.cameraModifiedSub.unsubscribe(),e.cameraModifiedSub=null),e.camera=r,r&&(e.cameraModifiedSub=r.onModified(t.update)),t.update(),t.modified())},t.computeFacesToDraw=()=>{const r=e.camera.getViewMatrix();De(r,r);let a=!1;const s=pe.getDiagonalLength(e.dataBounds),i=Math.sin(e.faceVisibilityAngle*Math.PI/180);for(let o=0;o<6;o++){let c=!1;const u=Math.floor(o/2),g=(u+1)%3,f=(u+2)%3;e.dataBounds[g*2]!==e.dataBounds[g*2+1]&&e.dataBounds[f*2]!==e.dataBounds[f*2+1]&&(re[u]=e.dataBounds[o]-.1*s*VO[o][u],re[g]=.5*(e.dataBounds[g*2]+e.dataBounds[g*2+1]),re[f]=.5*(e.dataBounds[f*2]+e.dataBounds[f*2+1]),Te(de,re,r),re[u]=e.dataBounds[o],Te(cr,re,r),Gn(de,cr,de),Wn(de,de),c=de[2]>i,e.camera.getParallelProjection()||(Wn(cr,cr),c=$c(cr,de)>i)),c!==e.lastFacesToDraw[o]&&(e.lastFacesToDraw[o]=c,a=!0)}return a},t.updatePolyData=(r,a,s)=>{let i=0,o=0;i+=8;let c=0;for(let p=0;p<12;p++)a[p]>0&&c++;if(o+=c,e.gridLines)for(let p=0;p<6;p++)r[p]&&(i+=s[Le[p][0]].length*2+s[Le[p][1]].length*2,o+=s[Le[p][0]].length+s[Le[p][1]].length);const u=new Float64Array(i*3),g=new Uint32Array(o*3);let f=0,l=0;for(let p=0;p<2;p++)for(let v=0;v<2;v++)for(let h=0;h<2;h++)u[f*3]=e.dataBounds[h],u[f*3+1]=e.dataBounds[2+v],u[f*3+2]=e.dataBounds[4+p],f++;for(let p=0;p<12;p++)a[p]>0&&(g[l*3]=2,g[l*3+1]=gs[p][0],g[l*3+2]=gs[p][1],l++);if(e.gridLines){for(let p=0;p<6;p++)if(r[p]){const v=Math.floor(p/2);let h=s[Le[p][0]];for(let d=0;d<h.length;d++)u[f*3+v]=e.dataBounds[p],u[f*3+Le[p][0]]=h[d],u[f*3+Le[p][1]]=e.dataBounds[Le[p][1]*2],f++,u[f*3+v]=e.dataBounds[p],u[f*3+Le[p][0]]=h[d],u[f*3+Le[p][1]]=e.dataBounds[Le[p][1]*2+1],f++,g[l*3]=2,g[l*3+1]=f-2,g[l*3+2]=f-1,l++;h=s[Le[p][1]];for(let d=0;d<h.length;d++)u[f*3+v]=e.dataBounds[p],u[f*3+Le[p][1]]=h[d],u[f*3+Le[p][0]]=e.dataBounds[Le[p][0]*2],f++,u[f*3+v]=e.dataBounds[p],u[f*3+Le[p][1]]=h[d],u[f*3+Le[p][0]]=e.dataBounds[Le[p][0]*2+1],f++,g[l*3]=2,g[l*3+1]=f-2,g[l*3+2]=f-1,l++}}e.polyData.getPoints().setData(u,3),e.polyData.getPoints().modified(),e.polyData.getLines().setData(g,1),e.polyData.getLines().modified(),e.polyData.modified()},t.updateTextData=(r,a,s,i)=>{let o=0;for(let p=0;p<12;p++)a[p]===1&&(o+=2,o+=s[Rg[p]].length);const c=e.polyData.getPoints().getData(),u=new Float64Array(o*3);let g=0,f=0,l=0;for(let p=0;p<6;p++)if(r[p])for(let v=0;v<4;v++){const h=Eg[p][v];if(a[h]===1){const d=Rg[h],T=gs[h][0]*3,S=gs[h][1]*3;u[g*3]=.5*(c[T]+c[S]),u[g*3+1]=.5*(c[T+1]+c[S+1]),u[g*3+2]=.5*(c[T+2]+c[S+2]),g++;const x=Math.floor(p/2);u[g*3+x]=e.dataBounds[p],u[g*3+Le[p][0]]=.5*(e.dataBounds[Le[p][0]*2]+e.dataBounds[Le[p][0]*2+1]),u[g*3+Le[p][1]]=.5*(e.dataBounds[Le[p][1]*2]+e.dataBounds[Le[p][1]*2+1]),g++,e.textValues[f]=e.axisLabels[d],f++;const y=(d+1)%3,C=(d+2)%3,w=s[d],R=i[d];e.tickCounts[l]=w.length;for(let O=0;O<w.length;O++)u[g*3+d]=w[O],u[g*3+y]=c[T+y],u[g*3+C]=c[T+C],g++,e.textValues[f]=R[O],f++;l++}}e.textPolyData.getPoints().setData(u,3),e.textPolyData.modified()},t.update=()=>{if(!e.camera)return;const r=t.computeFacesToDraw(),a=e.lastFacesToDraw;let s=!1;for(let i=0;i<6;i++)e.dataBounds[i]!==e.lastTickBounds[i]&&(s=!0,e.lastTickBounds[i]=e.dataBounds[i]);if(r||s||e.forceUpdate){const i=new Array(12).fill(0);for(let c=0;c<6;c++)if(a[c])for(let u=0;u<4;u++)i[Eg[c][u]]++;const o=e.generateTicks(e.dataBounds);t.updatePolyData(a,i,o.ticks),t.updateTextData(a,i,o.ticks,o.tickStrings),(s||e.forceUpdate)&&t.updateTextureAtlas(o.tickStrings)}e.forceUpdate=!1},t.updateTextureAtlas=r=>{e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e._tmAtlas.clear();let a=0,s=1;for(let i=0;i<3;i++){if(!e._tmAtlas.has(e.axisLabels[i])){uo(e.tmContext,e.axisTextStyle);const o=e.tmContext.measureText(e.axisLabels[i]),c={height:o.actualBoundingBoxAscent+2,startingHeight:s,width:o.width+2,textStyle:e.axisTextStyle};e._tmAtlas.set(e.axisLabels[i],c),s+=c.height,a<c.width&&(a=c.width)}uo(e.tmContext,e.tickTextStyle);for(let o=0;o<r[i].length;o++)if(!e._tmAtlas.has(r[i][o])){const c=e.tmContext.measureText(r[i][o]),u={height:c.actualBoundingBoxAscent+2,startingHeight:s,width:c.width+2,textStyle:e.tickTextStyle};e._tmAtlas.set(r[i][o],u),s+=u.height,a<u.width&&(a=u.width)}}a=mt(a),s=mt(s),e._tmAtlas.forEach(i=>{i.tcoords=[0,(s-i.startingHeight-i.height)/s,i.width/a,(s-i.startingHeight-i.height)/s,i.width/a,(s-i.startingHeight)/s,0,(s-i.startingHeight)/s]}),e.tmCanvas.width=a,e.tmCanvas.height=s,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,a,s),e._tmAtlas.forEach((i,o)=>{uo(e.tmContext,i.textStyle),e.tmContext.fillText(o,1,i.startingHeight+i.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified()},t.onModified(()=>{e.forceUpdate=!0,t.update()}),t.setTickTextStyle=r=>{e.tickTextStyle={...e.tickTextStyle,...r},t.modified()},t.setAxisTextStyle=r=>{e.axisTextStyle={...e.axisTextStyle,...r},t.modified()},t.get_tmAtlas=()=>e._tmAtlas,t.getBounds=()=>(t.update(),pe.setBounds(e.bounds,e.gridActor.getBounds()),pe.scaleAboutCenter(e.bounds,e.boundsScaleFactor,e.boundsScaleFactor,e.boundsScaleFactor),e.bounds);const n=E.chain(t.setProperty,e.gridActor.setProperty);t.setProperty=r=>n(r)[0]}function UO(t,e,n){return{boundsScaleFactor:1.3,camera:null,dataBounds:[...pe.INIT_BOUNDS],faceVisibilityAngle:8,gridLines:!0,axisLabels:null,axisTitlePixelOffset:35,tickLabelPixelOffset:12,generateTicks:n1,...n,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif",...n?.axisTextStyle},tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif",...n?.tickTextStyle}}}function r1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};vr.extend(t,e,UO(t,e,n)),e.lastFacesToDraw=[!1,!1,!1,!1,!1,!1],e.axisLabels=["X-Axis","Y-Axis","Z-Axis"],e.tickCounts=[],e.textValues=[],e.lastTickBounds=[],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.tmTexture=za.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),e.gridMapper=yr.newInstance(),e.polyData=xn.newInstance(),e.gridMapper.setInputData(e.polyData),e.gridActor=vr.newInstance(),e.gridActor.setMapper(e.gridMapper),e.gridActor.setProperty(t.getProperty()),e.gridActor.setParentProp(t),e.textPolyData=xn.newInstance(),E.setGet(t,e,["axisTitlePixelOffset","boundsScaleFactor","faceVisibilityAngle","gridLines","tickLabelPixelOffset","generateTicks"]),E.setGetArray(t,e,["dataBounds"],6),E.setGetArray(t,e,["axisLabels"],3),E.get(t,e,["axisTextStyle","tickTextStyle","camera","tmTexture","textValues","textPolyData","tickCounts","gridActor"]),_O(t,e)}const NO=E.newInstance(r1,"vtkCubeAxesActor");var a1={newInstance:NO,extend:r1,newCubeAxesActorHelper:BO,defaultGenerateTicks:n1};function kO(t,e){e.classHierarchy.push("vtkOpenGLCubeAxesActor"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,s=e._openGLRenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([s.usize,s.vsize],a,e._openGLRenderWindow.getRenderable())}}}const GO={};function bO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,GO,n),Be.extend(t,e,n),e.CubeAxesActorHelper=a1.newCubeAxesActorHelper(),kO(t,e)}const $O=we(bO,"vtkOpenGLCubeAxesActor");Ft("vtkCubeAxesActor",$O);const La={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2};var s1={ObjectType:La};const{ObjectType:zs}=s1,WO={};function zO(t,e){e.classHierarchy.push("vtkOpenGLBufferObject");function n(o){switch(o){case zs.ELEMENT_ARRAY_BUFFER:return e.context.ELEMENT_ARRAY_BUFFER;case zs.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in e.context)return e.context.TEXTURE_BUFFER;case zs.ARRAY_BUFFER:default:return e.context.ARRAY_BUFFER}}let r=null,a=null,s=!0,i="";t.getType=()=>r,t.setType=o=>{r=o},t.getHandle=()=>a,t.isReady=()=>s===!1,t.generateBuffer=o=>{const c=n(o);return a===null&&(a=e.context.createBuffer(),r=o),n(r)===c},t.upload=(o,c)=>t.generateBuffer(c)?(e.context.bindBuffer(n(r),a),e.context.bufferData(n(r),o,e.context.STATIC_DRAW),e.allocatedGPUMemoryInBytes=o.length*o.BYTES_PER_ELEMENT,s=!1,!0):(i="Trying to upload array buffer to incompatible buffer.",!1),t.bind=()=>a?(e.context.bindBuffer(n(r),a),!0):!1,t.release=()=>a?(e.context.bindBuffer(n(r),null),!0):!1,t.releaseGraphicsResources=()=>{a!==null&&(e.context.bindBuffer(n(r),null),e.context.deleteBuffer(a),a=null,e.allocatedGPUMemoryInBytes=0)},t.setOpenGLRenderWindow=o=>{e._openGLRenderWindow!==o&&(t.releaseGraphicsResources(),e._openGLRenderWindow=o,e.context=null,o&&(e.context=e._openGLRenderWindow.getContext()))},t.getError=()=>i}const HO={objectType:zs.ARRAY_BUFFER,context:null,allocatedGPUMemoryInBytes:0};function i1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,HO,n),E.obj(t,e),E.get(t,e,["_openGLRenderWindow","allocatedGPUMemoryInBytes"]),E.moveToProtected(t,e,["openGLRenderWindow"]),zO(t,e)}const AO=E.newInstance(i1);var o1={newInstance:AO,extend:i1,...WO,...s1};function jO(t){let e=0,n=0;for(let a=0;a<3;++a){const s=t.getRange(a),i=s[1]-s[0];e+=i*i;const o=.5*(s[1]+s[0]);n+=o*o}const r=e>0&&(Math.abs(n)/e>1e6||Math.abs(Math.log10(e))>3||e===0&&n>1e6);if(r){const a=new Float64Array(3),s=new Float64Array(3);for(let i=0;i<3;++i){const o=t.getRange(i),c=o[1]-o[0];a[i]=.5*(o[1]+o[0]),s[i]=c>0?1/c:1}return{useShiftAndScale:r,coordShift:a,coordScale:s}}return{useShiftAndScale:r,coordShift:new Float32Array([0,0,0]),coordScale:new Float32Array([1,1,1])}}const{vtkErrorMacro:Og}=E;function KO(t,e){const n=new Float64Array(3);Ex(n,e);const r=new Float64Array(16);return d0(r,hr(),t,n),r}function PO(t,e){return t===null||e===null?!1:!(cu(t,[0,0,0])&&cu(e,[1,1,1]))}function XO(t,e){e.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),t.setType(La.ARRAY_BUFFER),t.createVBO=function(n,r,a,s){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!n.getData()||!n.getData().length)return e.elementCount=0,0;e.blockSize=3,e.vertexOffset=0,e.normalOffset=0,e.tCoordOffset=0,e.tCoordComponents=0,e.colorComponents=0,e.colorOffset=0,e.customData=[];const o=s.points.getData();let c=null,u=null,g=null;const f=s.colors?s.colors.getNumberOfComponents():0,l=s.tcoords?s.tcoords.getNumberOfComponents():0;s.normals&&(e.normalOffset=4*e.blockSize,e.blockSize+=3,c=s.normals.getData()),s.customAttributes&&s.customAttributes.forEach(k=>{k&&(e.customData.push({data:k.getData(),offset:4*e.blockSize,components:k.getNumberOfComponents(),name:k.getName()}),e.blockSize+=k.getNumberOfComponents())}),s.tcoords&&(e.tCoordOffset=4*e.blockSize,e.tCoordComponents=l,e.blockSize+=l,u=s.tcoords.getData()),s.colors?(e.colorComponents=s.colors.getNumberOfComponents(),e.colorOffset=0,g=s.colors.getData(),e.colorBO||(e.colorBO=o1.newInstance()),e.colorBO.setOpenGLRenderWindow(e._openGLRenderWindow)):e.colorBO=null,e.stride=4*e.blockSize;let p=0,v=0,h=0,d=0,T=0,S=0,x;const y={anythingToPoints(k,Y,te,J){for(let q=0;q<k;++q)x(Y[te+q],J)},linesToWireframe(k,Y,te,J){for(let q=0;q<k-1;++q)x(Y[te+q],J),x(Y[te+q+1],J)},polysToWireframe(k,Y,te,J){if(k>2)for(let q=0;q<k;++q)x(Y[te+q],J),x(Y[te+(q+1)%k],J)},stripsToWireframe(k,Y,te,J){if(k>2){for(let q=0;q<k-1;++q)x(Y[te+q],J),x(Y[te+q+1],J);for(let q=0;q<k-2;q++)x(Y[te+q],J),x(Y[te+q+2],J)}},polysToSurface(k,Y,te,J){for(let q=0;q<k-2;q++)x(Y[te+0],J),x(Y[te+q+1],J),x(Y[te+q+2],J)},stripsToSurface(k,Y,te,J){for(let q=0;q<k-2;q++)x(Y[te+q],J),x(Y[te+q+1+q%2],J),x(Y[te+q+1+(q+1)%2],J)}},C={anythingToPoints(k,Y){return k},linesToWireframe(k,Y){return k>1?(k-1)*2:0},polysToWireframe(k,Y){return k>2?k*2:0},stripsToWireframe(k,Y){return k>2?k*4-6:0},polysToSurface(k,Y){return k>2?(k-2)*3:0},stripsToSurface(k,Y,te){return k>2?(k-2)*3:0}};let w=null,R=null;a===Vt.POINTS||r==="verts"?(w=y.anythingToPoints,R=C.anythingToPoints):a===Vt.WIREFRAME||r==="lines"?(w=y[`${r}ToWireframe`],R=C[`${r}ToWireframe`]):(w=y[`${r}ToSurface`],R=C[`${r}ToSurface`]);const O=n.getData(),V=O.length;let L=0;for(let k=0;k<V;)L+=R(O[k],O),k+=O[k]+1;let m=null;const F=new Float32Array(L*e.blockSize);g&&(m=new Uint8Array(L*4));let B=0,_=0;const{useShiftAndScale:P,coordShift:z,coordScale:A}=jO(s.points);if(P?t.setCoordShiftAndScale(z,A):e.coordShiftAndScaleEnabled===!0&&t.setCoordShiftAndScale(null,null),i)if(!i.points&&!i.cells)i.points=new Int32Array(L),i.cells=new Int32Array(L);else{const k=new Int32Array(L+i.points.length);k.set(i.points),i.points=k;const Y=new Int32Array(L+i.cells.length);Y.set(i.cells),i.cells=Y}let I=s.vertexOffset;x=function(Y,te){if(i&&(i.points[I]=Y,i.cells[I]=S+s.cellOffset),++I,p=Y*3,e.coordShiftAndScaleEnabled?(F[B++]=(o[p++]-e.coordShift[0])*e.coordScale[0],F[B++]=(o[p++]-e.coordShift[1])*e.coordScale[1],F[B++]=(o[p++]-e.coordShift[2])*e.coordScale[2]):(F[B++]=o[p++],F[B++]=o[p++],F[B++]=o[p++]),c!==null&&(s.haveCellNormals?v=(S+s.cellOffset)*3:v=Y*3,F[B++]=c[v++],F[B++]=c[v++],F[B++]=c[v++]),e.customData.forEach(J=>{T=Y*J.components;for(let q=0;q<J.components;++q)F[B++]=J.data[T++]}),u!==null){s.useTCoordsPerCell?h=te*l:h=Y*l;for(let J=0;J<l;++J)F[B++]=u[h++]}g!==null&&(s.haveCellScalars?d=(S+s.cellOffset)*f:d=Y*f,m[_++]=g[d++],m[_++]=g[d++],m[_++]=g[d++],m[_++]=f===4?g[d++]:255)};for(let k=0;k<V;k+=O[k]+1,S++)w(O[k],O,k+1,S+s.cellOffset);return e.elementCount=L,t.upload(F,La.ARRAY_BUFFER),e.colorBO&&(e.colorBOStride=4,e.colorBO.upload(m,La.ARRAY_BUFFER)),S},t.setCoordShiftAndScale=(n,r)=>{if(n!==null&&(n.constructor!==Float64Array||n.length!==3)){Og("Wrong type for coordShift, expected vec3 or null");return}if(r!==null&&(r.constructor!==Float64Array||r.length!==3)){Og("Wrong type for coordScale, expected vec3 or null");return}(e.coordShift===null||n===null||!fu(n,e.coordShift))&&(e.coordShift=n),(e.coordScale===null||r===null||!fu(r,e.coordScale))&&(e.coordScale=r),e.coordShiftAndScaleEnabled=PO(e.coordShift,e.coordScale),e.coordShiftAndScaleEnabled?e.inverseShiftAndScaleMatrix=KO(e.coordShift,e.coordScale):e.inverseShiftAndScaleMatrix=null}}const IO={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function c1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IO,n),o1.extend(t,e,n),E.setGet(t,e,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),E.get(t,e,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),XO(t,e)}const YO=E.newInstance(c1);var qO={newInstance:YO,extend:c1};const{vtkErrorMacro:QO}=E;function ZO(t,e){e.classHierarchy.push("vtkShader"),t.compile=()=>{let n=e.context.VERTEX_SHADER;if(!e.source||!e.source.length||e.shaderType==="Unknown")return!1;switch(e.handle!==0&&(e.context.deleteShader(e.handle),e.handle=0),e.shaderType){case"Fragment":n=e.context.FRAGMENT_SHADER;break;case"Vertex":default:n=e.context.VERTEX_SHADER;break}if(e.handle=e.context.createShader(n),e.context.shaderSource(e.handle,e.source),e.context.compileShader(e.handle),!e.context.getShaderParameter(e.handle,e.context.COMPILE_STATUS)){const a=e.context.getShaderInfoLog(e.handle);return QO(`Error compiling shader '${e.source}': ${a}`),e.context.deleteShader(e.handle),e.handle=0,!1}return!0},t.cleanup=()=>{e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0,e.dirty=!0)}}const JO={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function f1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,JO,n),E.obj(t,e),E.setGet(t,e,["shaderType","source","error","handle","context"]),ZO(t,e)}const eM=E.newInstance(f1,"vtkShader");var go={newInstance:eM,extend:f1};const{vtkErrorMacro:jt}=E;function tM(t,e,n,r){const a=typeof n=="string"?n:n.join(`
`),s=r===!1?e:new RegExp(e,"g"),i=t.replace(s,a);return{replace:i!==a,result:i}}function nM(t,e){e.classHierarchy.push("vtkShaderProgram"),t.compileShader=()=>e.vertexShader.compile()?e.fragmentShader.compile()?!t.attachShader(e.vertexShader)||!t.attachShader(e.fragmentShader)?(jt(e.error),0):t.link()?(t.setCompiled(!0),1):(jt(`Links failed: ${e.error}`),0):(jt(e.fragmentShader.getSource().split(`
`).map((n,r)=>`${r}: ${n}`).join(`
`)),jt(e.fragmentShader.getError()),0):(jt(e.vertexShader.getSource().split(`
`).map((n,r)=>`${r}: ${n}`).join(`
`)),jt(e.vertexShader.getError()),0),t.cleanup=()=>{e.shaderType==="Unknown"||e.handle===0||(t.release(),e.vertexShaderHandle!==0&&(e.context.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=0),e.fragmentShaderHandle!==0&&(e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=0),e.context.deleteProgram(e.handle),e.handle=0,t.setCompiled(!1))},t.bind=()=>!e.linked&&!t.link()?!1:(e.context.useProgram(e.handle),t.setBound(!0),!0),t.isBound=()=>!!e.bound,t.release=()=>{e.context.useProgram(null),t.setBound(!1)},t.setContext=n=>{e.vertexShader.setContext(n),e.fragmentShader.setContext(n),e.geometryShader.setContext(n)},t.link=()=>{if(e.linked)return!0;if(e.handle===0)return e.error="Program has not been initialized, and/or does not have shaders.",!1;if(e.uniformLocs={},e.context.linkProgram(e.handle),!e.context.getProgramParameter(e.handle,e.context.LINK_STATUS)){const r=e.context.getProgramInfoLog(e.handle);return jt(`Error linking shader ${r}`),e.handle=0,!1}return t.setLinked(!0),e.attributeLocs={},!0},t.setUniformMatrix=(n,r)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;const s=new Float32Array(r);return e.context.uniformMatrix4fv(a,!1,s),!0},t.setUniformMatrix3x3=(n,r)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;const s=new Float32Array(r);return e.context.uniformMatrix3fv(a,!1,s),!0},t.setUniformf=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1f(a,r),!0)},t.setUniformfv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1fv(a,r),!0)},t.setUniformi=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1i(a,r),!0)},t.setUniformiv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1iv(a,r),!0)},t.setUniform2f=(n,r,a)=>{const s=t.findUniform(n);if(s===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2f(s,r,a),!0},t.setUniform2fv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform2fv(a,r),!0)},t.setUniform2i=(n,r,a)=>{const s=t.findUniform(n);if(s===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2i(s,r,a),!0},t.setUniform2iv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform2iv(a,r),!0)},t.setUniform3f=(n,r,a,s)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(s===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(i,r,a,s),!0},t.setUniform3fArray=(n,r)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(!Array.isArray(r)||r.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(a,r[0],r[1],r[2]),!0},t.setUniform3fv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform3fv(a,r),!0)},t.setUniform3i=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];let o=s;if(o.length===1&&Array.isArray(o[0])&&(o=o[0]),o.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3i(r,o[0],o[1],o[2]),!0},t.setUniform3iv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform3iv(a,r),!0)},t.setUniform4f=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];let o=s;if(o.length===1&&Array.isArray(o[0])&&(o=o[0]),o.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4f(r,o[0],o[1],o[2],o[3]),!0},t.setUniform4fv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform4fv(a,r),!0)},t.setUniform4i=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];let o=s;if(o.length===1&&Array.isArray(o[0])&&(o=o[0]),o.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4i(r,o[0],o[1],o[2],o[3]),!0},t.setUniform4iv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform4iv(a,r),!0)},t.findUniform=n=>{if(!n||!e.linked)return-1;let r=e.uniformLocs[n];return r!==void 0?r:(r=e.context.getUniformLocation(e.handle,n),r===null?(e.error=`Uniform ${n} not found in current shader program.`,e.uniformLocs[n]=-1,-1):(e.uniformLocs[n]=r,r))},t.isUniformUsed=n=>{if(!n)return!1;let r=e.uniformLocs[n];return r!==void 0?r!==null:e.linked?(r=e.context.getUniformLocation(e.handle,n),e.uniformLocs[n]=r,r!==null):(jt("attempt to find uniform when the shader program is not linked"),!1)},t.isAttributeUsed=n=>{if(!n)return!1;if(n in e.attributeLocs)return!0;if(!e.linked)return jt("attempt to find uniform when the shader program is not linked"),!1;const r=e.context.getAttribLocation(e.handle,n);return r===-1?!1:(e.attributeLocs[n]=r,!0)},t.attachShader=n=>{if(n.getHandle()===0)return e.error="Shader object was not initialized, cannot attach it.",!1;if(n.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;if(e.handle===0){const r=e.context.createProgram();if(r===0)return e.error="Could not create shader program.",!1;e.handle=r,e.linked=!1}return n.getShaderType()==="Vertex"&&(e.vertexShaderHandle!==0&&e.context.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=n.getHandle()),n.getShaderType()==="Fragment"&&(e.fragmentShaderHandle!==0&&e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=n.getHandle()),e.context.attachShader(e.handle,n.getHandle()),t.setLinked(!1),!0},t.detachShader=n=>{if(n.getHandle()===0)return e.error="shader object was not initialized, cannot attach it.",!1;if(n.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;switch(e.handle===0&&(e.error="This shader program has not been initialized yet."),n.getShaderType()){case"Vertex":return e.vertexShaderHandle!==n.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,n.getHandle()),e.vertexShaderHandle=0,e.linked=!1,!0);case"Fragment":return e.fragmentShaderHandle!==n.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,n.getHandle()),e.fragmentShaderHandle=0,e.linked=!1,!0);default:return!1}},t.setContext=n=>{e.context=n,e.vertexShader.setContext(n),e.fragmentShader.setContext(n),e.geometryShader.setContext(n)},t.setLastCameraMTime=n=>{e.lastCameraMTime=n}}const rM={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function u1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rM,n),e.attributesLocs={},e.uniformLocs={},e.vertexShader=go.newInstance(),e.vertexShader.setShaderType("Vertex"),e.fragmentShader=go.newInstance(),e.fragmentShader.setShaderType("Fragment"),e.geometryShader=go.newInstance(),e.geometryShader.setShaderType("Geometry"),E.obj(t,e),E.get(t,e,["lastCameraMTime"]),E.setGet(t,e,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),nM(t,e)}const aM=E.newInstance(u1,"vtkShaderProgram");var N={newInstance:aM,extend:u1,substitute:tM};function sM(t,e){e.classHierarchy.push("vtkOpenGLVertexArrayObject"),t.exposedMethod=()=>{},t.initialize=()=>{e.instancingExtension=null,e._openGLRenderWindow.getWebgl2()||(e.instancingExtension=e.context.getExtension("ANGLE_instanced_arrays")),!e.forceEmulation&&e._openGLRenderWindow&&e._openGLRenderWindow.getWebgl2()?(e.extension=null,e.supported=!0,e.handleVAO=e.context.createVertexArray()):(e.extension=e.context.getExtension("OES_vertex_array_object"),!e.forceEmulation&&e.extension?(e.supported=!0,e.handleVAO=e.extension.createVertexArrayOES()):e.supported=!1)},t.isReady=()=>e.handleVAO!==0||e.supported===!1,t.bind=()=>{if(t.isReady()||t.initialize(),t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(e.handleVAO):e.context.bindVertexArray(e.handleVAO);else if(t.isReady()){const n=e.context;for(let r=0;r<e.buffers.length;++r){const a=e.buffers[r];e.context.bindBuffer(n.ARRAY_BUFFER,a.buffer);for(let s=0;s<a.attributes.length;++s){const i=a.attributes[s],o=i.isMatrix?i.size:1;for(let c=0;c<o;++c)n.enableVertexAttribArray(i.index+c),n.vertexAttribPointer(i.index+c,i.size,i.type,i.normalize,i.stride,i.offset+i.stride*c/i.size),i.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(i.index+c,1):n.vertexAttribDivisor(i.index+c,1))}}}},t.release=()=>{if(t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(null):e.context.bindVertexArray(null);else if(t.isReady()){const n=e.context;for(let r=0;r<e.buffers.length;++r){const a=e.buffers[r];e.context.bindBuffer(n.ARRAY_BUFFER,a.buffer);for(let s=0;s<a.attributes.length;++s){const i=a.attributes[s],o=i.isMatrix?i.size:1;for(let c=0;c<o;++c)n.enableVertexAttribArray(i.index+c),n.vertexAttribPointer(i.index+c,i.size,i.type,i.normalize,i.stride,i.offset+i.stride*c/i.size),i.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(i.index+c,0):n.vertexAttribDivisor(i.index+c,0)),n.disableVertexAttribArray(i.index+c)}}}},t.shaderProgramChanged=()=>{t.release(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.handleProgram=0},t.releaseGraphicsResources=()=>{t.shaderProgramChanged(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.supported=!0,e.handleProgram=0},t.addAttributeArray=(n,r,a,s,i,o,c,u)=>t.addAttributeArrayWithDivisor(n,r,a,s,i,o,c,u,0,!1),t.addAttributeArrayWithDivisor=(n,r,a,s,i,o,c,u,g,f)=>{if(!n||!n.isBound()||r.getHandle()===0||r.getType()!==La.ARRAY_BUFFER||(e.handleProgram===0&&(e.handleProgram=n.getHandle()),t.isReady()||t.initialize(),!t.isReady()||e.handleProgram!==n.getHandle()))return!1;const l=e.context,p={};if(p.name=a,p.index=l.getAttribLocation(e.handleProgram,a),p.offset=s,p.stride=i,p.type=o,p.size=c,p.normalize=u,p.isMatrix=f,p.divisor=g,p.Index===-1)return!1;if(r.bind(),l.enableVertexAttribArray(p.index),l.vertexAttribPointer(p.index,p.size,p.type,p.normalize,p.stride,p.offset),g>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(p.index,1):l.vertexAttribDivisor(p.index,1)),p.buffer=r.getHandle(),!e.supported){let v=!1;for(let h=0;h<e.buffers.length;++h){const d=e.buffers[h];if(d.buffer===p.buffer){v=!0;let T=!1;for(let S=0;S<d.attributes.length;++S)d.attributes[S].name===a&&(T=!0,d.attributes[S]=p);T||d.attributes.push(p)}}v||e.buffers.push({buffer:p.buffer,attributes:[p]})}return!0},t.addAttributeMatrixWithDivisor=(n,r,a,s,i,o,c,u,g)=>{const f=t.addAttributeArrayWithDivisor(n,r,a,s,i,o,c,u,g,!0);if(!f)return f;const l=e.context,p=l.getAttribLocation(e.handleProgram,a);for(let v=1;v<c;v++)l.enableVertexAttribArray(p+v),l.vertexAttribPointer(p+v,c,o,u,i,s+i*v/c),g>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(p+v,1):l.vertexAttribDivisor(p+v,1));return!0},t.removeAttributeArray=n=>{if(!t.isReady()||e.handleProgram===0)return!1;if(!e.supported)for(let r=0;r<e.buffers.length;++r){const a=e.buffers[r];for(let s=0;s<a.attributes.length;++s)if(a.attributes[s].name===n)return a.attributes.splice(s,1),a.attributes.length||e.buffers.splice(r,1),!0}return!0},t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))}}const iM={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null};function g1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iM,n),e.buffers=[],E.obj(t,e),E.get(t,e,["supported"]),E.setGet(t,e,["forceEmulation"]),sM(t,e)}const oM=E.newInstance(g1,"vtkOpenGLVertexArrayObject");var l1={newInstance:oM,extend:g1};const mn={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6};function cM(t,e){e.classHierarchy.push("vtkOpenGLHelper"),t.setOpenGLRenderWindow=n=>{e.context=n.getContext(),e.program.setContext(e.context),e.VAO.setOpenGLRenderWindow(n),e.CABO.setOpenGLRenderWindow(n)},t.releaseGraphicsResources=n=>{e.VAO.releaseGraphicsResources(),e.CABO.releaseGraphicsResources(),e.CABO.setElementCount(0)},t.drawArrays=(n,r,a,s)=>{if(e.CABO.getElementCount()){const i=t.getOpenGLMode(a),o=t.haveWideLines(n,r),c=e.context,u=c.getParameter(c.DEPTH_WRITEMASK);e.pointPicking&&c.depthMask(!1),i===c.LINES&&o?(t.updateShaders(n,r,s),c.drawArraysInstanced(i,0,e.CABO.getElementCount(),2*Math.ceil(r.getProperty().getLineWidth()))):(c.lineWidth(r.getProperty().getLineWidth()),t.updateShaders(n,r,s),c.drawArrays(i,0,e.CABO.getElementCount()),c.lineWidth(1));const f=(i===c.POINTS?1:0)||(i===c.LINES?2:3);return e.pointPicking&&c.depthMask(u),e.CABO.getElementCount()/f}return 0},t.getOpenGLMode=n=>{if(e.pointPicking)return e.context.POINTS;const r=e.primitiveType;return n===Vt.POINTS||r===mn.Points?e.context.POINTS:n===Vt.WIREFRAME||r===mn.Lines||r===mn.TrisEdges||r===mn.TriStripsEdges?e.context.LINES:e.context.TRIANGLES},t.haveWideLines=(n,r)=>r.getProperty().getLineWidth()>1?!(e.CABO.getOpenGLRenderWindow()&&e.CABO.getOpenGLRenderWindow().getHardwareMaximumLineWidth()>=r.getProperty().getLineWidth()):!1,t.getNeedToRebuildShaders=(n,r,a)=>!!(a.getNeedToRebuildShaders(t,n,r)||t.getProgram()===0||t.getShaderSourceTime().getMTime()<a.getMTime()||t.getShaderSourceTime().getMTime()<r.getMTime()),t.updateShaders=(n,r,a)=>{if(t.getNeedToRebuildShaders(n,r,a)){const s={Vertex:null,Fragment:null,Geometry:null};a.buildShaders(s,n,r);const i=e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgramArray(s.Vertex,s.Fragment,s.Geometry);i!==t.getProgram()&&(t.setProgram(i),t.getVAO().releaseGraphicsResources()),t.getShaderSourceTime().modified()}else e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgram(t.getProgram());t.getVAO().bind(),a.setMapperShaderParameters(t,n,r),a.setPropertyShaderParameters(t,n,r),a.setCameraShaderParameters(t,n,r),a.setLightingShaderParameters(t,n,r),a.invokeShaderCallbacks(t,n,r)},t.setMapperShaderParameters=(n,r,a)=>{if(t.haveWideLines(n,r)){t.getProgram().setUniform2f("viewportSize",a.usize,a.vsize);const s=parseFloat(r.getProperty().getLineWidth()),i=s/2;t.getProgram().setUniformf("lineWidthStepSize",s/Math.ceil(s)),t.getProgram().setUniformf("halfLineWidth",i)}e.primitiveType===mn.Points||r.getProperty().getRepresentation()===Vt.POINTS?t.getProgram().setUniformf("pointSize",r.getProperty().getPointSize()):e.pointPicking&&t.getProgram().setUniformf("pointSize",t.getPointPickingPrimitiveSize())},t.replaceShaderPositionVC=(n,r,a)=>{let s=n.Vertex;s=N.substitute(s,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform float pointSize;"]).result,s=N.substitute(s,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl","  gl_PointSize = pointSize;"],!1).result,t.getOpenGLMode(a.getProperty().getRepresentation())===e.context.LINES&&t.haveWideLines(r,a)&&(s=N.substitute(s,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform vec2 viewportSize;","uniform float lineWidthStepSize;","uniform float halfLineWidth;"]).result,s=N.substitute(s,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl"," if (halfLineWidth > 0.0)","   {","   float offset = float(gl_InstanceID / 2) * lineWidthStepSize - halfLineWidth;","   vec4 tmpPos = gl_Position;","   vec3 tmpPos2 = tmpPos.xyz / tmpPos.w;","   tmpPos2.x = tmpPos2.x + 2.0 * mod(float(gl_InstanceID), 2.0) * offset / viewportSize[0];","   tmpPos2.y = tmpPos2.y + 2.0 * mod(float(gl_InstanceID + 1), 2.0) * offset / viewportSize[1];","   gl_Position = vec4(tmpPos2.xyz * tmpPos.w, tmpPos.w);","   }"]).result),n.Vertex=s},t.getPointPickingPrimitiveSize=()=>e.primitiveType===mn.Points?2:e.primitiveType===mn.Lines?4:6,t.getAllocatedGPUMemoryInBytes=()=>t.getCABO().getAllocatedGPUMemoryInBytes()}const fM={context:null,program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0,pointPicking:!1};function p1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fM,n),E.obj(t,e),e.shaderSourceTime={},E.obj(e.shaderSourceTime),e.attributeUpdateTime={},E.obj(e.attributeUpdateTime),E.setGet(t,e,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType","pointPicking"]),e.program=N.newInstance(),e.VAO=l1.newInstance(),e.CABO=qO.newInstance(),cM(t,e)}const uM=E.newInstance(p1);var Qr={newInstance:uM,extend:p1,primTypes:mn};const gM={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},fc={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5};var h1={Wrap:gM,Filter:fc};const d1=new Float32Array(1),lM=new Int32Array(d1.buffer);function pM(t){d1[0]=t;const e=lM[0];let n=e>>16&32768,r=e>>12&2047;const a=e>>23&255;return a<103?n:a>142?(n|=31744,n|=(a===255?0:1)&&e&8388607,n):a<113?(r|=2048,n|=(r>>114-a)+(r>>113-a&1),n):(n|=a-112<<10|r>>1,n+=r&1,n)}function hM(t){const e=(t&32768)>>15,n=(t&31744)>>10,r=t&1023;return n===0?(e?-1:1)*2**-14*(r/2**10):n===31?r?NaN:(e?-1:1)*(1/0):(e?-1:1)*2**(n-15)*(1+r/2**10)}var kt={fromHalf:hM,toHalf:pM};function dM(){try{const r=new Int16Array([0,32767]),a=[1,1],s=document.createElement("canvas");s.width=4,s.height=4;const i=s.getContext("webgl2");if(!i)return!1;const o=i.getExtension("EXT_texture_norm16");if(!o)return!1;const c=`#version 300 es
    void main() {
      gl_PointSize = ${4 .toFixed(1)};
      gl_Position = vec4(0, 0, 0, 1);
    }
  `,u=`#version 300 es
    precision highp float;
    precision highp int;
    precision highp sampler2D;

    uniform sampler2D u_image;

    out vec4 color;

    void main() {
        vec4 intColor = texture(u_image, gl_PointCoord.xy);
        color = vec4(vec3(intColor.rrr), 1);
    }
    `,g=i.createShader(i.VERTEX_SHADER);if(i.shaderSource(g,c),i.compileShader(g),!i.getShaderParameter(g,i.COMPILE_STATUS))return!1;const f=i.createShader(i.FRAGMENT_SHADER);if(i.shaderSource(f,u),i.compileShader(f),!i.getShaderParameter(f,i.COMPILE_STATUS))return!1;const l=i.createProgram();if(i.attachShader(l,g),i.attachShader(l,f),i.linkProgram(l),!i.getProgramParameter(l,i.LINK_STATUS))return!1;const p=i.createTexture();i.bindTexture(i.TEXTURE_2D,p),i.texImage2D(i.TEXTURE_2D,0,o.R16_SNORM_EXT,2,1,0,i.RED,i.SHORT,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.useProgram(l),i.drawArrays(i.POINTS,0,1);const v=new Uint8Array(4);i.readPixels(a[0],a[1],1,1,i.RGBA,i.UNSIGNED_BYTE,v);const[h,d,T]=v,S=i.getExtension("WEBGL_lose_context");return S&&S.loseContext(),h===d&&d===T&&h!==0}catch{return!1}}let lo;function vM(){return lo===void 0&&(lo=dM()),lo}const{Wrap:un,Filter:be}=h1,{VtkDataTypes:se}=xe,{vtkDebugMacro:po,vtkErrorMacro:Jn,vtkWarningMacro:Mg,requiredParam:fe}=nn,{toHalf:yM}=kt;function TM(t,e){e.classHierarchy.push("vtkOpenGLTexture");function n(){return{internalFormat:e.internalFormat,format:e.format,openGLDataType:e.openGLDataType,width:e.width,height:e.height}}t.render=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(v?e._openGLRenderWindow=v:(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow")),e.context=e._openGLRenderWindow.getContext(),e.renderable.getInterpolate()?(e.generateMipmap?t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR):t.setMinificationFilter(be.LINEAR),t.setMagnificationFilter(be.LINEAR)):(t.setMinificationFilter(be.NEAREST),t.setMagnificationFilter(be.NEAREST)),e.renderable.getRepeat()&&(t.setWrapR(un.REPEAT),t.setWrapS(un.REPEAT),t.setWrapT(un.REPEAT)),e.renderable.getInputData()&&e.renderable.setImage(null),!e.handle||e.renderable.getMTime()>e.textureBuildTime.getMTime()){if(e.renderable.getImageBitmap()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR)),e.renderable.getImageBitmap()&&e.renderable.getImageLoaded()&&(t.create2DFromImageBitmap(e.renderable.getImageBitmap()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getImage()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR)),e.renderable.getImage()&&e.renderable.getImageLoaded()&&(t.create2DFromImage(e.renderable.getImage()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getCanvas()!==null){e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR));const d=e.renderable.getCanvas();t.create2DFromRaw({width:d.width,height:d.height,numComps:4,dataType:se.UNSIGNED_CHAR,data:d,flip:!0}),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}if(e.renderable.getJsImageData()!==null){const d=e.renderable.getJsImageData();e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR)),t.create2DFromRaw({width:d.width,height:d.height,numComps:4,dataType:se.UNSIGNED_CHAR,data:d.data,flip:!0}),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}const h=e.renderable.getInputData(0);if(h&&h.getPointData().getScalars()){const d=h.getExtent(),T=h.getPointData().getScalars(),S=[];for(let x=0;x<e.renderable.getNumberOfInputPorts();++x){const y=e.renderable.getInputData(x),C=y?y.getPointData().getScalars().getData():null;C&&S.push(C)}e.renderable.getInterpolate()&&T.getNumberOfComponents()===4&&(e.generateMipmap=!0,t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR)),S.length%6===0?t.createCubeFromRaw({width:d[1]-d[0]+1,height:d[3]-d[2]+1,numComps:T.getNumberOfComponents(),dataType:T.getDataType(),data:S}):t.create2DFromRaw({width:d[1]-d[0]+1,height:d[3]-d[2]+1,numComps:T.getNumberOfComponents(),dataType:T.getDataType(),data:T.getData()}),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}}e.handle&&t.activate()};const r=()=>{if(!((e.minificationFilter===be.LINEAR||e.magnificationFilter===be.LINEAR)&&!vM()))return e.oglNorm16Ext};t.destroyTexture=()=>{t.deactivate(),e.context&&e.handle&&e.context.deleteTexture(e.handle),e._prevTexParams=null,e.handle=0,e.numberOfDimensions=0,e.target=0,e.components=0,e.width=0,e.height=0,e.depth=0,t.resetFormatAndType()},t.createTexture=()=>{e.handle||(e.handle=e.context.createTexture(),e.target&&(e.context.bindTexture(e.target,e.handle),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.bindTexture(e.target,null)))},t.getTextureUnit=()=>e._openGLRenderWindow?e._openGLRenderWindow.getTextureUnitForTexture(t):-1,t.activate=()=>{e._openGLRenderWindow.activateTexture(t),t.bind()},t.deactivate=()=>{e._openGLRenderWindow&&e._openGLRenderWindow.deactivateTexture(t)},t.releaseGraphicsResources=v=>{v&&e.handle&&(v.activateTexture(t),v.deactivateTexture(t),e.context.deleteTexture(e.handle),e._prevTexParams=null,e.handle=0,e.numberOfDimensions=0,e.target=0,e.internalFormat=0,e.format=0,e.openGLDataType=0,e.components=0,e.width=0,e.height=0,e.depth=0,e.allocatedGPUMemoryInBytes=0),e.shaderProgram&&(e.shaderProgram.releaseGraphicsResources(v),e.shaderProgram=null)},t.bind=()=>{e.context.bindTexture(e.target,e.handle),e.autoParameters&&t.getMTime()>e.sendParametersTime.getMTime()&&t.sendParameters()},t.isBound=()=>{let v=!1;if(e.context&&e.handle){let h=0;switch(e.target){case e.context.TEXTURE_2D:h=e.context.TEXTURE_BINDING_2D;break;default:Mg("impossible case");break}v=e.context.getIntegerv(h)===e.handle}return v},t.sendParameters=()=>{e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e._openGLRenderWindow.getWebgl2()&&(e.context.texParameteri(e.target,e.context.TEXTURE_BASE_LEVEL,e.baseLevel),e.context.texParameteri(e.target,e.context.TEXTURE_MAX_LEVEL,e.maxLevel)),e.sendParametersTime.modified()},t.getInternalFormat=(v,h)=>(e._forceInternalFormat||(e.internalFormat=t.getDefaultInternalFormat(v,h)),e.internalFormat||po(`Unable to find suitable internal format for T=${v} NC= ${h}`),[e.context.R32F,e.context.RG32F,e.context.RGB32F,e.context.RGBA32F].includes(e.internalFormat)&&!e.context.getExtension("OES_texture_float_linear")&&Mg("Failed to load OES_texture_float_linear. Texture filtering is not available for *32F internal formats."),e.internalFormat),t.getDefaultInternalFormat=(v,h)=>{let d=0;return d=e._openGLRenderWindow.getDefaultTextureInternalFormat(v,h,r(),t.useHalfFloat()),d||(d||(po("Unsupported internal texture type!"),po(`Unable to find suitable internal format for T=${v} NC= ${h}`)),d)},t.useHalfFloat=()=>e.enableUseHalfFloat&&e.canUseHalfFloat,t.setInternalFormat=v=>{e._forceInternalFormat=!0,v!==e.internalFormat&&(e.internalFormat=v,t.modified())},t.getFormat=(v,h)=>(e.format=t.getDefaultFormat(v,h),e.format),t.getDefaultFormat=(v,h)=>{if(e._openGLRenderWindow.getWebgl2())switch(h){case 1:return e.context.RED;case 2:return e.context.RG;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}else switch(h){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}},t.resetFormatAndType=()=>{e._prevTexParams=null,e.format=0,e.internalFormat=0,e._forceInternalFormat=!1,e.openGLDataType=0},t.getDefaultDataType=v=>{const h=t.useHalfFloat();if(e._openGLRenderWindow.getWebgl2())switch(v){case se.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case(r()&&!h&&se.SHORT):return e.context.SHORT;case(r()&&!h&&se.UNSIGNED_SHORT):return e.context.UNSIGNED_SHORT;case(h&&se.SHORT):return e.context.HALF_FLOAT;case(h&&se.UNSIGNED_SHORT):return e.context.HALF_FLOAT;case se.FLOAT:case se.VOID:default:return e.context.FLOAT}switch(v){case se.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case se.FLOAT:case se.VOID:default:if(e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))return e.context.FLOAT;{const d=e.context.getExtension("OES_texture_half_float");if(d&&e.context.getExtension("OES_texture_half_float_linear"))return d.HALF_FLOAT_OES}return e.context.UNSIGNED_BYTE}},t.getOpenGLDataType=function(v){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(!e.openGLDataType||h)&&(e.openGLDataType=t.getDefaultDataType(v)),e.openGLDataType},t.getShiftAndScale=()=>{let v=0,h=1;switch(e.openGLDataType){case e.context.BYTE:h=127.5,v=h-128;break;case e.context.UNSIGNED_BYTE:h=255,v=0;break;case e.context.SHORT:h=32767.5,v=h-32768;break;case e.context.UNSIGNED_SHORT:h=65536,v=0;break;case e.context.INT:h=21474836475e-1,v=h-2147483648;break;case e.context.UNSIGNED_INT:h=4294967295,v=0;break;case e.context.FLOAT:}return{shift:v,scale:h}},t.getOpenGLFilterMode=v=>{switch(v){case be.NEAREST:return e.context.NEAREST;case be.LINEAR:return e.context.LINEAR;case be.NEAREST_MIPMAP_NEAREST:return e.context.NEAREST_MIPMAP_NEAREST;case be.NEAREST_MIPMAP_LINEAR:return e.context.NEAREST_MIPMAP_LINEAR;case be.LINEAR_MIPMAP_NEAREST:return e.context.LINEAR_MIPMAP_NEAREST;case be.LINEAR_MIPMAP_LINEAR:return e.context.LINEAR_MIPMAP_LINEAR;default:return e.context.NEAREST}},t.getOpenGLWrapMode=v=>{switch(v){case un.CLAMP_TO_EDGE:return e.context.CLAMP_TO_EDGE;case un.REPEAT:return e.context.REPEAT;case un.MIRRORED_REPEAT:return e.context.MIRRORED_REPEAT;default:return e.context.CLAMP_TO_EDGE}};function a(v){const[h,d,T,S,x,y]=v;return[d-h+1,S-T+1,y-x+1]}function s(v){const[h,d,T]=a(v);return h*d*T}function i(v,h,d,T,S){const[x,y,C,w,R,O]=d,[V,L]=h,m=V*L;let F=S;for(let B=R;B<=O;B++){const _=B*m;for(let P=C;P<=w;P++){const z=_+P*V;for(let A=z+x,I=z+y;A<=I;A++,F++)T[F]=v[A]}}}function o(v,h){const T=(arguments.length>2&&arguments[2]!==void 0?arguments[2]:null)||v.constructor,S=h.reduce((w,R)=>w+s(R),0),x=new T(S),y=[e.width,e.height,e.depth];let C=0;return h.forEach(w=>{i(v,y,w,x,C),C+=s(w)}),x}t.updateArrayDataTypeForGL=function(v,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,T=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];const S=[];let x=e.width*e.height*e.components;d&&(x*=e.depth);const y=!!T.length;if(v!==se.FLOAT&&e.openGLDataType===e.context.FLOAT)for(let w=0;w<h.length;w++)if(h[w])if(y)S.push(o(h[w],T,Float32Array));else{const R=h[w].length>x?h[w].subarray(0,x):h[w];S.push(new Float32Array(R))}else S.push(null);if(v!==se.UNSIGNED_CHAR&&e.openGLDataType===e.context.UNSIGNED_BYTE)for(let w=0;w<h.length;w++)if(h[w])if(y)S.push(o(h[w],T,Uint8Array));else{const R=h[w].length>x?h[w].subarray(0,x):h[w];S.push(new Uint8Array(R))}else S.push(null);let C=!1;if(e._openGLRenderWindow.getWebgl2())C=e.openGLDataType===e.context.HALF_FLOAT;else{const w=e.context.getExtension("OES_texture_half_float");C=w&&e.openGLDataType===w.HALF_FLOAT_OES}if(C)for(let w=0;w<h.length;w++)if(h[w]){const R=y?o(h[w],T):h[w],O=new Uint16Array(y?R.length:x),V=O.length;for(let L=0;L<V;L++)O[L]=yM(R[L]);S.push(O)}else S.push(null);if(S.length===0)for(let w=0;w<h.length;w++)S.push(y&&h[w]?o(h[w],T):h[w]);return S};function c(v){if(e._openGLRenderWindow.getWebgl2())return v;const h=[],d=e.width,T=e.height,S=e.components;if(v&&(!la(d)||!la(T))){const x=e.context.getExtension("OES_texture_half_float"),y=mt(d),C=mt(T),w=y*C*e.components;for(let R=0;R<v.length;R++)if(v[R]!==null){let O=null;const V=T/C,L=d/y;let m=!1;e.openGLDataType===e.context.FLOAT?O=new Float32Array(w):x&&e.openGLDataType===x.HALF_FLOAT_OES?(O=new Uint16Array(w),m=!0):O=new Uint8Array(w);for(let F=0;F<C;F++){const B=F*y*S,_=F*V;let P=Math.floor(_),z=Math.ceil(_);z>=T&&(z=T-1);const A=_-P,I=1-A;P=P*d*S,z=z*d*S;for(let k=0;k<y;k++){const Y=k*S,te=k*L;let J=Math.floor(te),q=Math.ceil(te);q>=d&&(q=d-1);const ht=te-J;J*=S,q*=S;for(let Ae=0;Ae<S;Ae++)m?O[B+Y+Ae]=kt.toHalf(kt.fromHalf(v[R][P+J+Ae])*I*(1-ht)+kt.fromHalf(v[R][P+q+Ae])*I*ht+kt.fromHalf(v[R][z+J+Ae])*A*(1-ht)+kt.fromHalf(v[R][z+q+Ae])*A*ht):O[B+Y+Ae]=v[R][P+J+Ae]*I*(1-ht)+v[R][P+q+Ae]*I*ht+v[R][z+J+Ae]*A*(1-ht)+v[R][z+q+Ae]*A*ht}}h.push(O),e.width=y,e.height=C}else h.push(null)}if(h.length===0)for(let x=0;x<v.length;x++)h.push(v[x]);return h}function u(v){return e._openGLRenderWindow?e.resizable||e.renderable?.getResizable()?!1:e._openGLRenderWindow.getWebgl2()?!(e._openGLRenderWindow.getGLInformations().RENDERER.value.match(/WebKit/gi)&&navigator.platform.match(/Mac/gi)&&r()&&(v===se.UNSIGNED_SHORT||v===se.SHORT)):!1:!1}t.create2DFromRaw=function(){let{width:v=fe("width"),height:h=fe("height"),numComps:d=fe("numComps"),dataType:T=fe("dataType"),data:S=fe("data"),flip:x=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(t.getOpenGLDataType(T,!0),t.getInternalFormat(T,d),t.getFormat(T,d),!e.internalFormat||!e.format||!e.openGLDataType)return Jn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=d,e.width=v,e.height=h,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const y=[S],C=t.updateArrayDataTypeForGL(T,y),w=c(C);return e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,x),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),u(T)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),w[0]!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,w[0])):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,w[0]),e.generateMipmap&&e.context.generateMipmap(e.target),x&&e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,!1),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*d*e._openGLRenderWindow.getDefaultTextureByteSize(T,r(),t.useHalfFloat()),t.deactivate(),!0},t.createCubeFromRaw=function(){let{width:v=fe("width"),height:h=fe("height"),numComps:d=fe("numComps"),dataType:T=fe("dataType"),data:S=fe("data")}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(t.getOpenGLDataType(T),t.getInternalFormat(T,d),t.getFormat(T,d),!e.internalFormat||!e.format||!e.openGLDataType)return Jn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_CUBE_MAP,e.components=d,e.width=v,e.height=h,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),e.maxLevel=S.length/6-1,t.createTexture(),t.bind();const x=t.updateArrayDataTypeForGL(T,S),y=c(x),C=[];let w=e.width,R=e.height;for(let O=0;O<y.length;O++){O%6===0&&O!==0&&(w/=2,R/=2),C[O]=Ir(T,R*w*e.components);for(let V=0;V<R;++V){const L=V*w*e.components,m=(R-V-1)*w*e.components;C[O].set(y[O].slice(m,m+w*e.components),L)}}e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),u(T)&&e.context.texStorage2D(e.target,6,e.internalFormat,e.width,e.height);for(let O=0;O<6;O++){let V=0,L=e.width,m=e.height;for(;L>=1&&m>=1;){let F=null;V<=e.maxLevel&&(F=C[6*V+O]),u(T)?F!=null&&e.context.texSubImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+O,V,0,0,L,m,e.format,e.openGLDataType,F):e.context.texImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+O,V,e.internalFormat,L,m,0,e.format,e.openGLDataType,F),V++,L/=2,m/=2}}return e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*d*e._openGLRenderWindow.getDefaultTextureByteSize(T,r(),t.useHalfFloat()),t.deactivate(),!0},t.createDepthFromRaw=function(){let{width:v=fe("width"),height:h=fe("height"),dataType:d=fe("dataType"),data:T=fe("data")}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.getOpenGLDataType(d),e.format=e.context.DEPTH_COMPONENT,e._openGLRenderWindow.getWebgl2()?d===se.FLOAT?e.internalFormat=e.context.DEPTH_COMPONENT32F:e.internalFormat=e.context.DEPTH_COMPONENT16:e.internalFormat=e.context.DEPTH_COMPONENT,!e.internalFormat||!e.format||!e.openGLDataType?(Jn("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=1,e.width=v,e.height=h,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),u(d)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),T!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,T)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,T),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(d,r(),t.useHalfFloat()),t.deactivate(),!0)},t.create2DFromImage=v=>{if(t.getOpenGLDataType(se.UNSIGNED_CHAR),t.getInternalFormat(se.UNSIGNED_CHAR,4),t.getFormat(se.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType)return Jn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=4,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const h=!e._openGLRenderWindow.getWebgl2()&&(!la(v.width)||!la(v.height));let d=v,T=v.width,S=v.height,x=!0;const y=window.chrome;if(h||y){const C=new OffscreenCanvas(mt(v.width),mt(v.height));T=C.width,S=C.height;const w=C.getContext("2d");w.translate(0,C.height),w.scale(1,-1),w.drawImage(v,0,0,v.width,v.height,0,0,C.width,C.height),d=C,x=!1}return e.width=T,e.height=S,e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,x),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),u(se.UNSIGNED_CHAR)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,d)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,d),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(se.UNSIGNED_CHAR,r(),t.useHalfFloat()),t.deactivate(),!0},t.create2DFromImageBitmap=v=>(t.getOpenGLDataType(se.UNSIGNED_CHAR),t.getInternalFormat(se.UNSIGNED_CHAR,4),t.getFormat(se.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType?(Jn("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=4,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),e.width=v.width,e.height=v.height,u(se.UNSIGNED_CHAR)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,v)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,v),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(se.UNSIGNED_CHAR,r(),t.useHalfFloat()),t.deactivate(),!0));function g(v,h,d){const T=new Array(d),S=new Array(d);for(let x=0;x<d;++x)T[x]=v[x],S[x]=h[x]-v[x]||1;return{scale:S,offset:T}}function f(v,h){for(let d=0;d<v.length;d++){const T=v[d],S=h[d]+T;if(T<-2048||T>2048||S<-2048||S>2048)return!1}return!0}function l(v,h,d,T){t.getOpenGLDataType(v);const S=f(h,d)||T;let x=!1;if(e._openGLRenderWindow.getWebgl2())x=e.openGLDataType===e.context.FLOAT&&e.context.getExtension("OES_texture_float_linear")===null&&S||e.openGLDataType===e.context.HALF_FLOAT;else{const y=e.context.getExtension("OES_texture_half_float");x=y&&e.openGLDataType===y.HALF_FLOAT_OES}e.canUseHalfFloat=x&&S}function p(v,h){const d=v.getNumberOfComponents(),T=v.getDataType(),S=v.getData(),x=new Array(d),y=new Array(d);for(let w=0;w<d;++w){const[R,O]=v.getRange(w);x[w]=R,y[w]=O}const C=g(x,y,d);return l(T,C.offset,C.scale,h),t.useHalfFloat()||t.getOpenGLDataType(T,!0),{numComps:d,dataType:T,data:S,scaleOffsets:C}}t.create2DFilterableFromRaw=function(){let{width:v=fe("width"),height:h=fe("height"),numComps:d=fe("numComps"),dataType:T=fe("dataType"),data:S=fe("data"),preferSizeOverAccuracy:x=!1,ranges:y=void 0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.create2DFilterableFromDataArray({width:v,height:h,dataArray:xe.newInstance({numberOfComponents:d,dataType:T,values:S,ranges:y}),preferSizeOverAccuracy:x})},t.create2DFilterableFromDataArray=function(){let{width:v=fe("width"),height:h=fe("height"),dataArray:d=fe("dataArray"),preferSizeOverAccuracy:T=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{numComps:S,dataType:x,data:y}=p(d,T);t.create2DFromRaw({width:v,height:h,numComps:S,dataType:x,data:y})},t.updateVolumeInfoForGL=(v,h)=>{let d=!1;const T=t.useHalfFloat();(!e.volumeInfo?.scale||!e.volumeInfo?.offset)&&(e.volumeInfo={scale:new Array(h),offset:new Array(h)});for(let S=0;S<h;++S)e.volumeInfo.scale[S]=1,e.volumeInfo.offset[S]=0;if(r()&&!T&&v===se.SHORT){for(let S=0;S<h;++S)e.volumeInfo.scale[S]=32767;d=!0}if(r()&&!T&&v===se.UNSIGNED_SHORT){for(let S=0;S<h;++S)e.volumeInfo.scale[S]=65535;d=!0}if(v===se.UNSIGNED_CHAR){for(let S=0;S<h;++S)e.volumeInfo.scale[S]=255;d=!0}return(v===se.FLOAT||T&&(v===se.SHORT||v===se.UNSIGNED_SHORT))&&(d=!0),d},t.create3DFromRaw=function(){let{width:v=fe("width"),height:h=fe("height"),depth:d=fe("depth"),numComps:T=fe("numComps"),dataType:S=fe("dataType"),data:x=fe("data"),updatedExtents:y=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},C=S,w=x;if(!t.updateVolumeInfoForGL(C,T)&&w){const B=v*h*d,_=structuredClone(e.volumeInfo),P=new Float32Array(B*T);e.volumeInfo.offset=_.offset,e.volumeInfo.scale=_.scale;let z=0;const A=_.scale.map(I=>1/I);for(let I=0;I<B;I++)for(let k=0;k<T;k++)P[z]=(w[z]-_.offset[k])*A[k],z++;C=se.FLOAT,w=P}if(t.getOpenGLDataType(C),t.getInternalFormat(C,T),t.getFormat(C,T),!e.internalFormat||!e.format||!e.openGLDataType)return Jn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_3D,e.components=T,e.width=v,e.height=h,e.depth=d,e.numberOfDimensions=3,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const R=y.length>0,O=!R||!R0(e._prevTexParams,n()),V=[w],m=t.updateArrayDataTypeForGL(C,V,!0,O?[]:y),F=c(m);if(e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),O)u(C)?(e.context.texStorage3D(e.target,1,e.internalFormat,e.width,e.height,e.depth),F[0]!=null&&e.context.texSubImage3D(e.target,0,0,0,0,e.width,e.height,e.depth,e.format,e.openGLDataType,F[0])):e.context.texImage3D(e.target,0,e.internalFormat,e.width,e.height,e.depth,0,e.format,e.openGLDataType,F[0]),e._prevTexParams=n();else if(R){const B=F[0];let _=0;for(let P=0;P<y.length;P++){const z=y[P],A=a(z),I=s(z),k=new B.constructor(B.buffer,_,I);_+=k.byteLength,e.context.texSubImage3D(e.target,0,z[0],z[2],z[4],A[0],A[1],A[2],e.format,e.openGLDataType,k)}}return e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(C,r(),t.useHalfFloat()),t.deactivate(),!0},t.create3DFilterableFromRaw=function(){let{width:v=fe("width"),height:h=fe("height"),depth:d=fe("depth"),numComps:T=fe("numComps"),dataType:S=fe("dataType"),data:x=fe("data"),preferSizeOverAccuracy:y=!1,ranges:C=void 0,updatedExtents:w=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.create3DFilterableFromDataArray({width:v,height:h,depth:d,dataArray:xe.newInstance({numberOfComponents:T,dataType:S,values:x,ranges:C}),preferSizeOverAccuracy:y,updatedExtents:w})},t.create3DFilterableFromDataArray=function(){let{width:v=fe("width"),height:h=fe("height"),depth:d=fe("depth"),dataArray:T=fe("dataArray"),preferSizeOverAccuracy:S=!1,updatedExtents:x=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{numComps:y,dataType:C,data:w,scaleOffsets:R}=p(T,S),O=[],V=[];for(let Ce=0;Ce<y;++Ce)O[Ce]=0,V[Ce]=1;if(e.volumeInfo={scale:V,offset:O,dataComputedScale:R.scale,dataComputedOffset:R.offset,width:v,height:h,depth:d},e._openGLRenderWindow.getWebgl2())return t.create3DFromRaw({width:v,height:h,depth:d,numComps:y,dataType:C,data:w,updatedExtents:x});const L=v*h*d,m=structuredClone(R);let F=(Ce,$e,Ot,Je,je)=>{Ce[$e]=Ot},B=se.UNSIGNED_CHAR;if(C===se.UNSIGNED_CHAR)for(let Ce=0;Ce<y;++Ce)m.offset[Ce]=0,m.scale[Ce]=255;else e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear")?(B=se.FLOAT,F=(Ce,$e,Ot,Je,je)=>{Ce[$e]=(Ot-Je)/je}):(B=se.UNSIGNED_CHAR,F=(Ce,$e,Ot,Je,je)=>{Ce[$e]=255*(Ot-Je)/je});if(t.getOpenGLDataType(B),t.getInternalFormat(B,y),t.getFormat(B,y),!e.internalFormat||!e.format||!e.openGLDataType)return Jn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=y,e.depth=1,e.numberOfDimensions=2;let _=e.context.getParameter(e.context.MAX_TEXTURE_SIZE);_>4096&&(B===se.FLOAT||y>=3)&&(_=4096);let P=1,z=1;L>_*_&&(P=Math.ceil(Math.sqrt(L/(_*_))),z=P);let A=Math.sqrt(L)/P;A=mt(A);const I=Math.floor(A*P/v),k=Math.ceil(d/I),Y=mt(h*k/z);e.width=A,e.height=Y,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.volumeInfo.xreps=I,e.volumeInfo.yreps=k,e.volumeInfo.xstride=P,e.volumeInfo.ystride=z,e.volumeInfo.offset=m.offset,e.volumeInfo.scale=m.scale;let te;const J=A*Y*y;B===se.FLOAT?te=new Float32Array(J):te=new Uint8Array(J);let q=0;const ht=Math.floor(v/P),Ae=Math.floor(h/z);for(let Ce=0;Ce<k;Ce++){const $e=Math.min(I,d-Ce*I),Ot=y*(e.width-$e*Math.floor(v/P));for(let Je=0;Je<Ae;Je++){for(let je=0;je<$e;je++){const wn=y*((Ce*I+je)*v*h+z*Je*v);for(let M=0;M<ht;M++)for(let D=0;D<y;D++)F(te,q,w[wn+P*M*y+D],m.offset[D],m.scale[D]),q++}q+=Ot}}return e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),u(B)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),te!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,te)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,te),t.deactivate(),!0},t.setOpenGLRenderWindow=v=>{e._openGLRenderWindow!==v&&(t.releaseGraphicsResources(),e._openGLRenderWindow=v,e.context=null,v&&(e.context=e._openGLRenderWindow.getContext()))},t.getMaximumTextureSize=v=>v&&v.isCurrent()?v.getIntegerv(v.MAX_TEXTURE_SIZE):-1,t.enableUseHalfFloat=v=>{e.enableUseHalfFloat=v}}const xM={_openGLRenderWindow:null,_forceInternalFormat:!1,_prevTexParams:null,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:un.CLAMP_TO_EDGE,wrapT:un.CLAMP_TO_EDGE,wrapR:un.CLAMP_TO_EDGE,minificationFilter:be.NEAREST,magnificationFilter:be.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1,oglNorm16Ext:null,allocatedGPUMemoryInBytes:0,enableUseHalfFloat:!0,canUseHalfFloat:!1};function v1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xM,n),Be.extend(t,e,n),e.sendParametersTime={},qe(e.sendParametersTime,{mtime:0}),e.textureBuildTime={},qe(e.textureBuildTime,{mtime:0}),ja(t,e,["format","openGLDataType"]),He(t,e,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap","oglNorm16Ext"]),pt(t,e,["width","height","volumeInfo","components","handle","target","allocatedGPUMemoryInBytes"]),Ka(t,e,["openGLRenderWindow"]),TM(t,e)}const y1=we(v1,"vtkOpenGLTexture");var hn={newInstance:y1,extend:v1,...h1};Ft("vtkTexture",y1);var SM=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexMC;

// frag position in VC
//VTK::PositionVC::Dec

// optional normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

// Apple Bug
//VTK::PrimID::Dec

// picking support
//VTK::Picking::Dec

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  //VTK::PrimID::Impl

  //VTK::PositionVC::Impl

  //VTK::Light::Impl

  //VTK::Picking::Impl
}
`,CM=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the polydata mappers fragment shader

uniform int PrimitiveIDOffset;

// VC position of this fragment
//VTK::PositionVC::Dec

// optional color passed in from the vertex shader, vertexColor
//VTK::Color::Dec

// optional surface normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// define vtkImageLabelOutlineOn
//VTK::ImageLabelOutlineOn

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// Depth Peeling Support
//VTK::DepthPeeling::Dec

// clipping plane vars
//VTK::Clip::Dec

// label outline 
//VTK::LabelOutline::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

//VTK::LabelOutlineHelperFunction

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Clip::Impl

  //VTK::Color::Impl

  // Generate the normal if we are not passed in one
  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Light::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;function wM(t,e){t.replaceShaderCoincidentOffset=(n,r,a)=>{const s=t.getCoincidentParameters(r,a);if(s&&(s.factor!==0||s.offset!==0)){let i=n.Fragment;i=N.substitute(i,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,e.context.getExtension("EXT_frag_depth")&&(s.factor!==0?(i=N.substitute(i,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,i=N.substitute(i,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):i=N.substitute(i,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),e._openGLRenderWindow.getWebgl2()&&(s.factor!==0?(i=N.substitute(i,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,i=N.substitute(i,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):i=N.substitute(i,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),n.Fragment=i}}}function EM(t,e){t.applyShaderReplacements=(n,r,a)=>{let s=null;if(r&&(s=r.ShaderReplacements),s)for(let i=0;i<s.length;i++){const o=s[i];if(a&&o.replaceFirst||!a&&!o.replaceFirst){const c=o.shaderType,u=n[c],g=N.substitute(u,o.originalValue,o.replacementValue,o.replaceAll);n[c]=g.result}}},t.buildShaders=(n,r,a)=>{t.getReplacedShaderTemplate(n,r,a),e.lastRenderPassShaderReplacement=e.currentRenderPass?e.currentRenderPass.getShaderReplacement():null,e.lastRenderPassShaderReplacement&&e.lastRenderPassShaderReplacement(n);const s=e.renderable.getViewSpecificProperties().OpenGL;t.applyShaderReplacements(n,s,!0),t.replaceShaderValues(n,r,a),t.applyShaderReplacements(n,s)},t.getReplacedShaderTemplate=(n,r,a)=>{const s=e.renderable.getViewSpecificProperties().OpenGL;t.getShaderTemplate(n,r,a);let i=n.Vertex;if(s){const u=s.VertexShaderCode;u!==void 0&&u!==""&&(i=u)}n.Vertex=i;let o=n.Fragment;if(s){const u=s.FragmentShaderCode;u!==void 0&&u!==""&&(o=u)}n.Fragment=o;let c=n.Geometry;if(s){const u=s.GeometryShaderCode;u!==void 0&&(c=u)}n.Geometry=c}}var oi={implementReplaceShaderCoincidentOffset:wM,implementBuildShadersWithReplacements:EM};const{FieldAssociations:ho}=Sr,{primTypes:We}=Qr,{Representation:Rr,Shading:Dg}=qr,{ScalarMode:hs}=yr,{Filter:Lg,Wrap:mg}=hn,{vtkErrorMacro:er}=nn,RM={type:"StartEvent"},OM={type:"EndEvent"},{CoordinateSystem:MM}=qa;function DM(t){const e=t.getSelector();return e?e.getCurrentPass():ct.MIN_KNOWN_PASS-1}function LM(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper"),t.buildPass=r=>{r&&(e.currentRenderPass=null,e.openGLActor=t.getFirstAncestorOfType("vtkOpenGLActor"),e._openGLRenderer=e.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera(),e.openGLCamera))},t.translucentPass=(r,a)=>{r&&(e.currentRenderPass=a,t.render())},t.zBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=r=>t.zBufferPass(r),t.opaquePass=r=>{r&&t.render()},t.render=()=>{const r=e._openGLRenderWindow.getContext();if(e.context!==r){e.context=r;for(let i=We.Start;i<We.End;i++)e.primitives[i].setOpenGLRenderWindow(e._openGLRenderWindow)}const a=e.openGLActor.getRenderable(),s=e._openGLRenderer.getRenderable();t.renderPiece(s,a)},t.getShaderTemplate=(r,a,s)=>{r.Vertex=SM,r.Fragment=CM,r.Geometry=""},t.replaceShaderColor=(r,a,s)=>{let i=r.Vertex,o=r.Geometry,c=r.Fragment;const u=e.lastBoundBO.getReferenceByName("lastLightComplexity");let g=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];u&&(g=g.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let f=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];u&&(f=f.concat(["  vec3 specularColor;","  float specularPower;"])),f=f.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),u&&(f=f.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges&&(g=g.concat(["varying vec4 vertexColorVSOutput;"]),i=N.substitute(i,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,i=N.substitute(i,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,o=N.substitute(o,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,o=N.substitute(o,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges?c=N.substitute(c,"//VTK::Color::Impl",f.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result:(e.renderable.getAreScalarsMappedFromCells()||e.renderable.getInterpolateScalarsBeforeMapping())&&e.renderable.getColorCoordinates()&&!e.drawingEdges?c=N.substitute(c,"//VTK::Color::Impl",f.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:(s.getBackfaceProperty()&&!e.drawingEdges&&(g=g.concat(["uniform float opacityUniformBF; // the fragment opacity","uniform float ambientIntensityBF; // the material ambient","uniform float diffuseIntensityBF; // the material diffuse","uniform vec3 ambientColorUniformBF; // ambient material color","uniform vec3 diffuseColorUniformBF; // diffuse material color"]),u?(g=g.concat(["uniform float specularIntensityBF; // the material specular intensity","uniform vec3 specularColorUniformBF; // intensity weighted color","uniform float specularPowerUniformBF;"]),f=f.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  specularColor = specularIntensityBF * specularColorUniformBF;","  specularPower = specularPowerUniformBF;","  opacity = opacityUniformBF; }"])):f=f.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  opacity = opacityUniformBF; }"])),e.haveCellScalars&&!e.drawingEdges&&(g=g.concat(["uniform samplerBuffer texture1;"])),c=N.substitute(c,"//VTK::Color::Impl",f).result),c=N.substitute(c,"//VTK::Color::Dec",g).result,r.Vertex=i,r.Geometry=o,r.Fragment=c},t.replaceShaderLight=(r,a,s)=>{let i=r.Fragment;const o="",c=e.lastBoundBO.getReferenceByName("lastLightComplexity"),u=e.lastBoundBO.getReferenceByName("lastLightCount");let g=[];switch(c){case 0:i=N.substitute(i,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:i=N.substitute(i,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(let f=0;f<u;++f)g=g.concat([`uniform vec3 lightColor${f};`,`uniform vec3 lightDirectionVC${f}; // normalized`,`uniform vec3 lightHalfAngleVC${f}; // normalized`]);i=N.substitute(i,"//VTK::Light::Dec",g).result,g=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(let f=0;f<u;++f)g=g.concat([`  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC${f}));`,`  diffuseL += ((df${o}) * lightColor${f});`,`  if (dot(normalVCVSOutput, lightDirectionVC${f}) < 0.0)`,"    {",`    float sf = sign(df)*pow(max(1e-5,
                                              dot(reflect(lightDirectionVC${f},normalVCVSOutput),
                                                  normalize(-vertexVC.xyz))),
                                         specularPower);`,`    specularL += (sf${o} * lightColor${f});`,"    }"]);g=g.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),i=N.substitute(i,"//VTK::Light::Impl",g,!1).result;break;case 3:for(let f=0;f<u;++f)g=g.concat([`uniform vec3 lightColor${f};`,`uniform vec3 lightDirectionVC${f}; // normalized`,`uniform vec3 lightHalfAngleVC${f}; // normalized`,`uniform vec3 lightPositionVC${f};`,`uniform vec3 lightAttenuation${f};`,`uniform float lightConeAngle${f};`,`uniform float lightExponent${f};`,`uniform int lightPositional${f};`]);i=N.substitute(i,"//VTK::Light::Dec",g).result,g=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(let f=0;f<u;++f)g=g.concat(["  attenuation = 1.0;",`  if (lightPositional${f} == 0)`,"    {",`      vertLightDirectionVC = lightDirectionVC${f};`,"    }","  else","    {",`    vertLightDirectionVC = vertexVC.xyz - lightPositionVC${f};`,"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /",`      (lightAttenuation${f}.x`,`       + lightAttenuation${f}.y * distanceVC`,`       + lightAttenuation${f}.z * distanceVC * distanceVC);`,"    // per OpenGL standard cone angle is 90 or less for a spot light",`    if (lightConeAngle${f} <= 90.0)`,"      {",`      float coneDot = dot(vertLightDirectionVC, lightDirectionVC${f});`,"      // if inside the cone",`      if (coneDot >= cos(radians(lightConeAngle${f})))`,"        {",`        attenuation = attenuation * pow(coneDot, lightExponent${f});`,"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));",`    diffuseL += ((df${o}) * lightColor${f});`,"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {",`      float sf = sign(df)*attenuation*pow(max(1e-5,
                                                           dot(reflect(lightDirectionVC${f},
                                                                       normalVCVSOutput),
                                                               normalize(-vertexVC.xyz))),
                                                       specularPower);`,`    specularL += ((sf${o}) * lightColor${f});`,"    }"]);g=g.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),i=N.substitute(i,"//VTK::Light::Impl",g,!1).result;break;default:er("bad light complexity")}r.Fragment=i},t.replaceShaderNormal=(r,a,s)=>{if(e.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let o=r.Vertex,c=r.Geometry,u=r.Fragment;e.lastBoundBO.getCABO().getNormalOffset()?(o=N.substitute(o,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,o=N.substitute(o,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,c=N.substitute(c,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,c=N.substitute(c,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,u=N.substitute(u,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,u=N.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.haveCellNormals?(u=N.substitute(u,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,u=N.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.lastBoundBO.getOpenGLMode(s.getProperty().getRepresentation())===e.context.LINES?(u=N.substitute(u,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,u=N.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  if (abs(fdx.x) > 0.0)","    { fdx = normalize(fdx); normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { fdy = normalize(fdy); normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(u=N.substitute(u,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,u=N.substitute(u,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,u=N.substitute(u,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),r.Vertex=o,r.Geometry=c,r.Fragment=u}},t.replaceShaderPositionVC=(r,a,s)=>{e.lastBoundBO.replaceShaderPositionVC(r,a,s);let i=r.Vertex,o=r.Geometry,c=r.Fragment;e.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(i=N.substitute(i,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,i=N.substitute(i,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,i=N.substitute(i,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,o=N.substitute(o,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,o=N.substitute(o,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,c=N.substitute(c,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,c=N.substitute(c,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(i=N.substitute(i,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,i=N.substitute(i,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),r.Vertex=i,r.Geometry=o,r.Fragment=c},t.replaceShaderTCoord=(r,a,s)=>{if(e.lastBoundBO.getCABO().getTCoordOffset()){let i=r.Vertex,o=r.Geometry,c=r.Fragment;if(e.drawingEdges)return;i=N.substitute(i,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;const u=e.openGLActor.getActiveTextures();let g=2,f=2;if(u&&u.length>0&&(g=u[0].getComponents(),u[0].getTarget()===e.context.TEXTURE_CUBE_MAP&&(f=3)),e.renderable.getColorTextureMap()&&(g=e.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),f=2),f===2){if(i=N.substitute(i,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,o=N.substitute(o,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,o=N.substitute(o,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,c=N.substitute(c,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,u&&u.length>=1)switch(g){case 1:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}}else switch(i=N.substitute(i,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,o=N.substitute(o,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,o=N.substitute(o,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,c=N.substitute(c,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,g){case 1:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}r.Vertex=i,r.Geometry=o,r.Fragment=c}},t.replaceShaderClip=(r,a,s)=>{let i=r.Vertex,o=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){const c=e.renderable.getNumberOfClippingPlanes();i=N.substitute(i,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`uniform vec4 clipPlanes[${c}];`,`varying float clipDistancesVSOutput[${c}];`]).result,i=N.substitute(i,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${c}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,o=N.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`varying float clipDistancesVSOutput[${c}];`]).result,o=N.substitute(o,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${c}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=i,r.Fragment=o},t.getCoincidentParameters=(r,a)=>{let s={factor:0,offset:0};const i=a.getProperty();if(e.renderable.getResolveCoincidentTopology()==Pn.PolygonOffset||i.getEdgeVisibility()&&i.getRepresentation()===Rr.SURFACE){const c=e.lastBoundBO.getPrimitiveType();c===We.Points||i.getRepresentation()===Rr.POINTS?s=e.renderable.getCoincidentTopologyPointOffsetParameter():c===We.Lines||i.getRepresentation()===Rr.WIREFRAME?s=e.renderable.getCoincidentTopologyLineOffsetParameters():(c===We.Tris||c===We.TriStrips)&&(s=e.renderable.getCoincidentTopologyPolygonOffsetParameters()),(c===We.TrisEdges||c===We.TriStripsEdges)&&(s=e.renderable.getCoincidentTopologyPolygonOffsetParameters(),s.factor/=2,s.offset/=2)}const o=e._openGLRenderer.getSelector();return o&&o.getFieldAssociation()===ho.FIELD_ASSOCIATION_POINTS&&(s.offset-=2),s},t.replaceShaderPicking=(r,a,s)=>{let i=r.Fragment,o=r.Vertex;if(i=N.substitute(i,"//VTK::Picking::Dec",["uniform int picking;","//VTK::Picking::Dec"]).result,!!e._openGLRenderer.getSelector()){switch((e.lastSelectionState===ct.ID_LOW24||e.lastSelectionState===ct.ID_HIGH24)&&(o=N.substitute(o,"//VTK::Picking::Dec",[`flat out int vertexIDVSOutput;
`,`uniform int VertexIDOffset;
`]).result,o=N.substitute(o,"//VTK::Picking::Impl",`  vertexIDVSOutput = gl_VertexID + VertexIDOffset;
`).result,i=N.substitute(i,"//VTK::Picking::Dec",`flat in int vertexIDVSOutput;
`).result,i=N.substitute(i,"//VTK::Picking::Impl",["  int idx = vertexIDVSOutput;","//VTK::Picking::Impl"]).result),e.lastSelectionState){case ct.ID_LOW24:i=N.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx%256)/255.0, float((idx/256)%256)/255.0, float((idx/65536)%256)/255.0, 1.0);").result;break;case ct.ID_HIGH24:i=N.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float((idx/16777216)%256)/255.0, 0.0, 0.0, 1.0);").result;break;default:i=N.substitute(i,"//VTK::Picking::Dec","uniform vec3 mapperIndex;").result,i=N.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result}r.Fragment=i,r.Vertex=o}},t.replaceShaderValues=(r,a,s)=>{if(t.replaceShaderColor(r,a,s),t.replaceShaderNormal(r,a,s),t.replaceShaderLight(r,a,s),t.replaceShaderTCoord(r,a,s),t.replaceShaderPicking(r,a,s),t.replaceShaderClip(r,a,s),t.replaceShaderCoincidentOffset(r,a,s),t.replaceShaderPositionVC(r,a,s),e.haveSeenDepthRequest){let i=r.Fragment;i=N.substitute(i,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,i=N.substitute(i,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,r.Fragment=i}},t.getNeedToRebuildShaders=(r,a,s)=>{let i=0,o=0;const c=r.getPrimitiveType(),u=e.currentInput;let g=!1;const f=u.getPointData().getNormals(),l=u.getCellData().getNormals(),p=s.getProperty().getInterpolation()===Dg.FLAT,v=s.getProperty().getRepresentation(),h=r.getOpenGLMode(v,c);if((h===e.context.TRIANGLES||l&&!f||!p&&f||!p&&h===e.context.LINES)&&(g=!0),s.getProperty().getLighting()&&g){i=0;const x=a.getLightsByReference();for(let y=0;y<x.length;++y){const C=x[y];C.getSwitch()>0&&(o++,i===0&&(i=1)),i===1&&(o>1||C.getIntensity()!==1||!C.lightTypeIsHeadLight())&&(i=2),i<3&&C.getPositional()&&(i=3)}}let d=!1;const T=e.lastBoundBO.getReferenceByName("lastLightComplexity"),S=e.lastBoundBO.getReferenceByName("lastLightCount");return(T!==i||S!==o)&&(e.lastBoundBO.set({lastLightComplexity:i},!0),e.lastBoundBO.set({lastLightCount:o},!0),d=!0),(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(d=!0),e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime()||r.getShaderSourceTime().getMTime()<e.selectionStateChanged.getMTime()||d?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,!0):!1},t.invokeShaderCallbacks=(r,a,s)=>{const i=e.renderable.getViewSpecificProperties().ShadersCallbacks;i&&i.forEach(o=>{o.callback(o.userData,r,a,s)})},t.setMapperShaderParameters=(r,a,s)=>{if(r.getProgram().isUniformUsed("PrimitiveIDOffset")&&r.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),r.getProgram().isUniformUsed("VertexIDOffset")&&r.getProgram().setUniformi("VertexIDOffset",e.vertexIDOffset),r.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){const c=e.lastBoundBO.getReferenceByName("lastLightComplexity");r.getProgram().isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexMC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||er("Error setting vertexMC in shader VAO.")),r.getProgram().isAttributeUsed("normalMC")&&r.getCABO().getNormalOffset()&&c>0?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"normalMC",r.getCABO().getNormalOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||er("Error setting normalMC in shader VAO."):r.getVAO().removeAttributeArray("normalMC"),e.renderable.getCustomShaderAttributes().forEach((u,g)=>{r.getProgram().isAttributeUsed(`${u}MC`)&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),`${u}MC`,r.getCABO().getCustomData()[g].offset,r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getCustomData()[g].components,!1)||er(`Error setting ${u}MC in shader VAO.`))}),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),!1)||er("Error setting tcoordMC in shader VAO."):r.getVAO().removeAttributeArray("tcoordMC"),r.getProgram().isAttributeUsed("scalarColor")&&r.getCABO().getColorComponents()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO().getColorBO(),"scalarColor",r.getCABO().getColorOffset(),r.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||er("Error setting scalarColor in shader VAO."):r.getVAO().removeAttributeArray("scalarColor"),r.getAttributeUpdateTime().modified()}if(e.renderable.getNumberOfClippingPlanes()){const c=e.renderable.getNumberOfClippingPlanes(),u=[],f=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,l=f?Qe(e.tmpMat4,s.getMatrix()):s.getMatrix();f&&(De(l,l),Ne(l,l,f),De(l,l));for(let p=0;p<c;p++){const v=[];e.renderable.getClippingPlaneInDataCoords(l,p,v);for(let h=0;h<4;h++)u.push(v[h])}r.getProgram().setUniformi("numClipPlanes",c),r.getProgram().setUniform4fv("clipPlanes",u)}e.internalColorTexture&&r.getProgram().isUniformUsed("texture1")&&r.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());const i=e.openGLActor.getActiveTextures();if(i)for(let c=0;c<i.length;++c){const g=i[c].getTextureUnit(),f=`texture${g+1}`;r.getProgram().isUniformUsed(f)&&r.getProgram().setUniformi(f,g)}if(e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),r.getProgram().isUniformUsed("coffset")){const c=t.getCoincidentParameters(a,s);r.getProgram().setUniformf("coffset",c.offset),r.getProgram().isUniformUsed("cfactor")&&r.getProgram().setUniformf("cfactor",c.factor)}r.setMapperShaderParameters(a,s,e._openGLRenderer.getTiledSizeAndOrigin());const o=e._openGLRenderer.getSelector();r.getProgram().setUniform3fArray("mapperIndex",o?o.getPropColorValue():[0,0,0]),r.getProgram().setUniformi("picking",o?o.getCurrentPass()+1:0)},t.setLightingShaderParameters=(r,a,s)=>{const i=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(i<2)return;const o=r.getProgram();let c=0;const u=a.getLightsByReference();for(let l=0;l<u.length;++l){const p=u[l];if(p.getSwitch()>0){const h=p.getColorByReference(),d=p.getIntensity();e.lightColor[0]=h[0]*d,e.lightColor[1]=h[1]*d,e.lightColor[2]=h[2]*d;const T=p.getDirection(),S=a.getActiveCamera().getViewMatrix(),x=[...T];p.lightTypeIsSceneLight()&&(x[0]=S[0]*T[0]+S[1]*T[1]+S[2]*T[2],x[1]=S[4]*T[0]+S[5]*T[1]+S[6]*T[2],x[2]=S[8]*T[0]+S[9]*T[1]+S[10]*T[2],Rt(x)),e.lightDirection[0]=x[0],e.lightDirection[1]=x[1],e.lightDirection[2]=x[2],Rt(e.lightDirection),o.setUniform3fArray(`lightColor${c}`,e.lightColor),o.setUniform3fArray(`lightDirectionVC${c}`,e.lightDirection),c++}}if(i<3)return;const f=a.getActiveCamera().getViewMatrix();De(f,f),c=0;for(let l=0;l<u.length;++l){const p=u[l];if(p.getSwitch()>0){const h=p.getTransformedPosition(),d=new Float64Array(3);Te(d,h,f),o.setUniform3fArray(`lightAttenuation${c}`,p.getAttenuationValuesByReference()),o.setUniformi(`lightPositional${c}`,p.getPositional()),o.setUniformf(`lightExponent${c}`,p.getExponent()),o.setUniformf(`lightConeAngle${c}`,p.getConeAngle()),o.setUniform3fArray(`lightPositionVC${c}`,[d[0],d[1],d[2]]),c++}}};function n(r,a,s){return a.identity(s),r.reduce((i,o,c)=>c===0?o?a.copy(i,o):a.identity(i):o?a.multiply(i,i,o):i,s)}t.setCameraShaderParameters=(r,a,s)=>{const i=r.getProgram(),o=e.openGLCamera.getKeyMatrices(a),c=a.getActiveCamera(),u=e.openGLCamera.getKeyMatrixTime().getMTime(),g=i.getLastCameraMTime(),l=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,p=s.getIsIdentity(),v=p?{mcwc:null,normalMatrix:null}:e.openGLActor.getKeyMatrices();if(s.getCoordinateSystem()===MM.DISPLAY){const h=e._openGLRenderer.getTiledSizeAndOrigin();ue(e.tmpMat4),e.tmpMat4[0]=2/h.usize,e.tmpMat4[12]=-1,e.tmpMat4[5]=2/h.vsize,e.tmpMat4[13]=-1,Ne(e.tmpMat4,e.tmpMat4,l),i.setUniformMatrix("MCPCMatrix",e.tmpMat4)}else i.setUniformMatrix("MCPCMatrix",n([o.wcpc,v.mcwc,l],Wo,e.tmpMat4));i.isUniformUsed("MCVCMatrix")&&i.setUniformMatrix("MCVCMatrix",n([o.wcvc,v.mcwc,l],Wo,e.tmpMat4)),i.isUniformUsed("normalMatrix")&&i.setUniformMatrix3x3("normalMatrix",n([o.normalMatrix,v.normalMatrix],YT,e.tmpMat3)),g!==u&&(i.isUniformUsed("cameraParallel")&&i.setUniformi("cameraParallel",c.getParallelProjection()),i.setLastCameraMTime(u)),p||i.setLastCameraMTime(0)},t.setPropertyShaderParameters=(r,a,s)=>{const i=r.getProgram();let o=s.getProperty(),c=o.getOpacity(),u=e.drawingEdges?o.getEdgeColorByReference():o.getAmbientColorByReference(),g=e.drawingEdges?o.getEdgeColorByReference():o.getDiffuseColorByReference(),f=e.drawingEdges?1:o.getAmbient(),l=e.drawingEdges?0:o.getDiffuse(),p=e.drawingEdges?0:o.getSpecular();const v=o.getSpecularPower();i.setUniformf("opacityUniform",c),i.setUniform3fArray("ambientColorUniform",u),i.setUniform3fArray("diffuseColorUniform",g),i.setUniformf("ambient",f),i.setUniformf("diffuse",l);const h=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(h<1)return;let d=o.getSpecularColorByReference();if(i.setUniform3fArray("specularColorUniform",d),i.setUniformf("specularPowerUniform",v),i.setUniformf("specular",p),i.isUniformUsed("ambientIntensityBF")){if(o=s.getBackfaceProperty(),c=o.getOpacity(),u=o.getAmbientColor(),f=o.getAmbient(),g=o.getDiffuseColor(),l=o.getDiffuse(),d=o.getSpecularColor(),p=o.getSpecular(),i.setUniformf("ambientIntensityBF",f),i.setUniformf("diffuseIntensityBF",l),i.setUniformf("opacityUniformBF",c),i.setUniform3fArray("ambientColorUniformBF",u),i.setUniform3fArray("diffuseColorUniformBF",g),h<1)return;i.setUniformf("specularIntensityBF",p),i.setUniform3fArray("specularColorUniformBF",d),i.setUniformf("specularPowerUniformBF",v)}},t.updateMaximumPointCellIds=(r,a)=>{const s=e._openGLRenderer.getSelector();if(!s)return;if(e.selectionWebGLIdsToVTKIds?.points?.length){const o=e.selectionWebGLIdsToVTKIds.points.length;s.setMaximumPointId(o-1)}if(e.selectionWebGLIdsToVTKIds?.cells?.length){const o=e.selectionWebGLIdsToVTKIds.cells.length;s.setMaximumCellId(o-1)}s.getFieldAssociation()===ho.FIELD_ASSOCIATION_POINTS&&(e.pointPicking=!0)},t.renderPieceStart=(r,a)=>{e.primitiveIDOffset=0,e.vertexIDOffset=0;const s=DM(e._openGLRenderer);e.lastSelectionState!==s&&(e.selectionStateChanged.modified(),e.lastSelectionState=s),e._openGLRenderer.getSelector()&&e._openGLRenderer.getSelector().renderProp(a),t.updateBufferObjects(r,a),e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),e.lastBoundBO=null},t.renderPieceDraw=(r,a)=>{const s=a.getProperty().getRepresentation(),i=a.getProperty().getEdgeVisibility()&&s===Rr.SURFACE,o=e._openGLRenderer.getSelector(),c=o&&o.getFieldAssociation()===ho.FIELD_ASSOCIATION_POINTS&&(e.lastSelectionState===ct.ID_LOW24||e.lastSelectionState===ct.ID_HIGH24);for(let u=We.Start;u<We.End;u++)e.primitives[u].setPointPicking(c),e.primitives[u].getCABO().getElementCount()&&(e.drawingEdges=i&&(u===We.TrisEdges||u===We.TriStripsEdges),(!e.drawingEdges||!(e.renderDepth||e.lastSelectionState>=0))&&(e.lastBoundBO=e.primitives[u],e.primitiveIDOffset+=e.primitives[u].drawArrays(r,a,s,t),e.vertexIDOffset+=e.primitives[u].getCABO().getElementCount()))},t.renderPieceFinish=(r,a)=>{e.LastBoundBO&&e.LastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.renderPiece=(r,a)=>{if(t.invokeEvent(RM),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(OM),!e.currentInput){er("No input!");return}if(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())return;const s=e.context,i=a.getProperty().getBackfaceCulling(),o=a.getProperty().getFrontfaceCulling();!i&&!o?e._openGLRenderWindow.disableCullFace():o?(e._openGLRenderWindow.enableCullFace(),s.cullFace(s.FRONT)):(e._openGLRenderWindow.enableCullFace(),s.cullFace(s.BACK)),t.renderPieceStart(r,a),t.renderPieceDraw(r,a),t.renderPieceFinish(r,a)},t.updateBufferObjects=(r,a)=>{t.getNeedToRebuildBufferObjects(r,a)&&t.buildBufferObjects(r,a),t.updateMaximumPointCellIds()},t.getNeedToRebuildBufferObjects=(r,a)=>{const s=e.VBOBuildTime.getMTime();return s<t.getMTime()||s<e.renderable.getMTime()||s<a.getMTime()||s<e.currentInput.getMTime()},t.buildBufferObjects=(r,a)=>{const s=e.currentInput;if(s===null)return;e.renderable.mapScalars(s,1);const i=e.renderable.getColorMapColors();e.haveCellScalars=!1;const o=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(o===hs.USE_CELL_DATA||o===hs.USE_CELL_FIELD_DATA||o===hs.USE_FIELD_DATA||!s.getPointData().getScalars())&&o!==hs.USE_POINT_FIELD_DATA&&i&&(e.haveCellScalars=!0);let c=a.getProperty().getInterpolation()!==Dg.FLAT?s.getPointData().getNormals():null;c===null&&s.getCellData().getNormals()&&(e.haveCellNormals=!0,c=s.getCellData().getNormals());const u=a.getProperty().getRepresentation();let g=s.getPointData().getTCoords();e.openGLActor.getActiveTextures()||(g=null);let f=!1;if(e.renderable.getColorCoordinates()){g=e.renderable.getColorCoordinates(),f=e.renderable.getAreScalarsMappedFromCells(),e.internalColorTexture||(e.internalColorTexture=hn.newInstance({resizable:!0}));const p=e.internalColorTexture;p.setMinificationFilter(Lg.NEAREST),p.setMagnificationFilter(Lg.NEAREST),p.setWrapS(mg.CLAMP_TO_EDGE),p.setWrapT(mg.CLAMP_TO_EDGE),p.setOpenGLRenderWindow(e._openGLRenderWindow);const v=e.renderable.getColorTextureMap(),h=v.getExtent(),d=v.getPointData().getScalars();p.create2DFromRaw({width:h[1]-h[0]+1,height:h[3]-h[2]+1,numComps:d.getNumberOfComponents(),dataType:d.getDataType(),data:d.getData()}),p.activate(),p.sendParameters(),p.deactivate()}const l=`${s.getMTime()}A${u}B${s.getMTime()}C${c?c.getMTime():1}D${i?i.getMTime():1}E${a.getProperty().getEdgeVisibility()}F${g?g.getMTime():1}`;if(e.VBOBuildString!==l){const v={points:s.getPoints(),normals:c,tcoords:g,colors:i,cellOffset:0,vertexOffset:0,useTCoordsPerCell:f,haveCellScalars:e.haveCellScalars,haveCellNormals:e.haveCellNormals,customAttributes:e.renderable.getCustomShaderAttributes().map(T=>s.getPointData().getArrayByName(T))};e.renderable.getPopulateSelectionSettings()&&(e.selectionWebGLIdsToVTKIds={points:null,cells:null});const h=[{inRep:"verts",cells:s.getVerts()},{inRep:"lines",cells:s.getLines()},{inRep:"polys",cells:s.getPolys()},{inRep:"strips",cells:s.getStrips()},{inRep:"polys",cells:s.getPolys()},{inRep:"strips",cells:s.getStrips()}],d=a.getProperty().getEdgeVisibility()&&u===Rr.SURFACE;for(let T=We.Start;T<We.End;T++)T!==We.TrisEdges&&T!==We.TriStripsEdges?(v.cellOffset+=e.primitives[T].getCABO().createVBO(h[T].cells,h[T].inRep,u,v,e.selectionWebGLIdsToVTKIds),v.vertexOffset+=e.primitives[T].getCABO().getElementCount()):d?e.primitives[T].getCABO().createVBO(h[T].cells,h[T].inRep,Rr.WIREFRAME,{...v,tcoords:null,colors:null,haveCellScalars:!1,haveCellNormals:!1}):e.primitives[T].releaseGraphicsResources();e.renderable.getPopulateSelectionSettings()&&e.renderable.setSelectionWebGLIdsToVTKIds(e.selectionWebGLIdsToVTKIds),e.VBOBuildString=l}e.VBOBuildTime.modified()},t.getAllocatedGPUMemoryInBytes=()=>{let r=0;return e.primitives.forEach(a=>{r+=a.getAllocatedGPUMemoryInBytes()}),r}}const mM={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastSelectionState:ct.MIN_KNOWN_PASS-1,selectionStateChanged:null,selectionWebGLIdsToVTKIds:null,pointPicking:!1};function VM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mM,n),Be.extend(t,e,n),oi.implementReplaceShaderCoincidentOffset(t,e,n),oi.implementBuildShadersWithReplacements(t,e,n),e.primitives=[],e.primTypes=We,e.tmpMat3=Kn(new Float64Array(9)),e.tmpMat4=ue(new Float64Array(16));for(let r=We.Start;r<We.End;r++)e.primitives[r]=Qr.newInstance(),e.primitives[r].setPrimitiveType(r),e.primitives[r].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);He(t,e,["context"]),e.VBOBuildTime={},qe(e.VBOBuildTime,{mtime:0}),e.selectionStateChanged={},qe(e.selectionStateChanged,{mtime:0}),LM(t,e)}const FM=we(VM,"vtkOpenGLPolyDataMapper");Ft("vtkMapper",FM);var BM=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

uniform int PrimitiveIDOffset;

// Texture coordinates
//VTK::TCoord::Dec

// Scalar coloring
//VTK::Color::Dec

// Depth Peeling
//VTK::DepthPeeling::Dec

// picking support
//VTK::Picking::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Color::Impl
  //VTK::TCoord::Impl

  //VTK::DepthPeeling::Impl
  //VTK::Picking::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }
}
`,_M=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model Coordinates
// WC - WC world coordinates
// VC - View Coordinates
// DC - Display Coordinates

in vec4 vertexWC;

// frag position in VC
//VTK::PositionVC::Dec

// material property values
//VTK::Color::Dec

// Texture coordinates
//VTK::TCoord::Dec

// Apple Bug
//VTK::PrimID::Dec

uniform mat4 WCVCMatrix;  // World to view matrix

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  gl_Position = WCVCMatrix*vertexWC;

  //VTK::TCoord::Impl

  //VTK::Color::Impl

  //VTK::PositionVC::Impl
}
`;const T1={BACKGROUND:0,FOREGROUND:1};var x1={DisplayLocation:T1};const{primTypes:_t}=Qr,{Filter:Vg,Wrap:Fg}=hn,{vtkErrorMacro:sa}=nn,UM={type:"StartEvent"},NM={type:"EndEvent"};function kM(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper2D"),t.buildPass=r=>{r&&(e.openGLActor2D=t.getFirstAncestorOfType("vtkOpenGLActor2D"),e._openGLRenderer=e.openGLActor2D.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera(),e.openGLCamera))},t.overlayPass=r=>{r&&t.render()},t.getShaderTemplate=(r,a,s)=>{r.Vertex=_M,r.Fragment=BM,r.Geometry=""},t.render=()=>{const r=e._openGLRenderWindow.getContext();if(e.context!==r){e.context=r;for(let i=_t.Start;i<_t.End;i++)e.primitives[i].setOpenGLRenderWindow(e._openGLRenderWindow)}const a=e.openGLActor2D.getRenderable(),s=e._openGLRenderer.getRenderable();t.renderPiece(s,a)},t.renderPiece=(r,a)=>{if(t.invokeEvent(UM),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(NM),!e.currentInput){sa("No input!");return}if(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())return;const s=e.context;e._openGLRenderWindow.enableCullFace(),s.cullFace(s.BACK),t.renderPieceStart(r,a),t.renderPieceDraw(r,a),t.renderPieceFinish(r,a)},t.renderPieceStart=(r,a)=>{if(e.primitiveIDOffset=0,e._openGLRenderer.getSelector())switch(e._openGLRenderer.getSelector().getCurrentPass()){default:e._openGLRenderer.getSelector().renderProp(a)}e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),t.updateBufferObjects(r,a),e.lastBoundBO=null},t.getNeedToRebuildShaders=(r,a,s)=>r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime(),t.updateBufferObjects=(r,a)=>{t.getNeedToRebuildBufferObjects(r,a)&&t.buildBufferObjects(r,a)},t.getNeedToRebuildBufferObjects=(r,a)=>{const s=e.VBOBuildTime.getMTime();return!!(s<t.getMTime()||s<e._openGLRenderWindow.getMTime()||s<e.renderable.getMTime()||s<a.getMTime()||s<e.currentInput.getMTime()||e.renderable.getTransformCoordinate()&&s<r.getMTime())},t.buildBufferObjects=(r,a)=>{const s=e.currentInput;if(s===null)return;e.renderable.mapScalars(s,a.getProperty().getOpacity());const i=e.renderable.getColorMapColors(),o=a.getProperty().getRepresentation();let c=s.getPointData().getTCoords();e.openGLActor2D.getActiveTextures()||(c=null);let u=!1;if(e.renderable.getColorCoordinates()){c=e.renderable.getColorCoordinates(),u=e.renderable.getAreScalarsMappedFromCells(),e.internalColorTexture||(e.internalColorTexture=hn.newInstance({resizable:!0}));const v=e.internalColorTexture;v.setMinificationFilter(Vg.NEAREST),v.setMagnificationFilter(Vg.NEAREST),v.setWrapS(Fg.CLAMP_TO_EDGE),v.setWrapT(Fg.CLAMP_TO_EDGE),v.setOpenGLRenderWindow(e._openGLRenderWindow);const h=e.renderable.getColorTextureMap(),d=h.getExtent(),T=h.getPointData().getScalars();v.create2DFromRaw({width:d[1]-d[0]+1,height:d[3]-d[2]+1,numComps:T.getNumberOfComponents(),dataType:T.getDataType(),data:T.getData()}),v.activate(),v.sendParameters(),v.deactivate()}const g=e.renderable.getTransformCoordinate(),l=r.getRenderWindow().getViews()[0].getViewportSize(r),p=`${s.getMTime()}A${o}B${s.getMTime()}C${i?i.getMTime():1}D${c?c.getMTime():1}E${g?r.getMTime():1}F${l}`;if(e.VBOBuildString!==p){let v=s.getPoints();if(g){const d=$a.newInstance(),T=v.getNumberOfPoints();d.setNumberOfPoints(T);const S=[];for(let x=0;x<T;++x){v.getPoint(x,S),g.setValue(S);const y=g.getComputedDoubleViewportValue(r);d.setPoint(x,y[0],y[1],0)}v=d}const h={points:v,tcoords:c,colors:i,cellOffset:0,useTCoordsPerCell:u,haveCellScalars:e.renderable.getAreScalarsMappedFromCells(),customAttributes:e.renderable.getCustomShaderAttributes().map(d=>s.getPointData().getArrayByName(d))};h.cellOffset+=e.primitives[_t.Points].getCABO().createVBO(s.getVerts(),"verts",o,h),h.cellOffset+=e.primitives[_t.Lines].getCABO().createVBO(s.getLines(),"lines",o,h),h.cellOffset+=e.primitives[_t.Tris].getCABO().createVBO(s.getPolys(),"polys",o,h),h.cellOffset+=e.primitives[_t.TriStrips].getCABO().createVBO(s.getStrips(),"strips",o,h),e.VBOBuildTime.modified(),e.VBOBuildString=p}},t.renderPieceDraw=(r,a)=>{const s=a.getProperty().getRepresentation();e.context.depthMask(!0);for(let o=_t.Start;o<_t.End;o++)e.primitives[o].getCABO().getElementCount()&&(e.lastBoundBO=e.primitives[o],e.primitiveIDOffset+=e.primitives[o].drawArrays(r,a,s,t))},t.renderPieceFinish=(r,a)=>{e.lastBoundBO&&e.lastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.replaceShaderValues=(r,a,s)=>{t.replaceShaderColor(r,a,s),t.replaceShaderTCoord(r,a,s),t.replaceShaderPicking(r,a,s),t.replaceShaderPositionVC(r,a,s)},t.replaceShaderColor=(r,a,s)=>{let i=r.Vertex,o=r.Geometry,c=r.Fragment,u=["uniform vec3 diffuseColorUniform;","uniform float opacityUniform;"],g=["vec3 diffuseColor = diffuseColorUniform;","float opacity = opacityUniform;"];e.lastBoundBO.getCABO().getColorComponents()!==0?(u=u.concat(["varying vec4 vertexColorVSOutput;"]),i=N.substitute(i,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,i=N.substitute(i,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,o=N.substitute(o,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,o=N.substitute(o,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result,c=N.substitute(c,"//VTK::Color::Impl",g.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result):e.renderable.getAreScalarsMappedFromCells()&&(g=g.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  opacity = opacity*texColor.a;"])),g=g.concat(["gl_FragData[0] = vec4(diffuseColor, opacity);"]),c=N.substitute(c,"//VTK::Color::Dec",u).result,c=N.substitute(c,"//VTK::Color::Impl",g).result,r.Vertex=i,r.Geometry=o,r.Fragment=c},t.replaceShaderTCoord=(r,a,s)=>{if(e.lastBoundBO.getCABO().getTCoordOffset()){let i=r.Vertex,o=r.Geometry,c=r.Fragment;const u=e.lastBoundBO.getCABO().getTCoordComponents();u===1?(i=N.substitute(i,"//VTK::TCoord::Dec",["in float tcoordMC;","out float tcoordVCVSOutput;"]).result,i=N.substitute(i,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,o=N.substitute(o,"//VTK::TCoord::Dec",[`in float tcoordVCVSOutput[];
`,"out float tcoordVCGSOutput;"]).result,o=N.substitute(o,["//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,c=N.substitute(c,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,c=N.substitute(c,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, vec2(tcoordVCVSOutput,0));"]).result):u===2&&(i=N.substitute(i,"//VTK::TCoord::Dec",["in vec2 tcoordMC;","out vec2 tcoordVCVSOutput;"]).result,i=N.substitute(i,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,o=N.substitute(o,"//VTK::TCoord::Dec",[`in vec2 tcoordVCVSOutput[];
`,"out vec2 tcoordVCGSOutput;"]).result,o=N.substitute(o,"//VTK::TCoord::Impl",["tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,c=N.substitute(c,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,c=N.substitute(c,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, tcoordVCVSOutput.st);"]).result),e.renderable.getAreScalarsMappedFromCells()&&(o=N.substitute(o,"//VTK::PrimID::Impl",["gl_PrimitiveID = gl_PrimitiveIDIn;"]).result),r.Vertex=i,r.Geometry=o,r.Fragment=c}},t.replaceShaderPicking=(r,a,s)=>{let i=r.Fragment;i=N.substitute(i,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,i=N.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,r.Fragment=i},t.replaceShaderPositionVC=(r,a,s)=>{e.lastBoundBO.replaceShaderPositionVC(r,a,s)},t.invokeShaderCallbacks=(r,a,s)=>{const i=e.renderable.getViewSpecificProperties().ShadersCallbacks;i&&i.forEach(o=>{o.callback(o.userData,r,a,s)})},t.setMapperShaderParameters=(r,a,s)=>{if(r.getProgram().isUniformUsed("PrimitiveIDOffset")&&r.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),r.getProgram().isAttributeUsed("vertexWC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexWC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||sa("Error setting vertexWC in shader VAO.")),r.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){e.renderable.getCustomShaderAttributes().forEach((c,u)=>{r.getProgram().isAttributeUsed(`${c}MC`)&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),`${c}MC`,r.getCABO().getCustomData()[u].offset,r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getCustomData()[u].components,!1)||sa(`Error setting ${c}MC in shader VAO.`))}),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),!1)||sa("Error setting tcoordMC in shader VAO."):r.getVAO().removeAttributeArray("tcoordMC"),r.getProgram().isAttributeUsed("scalarColor")&&r.getCABO().getColorComponents()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO().getColorBO(),"scalarColor",r.getCABO().getColorOffset(),r.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||sa("Error setting scalarColor in shader VAO."):r.getVAO().removeAttributeArray("scalarColor"),e.internalColorTexture&&r.getProgram().isUniformUsed("texture1")&&e.internalColorTexture.getTextureUnit()>-1&&r.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());const i=e.openGLActor2D.getActiveTextures();if(i)for(let c=0;c<i.length;++c){const g=i[c].getTextureUnit(),f=`texture${g+1}`;r.getProgram().isUniformUsed(f)&&r.getProgram().setUniformi(f,g)}r.setMapperShaderParameters(a,s,e._openGLRenderer.getTiledSizeAndOrigin());const o=e._openGLRenderer.getSelector();r.getProgram().setUniform3fArray("mapperIndex",o?o.getPropColorValue():[0,0,0]),r.getProgram().setUniformi("picking",o?o.getCurrentPass()+1:0)}},t.setPropertyShaderParameters=(r,a,s)=>{const i=e.renderable.getColorMapColors();if(!i||i.getNumberOfComponents()===0){const o=r.getProgram(),c=s.getProperty(),u=c.getOpacity();o.setUniformf("opacityUniform",u);const g=c.getColor();o.setUniform3fArray("diffuseColorUniform",g)}},t.setLightingShaderParameters=(r,a,s)=>{};function n(r,a,s){return a.identity(s),r.reduce((i,o,c)=>c===0?o?a.copy(i,o):a.identity(i):o?a.multiply(i,i,o):i,s)}t.setCameraShaderParameters=(r,a,s)=>{const i=r.getProgram(),c=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,g=a.getRenderWindow().getViews()[0].getViewportSize(a),f=a.getViewport(),l=s.getActualPositionCoordinate().getComputedDoubleViewportValue(a),p=[0,0,1,1],v=[0,0,1,1];if(v[0]=f[0]>=p[0]?f[0]:p[0],v[1]=f[1]>=p[1]?f[1]:p[1],v[2]=f[2]<=p[2]?f[2]:p[2],v[3]=f[3]<=p[3]?f[3]:p[3],v[0]>=v[2]||v[1]>=v[3])return;g[0]=ga(g[0]*(v[2]-v[0])/(f[2]-f[0])),g[1]=ga(g[1]*(v[3]-v[1])/(f[3]-f[1]));const h=e._openGLRenderer.getParent().getSize(),d=ga(l[0]-(v[0]-f[0])*h[0]),T=ga(l[1]-(v[1]-f[1])*h[1]),S=-d;let x=-d+g[0];const y=-T;let C=-T+g[1];S===x&&(x=S+1),y===C&&(C=y+1);const w=ue(new Float64Array(16));w[0]=2/(x-S),w[5]=2/(C-y),w[3]=-1*(x+S)/(x-S),w[7]=-1*(C+y)/(C-y),w[10]=0,w[11]=s.getProperty().getDisplayLocation()===T1.FOREGROUND?-1:1,w[15]=1,De(w,w),i.setUniformMatrix("WCVCMatrix",n([w,c],Wo,e.tmpMat4))},t.getAllocatedGPUMemoryInBytes=()=>{let r=0;return e.primitives.forEach(a=>{r+=a.getAllocatedGPUMemoryInBytes()}),r}}const GM={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null};function bM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,GM,n),Be.extend(t,e,n),oi.implementReplaceShaderCoincidentOffset(t,e,n),oi.implementBuildShadersWithReplacements(t,e,n),e.primitives=[],e.primTypes=_t,e.tmpMat4=ue(new Float64Array(16));for(let r=_t.Start;r<_t.End;r++)e.primitives[r]=Qr.newInstance(),e.primitives[r].setPrimitiveType(r),e.primitives[r].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);He(t,e,["context"]),e.VBOBuildTime={},qe(e.VBOBuildTime,{mtime:0}),kM(t,e)}const $M=we(bM,"vtkOpenGLPolyDataMapper2D");Ft("vtkMapper2D",$M);const WM={HORIZONTAL:"horizontal",VERTICAL:"vertical",AUTO:"auto"};var S1={Orientation:WM};const{VectorMode:zM}=Lh,{Orientation:ci}=S1;function vo(t,e,n){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor;const r=e.fontSize??n;t.font=`${e.fontStyle} ${r}px ${e.fontFamily}`}function C1(t,e){return n=>{const r=n.getLastSize(),a=(r[0]/700)**.8,s=(r[1]/700)**.8,i=Math.min(a,s),o=n.getAxisTextStyle(),c=n.getTickTextStyle();Object.assign(o,e.axisTextStyle),Object.assign(c,e.tickTextStyle),o.fontSize===void 0&&(o.fontSize=Math.max(24*i,12)),c.fontSize===void 0&&(n.getLastAspectRatio()>1?c.fontSize=Math.max(20*i,10):c.fontSize=Math.max(16*i,10));const u=n.updateTextureAtlas();n.setTopTitle(!1);const g=n.getBoxSizeByReference();let f=!1;if(e.orientation===ci.VERTICAL?f=!0:e.orientation===ci.HORIZONTAL?f=!1:f=n.getLastAspectRatio()>1,f)n.setTickLabelPixelOffset(.3*c.fontSize),u.titleWidth<=u.tickWidth+n.getTickLabelPixelOffset()+.8*c.fontSize?(n.setTopTitle(!0),n.setAxisTitlePixelOffset(.2*c.fontSize),g[0]=2*(u.tickWidth+n.getTickLabelPixelOffset()+.8*c.fontSize)/r[0],n.setBoxPosition([.98-g[0],-.92])):(n.setAxisTitlePixelOffset(.2*c.fontSize),g[0]=2*(u.titleHeight+n.getAxisTitlePixelOffset()+u.tickWidth+n.getTickLabelPixelOffset()+.8*c.fontSize)/r[0],n.setBoxPosition([.99-g[0],-.92])),g[1]=Math.max(1.2,Math.min(1.84/s,1.84));else{n.setAxisTitlePixelOffset(1.2*c.fontSize),n.setTickLabelPixelOffset(.1*c.fontSize);const l=2*(.8*c.fontSize+u.titleHeight+n.getAxisTitlePixelOffset())/r[1],p=2*u.tickWidth/r[0];g[0]=Math.min(1.9,Math.max(1.4,1.4*p*(n.getTicks().length+3))),g[1]=l,n.setBoxPosition([-.5*g[0],-.97])}n.recomputeBarSegments(u)}}function w1(t,e){return n=>{const r=n.getLastTickBounds(),a=Zc().domain([r[0],r[1]]),s=a.ticks(5),i=a.tickFormat(5);n.setTicks(s),n.setTickStrings(s.map(i))}}function HM(t,e){e.classHierarchy.push("vtkScalarBarActorHelper"),t.setRenderable=a=>{e.renderable!==a&&(e.renderable=a,e.barActor.setProperty(a.getProperty()),e.barActor.setParentProp(a),e.barActor.setCoordinateSystemToDisplay(),e.tmActor.setProperty(a.getProperty()),e.tmActor.setParentProp(a),e.tmActor.setCoordinateSystemToDisplay(),e.generateTicks=a.generateTicks,e.axisTextStyle={...a.getAxisTextStyle()},e.tickTextStyle={...a.getTickTextStyle()},t.modified())},t.updateAPISpecificData=(a,s,i)=>{(e.lastSize[0]!==a[0]||e.lastSize[1]!==a[1])&&(e.lastSize[0]=a[0],e.lastSize[1]=a[1],e.lastAspectRatio=a[0]/a[1],e.forceUpdate=!0);const o=e.renderable.getScalarsToColors();if(!(!o||!e.renderable.getVisibility())&&(e.barMapper.setLookupTable(o),e.camera=s,e.renderWindow=i,e.forceUpdate||Math.max(o.getMTime(),t.getMTime(),e.renderable.getMTime())>e.lastRebuildTime.getMTime())){const c=o.getMappingRange();if(e.lastTickBounds=[...c],e.renderable.getGenerateTicks()(t),e.renderable.getAutomated())e.renderable.getAutoLayout()(t);else{e.axisTextStyle={...e.renderable.getAxisTextStyle()},e.tickTextStyle={...e.renderable.getTickTextStyle()},e.barPosition=[...e.renderable.getBarPosition()],e.barSize=[...e.renderable.getBarSize()],e.boxPosition=[...e.renderable.getBoxPosition()],e.boxSize=[...e.renderable.getBoxSize()],e.axisTitlePixelOffset=e.renderable.getAxisTitlePixelOffset(),e.tickLabelPixelOffset=e.renderable.getTickLabelPixelOffset();const u=t.updateTextureAtlas();t.recomputeBarSegments(u)}t.updatePolyDataForLabels(),t.updatePolyDataForBarSegments(),e.lastRebuildTime.modified(),e.forceUpdate=!1}},t.updateTextureAtlas=()=>{e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left";const a={},s=new Map;let i=0,o=1;vo(e.tmContext,e.axisTextStyle,18);let c=e.tmContext.measureText(e.renderable.getAxisLabel()),u={height:c.actualBoundingBoxAscent+2,startingHeight:o,width:c.width+2,textStyle:e.axisTextStyle};s.set(e.renderable.getAxisLabel(),u),o+=u.height,i=u.width,a.titleWidth=u.width,a.titleHeight=u.height,a.tickWidth=0,a.tickHeight=0,vo(e.tmContext,e.tickTextStyle,14);const g=[...t.getTickStrings(),"NaN","Below","Above"];for(let f=0;f<g.length;f++)s.has(g[f])||(c=e.tmContext.measureText(g[f]),u={height:c.actualBoundingBoxAscent+2,startingHeight:o,width:c.width+2,textStyle:e.tickTextStyle},s.set(g[f],u),o+=u.height,i<u.width&&(i=u.width),a.tickWidth<u.width&&(a.tickWidth=u.width),a.tickHeight<u.height&&(a.tickHeight=u.height));return i=mt(i),o=mt(o),s.forEach(f=>{f.tcoords=[0,(o-f.startingHeight-f.height)/o,f.width/i,(o-f.startingHeight-f.height)/o,f.width/i,(o-f.startingHeight)/o,0,(o-f.startingHeight)/o]}),e.tmCanvas.width=i,e.tmCanvas.height=o,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,i,o),s.forEach((f,l)=>{const p=f.textStyle===e.axisTextStyle?18:14;vo(e.tmContext,f.textStyle,p),e.tmContext.fillText(l,1,f.startingHeight+f.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified(),e._tmAtlas=s,a},t.computeBarSize=a=>{e.vertical=e.boxSize[1]>e.boxSize[0];const s=2*a.tickHeight/e.lastSize[1],i=[1,1];if(e.vertical){const o=2*(a.tickWidth+e.tickLabelPixelOffset)/e.lastSize[0];if(e.topTitle){const c=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0]-o,e.barSize[1]=e.boxSize[1]-c}else{const c=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[0];e.barSize[0]=e.boxSize[0]-c-o,e.barSize[1]=e.boxSize[1]}e.barPosition[0]=e.boxPosition[0]+o,e.barPosition[1]=e.boxPosition[1],i[1]=s}else{const o=(2*a.tickWidth-8)/e.lastSize[0],c=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0],e.barPosition[0]=e.boxPosition[0],e.barSize[1]=e.boxSize[1]-c,e.barPosition[1]=e.boxPosition[1],i[0]=o}return i},t.recomputeBarSegments=a=>{const s=t.computeBarSize(a);e.barSegments=[];const i=[0,0],o=e.vertical?1:0,c=e.vertical?.01:.02;function u(l,p){e.barSegments.push({corners:[[...i],[i[0]+s[0],i[1]],[i[0]+s[0],i[1]+s[1]],[i[0],i[1]+s[1]]],scalars:p,title:l}),i[o]+=s[o]+c}e.renderable.getDrawNanAnnotation()&&e.renderable.getScalarsToColors().getNanColor()&&u("NaN",[NaN,NaN,NaN,NaN]),e.renderable.getDrawBelowRangeSwatch()&&e.renderable.getScalarsToColors().getUseBelowRangeColor?.()&&u("Below",[-.1,-.1,-.1,-.1]);const g=e.renderable.getScalarsToColors().getUseAboveRangeColor?.();i[o]+=c;const f=s[o];s[o]=g?1-2*c-s[o]-i[o]:1-c-i[o],u("ticks",e.vertical?[0,0,.995,.995]:[0,.995,.995,0]),e.renderable.getDrawAboveRangeSwatch()&&g&&(s[o]=f,i[o]+=c,u("Above",[1.1,1.1,1.1,1.1]))};const n=new Float64Array(3);t.createPolyDataForOneLabel=(a,s,i,o,c,u)=>{const g=e._tmAtlas.get(a);if(!g)return;let f=u.ptIdx,l=u.cellIdx;n[0]=(.5*s[0]+.5)*e.lastSize[0],n[1]=(.5*s[1]+.5)*e.lastSize[1],n[2]=s[2],n[0]+=c[0],n[1]+=c[1];const p=[],v=o==="vertical"?[1,0]:[0,1];o==="vertical"?(p[0]=g.width,p[1]=-g.height,i[0]==="middle"?n[1]-=g.width/2:i[0]==="right"&&(n[1]-=g.width),i[1]==="middle"?n[0]+=g.height/2:i[1]==="top"&&(n[0]+=g.height)):(p[0]=g.width,p[1]=g.height,i[0]==="middle"?n[0]-=g.width/2:i[0]==="right"&&(n[0]-=g.width),i[1]==="middle"?n[1]-=g.height/2:i[1]==="top"&&(n[1]-=g.height)),u.points[f*3]=n[0],u.points[f*3+1]=n[1],u.points[f*3+2]=n[2],u.tcoords[f*2]=g.tcoords[0],u.tcoords[f*2+1]=g.tcoords[1],f++,n[v[0]]+=p[0],u.points[f*3]=n[0],u.points[f*3+1]=n[1],u.points[f*3+2]=n[2],u.tcoords[f*2]=g.tcoords[2],u.tcoords[f*2+1]=g.tcoords[3],f++,n[v[1]]+=p[1],u.points[f*3]=n[0],u.points[f*3+1]=n[1],u.points[f*3+2]=n[2],u.tcoords[f*2]=g.tcoords[4],u.tcoords[f*2+1]=g.tcoords[5],f++,n[v[0]]-=p[0],u.points[f*3]=n[0],u.points[f*3+1]=n[1],u.points[f*3+2]=n[2],u.tcoords[f*2]=g.tcoords[6],u.tcoords[f*2+1]=g.tcoords[7],f++,u.polys[l*4]=3,u.polys[l*4+1]=f-4,u.polys[l*4+2]=f-3,u.polys[l*4+3]=f-2,l++,u.polys[l*4]=3,u.polys[l*4+1]=f-4,u.polys[l*4+2]=f-2,u.polys[l*4+3]=f-1,u.ptIdx+=4,u.cellIdx+=2};const r=new Float64Array(3);t.updatePolyDataForLabels=()=>{const a=t.getTickStrings().length+e.barSegments.length,s=a*4,i=a*2,o=new Float64Array(s*3),c=new Uint16Array(i*4),u=new Float32Array(s*2),g={ptIdx:0,cellIdx:0,polys:c,points:o,tcoords:u},f=e.vertical?0:1,l=e.vertical?1:0;r[2]=-.99;const p=e.vertical?["right","middle"]:["middle","bottom"];let v=[0,1];const h=[0,0];e.vertical?(h[0]=-e.tickLabelPixelOffset,e.topTitle?(r[0]=e.boxPosition[0]+.5*e.boxSize[0],r[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],g)):(r[0]=e.barPosition[0]+e.barSize[0],r[1]=e.barPosition[1]+.5*e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","top"],"vertical",[e.axisTitlePixelOffset,0],g)),v=[-1,0]):(h[1]=e.tickLabelPixelOffset,r[0]=e.barPosition[0]+.5*e.barSize[0],r[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],g)),r[f]=e.barPosition[f]+(.5*v[f]+.5)*e.barSize[f],r[l]=e.barPosition[l]+e.barSize[l]*.5;let d=null;for(let R=0;R<e.barSegments.length;R++){const O=e.barSegments[R];O.title==="ticks"?d=O:(r[l]=e.barPosition[l]+.5*e.barSize[l]*(O.corners[2][l]+O.corners[0][l]),t.createPolyDataForOneLabel(O.title,r,p,"horizontal",h,g))}const T=e.barPosition[l]+e.barSize[l]*d.corners[0][l],S=e.barSize[l]*(d.corners[2][l]-d.corners[0][l]),x=t.getTicks(),y=t.getTickStrings(),C=t.getTickPositions();for(let R=0;R<x.length;R++){const O=C?C[R]:(x[R]-e.lastTickBounds[0])/(e.lastTickBounds[1]-e.lastTickBounds[0]);r[l]=T+S*O,t.createPolyDataForOneLabel(y[R],r,p,"horizontal",h,g)}const w=xe.newInstance({numberOfComponents:2,values:u,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(w),e.tmPolyData.getPoints().setData(o,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(c,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updatePolyDataForBarSegments=()=>{const a=e.renderable.getScalarsToColors();let s=0;e.renderable.getDrawNanAnnotation()&&a.getNanColor()&&(s+=1),e.renderable.getDrawBelowRangeSwatch()&&a.getUseBelowRangeColor?.()&&(s+=1),e.renderable.getDrawAboveRangeSwatch()&&a.getUseAboveRangeColor?.()&&(s+=1);const i=4*(1+s),o=i;let c=1;a.getVectorMode()===zM.COMPONENT&&(c=a.getVectorComponent()+1);const u=new Float64Array(i*3),g=new Uint16Array(o*5),f=new Float32Array(i*c);let l=0,p=0;for(let h=0;h<e.barSegments.length;h++){const d=e.barSegments[h];for(let T=0;T<4;T++){r[0]=e.barPosition[0]+d.corners[T][0]*e.barSize[0],r[1]=e.barPosition[1]+d.corners[T][1]*e.barSize[1],u[l*3]=(.5*r[0]+.5)*e.lastSize[0],u[l*3+1]=(.5*r[1]+.5)*e.lastSize[1],u[l*3+2]=r[2];for(let S=0;S<c;S++)f[l*c+S]=e.lastTickBounds[0]+d.scalars[T]*(e.lastTickBounds[1]-e.lastTickBounds[0]);l++}g[p*5]=4,g[p*5+1]=l-4,g[p*5+2]=l-3,g[p*5+3]=l-2,g[p*5+4]=l-1,p++}const v=xe.newInstance({numberOfComponents:c,values:f,name:"Scalars"});e.polyData.getPointData().setScalars(v),e.polyData.getPoints().setData(u,3),e.polyData.getPoints().modified(),e.polyData.getPolys().setData(g,1),e.polyData.getPolys().modified(),e.polyData.modified()}}const AM=E.newInstance(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},n),E.obj(t,e),E.setGet(t,e,["axisTitlePixelOffset","tickLabelPixelOffset","renderable","topTitle","ticks","tickStrings","tickPositions"]),E.get(t,e,["lastSize","lastAspectRatio","lastTickBounds","axisTextStyle","tickTextStyle","barActor","tmActor"]),E.getArray(t,e,["boxPosition","boxSize"]),E.setArray(t,e,["boxPosition","boxSize"],2),e.forceUpdate=!1,e.lastRebuildTime={},E.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.barMapper=yr.newInstance(),e.barMapper.setInterpolateScalarsBeforeMapping(!0),e.barMapper.setUseLookupTableScalarRange(!0),e.polyData=xn.newInstance(),e.barMapper.setInputData(e.polyData),e.barActor=vr.newInstance(),e.barActor.setMapper(e.barMapper),e.tmPolyData=xn.newInstance(),e.tmMapper=yr.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmTexture=za.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),e.tmActor=vr.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),e.tmActor.addTexture(e.tmTexture),e.barPosition=[0,0],e.barSize=[0,0],e.boxPosition=[.88,-.92],e.boxSize=[.1,1.1],e.lastTickBounds=[],HM(t,e)},"vtkScalarBarActorHelper");function jM(t,e){e.classHierarchy.push("vtkScalarBarActor"),t.setTickTextStyle=n=>{e.tickTextStyle={...e.tickTextStyle,...n},t.modified()},t.setAxisTextStyle=n=>{e.axisTextStyle={...e.axisTextStyle,...n},t.modified()},t.setOrientationToHorizontal=()=>t.setOrientation(ci.HORIZONTAL),t.setOrientationToVertical=()=>t.setOrientation(ci.VERTICAL),t.resetAutoLayoutToDefault=()=>{t.setAutoLayout(C1(t,e))},t.resetGenerateTicksToDefault=()=>{t.setGenerateTicks(w1())}}function KM(t){return{automated:!0,autoLayout:null,axisLabel:"Scalar Value",barPosition:[0,0],barSize:[0,0],boxPosition:[.88,-.92],boxSize:[.1,1.1],scalarToColors:null,axisTitlePixelOffset:36,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:void 0,fontFamily:"serif"},tickLabelPixelOffset:14,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:void 0,fontFamily:"serif"},generateTicks:null,drawNanAnnotation:!0,drawBelowRangeSwatch:!0,drawAboveRangeSwatch:!0,orientation:null,...t}}function E1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KM(n)),e.autoLayout||(e.autoLayout=C1(t,e)),e.generateTicks||(e.generateTicks=w1()),vr.extend(t,e,n),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),E.setGet(t,e,["automated","autoLayout","axisTitlePixelOffset","axisLabel","scalarsToColors","tickLabelPixelOffset","generateTicks","drawNanAnnotation","drawBelowRangeSwatch","drawAboveRangeSwatch","orientation"]),E.get(t,e,["axisTextStyle","tickTextStyle"]),E.getArray(t,e,["barPosition","barSize","boxPosition","boxSize"]),E.setArray(t,e,["barPosition","barSize","boxPosition","boxSize"],2),jM(t,e)}const PM=E.newInstance(E1,"vtkScalarBarActor");var R1={newInstance:PM,extend:E1,newScalarBarActorHelper:AM,...S1};function XM(t,e){e.classHierarchy.push("vtkOpenGLScalarBarActor"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,s=e._openGLRenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([s.usize,s.vsize],a,e._openGLRenderWindow.getRenderable())}}}const IM={};function YM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IM,n),Be.extend(t,e,n),e.scalarBarActorHelper=R1.newScalarBarActorHelper(),XM(t,e)}const qM=we(YM,"vtkOpenGLScalarBarActor");Ft("vtkScalarBarActor",qM);const{vtkErrorMacro:Bg}=nn;function QM(t,e){e.classHierarchy.push("vtkOpenGLSkybox"),t.buildPass=n=>{if(n){e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const r=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(r.getActiveCamera(),e.openGLCamera)}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementOpaqueActorCount()}},t.opaquePass=(n,r)=>{if(n&&!e._openGLRenderer.getSelector()){t.updateBufferObjects(),e.context.depthMask(!0),e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.tris.getProgram()),e.openGLTexture.render(e._openGLRenderWindow);const a=e.openGLTexture.getTextureUnit();e.tris.getProgram().setUniformi("sbtexture",a);const s=e._openGLRenderer.getRenderable(),i=e.openGLCamera.getKeyMatrices(s),o=new Float64Array(16);if(ut(o,i.wcpc),e.tris.getProgram().setUniformMatrix("IMCPCMatrix",o),e.lastFormat==="box"){const c=s.getActiveCamera().getPosition();e.tris.getProgram().setUniform3f("camPos",c[0],c[1],c[2])}e.tris.getVAO().bind(),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate()}},t.updateBufferObjects=()=>{if(!e.tris.getCABO().getElementCount()){const r=new Float32Array(12);for(let o=0;o<4;o++)r[o*3]=o%2*2-1,r[o*3+1]=o>1?1:-1,r[o*3+2]=1;const a=xe.newInstance({numberOfComponents:3,values:r});a.setName("points");const s=new Uint16Array(8);s[0]=3,s[1]=0,s[2]=1,s[3]=3,s[4]=3,s[5]=0,s[6]=3,s[7]=2;const i=xe.newInstance({numberOfComponents:1,values:s});e.tris.getCABO().createVBO(i,"polys",Vt.SURFACE,{points:a,cellOffset:0})}e.renderable.getFormat()!==e.lastFormat&&(e.lastFormat=e.renderable.getFormat(),e.lastFormat==="box"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec3 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = wpos.xyz/wpos.w;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec3 TexCoords;
             uniform samplerCube sbtexture;
             uniform vec3 camPos;
             void main () {
               // skybox looks from inside out
               // which means we have to adjust
               // our tcoords. Otherwise text would
               // be flipped
               vec3 tc = normalize(TexCoords - camPos);
               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))
               {
                 tc = vec3(1.0, 1.0, -1.0) * tc;
               }
               else
               {
                 tc = vec3(-1.0, 1.0, 1.0) * tc;
               }
               gl_FragData[0] = textureCube(sbtexture, tc);
             }`,"")),e.lastFormat==="background"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec2 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec2 TexCoords;
             uniform sampler2D sbtexture;
             void main () {
               gl_FragData[0] = texture2D(sbtexture, TexCoords);
             }`,"")),e.tris.getShaderSourceTime().modified(),e.tris.getVAO().bind(),e.tris.getVAO().addAttributeArray(e.tris.getProgram(),e.tris.getCABO(),"vertexMC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||Bg("Error setting vertexMC in shader VAO."));const n=e.renderable.getTextures();n.length||Bg("vtkSkybox requires a texture map"),e.openGLTexture.getRenderable()!==n[0]&&(e.openGLTexture.releaseGraphicsResources(e._openGLRenderWindow),e.openGLTexture.setRenderable(n[0]))}}const ZM={context:null};function JM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZM,n),Be.extend(t,e,n),e.openGLTexture=hn.newInstance(),e.tris=Qr.newInstance(),e.keyMatrixTime={},qe(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:Kn(new Float64Array(9)),mcwc:ue(new Float64Array(16))},He(t,e,["context"]),pt(t,e,["activeTextures"]),QM(t,e)}const eD=we(JM);Ft("vtkSkybox",eD);const{vtkDebugMacro:tD}=nn;function nD(t,e){e.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),t.opaquePass=(n,r)=>{e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow");const a=e._openGLRenderer.getAspectRatio(),s=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,i=e._openGLRenderer.getTiledSizeAndOrigin();let o=null;if(e.renderable.getUseZValues()){const c=r.getZBufferTexture(),u=Math.floor(c.getWidth()),g=Math.floor(c.getHeight()),f=e._openGLRenderWindow.getContext();c.bind();const l=r.getFramebuffer();l?l.saveCurrentBindingsAndBuffers():tD("No framebuffer to save/restore");const p=f.createFramebuffer();f.bindFramebuffer(f.FRAMEBUFFER,p),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,c.getHandle(),0),f.checkFramebufferStatus(f.FRAMEBUFFER)===f.FRAMEBUFFER_COMPLETE&&(o=new Uint8Array(u*g*4),f.viewport(0,0,u,g),f.readPixels(0,0,u,g,f.RGBA,f.UNSIGNED_BYTE,o)),l&&l.restorePreviousBindingsAndBuffers(),f.deleteFramebuffer(p)}e.renderable.invokeCallback(e.renderable.getInputData(),s,a,i,o)},t.queryPass=(n,r)=>{n&&e.renderable.getUseZValues()&&r.requestDepth()}}const rD={};function aD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rD,n),Be.extend(t,e,n),nD(t,e)}const sD=we(aD,"vtkOpenGLPixelSpaceCallbackMapper");Ft("vtkPixelSpaceCallbackMapper",sD);const O1=Object.create(null);function rn(t,e){O1[t]=e}function iD(t,e){e.classHierarchy.push("vtkWebGPUViewNodeFactory")}const oD={};function M1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oD,n),e.overrides=O1,np.extend(t,e,n),iD(t,e)}const cD=E.newInstance(M1,"vtkWebGPUViewNodeFactory");var fD={newInstance:cD,extend:M1};function uD(t,e){e.classHierarchy.push("vtkWebGPUCamera"),t.getProjectionMatrix=(n,r,a,s)=>{if(ue(n),e.renderable.getParallelProjection()){const i=e.renderable.getParallelScale(),o=i*r,c=i,u=(s[0]-1)*o,g=(s[0]+1)*o,f=(s[1]-1)*c,l=(s[1]+1)*c,p=1/(g-u),v=1/(l-f);n[0]=2*p,n[5]=2*v,n[10]=1/(a[1]-a[0]),n[12]=(g+u)*p,n[13]=(l+f)*v,n[14]=a[1]/(a[1]-a[0])}else{const i=Math.tan(Math.PI*e.renderable.getViewAngle()/360);let o,c;e.renderable.getUseHorizontalViewAngle()===!0?(o=a[0]*i,c=a[0]*i/r):(o=a[0]*i*r,c=a[0]*i);const u=(s[0]-1)*o,g=(s[0]+1)*o,f=(s[1]-1)*c,l=(s[1]+1)*c;n[0]=2*a[0]/(g-u),n[5]=2*a[0]/(l-f),n[12]=(u+g)/(g-u),n[13]=(f+l)/(l-f),n[10]=0,n[14]=a[0],n[11]=-1,n[15]=0}},t.convertToOpenGLDepth=n=>{if(e.renderable.getParallelProjection())return 1-n;const r=e.renderable.getClippingRangeByReference();let a=-r[0]/n;return a=(r[0]+r[1])/(r[1]-r[0])+2*r[0]*r[1]/(a*(r[1]-r[0])),.5*a+.5},t.getKeyMatrices=n=>{const r=n.getRenderable(),a=n.getParent();if(Math.max(a.getMTime(),t.getMTime(),r.getMTime(),e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatrixTime.getMTime()){const s=e.renderable.getViewMatrix();Qe(e.keyMatrices.normalMatrix,s),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,ut(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),De(e.keyMatrices.wcvc,s);const i=n.getStabilizedCenterByReference();Ue(e.keyMatrices.scvc,e.keyMatrices.wcvc,i);const o=n.getAspectRatio(),c=e.renderable.getClippingRangeByReference();t.getProjectionMatrix(e.keyMatrices.vcpc,o,c,e.renderable.getWindowCenterByReference()),Ne(e.keyMatrices.scpc,e.keyMatrices.vcpc,e.keyMatrices.scvc),ut(e.keyMatrices.pcsc,e.keyMatrices.scpc),e.keyMatrixTime.modified()}return e.keyMatrices}}const gD={keyMatrixTime:null,keyMatrices:null};function lD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gD,n),Be.extend(t,e,n),e.keyMatrixTime={},E.obj(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(16),vcpc:new Float64Array(16),pcsc:new Float64Array(16),wcvc:new Float64Array(16),scpc:new Float64Array(16),scvc:new Float64Array(16)},E.setGet(t,e,["keyMatrixTime"]),uD(t,e)}const pD=E.newInstance(lD);rn("vtkCamera",pD);function hD(t,e){e.classHierarchy.push("vtkWebGPUBindGroup"),t.setBindables=n=>{if(e.bindables.length===n.length){let r=!0;for(let a=0;a<e.bindables.length;a++)e.bindables[a]!==n[a]&&(r=!1);if(r)return}e.bindables=n,t.modified()},t.getBindGroupLayout=n=>{const r=[];for(let a=0;a<e.bindables.length;a++){const s=e.bindables[a].getBindGroupLayoutEntry();s.binding=a,r.push(s)}return n.getBindGroupLayout({entries:r})},t.getBindGroup=n=>{let r=t.getMTime();for(let s=0;s<e.bindables.length;s++){const i=e.bindables[s].getBindGroupTime().getMTime();r=i>r?i:r}if(r<e.bindGroupTime.getMTime())return e.bindGroup;const a=[];for(let s=0;s<e.bindables.length;s++){const i=e.bindables[s].getBindGroupEntry();i.binding=s,a.push(i)}return e.bindGroup=n.getHandle().createBindGroup({layout:t.getBindGroupLayout(n),entries:a,label:e.label}),e.bindGroupTime.modified(),e.bindGroup},t.getShaderCode=n=>{const r=[],a=n.getBindGroupLayoutCount(e.label);for(let s=0;s<e.bindables.length;s++)r.push(e.bindables[s].getShaderCode(s,a));return r.join(`
`)}}const dD={device:null,handle:null,label:null};function D1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dD,n),E.obj(t,e),e.bindables=[],e.bindGroupTime={},E.obj(e.bindGroupTime,{mtime:0}),E.get(t,e,["bindGroupTime","handle","sizeInBytes","usage"]),E.setGet(t,e,["label","device","arrayInformation"]),hD(t,e)}const vD=E.newInstance(D1);var L1={newInstance:vD,extend:D1};function yD(t,e){e.classHierarchy.push("vtkWebGPUShaderModule"),t.initialize=(n,r)=>{e.device=n,e.handle=e.device.getHandle().createShaderModule({code:r.getCode()})}}const TD={device:null,handle:null};function m1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TD,n),E.obj(t,e),E.get(t,e,["lastCameraMTime"]),E.setGet(t,e,["device","handle"]),yD(t,e)}const xD=E.newInstance(m1,"vtkWebGPUShaderModule");var SD={newInstance:xD,extend:m1};function CD(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;const a=Array.isArray(n)?n.join(`
`):n;let s=!1;t.search(e)!==-1&&(s=!0);let i="";r&&(i="g");const o=new RegExp(e,i),c=t.replace(o,a);return{replace:s,result:c}}function wD(t,e){e.classHierarchy.push("vtkWebGPUShaderCache"),t.getShaderModule=n=>{const r=n.getType(),a=n.getHash(),s=e._shaderModules.keys();for(let o=0;o<s.length;o++){const c=s[o];if(c.getHash()===a&&c.getType()===r)return e._shaderModules.get(c)}const i=SD.newInstance();return i.initialize(e.device,n),e._shaderModules.set(n,i),i}}const ED={shaderModules:null,device:null,window:null};function V1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ED,n),e._shaderModules=new Map,E.obj(t,e),E.setGet(t,e,["device","window"]),wD(t,e)}const RD=E.newInstance(V1,"vtkWebGPUShaderCache");var ae={newInstance:RD,extend:V1,substitute:CD};function OD(t,e){e.classHierarchy.push("vtkWebGPUPipeline"),t.getShaderDescriptions=()=>e.shaderDescriptions,t.initialize=(n,r)=>{e.pipelineDescription=e.renderEncoder.getPipelineSettings(),e.pipelineDescription.primitive.topology=e.topology,e.pipelineDescription.vertex=e.vertexState,e.pipelineDescription.label=r;const a=[];for(let s=0;s<e.layouts.length;s++)a.push(e.layouts[s].layout);e.pipelineLayout=n.getHandle().createPipelineLayout({bindGroupLayouts:a}),e.pipelineDescription.layout=e.pipelineLayout;for(let s=0;s<e.shaderDescriptions.length;s++){const i=e.shaderDescriptions[s],o=n.getShaderModule(i);i.getType()==="vertex"&&(e.pipelineDescription.vertex.module=o.getHandle(),e.pipelineDescription.vertex.entryPoint="main"),i.getType()==="fragment"&&(e.pipelineDescription.fragment.module=o.getHandle(),e.pipelineDescription.fragment.entryPoint="main")}e.handle=n.getHandle().createRenderPipeline(e.pipelineDescription)},t.getShaderDescription=n=>{for(let r=0;r<e.shaderDescriptions.length;r++)if(e.shaderDescriptions[r].getType()===n)return e.shaderDescriptions[r];return null},t.addBindGroupLayout=n=>{n&&e.layouts.push({layout:n.getBindGroupLayout(e.device),label:n.getLabel()})},t.getBindGroupLayout=n=>e.layouts[n].layout,t.getBindGroupLayoutCount=n=>{for(let r=0;r<e.layouts.length;r++)if(e.layouts[r].label===n)return r;return 0},t.bindVertexInput=(n,r)=>{r.bindBuffers(n)}}const MD={handle:null,layouts:null,renderEncoder:null,shaderDescriptions:null,vertexState:null,topology:null,pipelineDescription:null};function F1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MD,n),qe(t,e),e.layouts=[],e.shaderDescriptions=[],pt(t,e,["handle","pipelineDescription"]),He(t,e,["device","renderEncoder","topology","vertexState"]),OD(t,e)}const DD=we(F1,"vtkWebGPUPipeline");var LD={newInstance:DD,extend:F1};function mD(t,e){e.classHierarchy.push("vtkWebGPUShaderDescription"),t.hasOutput=n=>e.outputNames.includes(n),t.addOutput=function(n,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;e.outputTypes.push(n),e.outputNames.push(r),e.outputInterpolations.push(a)},t.addBuiltinOutput=(n,r)=>{e.builtinOutputTypes.push(n),e.builtinOutputNames.push(r)},t.addBuiltinInput=(n,r)=>{e.builtinInputTypes.push(n),e.builtinInputNames.push(r)},t.replaceShaderCode=(n,r)=>{const a=[];let s=[];if(r&&a.push(r.getShaderCode()),n||e.builtinInputNames.length){const i=[];if(i.push(`struct ${e.type}Input
{`),n){const o=n.getOutputNamesByReference(),c=n.getOutputTypesByReference(),u=n.getOutputInterpolationsByReference();for(let g=0;g<o.length;g++)u[g]!==void 0?i.push(`  @location(${g}) @interpolate(${u[g]}) ${o[g]} : ${c[g]},`):i.push(`  @location(${g}) ${o[g]} : ${c[g]},`)}for(let o=0;o<e.builtinInputNames.length;o++)i.push(`  ${e.builtinInputNames[o]} : ${e.builtinInputTypes[o]},`);i.length>1&&(i.push("};"),s=i,a[a.length-1]+=",",a.push(`input: ${e.type}Input`))}if(a.length&&(e.code=ae.substitute(e.code,"//VTK::IOStructs::Input",a).result),e.outputNames.length+e.builtinOutputNames.length){const i=[`struct ${e.type}Output
{`];for(let o=0;o<e.outputNames.length;o++)e.outputInterpolations[o]!==void 0?i.push(`  @location(${o}) @interpolate(${e.outputInterpolations[o]}) ${e.outputNames[o]} : ${e.outputTypes[o]},`):i.push(`  @location(${o}) ${e.outputNames[o]} : ${e.outputTypes[o]},`);for(let o=0;o<e.builtinOutputNames.length;o++)i.push(`  ${e.builtinOutputNames[o]} : ${e.builtinOutputTypes[o]},`);i.push("};"),s=s.concat(i),e.code=ae.substitute(e.code,"//VTK::IOStructs::Output",[`-> ${e.type}Output`]).result}e.code=ae.substitute(e.code,"//VTK::IOStructs::Dec",s).result}}const VD={type:null,hash:null,code:null,outputNames:null,outputTypes:null};function B1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,VD,n),e.outputNames=[],e.outputTypes=[],e.outputInterpolations=[],e.builtinOutputNames=[],e.builtinOutputTypes=[],e.builtinInputNames=[],e.builtinInputTypes=[],E.obj(t,e),E.setGet(t,e,["type","hash","code"]),E.getArray(t,e,["outputTypes","outputNames","outputInterpolations"]),mD(t,e)}const FD=E.newInstance(B1,"vtkWebGPUShaderDescription");var _g={newInstance:FD,extend:B1};const Ug={r8unorm:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"float"},r8snorm:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"float"},r8uint:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},r8sint:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"sint"},r16uint:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"uint"},r16sint:{numComponents:1,nativeType:Int16Array,stride:2,elementSize:2,sampleType:"sint"},r16float:{numComponents:1,nativeType:Float32Array,stride:2,elementSize:2,sampleType:"float"},rg8unorm:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"float"},rg8snorm:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"float"},rg8uint:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"uint"},rg8sint:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"sint"},r32uint:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:4,sampleType:"uint"},r32sint:{numComponents:1,nativeType:Int32Array,stride:4,elementSize:4,sampleType:"sint"},r32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"unfilterable-float"},rg16uint:{numComponents:2,nativeType:Uint16Array,stride:4,elementSize:2,sampleType:"uint"},rg16sint:{numComponents:2,nativeType:Int16Array,stride:4,elementSize:2,sampleType:"sint"},rg16float:{numComponents:2,nativeType:Float32Array,stride:4,elementSize:2,sampleType:"float"},rgba8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"rgba8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgba8snorm:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"float"},rgba8uint:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"uint"},rgba8sint:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"sint"},bgra8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"bgra8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgb9e5ufloat:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rgb10a2unorm:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rg11b10ufloat:{numComponents:4,nativeType:Float32Array,stride:4,sampleType:"float"},rg32uint:{numComponents:2,nativeType:Uint32Array,stride:8,elementSize:4,sampleType:"uint"},rg32sint:{numComponents:2,nativeType:Int32Array,stride:8,elementSize:4,sampleType:"sint"},rg32float:{numComponents:2,nativeType:Float32Array,stride:8,elementSize:4,sampleType:"unfilterable-float"},rgba16uint:{numComponents:4,nativeType:Uint16Array,stride:8,elementSize:2,sampleType:"uint"},rgba16sint:{numComponents:4,nativeType:Int16Array,stride:8,elementSize:2,sampleType:"sint"},rgba16float:{numComponents:4,nativeType:Float32Array,stride:8,elementSize:2,sampleType:"float"},rgba32uint:{numComponents:4,nativeType:Uint32Array,stride:16,elementSize:4,sampleType:"uint"},rgba32sint:{numComponents:4,nativeType:Int32Array,stride:16,elementSize:4,sampleType:"sint"},rgba32float:{numComponents:4,nativeType:Float32Array,stride:16,elementSize:4,sampleType:"unfilterable-float"},stencil8:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},depth16unorm:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"depth"},depth24plus:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:3,sampleType:"depth"},"depth24plus-stencil8":{numComponents:2,nativeType:Uint32Array,stride:4,sampleType:"mixed"},depth32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"depth"}};function BD(t){return!t||t.length<6?0:t in Ug?Ug[t]:(ie(`unknown format ${t}`),null)}function _D(t){if(!t||t.length<5)return 0;let e=1;t[t.length-2]==="x"&&(e=Number(t[t.length-1]));const n=e===1?t.length-1:t.length-3,r=Number(t[n]);if(Number.isNaN(r))return ie(`unknown format ${t}`),0;const a=5-r/2;return e*a}function UD(t){if(!t||t.length<5)return 0;let e=1;return t[t.length-2]==="x"&&(e=Number(t[t.length-1])),e}function ND(t){if(!t||t.length<5)return 0;let e;if(t[0]==="f")e="Float";else if(t[0]==="s")e="Int";else if(t[0]==="u")e="Uint";else{ie(`unknown format ${t}`);return}const n=t.split("x")[0],r=Number(n[n.length-1]);if(Number.isNaN(r)){ie(`unknown format ${t}`);return}return e+=8*(5-r/2),e+="Array",e}function kD(t){let e;if(t[0]==="f"||t[1]==="n")e="f32";else if(t[0]==="s"&&t[1]==="i")e="i32";else if(t[0]==="u"&&t[1]==="i")e="u32";else{ie(`unknown format ${t}`);return}let n=1;return t[t.length-2]==="x"&&(n=Number(t[t.length-1])),n===4?`vec4<${e}>`:n===3?`vec3<${e}>`:n===2?`vec2<${e}>`:e}function GD(t){if(!t)return 0;let e=1;return t.substring(0,3)==="vec"?e=Number(t[3]):t.substring(0,3)==="mat"&&(e=t[3]*t[5]),e*4}function bD(t){if(t){if(t.includes("f32"))return"Float32Array";if(t.includes("i32"))return"Int32Array";if(t.includes("u32"))return"Uint32Array";ie(`unknown format ${t}`)}}var Xe={getDetailsFromTextureFormat:BD,getByteStrideFromBufferFormat:_D,getNumberOfComponentsFromBufferFormat:UD,getNativeTypeFromBufferFormat:ND,getShaderTypeFromBufferFormat:kD,getByteStrideFromShaderFormat:GD,getNativeTypeFromShaderFormat:bD};function $D(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!e.includes(t[n]))return!1;return!0}function WD(t,e){e.classHierarchy.push("vtkWebGPUVertexInput"),t.addBuffer=function(n,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"vertex",s=r;Array.isArray(s)||(s=[s]);for(let i=0;i<e.inputs.length;i++)if($D(e.inputs[i].names,s)){if(e.inputs[i].buffer===n)return;e.inputs[i].buffer=n;return}e.inputs.push({buffer:n,stepMode:a,names:s}),e.inputs=e.inputs.sort((i,o)=>i.names[0]<o.names[0]?-1:i.names[0]>o.names[0]?1:0)},t.removeBufferIfPresent=n=>{for(let r=0;r<e.inputs.length;r++)e.inputs[r].names.includes(n)&&e.inputs.splice(r,1)},t.getBuffer=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return e.inputs[r].buffer;return null},t.hasAttribute=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return!0;return!1},t.getAttributeTime=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return e.inputs[r].buffer.getSourceTime();return 0},t.getShaderCode=()=>{let n="",r=0;for(let a=0;a<e.inputs.length;a++)for(let s=0;s<e.inputs[a].names.length;s++){const i=e.inputs[a].buffer.getArrayInformation()[s],o=Xe.getShaderTypeFromBufferFormat(i.format);r>0&&(n+=`,
`),n=`${n}  @location(${r}) ${e.inputs[a].names[s]} : ${o}`,r++}return n},t.getVertexInputInformation=()=>{const n={};if(e.inputs.length){const r=[];let a=0;for(let s=0;s<e.inputs.length;s++){const i=e.inputs[s].buffer,o={arrayStride:i.getStrideInBytes(),stepMode:e.inputs[s].stepMode,attributes:[]},c=i.getArrayInformation();for(let u=0;u<e.inputs[s].names.length;u++)o.attributes.push({shaderLocation:a,offset:c[u].offset,format:c[u].format}),a++;r.push(o)}n.buffers=r}return n},t.bindBuffers=n=>{for(let r=0;r<e.inputs.length;r++)n.setVertexBuffer(r,e.inputs[r].buffer.getHandle());e.indexBuffer&&n.setIndexBuffer(e.indexBuffer.getHandle(),e.indexBuffer.getArrayInformation()[0].format)},t.getReady=()=>{},t.releaseGraphicsResources=()=>{e.created&&(e.inputs=[],e.bindingDescriptions=[],e.attributeDescriptions=[])}}const zD={inputs:null,bindingDescriptions:!1,attributeDescriptions:null,indexBuffer:null};function _1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zD,n),qe(t,e),e.bindingDescriptions=[],e.attributeDescriptions=[],e.inputs=[],He(t,e,["created","device","handle","indexBuffer"]),WD(t,e)}const HD=we(_1,"vtkWebGPUVertexInput");var AD={newInstance:HD,extend:_1};const jD=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  // var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,KD=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::Light::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  // var computedColor:vec4<f32> = vec4<f32>(1.0,0.5,0.5,1.0);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function PD(t,e){e.classHierarchy.push("vtkWebGPUSimpleMapper"),t.generateShaderDescriptions=(n,r,a)=>{const s=_g.newInstance({type:"vertex",hash:n,code:e.vertexShaderTemplate}),i=_g.newInstance({type:"fragment",hash:n,code:e.fragmentShaderTemplate}),o=r.getShaderDescriptions();o.push(s),o.push(i);const c=e.vertexShaderTemplate+e.fragmentShaderTemplate,u=new RegExp("//VTK::[^:]*::","g"),f=c.match(u).filter((l,p,v)=>v.indexOf(l)===p).map(l=>`replaceShader${l.substring(7,l.length-2)}`);for(let l=0;l<f.length;l++){const p=f[l];p!=="replaceShaderIOStructs"&&e.shaderReplacements.has(p)&&e.shaderReplacements.get(p)(n,r,a)}t.replaceShaderIOStructs(n,r,a)},t.replaceShaderIOStructs=(n,r,a)=>{const s=r.getShaderDescription("vertex");s.replaceShaderCode(null,a),r.getShaderDescription("fragment").replaceShaderCode(s)},t.replaceShaderRenderEncoder=(n,r,a)=>{e.renderEncoder.replaceShaderCode(r)},e.shaderReplacements.set("replaceShaderRenderEncoder",t.replaceShaderRenderEncoder),t.replaceShaderRenderer=(n,r,a)=>{if(!e.WebGPURenderer)return;const s=e.WebGPURenderer.getBindGroup().getShaderCode(r),i=r.getShaderDescription("vertex");let o=i.getCode();o=ae.substitute(o,"//VTK::Renderer::Dec",[s]).result,i.setCode(o);const c=r.getShaderDescription("fragment");o=c.getCode(),o=ae.substitute(o,"//VTK::Renderer::Dec",[s]).result,c.setCode(o)},e.shaderReplacements.set("replaceShaderRenderer",t.replaceShaderRenderer),t.replaceShaderMapper=(n,r,a)=>{const s=e.bindGroup.getShaderCode(r),i=r.getShaderDescription("vertex");let o=i.getCode();o=ae.substitute(o,"//VTK::Mapper::Dec",[s]).result,i.setCode(o);const c=r.getShaderDescription("fragment");c.addBuiltinInput("bool","@builtin(front_facing) frontFacing"),o=c.getCode(),o=ae.substitute(o,"//VTK::Mapper::Dec",[s]).result,c.setCode(o)},e.shaderReplacements.set("replaceShaderMapper",t.replaceShaderMapper),t.replaceShaderPosition=(n,r,a)=>{const s=r.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let i=s.getCode();i=ae.substitute(i,"//VTK::Position::Impl",["    output.Position = rendererUBO.SCPCMatrix*vertexBC;"]).result,s.setCode(i)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=(n,r,a)=>{r.getShaderDescription("vertex").addOutput("vec2<f32>","tcoordVS")},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.addTextureView=n=>{e.textureViews.includes(n)||e.textureViews.push(n)},t.prepareToDraw=n=>{e.renderEncoder=n,t.updateInput(),t.updateBuffers(),t.updateBindings(),t.updatePipeline()},t.updateInput=()=>{},t.updateBuffers=()=>{},t.updateBindings=()=>{e.bindGroup.setBindables(t.getBindables())},t.computePipelineHash=()=>{},t.registerDrawCallback=n=>{n.registerDrawCallback(e.pipeline,t.draw)},t.prepareAndDraw=n=>{t.prepareToDraw(n),n.setPipeline(e.pipeline),t.draw(n)},t.draw=n=>{const r=n.getBoundPipeline();n.activateBindGroup(e.bindGroup),e.WebGPURenderer&&e.WebGPURenderer.bindUBO(n),r.bindVertexInput(n,e.vertexInput);const a=e.vertexInput.getIndexBuffer();a?n.drawIndexed(a.getIndexCount(),e.numberOfInstances,0,0,0):n.draw(e.numberOfVertices,e.numberOfInstances,0,0)},t.getBindables=()=>{const n=[...e.additionalBindables];e.UBO&&n.push(e.UBO),e.SSBO&&n.push(e.SSBO);for(let r=0;r<e.textureViews.length;r++){n.push(e.textureViews[r]);const a=e.textureViews[r].getSampler();a&&n.push(a)}return n},t.updatePipeline=()=>{t.computePipelineHash(),e.pipeline=e.device.getPipeline(e.pipelineHash),e.pipeline||(e.pipeline=LD.newInstance(),e.pipeline.setDevice(e.device),e.WebGPURenderer&&e.pipeline.addBindGroupLayout(e.WebGPURenderer.getBindGroup()),e.pipeline.addBindGroupLayout(e.bindGroup),t.generateShaderDescriptions(e.pipelineHash,e.pipeline,e.vertexInput),e.pipeline.setTopology(e.topology),e.pipeline.setRenderEncoder(e.renderEncoder),e.pipeline.setVertexState(e.vertexInput.getVertexInputInformation()),e.device.createPipeline(e.pipelineHash,e.pipeline))}}const XD={additionalBindables:void 0,bindGroup:null,device:null,fragmentShaderTemplate:null,numberOfInstances:1,numberOfVertices:0,pipelineHash:null,shaderReplacements:null,SSBO:null,textureViews:null,topology:"triangle-list",UBO:null,vertexShaderTemplate:null,WebGPURenderer:null};function U1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XD,n),Be.extend(t,e,n),e.textureViews=[],e.vertexInput=AD.newInstance(),e.bindGroup=L1.newInstance({label:"mapperBG"}),e.additionalBindables=[],e.fragmentShaderTemplate=e.fragmentShaderTemplate||KD,e.vertexShaderTemplate=e.vertexShaderTemplate||jD,e.shaderReplacements=new Map,E.get(t,e,["pipeline","vertexInput"]),E.setGet(t,e,["additionalBindables","device","fragmentShaderTemplate","interpolate","numberOfInstances","numberOfVertices","pipelineHash","shaderReplacements","SSBO","textureViews","topology","UBO","vertexShaderTemplate","WebGPURenderer"]),PD(t,e)}const ID=E.newInstance(U1,"vtkWebGPUSimpleMapper");var xf={newInstance:ID,extend:U1};function YD(t,e){e.classHierarchy.push("vtkWebGPUFullScreenQuad"),t.replaceShaderPosition=(n,r,a)=>{const s=r.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),s.addOutput("vec4<f32>","vertexVC");let i=s.getCode();i=ae.substitute(i,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);","output.vertexVC = vec4<f32>(vertexBC, 1);"]).result,s.setCode(i)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.updateBuffers=()=>{const n=e.device.getBufferManager().getFullScreenQuadBuffer();e.vertexInput.addBuffer(n,["vertexBC"]),e.numberOfVertices=6}}const qD={};function N1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,qD,n),xf.extend(t,e,n),YD(t,e)}const QD=E.newInstance(N1,"vtkWebGPUFullScreenQuad");var jr={newInstance:QD,extend:N1};const ZD={Verts:0,Lines:1,Triangles:2,Strips:3,LinesFromStrips:4,LinesFromTriangles:5,Points:6,UniformArray:7,PointArray:8,NormalsFromPoints:9,Texture:10,RawVertex:11,Storage:12,Index:13},JD={Start:0,Points:0,Lines:1,Triangles:2,TriangleStrips:3,TriangleEdges:4,TriangleStripEdges:5,End:6};var Qa={BufferUsage:ZD,PrimitiveTypes:JD};const yo=["getMappedRange","mapAsync","unmap"];function eL(t,e,n,r){const a=r.byteLength,s=t.createBuffer({size:a,usage:GPUBufferUsage.COPY_SRC,mappedAtCreation:!0}),i=s.getMappedRange(0,a);new Uint8Array(i).set(new Uint8Array(r)),s.unmap();const o=t.createCommandEncoder();o.copyBufferToBuffer(s,0,e,n,a);const c=o.finish();t.queue.submit([c]),s.destroy()}function tL(t,e){e.classHierarchy.push("vtkWebGPUBuffer"),t.create=(n,r)=>{e.handle=e.device.getHandle().createBuffer({size:n,usage:r,label:e.label}),e.sizeInBytes=n,e.usage=r},t.write=n=>{eL(e.device.getHandle(),e.handle,0,n.buffer)},t.createAndWrite=(n,r)=>{const a=Math.ceil(n.byteLength/4)*4;e.handle=e.device.getHandle().createBuffer({size:a,usage:r,mappedAtCreation:!0,label:e.label}),e.sizeInBytes=a,e.usage=r,new Uint8Array(e.handle.getMappedRange()).set(new Uint8Array(n.buffer)),e.handle.unmap()};for(let n=0;n<yo.length;n++)t[yo[n]]=function(){return e.handle[yo[n]](...arguments)}}const nL={device:null,handle:null,sizeInBytes:0,strideInBytes:0,arrayInformation:null,usage:null,label:null,sourceTime:null};function k1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nL,n),E.obj(t,e),E.get(t,e,["handle","sizeInBytes","usage"]),E.setGet(t,e,["strideInBytes","device","arrayInformation","label","sourceTime"]),tL(t,e)}const rL=E.newInstance(k1);var Kr={newInstance:rL,extend:k1,...Qa};const{Representation:Ng}=qr,{PrimitiveTypes:Un}=Qa;class aL{constructor(){this.keys=new Uint32Array(10),this.values=new Uint32Array(10),this.count=0}clear(){this.count=0}has(e){for(let n=0;n<this.count;n++)if(this.keys[n]===e)return!0}get(e){for(let n=0;n<this.count;n++)if(this.keys[n]===e)return this.values[n]}set(e,n){this.count<9&&(this.keys[this.count]=e,this.values[this.count++]=n)}}function sL(t){switch(t){case Un.Points:return"points";case Un.Lines:return"lines";case Un.Triangles:case Un.TriangleEdges:return"polys";case Un.TriangleStripEdges:case Un.TriangleStrips:return"strips";default:return""}}function ds(t,e,n){let r=t.pointIdToFlatId[e];return r<0&&(r=t.flatId,t.pointIdToFlatId[e]=r,t.flatIdToPointId[t.flatId]=e,t.flatIdToCellId[t.flatId]=n,t.flatId++),r}function iL(t,e,n){const r=t.length;for(let i=0;i<r;i++){let o=t[i];if(n.cellProvokedMap.has(o)){n.ibo[n.iboId++]=n.cellProvokedMap.get(o);for(let c=i+1;c<i+r;c++){o=t[c%r];const u=ds(n,o,e);n.ibo[n.iboId++]=u}return}}for(let i=0;i<r;i++){let o=t[i];if(!n.provokedPointIds[o]){let c=ds(n,o,e);n.provokedPointIds[o]=1,n.cellProvokedMap.set(o,c),n.flatIdToCellId[c]=e,n.ibo[n.iboId++]=c;for(let u=i+1;u<i+r;u++)o=t[u%r],c=ds(n,o,e),n.ibo[n.iboId++]=c;return}}let a=t[0],s=n.flatId;n.cellProvokedMap.set(a,s),n.flatIdToPointId[n.flatId]=a,n.flatIdToCellId[n.flatId]=e,n.flatId++,n.ibo[n.iboId++]=s;for(let i=1;i<r;i++)a=t[i],s=ds(n,a,e),n.ibo[n.iboId++]=s}function oL(t,e,n){const r=t.length;n.iboSize+=r;for(let a=0;a<r;a++){const s=t[a];if(n.cellProvokedMap.has(s))return}for(let a=0;a<r;a++){const s=t[a];if(!n.provokedPointIds[s]){n.provokedPointIds[s]=1,n.cellProvokedMap.set(s,1);return}}n.cellProvokedMap.set(t[0],1),n.extraPoints++}let cn;const kg=new Uint32Array(1),Mt=new Uint32Array(2),On=new Uint32Array(3),To={anythingToPoints(t,e,n,r,a){for(let s=0;s<t;++s)kg[0]=e[n+s],cn(kg,r,a)},linesToWireframe(t,e,n,r,a){for(let s=0;s<t-1;++s)Mt[0]=e[n+s],Mt[1]=e[n+s+1],cn(Mt,r,a)},polysToWireframe(t,e,n,r,a){if(t>2)for(let s=0;s<t;++s)Mt[0]=e[n+s],Mt[1]=e[n+(s+1)%t],cn(Mt,r,a)},stripsToWireframe(t,e,n,r,a){if(t>2){for(let s=0;s<t-1;++s)Mt[0]=e[n+s],Mt[1]=e[n+s+1],cn(Mt,r,a);for(let s=0;s<t-2;s++)Mt[0]=e[n+s],Mt[1]=e[n+s+2],cn(Mt,r,a)}},polysToSurface(t,e,n,r,a){for(let s=0;s<t-2;s++)On[0]=e[n],On[1]=e[n+s+1],On[2]=e[n+s+2],cn(On,r,a)},stripsToSurface(t,e,n,r,a){for(let s=0;s<t-2;s++)On[0]=e[n+s],On[1]=e[n+s+1+s%2],On[2]=e[n+s+1+(s+1)%2],cn(On,r,a)}};function cL(t,e){e.classHierarchy.push("vtkWebGPUIndexBuffer"),t.buildIndexBuffer=n=>{const r=n.cells,a=n.primitiveType,s=n.representation,i=n.cellOffset,o=r.getData(),c=o.length,u=sL(a),g=n.numberOfPoints,f={provokedPointIds:new Uint8Array(g),extraPoints:0,iboSize:0,flatId:0,iboId:0,cellProvokedMap:new aL};let l=null;s===Ng.POINTS||a===Un.Points?l=To.anythingToPoints:s===Ng.WIREFRAME||a===Un.Lines?l=To[`${u}ToWireframe`]:l=To[`${u}ToSurface`],cn=oL;let p=i||0;for(let v=0;v<c;)f.cellProvokedMap.clear(),l(o[v],o,v+1,p,f),v+=o[v]+1,p++;g<=65535?f.flatIdToPointId=new Uint16Array(g+f.extraPoints):f.flatIdToPointId=new Uint32Array(g+f.extraPoints),g+f.extraPoints<36863?f.pointIdToFlatId=new Int16Array(g):f.pointIdToFlatId=new Int32Array(g),g+f.extraPoints<=65535?(f.ibo=new Uint16Array(f.iboSize),n.format="uint16"):(f.ibo=new Uint32Array(f.iboSize),n.format="uint32"),p<=65535?f.flatIdToCellId=new Uint16Array(g+f.extraPoints):f.flatIdToCellId=new Uint32Array(g+f.extraPoints),f.pointIdToFlatId.fill(-1),f.provokedPointIds.fill(0),cn=iL,p=i||0;for(let v=0;v<c;)f.cellProvokedMap.clear(),l(o[v],o,v+1,p,f),v+=o[v]+1,p++;delete f.provokedPointIds,delete f.pointIdToFlatId,n.nativeArray=f.ibo,e.flatIdToPointId=f.flatIdToPointId,e.flatIdToCellId=f.flatIdToCellId,e.flatSize=f.flatId,e.indexCount=f.iboId}}const fL={flatIdToPointId:null,flatIdToCellId:null,flatSize:0,indexCount:0};function G1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fL,n),Kr.extend(t,e,n),E.setGet(t,e,["flatIdToPointId","flatIdToCellId","flatSize","indexCount"]),cL(t,e)}const uL=E.newInstance(G1);var gL={newInstance:uL,extend:G1,...Qa};const{BufferUsage:Mn}=Qa,{vtkErrorMacro:lL}=nn,{VtkDataTypes:tr}=xe,pL={};function hL(t){let e;switch(t.getDataType()){case tr.UNSIGNED_CHAR:e="uint8";break;case tr.FLOAT:e="float32";break;case tr.UNSIGNED_INT:e="uint32";break;case tr.INT:e="sint32";break;case tr.DOUBLE:e="float32";break;case tr.UNSIGNED_SHORT:e="uint16";break;case tr.SHORT:e="sin16";break;default:e="float32";break}switch(t.getNumberOfComponents()){case 2:e+="x2";break;case 3:e.includes("32")||lL(`unsupported x3 type for ${e}`),e+="x3";break;case 4:e+="x4";break}return e}function Gg(t,e,n,r,a){const s={},i=t.getFlatSize();if(!i)return s;let o=[0,0,0,0];a.shift&&(a.shift.length?o=a.shift:o.fill(a.shift));let c=[1,1,1,1];a.scale&&(a.scale.length?c=a.scale:c.fill(a.scale));const u=Object.prototype.hasOwnProperty.call(a,"packExtra")?a.packExtra:!1;let g,f=0;const l=n+(u?1:0),p=Ir(r,i*l);let v=t.getFlatIdToPointId();a.cellData&&(v=t.getFlatIdToCellId()),n===1?g=function(d){p[f++]=c[0]*e[d]+o[0]}:n===2?g=function(d){p[f++]=c[0]*e[d]+o[0],p[f++]=c[1]*e[d+1]+o[1]}:n===3&&!u?g=function(d){p[f++]=c[0]*e[d]+o[0],p[f++]=c[1]*e[d+1]+o[1],p[f++]=c[2]*e[d+2]+o[2]}:n===3&&u?g=function(d){p[f++]=c[0]*e[d]+o[0],p[f++]=c[1]*e[d+1]+o[1],p[f++]=c[2]*e[d+2]+o[2],p[f++]=c[3]*1+o[3]}:n===4&&(g=function(d){p[f++]=c[0]*e[d]+o[0],p[f++]=c[1]*e[d+1]+o[1],p[f++]=c[2]*e[d+2]+o[2],p[f++]=c[3]*e[d+3]+o[3]});for(let h=0;h<i;h++){const d=n*v[h];g(d)}return s.nativeArray=p,s}function dL(t,e,n,r){const a=[t[r*3]-t[n*3],t[r*3+1]-t[n*3+1],t[r*3+2]-t[n*3+2]],s=[t[e*3]-t[n*3],t[e*3+1]-t[n*3+1],t[e*3+2]-t[n*3+2]],i=[];return gt(a,s,i),Rt(i),i}function vL(t,e){const n=e.getData(),r=t.getData();if(!r||!n)return null;const a=new Int8Array(t.getNumberOfCells()*4),s=r.length;let i=0;for(let o=0;o<s;){const c=dL(n,r[o+1],r[o+2],r[o+3]);a[i++]=127*c[0],a[i++]=127*c[1],a[i++]=127*c[2],a[i++]=127,o+=r[o]+1}return a}function yL(t,e){e.classHierarchy.push("vtkWebGPUBufferManager");function n(r){r.dataArray&&!r.nativeArray&&(r.nativeArray=r.dataArray.getData());let a,s;if(r.usage===Mn.Index&&(a=gL.newInstance({label:r.label}),a.setDevice(e.device),s=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,a.buildIndexBuffer(r),a.createAndWrite(r.nativeArray,s),a.setArrayInformation([{format:r.format}])),a||(a=Kr.newInstance({label:r.label}),a.setDevice(e.device)),r.usage===Mn.UniformArray&&(s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a.createAndWrite(r.nativeArray,s)),r.usage===Mn.Storage&&(s=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,a.createAndWrite(r.nativeArray,s)),r.usage===Mn.Texture&&(s=GPUBufferUsage.COPY_SRC,a.createAndWrite(r.nativeArray,s)),r.usage===Mn.PointArray){s=GPUBufferUsage.VERTEX;const i=Xe.getNativeTypeFromBufferFormat(r.format),o=Gg(r.indexBuffer,r.dataArray.getData(),r.dataArray.getNumberOfComponents(),i,{packExtra:r.packExtra,shift:r.shift,scale:r.scale,cellData:r.cellData,cellOffset:r.cellOffset});a.createAndWrite(o.nativeArray,s),a.setStrideInBytes(Xe.getByteStrideFromBufferFormat(r.format)),a.setArrayInformation([{offset:0,format:r.format,interpolation:r.cellData?"flat":"perspective"}])}if(r.usage===Mn.NormalsFromPoints){s=GPUBufferUsage.VERTEX;const i=Xe.getNativeTypeFromBufferFormat(r.format),o=vL(r.cells,r.dataArray),c=Gg(r.indexBuffer,o,4,i,{cellData:!0});a.createAndWrite(c.nativeArray,s),a.setStrideInBytes(Xe.getByteStrideFromBufferFormat(r.format)),a.setArrayInformation([{offset:0,format:r.format,interpolation:"flat"}])}return r.usage===Mn.RawVertex&&(s=GPUBufferUsage.VERTEX,a.createAndWrite(r.nativeArray,s),a.setStrideInBytes(Xe.getByteStrideFromBufferFormat(r.format)),a.setArrayInformation([{offset:0,format:r.format}])),a.setSourceTime(r.time),a}t.hasBuffer=r=>e.device.hasCachedObject(r),t.getBuffer=r=>r.hash?e.device.getCachedObject(r.hash,n,r):n(r),t.getBufferForPointArray=(r,a)=>{const s=hL(r),i={hash:`${r.getMTime()}I${a.getMTime()}${s}`,usage:Mn.PointArray,format:s,dataArray:r,indexBuffer:a};return t.getBuffer(i)},t.getFullScreenQuadBuffer=()=>{if(e.fullScreenQuadBuffer)return e.fullScreenQuadBuffer;e.fullScreenQuadBuffer=Kr.newInstance(),e.fullScreenQuadBuffer.setDevice(e.device);const r=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]);return e.fullScreenQuadBuffer.createAndWrite(r,GPUBufferUsage.VERTEX),e.fullScreenQuadBuffer.setStrideInBytes(12),e.fullScreenQuadBuffer.setArrayInformation([{offset:0,format:"float32x3"}]),e.fullScreenQuadBuffer}}const TL={device:null,fullScreenQuadBuffer:null};function b1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TL,n),qe(t,e),He(t,e,["device"]),yL(t,e)}const xL=we(b1);var Cr={newInstance:xL,extend:b1,...pL,...Qa};const{BufferUsage:SL}=Cr,{vtkErrorMacro:Or}=E;function CL(t,e){e.classHierarchy.push("vtkWebGPUStorageBuffer"),t.addEntry=(n,r)=>{if(e._bufferEntryNames.has(n)){Or(`entry named ${n} already exists`);return}e._bufferEntryNames.set(n,e.bufferEntries.length);const a=Xe.getByteStrideFromShaderFormat(r);e.bufferEntries.push({name:n,type:r,sizeInBytes:a,offset:e.sizeInBytes,nativeType:Xe.getNativeTypeFromShaderFormat(r)}),e.sizeInBytes+=a},t.send=n=>{if(!e._buffer){const r={nativeArray:e.Float32Array,usage:SL.Storage,label:e.label};e._buffer=n.getBufferManager().getBuffer(r),e.bindGroupTime.modified(),e._sendTime.modified();return}n.getHandle().queue.writeBuffer(e._buffer.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes*e.numberOfInstances),e._sendTime.modified()},t.createView=n=>{n in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes*e.numberOfInstances)),e[n]=E.newTypedArray(n,e.arrayBuffer))},t.setValue=(n,r,a)=>{const s=e._bufferEntryNames.get(n);if(s===void 0){Or(`entry named ${n} not found in UBO`);return}const i=e.bufferEntries[s];t.createView(i.nativeType);const o=e[i.nativeType];o[(i.offset+r*e.sizeInBytes)/o.BYTES_PER_ELEMENT]=a},t.setArray=(n,r,a)=>{const s=e._bufferEntryNames.get(n);if(s===void 0){Or(`entry named ${n} not found in UBO`);return}const i=e.bufferEntries[s];t.createView(i.nativeType);const o=e[i.nativeType],c=(i.offset+r*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let u=0;u<a.length;u++)o[c+u]=a[u]},t.setAllInstancesFromArray=(n,r)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){Or(`entry named ${n} not found in UBO`);return}const s=e.bufferEntries[a];t.createView(s.nativeType);const i=e[s.nativeType],o=r.length/e.numberOfInstances;for(let c=0;c<e.numberOfInstances;c++){const u=(s.offset+c*e.sizeInBytes)/i.BYTES_PER_ELEMENT;for(let g=0;g<o;g++)i[u+g]=r[c*o+g]}},t.setAllInstancesFromArrayColorToFloat=(n,r)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){Or(`entry named ${n} not found in UBO`);return}const s=e.bufferEntries[a];t.createView(s.nativeType);const i=e[s.nativeType],o=r.length/e.numberOfInstances;for(let c=0;c<e.numberOfInstances;c++){const u=(s.offset+c*e.sizeInBytes)/i.BYTES_PER_ELEMENT;for(let g=0;g<o;g++)i[u+g]=r[c*o+g]/255}},t.setAllInstancesFromArray3x3To4x4=(n,r)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){Or(`entry named ${n} not found in UBO`);return}const s=e.bufferEntries[a];t.createView(s.nativeType);const i=e[s.nativeType],o=9;for(let c=0;c<e.numberOfInstances;c++){const u=(s.offset+c*e.sizeInBytes)/i.BYTES_PER_ELEMENT;for(let g=0;g<3;g++)for(let f=0;f<3;f++)i[u+g*4+f]=r[c*o+g*3+f]}},t.getSendTime=()=>e._sendTime.getMTime(),t.getShaderCode=(n,r)=>{const a=[`struct ${e.label}StructEntry
{`];for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];a.push(`  ${i.name}: ${i.type},`)}return a.push(`
};
struct ${e.label}Struct
{
  values: array<${e.label}StructEntry>,
};
@binding(${n}) @group(${r}) var<storage, read> ${e.label}: ${e.label}Struct;
`),a.join(`
`)},t.getBindGroupEntry=()=>({resource:{buffer:e._buffer.getHandle()}}),t.clearData=()=>{e.numberOfInstances=0,e.sizeInBytes=0,e.bufferEntries=[],e._bufferEntryNames=new Map,e._buffer=null,delete e.arrayBuffer,delete e.Float32Array}}const wL={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,numberOfInstances:1};function $1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wL,n),E.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e._sendTime={},E.obj(e._sendTime,{mtime:0}),e.bindGroupTime={},E.obj(e.bindGroupTime,{mtime:0}),e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"read-only-storage"}},E.get(t,e,["bindGroupTime"]),E.setGet(t,e,["device","bindGroupLayoutEntry","label","numberOfInstances","sizeInBytes"]),CL(t,e)}const EL=E.newInstance($1,"vtkWebGPUStorageBuffer");var uc={newInstance:EL,extend:$1};const{BufferUsage:RL}=Cr,{vtkErrorMacro:xo}=E;function OL(t,e){e.classHierarchy.push("vtkWebGPUUniformBuffer"),t.addEntry=(n,r)=>{if(e._bufferEntryNames.has(n)){xo(`entry named ${n} already exists`);return}e.sortDirty=!0,e._bufferEntryNames.set(n,e.bufferEntries.length),e.bufferEntries.push({name:n,type:r,sizeInBytes:Xe.getByteStrideFromShaderFormat(r),offset:-1,nativeType:Xe.getNativeTypeFromShaderFormat(r),packed:!1})},t.sortBufferEntries=()=>{if(!e.sortDirty)return;let n=0;const r=[];let a=4;for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];i.sizeInBytes%16===0&&(a=Math.max(16,a)),i.sizeInBytes%8===0&&(a=Math.max(8,a))}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];i.packed===!1&&i.sizeInBytes%16===0&&(i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes)}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];if(i.packed===!1&&i.sizeInBytes===12)for(let o=0;o<e.bufferEntries.length;o++){const c=e.bufferEntries[o];if(c.packed===!1&&c.sizeInBytes===4){i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes,c.packed=!0,c.offset=n,r.push(c),n+=c.sizeInBytes;break}}}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];if(!i.packed&&i.sizeInBytes%8===0)for(let o=s+1;o<e.bufferEntries.length;o++){const c=e.bufferEntries[o];if(!c.packed&&c.sizeInBytes%8===0){i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes,c.packed=!0,c.offset=n,r.push(c),n+=c.sizeInBytes;break}}}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];if(!i.packed&&i.sizeInBytes%8===0){let o=!1;for(let c=0;!o&&c<e.bufferEntries.length;c++){const u=e.bufferEntries[c];if(!u.packed&&u.sizeInBytes===4)for(let g=c+1;g<e.bufferEntries.length;g++){const f=e.bufferEntries[g];if(!f.packed&&f.sizeInBytes===4){i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes,u.packed=!0,u.offset=n,r.push(u),n+=u.sizeInBytes,f.packed=!0,f.offset=n,r.push(f),n+=f.sizeInBytes,o=!0;break}}}}}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];!i.packed&&i.sizeInBytes>4&&(i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes)}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];i.packed||(i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes)}e.bufferEntries=r,e._bufferEntryNames.clear();for(let s=0;s<e.bufferEntries.length;s++)e._bufferEntryNames.set(e.bufferEntries[s].name,s);e.sizeInBytes=n,e.sizeInBytes=a*Math.ceil(e.sizeInBytes/a),e.sortDirty=!1},t.sendIfNeeded=n=>{if(!e.UBO){const r={nativeArray:e.Float32Array,usage:RL.UniformArray,label:e.label};e.UBO=n.getBufferManager().getBuffer(r),e.bindGroupTime.modified(),e.sendDirty=!1}e.sendDirty&&(n.getHandle().queue.writeBuffer(e.UBO.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes),e.sendDirty=!1),e.sendTime.modified()},t.createView=n=>{n in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes)),e[n]=E.newTypedArray(n,e.arrayBuffer))},t.setValue=(n,r)=>{t.sortBufferEntries();const a=e._bufferEntryNames.get(n);if(a===void 0){xo(`entry named ${n} not found in UBO`);return}const s=e.bufferEntries[a];t.createView(s.nativeType);const i=e[s.nativeType];s.lastValue!==r&&(i[s.offset/i.BYTES_PER_ELEMENT]=r,e.sendDirty=!0),s.lastValue=r},t.setArray=(n,r)=>{t.sortBufferEntries();const a=e._bufferEntryNames.get(n);if(a===void 0){xo(`entry named ${n} not found in UBO`);return}const s=e.bufferEntries[a];t.createView(s.nativeType);const i=e[s.nativeType];let o=!1;for(let c=0;c<r.length;c++)(!s.lastValue||s.lastValue[c]!==r[c])&&(i[s.offset/i.BYTES_PER_ELEMENT+c]=r[c],o=!0);o&&(e.sendDirty=!0,s.lastValue=[...r])},t.getBindGroupEntry=()=>({resource:{buffer:e.UBO.getHandle()}}),t.getSendTime=()=>e.sendTime.getMTime(),t.getShaderCode=(n,r)=>{t.sortBufferEntries();const a=[`struct ${e.label}Struct
{`];for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];a.push(`  ${i.name}: ${i.type},`)}return a.push(`};
@binding(${n}) @group(${r}) var<uniform> ${e.label}: ${e.label}Struct;`),a.join(`
`)}}const ML={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,bindGroupLayoutEntry:null,bindGroupEntry:null};function W1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ML,n),E.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"uniform"}},e.sendTime={},E.obj(e.sendTime,{mtime:0}),e.bindGroupTime={},E.obj(e.bindGroupTime,{mtime:0}),e.sendDirty=!0,e.sortDirty=!0,E.get(t,e,["binding","bindGroupTime"]),E.setGet(t,e,["bindGroupLayoutEntry","device","label","sizeInBytes"]),OL(t,e)}const DL=E.newInstance(W1,"vtkWebGPUUniformBuffer");var lr={newInstance:DL,extend:W1};const{vtkDebugMacro:LL}=nn,bg=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = mapperUBO.BackgroundColor;

  //VTK::RenderEncoder::Impl
  return output;
}
`,mL=`
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec4<f32> = vec4<f32>(input.vertexVC.xy, -1, 1);
  var V: vec4<f32> = normalize(mapperUBO.FSQMatrix * tcoord); // vec2<f32>((input.tcoordVS.x - 0.5) * 2, -(input.tcoordVS.y - 0.5) * 2);
  // textureSampleLevel gets rid of some ugly artifacts
  var background = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, vecToRectCoord(V.xyz), 0.0);
  var computedColor: vec4<f32> = vec4<f32>(background.rgb, 1);

  //VTK::RenderEncoder::Impl
  return output;
}
`,vs=new Float64Array(16),$g=new Float64Array(16);function VL(t){return t.getPositional()?t.getConeAngle()>=90?0:2:1}function FL(t,e){e.classHierarchy.push("vtkWebGPURenderer"),t.buildPass=n=>{if(n){if(!e.renderable)return;e.camera=e.renderable.getActiveCamera(),t.updateLights(),t.prepareNodes(),t.addMissingNode(e.camera),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes(),e.webgpuCamera=t.getViewNodeFor(e.camera,e.webgpuCamera),t.updateStabilizedMatrix()}},t.updateStabilizedMatrix=()=>{const n=e.camera.getClippingRange(),r=e.camera.getPositionByReference(),a=e.camera.getDirectionOfProjectionByReference(),s=[],i=[];Ln(i,a,.5*(n[0]+n[1])),fa(s,r,i),Ho(i,s,e.stabilizedCenter),w0(i)/(n[1]-n[0])>e.recenterThreshold&&(e.stabilizedCenter=s,e.stabilizedTime.modified())},t.updateLights=()=>{let n=0;const r=e.renderable.getLightsByReference();for(let a=0;a<r.length;++a)r[a].getSwitch()>0&&n++;return n||(LL("No lights are on, creating one."),e.renderable.createLight()),n},t.updateUBO=()=>{const n=e.UBO.getSendTime();if(e._parent.getMTime()>n||t.getMTime()>n||e.camera.getMTime()>n||e.renderable.getMTime()>n){const r=e.webgpuCamera.getKeyMatrices(t);e.UBO.setArray("WCVCMatrix",r.wcvc),e.UBO.setArray("SCPCMatrix",r.scpc),e.UBO.setArray("PCSCMatrix",r.pcsc),e.UBO.setArray("SCVCMatrix",r.scvc),e.UBO.setArray("VCPCMatrix",r.vcpc),e.UBO.setArray("WCVCNormals",r.normalMatrix),e.UBO.setValue("LightCount",e.renderable.getLights().length),e.UBO.setValue("MaxEnvironmentMipLevel",e.renderable.getEnvironmentTexture()?.getMipLevel()),e.UBO.setValue("BackgroundDiffuseStrength",e.renderable.getEnvironmentTextureDiffuseStrength()),e.UBO.setValue("BackgroundSpecularStrength",e.renderable.getEnvironmentTextureSpecularStrength());const a=t.getYInvertedTiledSizeAndOrigin();e.UBO.setArray("viewportSize",[a.usize,a.vsize]),e.UBO.setValue("cameraParallel",e.camera.getParallelProjection());const s=e._parent.getDevice();e.UBO.sendIfNeeded(s)}},t.updateSSBO=()=>{const n=e.renderable.getLights(),r=e.webgpuCamera.getKeyMatrices(t);let a=`${e.renderable.getMTime()}`;for(let s=0;s<n.length;s++)a+=n[s].getMTime();if(a!==e.lightTimeString){const s=new Float32Array(n.length*4),i=new Float32Array(n.length*4),o=new Float32Array(n.length*4),c=new Float32Array(n.length*4);for(let g=0;g<n.length;g++){const f=g*4,l=n[g].getPosition();Te(l,l,r.wcvc),s[f]=l[0],s[f+1]=l[1],s[f+2]=l[2],s[f+3]=0,i[f]=-n[g].getDirection()[0],i[f+1]=-n[g].getDirection()[1],i[f+2]=-n[g].getDirection()[2],i[f+3]=0,o[f]=n[g].getColor()[0],o[f+1]=n[g].getColor()[1],o[f+2]=n[g].getColor()[2],o[f+3]=n[g].getIntensity()*5,c[f]=VL(n[g]),c[f+1]=Math.cos(Ve(n[g].getConeAngle())),c[f+2]=Math.cos(Ve(n[g].getConeAngle()+n[g].getConeFalloff())),c[f+3]=0}e.SSBO.clearData(),e.SSBO.setNumberOfInstances(n.length),e.SSBO.addEntry("LightPos","vec4<f32>"),e.SSBO.addEntry("LightDir","vec4<f32>"),e.SSBO.addEntry("LightColor","vec4<f32>"),e.SSBO.addEntry("LightData","vec4<f32>"),e.SSBO.setAllInstancesFromArray("LightPos",s),e.SSBO.setAllInstancesFromArray("LightDir",i),e.SSBO.setAllInstancesFromArray("LightColor",o),e.SSBO.setAllInstancesFromArray("LightData",c);const u=e._parent.getDevice();e.SSBO.send(u)}e.lightTimeString=a},t.scissorAndViewport=n=>{const r=t.getYInvertedTiledSizeAndOrigin();n.getHandle().setViewport(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize,0,1),n.getHandle().setScissorRect(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize)},t.bindUBO=n=>{n.activateBindGroup(e.bindGroup)},t.opaquePass=n=>{n?(e.renderEncoder.begin(e._parent.getCommandEncoder()),t.updateUBO(),t.updateSSBO()):(t.scissorAndViewport(e.renderEncoder),t.clear(),e.renderEncoder.end())},t.clear=()=>{if(e.renderable.getTransparent()||e.suppressClear)return;const n=e._parent.getDevice();if(!e.clearFSQ){e.clearFSQ=jr.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(bg);const s=lr.newInstance({label:"mapperUBO"});s.addEntry("FSQMatrix","mat4x4<f32>"),s.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(s),e.backgroundTex=e.renderable.getEnvironmentTexture()}if(e.clearFSQ.getPipelineHash()!=="clearfsqwithtexture"&&e.renderable.getUseEnvironmentTextureAsBackground()&&e.backgroundTex?.getImageLoaded()){e.clearFSQ.setFragmentShaderTemplate(mL);const s=lr.newInstance({label:"mapperUBO"});s.addEntry("FSQMatrix","mat4x4<f32>"),s.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(s);const i=n.getTextureManager().getTextureForVTKTexture(e.backgroundTex,"EnvironmentTexture");if(i.getReady()){const o=i.createView("EnvironmentTexture");e.clearFSQ.setTextureViews([o]),e.backgroundTexLoaded=!0;const c=e.backgroundTex.getInterpolate()?"linear":"nearest";o.addSampler(n,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:c,magFilter:c,mipmapFilter:"linear"})}e.clearFSQ.setPipelineHash("clearfsqwithtexture")}else if(e.clearFSQ.getPipelineHash()==="clearfsqwithtexture"&&!e.renderable.getUseEnvironmentTextureAsBackground()){e.clearFSQ=jr.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(bg);const s=lr.newInstance({label:"mapperUBO"});s.addEntry("FSQMatrix","mat4x4<f32>"),s.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(s)}const r=e.webgpuCamera.getKeyMatrices(t),a=e.renderable.getBackgroundByReference();e.clearFSQ.getUBO().setArray("BackgroundColor",a),De($g,r.normalMatrix),$o(vs,r.scvc,r.pcsc),$o(vs,$g,vs),e.clearFSQ.getUBO().setArray("FSQMatrix",vs),e.clearFSQ.getUBO().sendIfNeeded(n),e.clearFSQ.prepareAndDraw(e.renderEncoder)},t.translucentPass=n=>{n?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.volumeDepthRangePass=n=>{n?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.getAspectRatio=()=>{const n=e._parent.getSizeByReference(),r=e.renderable.getViewportByReference();return n[0]*(r[2]-r[0])/((r[3]-r[1])*n[1])},t.convertToOpenGLDepth=n=>e.webgpuCamera.convertToOpenGLDepth(n),t.getYInvertedTiledSizeAndOrigin=()=>{const n=t.getTiledSizeAndOrigin(),r=e._parent.getSizeByReference();return n.lowerLeftV=r[1]-n.vsize-n.lowerLeftV,n},t.getTiledSizeAndOrigin=()=>{const n=e.renderable.getViewportByReference(),r=[0,0,1,1],a=n[0]-r[0],s=n[1]-r[1],i=e._parent.normalizedDisplayToDisplay(a,s),o=Math.round(i[0]),c=Math.round(i[1]),u=n[2]-r[0],g=n[3]-r[1],f=e._parent.normalizedDisplayToDisplay(u,g);let l=Math.round(f[0])-o,p=Math.round(f[1])-c;return l<0&&(l=0),p<0&&(p=0),{usize:l,vsize:p,lowerLeftU:o,lowerLeftV:c}},t.getPropFromID=n=>{for(let r=0;r<e.children.length;r++)if((e.children[r].getPropID?e.children[r].getPropID():-1)===n)return e.children[r];return null},t.getStabilizedTime=()=>e.stabilizedTime.getMTime(),t.releaseGraphicsResources=()=>{e.selector!==null&&e.selector.releaseGraphicsResources()}}const BL={bindGroup:null,selector:null,renderEncoder:null,recenterThreshold:20,suppressClear:!1,stabilizedCenter:[0,0,0]};function _L(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,BL,n),Be.extend(t,e,n),e.UBO=lr.newInstance({label:"rendererUBO"}),e.UBO.addEntry("WCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("PCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("VCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("WCVCNormals","mat4x4<f32>"),e.UBO.addEntry("viewportSize","vec2<f32>"),e.UBO.addEntry("LightCount","i32"),e.UBO.addEntry("MaxEnvironmentMipLevel","f32"),e.UBO.addEntry("BackgroundDiffuseStrength","f32"),e.UBO.addEntry("BackgroundSpecularStrength","f32"),e.UBO.addEntry("cameraParallel","u32"),e.SSBO=uc.newInstance({label:"rendererLightSSBO"}),e.lightTimeString="",e.bindGroup=L1.newInstance({label:"rendererBG"}),e.bindGroup.setBindables([e.UBO,e.SSBO]),e.tmpMat4=ue(new Float64Array(16)),e.stabilizedTime={},qe(e.stabilizedTime,{mtime:0}),pt(t,e,["bindGroup","stabilizedTime"]),Yr(t,e,["stabilizedCenter"]),He(t,e,["renderEncoder","selector","suppressClear","UBO"]),FL(t,e)}const UL=we(_L,"vtkWebGPURenderer");rn("vtkRenderer",UL);const{CoordinateSystem:Wg}=qa;function NL(t,e){e.classHierarchy.push("vtkWebGPUActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const r=e.renderable.getMatrix();e.bufferShift[0]=r[3],e.bufferShift[1]=r[7],e.bufferShift[2]=r[11];const a=n.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Wg.WORLD&&(e.bufferShift[0]-=a[0],e.bufferShift[1]-=a[1],e.bufferShift[2]-=a[2]),De(e.keyMatrices.bcwc,r),e.renderable.getIsIdentity()?ue(e.keyMatrices.normalMatrix):(Qe(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,ut(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),De(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),Ue(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Wg.WORLD?Ue(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-a[0],-a[1],-a[2]]):Qe(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}const kL={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function GL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kL,n),Be.extend(t,e,n),e.keyMatricesTime={},E.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},E.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],NL(t,e)}const bL=E.newInstance(GL);rn("vtkActor",bL);const{CoordinateSystem:zg}=qa;function $L(t,e){e.classHierarchy.push("vtkWebGPUActor2D"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.bufferShift[0]=0,e.bufferShift[1]=0,e.bufferShift[2]=0;const r=n.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===zg.WORLD&&(e.bufferShift[0]-=r[0],e.bufferShift[1]-=r[1],e.bufferShift[2]-=r[2]),ue(e.keyMatrices.bcwc),ue(e.keyMatrices.normalMatrix),Ue(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===zg.WORLD?Ue(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-r[0],-r[1],-r[2]]):Qe(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}const WL={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function zL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,WL,n),Be.extend(t,e,n),e.keyMatricesTime={},E.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},E.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],$L(t,e)}const HL=E.newInstance(zL);rn("vtkActor2D",HL);function AL(t,e){e.classHierarchy.push("vtkWebGPUCubeAxesActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,s=e.WebGPURenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([s.usize,s.vsize],a,e.WebGPURenderWindow.getRenderable())}}}const jL={};function KL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jL,n),Be.extend(t,e,n),e.CubeAxesActorHelper=a1.newCubeAxesActorHelper(),AL(t,e)}const PL=we(KL,"vtkWebGPUCubeAxesActor");rn("vtkCubeAxesActor",PL);const{DisplayLocation:gc}=x1;function XL(t,e){e.classHierarchy.push("vtkProperty2D"),t.setDisplayLocationToBackground=()=>t.setDisplayLocation(gc.BACKGROUND),t.setDisplayLocationToForeground=()=>t.setDisplayLocation(gc.FOREGROUND),t.setRepresentationToWireframe=()=>t.setRepresentation(Vt.WIREFRAME),t.setRepresentationToSurface=()=>t.setRepresentation(Vt.SURFACE),t.setRepresentationToPoints=()=>t.setRepresentation(Vt.POINTS),t.getRepresentationAsString=()=>E.enumToString(Vt,e.representation)}const IL={color:[1,1,1],opacity:1,pointSize:1,lineWidth:1,representation:Vt.SURFACE,displayLocation:gc.FOREGROUND};function YL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IL,n),E.obj(t,e),E.setGet(t,e,["opacity","lineWidth","pointSize","displayLocation","representation"]),E.setGetArray(t,e,["color"],3),XL(t,e)}E.newInstance(YL,"vtkProperty2D");var qL={...x1};const{BufferUsage:Ke,PrimitiveTypes:rt}=Cr,{Representation:ys}=qr,{ScalarMode:Ts}=yr,{CoordinateSystem:QL}=qa,{DisplayLocation:Hg}=qL,ZL=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,JL=`
struct PBRData {
  diffuse: vec3<f32>,
  specular: vec3<f32>,
}

struct Material {
  ior: f32,
  roughness: f32,
  metallic: f32,
  base: vec3<f32>,
};

struct DirectionalLight {
  direction: vec3<f32>,
  color: vec3<f32>,
};

struct PointLight {
  position: vec3<f32>,
  color: vec3<f32>,
};

struct SpotLight {
  position: vec3<f32>,
  direction: vec3<f32>,
  cones: vec2<f32>,
  color: vec3<f32>,
};

const pi: f32 = 3.14159265359;

// Dot product with the max already in it
fn mdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  return max(0.0, dot(a, b));
}
// Dot product with a max in it that does not allow for negative values
// Physically based rendering is accurate as long as normals are accurate,
// however this is pretty often not the case. In order to prevent negative
// values from ruining light calculations and creating zones of zero light,
// this remapping is used, which smoothly clamps the dot product between
// zero and one while still maintaining a good amount of accuracy.
fn cdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  var d: f32 = max(0.0, dot(a, b));
  d = pow((d + 1.0) / 2.0, 2.6);
  return d;
}

// Lambertian diffuse model
fn lambertDiffuse(base: vec3<f32>, N: vec3<f32>, L: vec3<f32>) -> vec3<f32> {
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5);
  return (base/pi)*NdotL;
}

// Yasuhiro Fujii improvement on the Oren-Nayar model
// https://mimosa-pudica.net/improved-oren-nayar.html
// p is surface color, o is roughness
fn fujiiOrenNayar(p: vec3<f32>, o: f32, N: vec3<f32>, L: vec3<f32>, V: vec3<f32>) -> vec3<f32> {
  var invpi: f32 = 0.31830988618; // 1/pi

  var o2 = o*o;
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5); // Less physically accurate, but hides the "seams" between lights better

  var NdotV: f32 = mdot(N, V);
  var LdotV: f32 = mdot(L, V);

  var s: f32 = LdotV - NdotL*NdotV;
  var t: f32 = mix(1.0, max(NdotL, NdotV), step(0.0, s)); // Mix with step is the equivalent of an if statement
  var A: vec3<f32> = 0.5*(o2 / (o2 + 0.33)) + 0.17*p*(o2 / (o2 + 0.13));
  A = invpi*(1 - A);
  var B: f32 = 0.45*(o2 / (o2 + 0.09));
  B = invpi*B;

  return p*NdotL*(A + B*(s/t));
}

// Fresnel portion of BRDF (IOR only, simplified)
fn schlickFresnelIOR(V: vec3<f32>, N: vec3<f32>, ior: f32, k: f32) -> f32 {
  var NdotV: f32 = mdot(V, N);
  var F0: f32 = (pow((ior - 1.0), 2.0) + k*k) / (pow((ior + 1.0), 2.0) + k*k); // This takes into account the roughness, which the other one does not
  return F0 + (1.0 - F0) * pow((1.0-NdotV), 5.0);
}

// Fresnel portion of BRDF (Color ior, better)
fn schlickFresnelRGB(V: vec3<f32>, N: vec3<f32>, F0: vec3<f32>) -> vec3<f32> {
  var NdotV: f32 = mdot(V, N);
  return F0 + (1.0 - F0) * pow((1-NdotV), 5.0);
}

// Normal portion of BRDF
// https://learnopengl.com/PBR/Theory
// Trowbridge-Reitz GGX functions: normal, halfway, roughness^2
fn trGGX(N: vec3<f32>, H: vec3<f32>, a: f32) -> f32 {
  var a2: f32 = a*a;
  var NdotH = mdot(N, H);
  var NdotH2 = NdotH*NdotH;

  var denom: f32 = NdotH2 * (a2 - 1.0) + 1.0;

  return a2 / max((pi*denom*denom), 0.000001);
}

// A VERY bad approximation of anisotropy. Real anisotropic calculations require tangent and bitangent
fn anisotrophicTrGGX(N: vec3<f32>, H: vec3<f32>, O: vec3<f32>, s: f32, a: f32) -> f32 {
  var Op: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(O) * s, 0.)).xyz;

  var ggx1: f32 = trGGX(N + Op*s, H, a);
  var ggx2: f32 = trGGX(N - Op*s, H, a);
  return (0.5 * ggx1 + 0.5 * ggx2);
}

// Geometry portion of BRDF
fn schlickGGX(N: vec3<f32>, X: vec3<f32>, k: f32) -> f32 {
  var NdotX = cdot(N, X);
  return NdotX / max(0.000001, (NdotX*(1.0-k) + k));
}

fn smithSurfaceRoughness(N: vec3<f32>, V: vec3<f32>, L: vec3<f32>, k: f32) -> f32 {
  var ggx1: f32 = min(1.0, schlickGGX(N, V, k));
  var ggx2: f32 = min(1.0, schlickGGX(N, L, k));
  return ggx1*ggx2;
}

// BRDF Combination
fn cookTorrance(D: f32, F: f32, G: f32, N: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> f32 {
  var num: f32 = D*F*G;
  var denom: f32 = 4*cdot(V, N)*cdot(L, N);

  return num / max(denom, 0.000001);
}

// Different lighting calculations for different light sources
fn calcDirectionalLight(N: vec3<f32>, V: vec3<f32>, mat: Material, light: DirectionalLight) -> PBRData {
  var L: vec3<f32> = normalize(light.direction); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector

  var alpha = mat.roughness * mat.roughness;
  var k: f32 = alpha * alpha / 2.0;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L); // Fresnel term is replaced with 1 because it is added later
  var incoming: vec3<f32> = light.color;
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5);

  var specular: vec3<f32> = brdf * incoming * angle;
  // Oren-Nayar gives a clay-like effect when fully rough which some people may not want, so it might be better to give a separate
  // control property for the diffuse vs specular roughness
  var diffuse: vec3<f32> = incoming * fujiiOrenNayar(mat.base, mat.roughness, N, L, V);
  // Stores the specular and diffuse separately to allow for finer post processing
  var out = PBRData(diffuse, specular);

  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

fn calcPointLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, mat: Material, light: PointLight) -> PBRData {
  var L: vec3<f32> = normalize(light.position - fragPos);
  var H: vec3<f32> = normalize(L + V);
  var dist = distance(light.position, fragPos);

  var alpha = mat.roughness * mat.roughness;
  var k: f32 = alpha * alpha / 2.0;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  var F: f32 = schlickFresnelIOR(V, N, mat.ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);
  var incoming: vec3<f32> = light.color * (1.0 / (dist * dist));
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" between light sources

  var specular: vec3<f32> = brdf * incoming * angle;
  var diffuse: vec3<f32> = incoming * fujiiOrenNayar(mat.base, mat.roughness, N, L, V);
  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);

  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// For a reason unknown to me, spheres dont seem to behave propperly with head-on spot lights
fn calcSpotLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, mat: Material, light: SpotLight) -> PBRData {
  var L: vec3<f32> = normalize(light.position - fragPos);
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(light.position, fragPos);

  var alpha = mat.roughness * mat.roughness;
  var k: f32 = alpha * alpha / 2.0; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);

  var theta: f32 = mdot(normalize(light.direction), L);
  var epsilon: f32 = light.cones.x - light.cones.y;
  var intensity: f32 = (theta - light.cones.y) / epsilon;
  intensity = clamp(intensity, 0.0, 1.0);
  intensity /= dist * dist;

  var incoming: vec3<f32> = light.color * intensity;

  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" between light sources

  var specular: vec3<f32> = brdf * incoming * angle;
  var diffuse: vec3<f32> = incoming * fujiiOrenNayar(mat.base, mat.roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);

  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// Environment mapping stuff
// Takes in a vector and converts it to an equivalent coordinate in a rectilinear texture. Should be replaced with cubemaps at some point
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::TCoord::Dec

// optional surface normal declaration
//VTK::Normal::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  // Temporary ambient, diffuse, and opacity
  var ambientColor: vec4<f32> = mapperUBO.AmbientColor;
  var diffuseColor: vec4<f32> = mapperUBO.DiffuseColor;
  var opacity: f32 = mapperUBO.Opacity;
  var ior: f32 = mapperUBO.BaseIOR;

  // This should be declared somewhere else
  var _diffuseMap: vec4<f32> = vec4<f32>(1.0);
  var _roughnessMap: vec4<f32> = vec4<f32>(1.0);
  var _metallicMap: vec4<f32> = vec4<f32>(1.0);
  var _normalMap: vec4<f32> = vec4<f32>(0.0, 0.0, 1.0, 0.0); // normal map was setting off the normal vector detection in fragment
  var _ambientOcclusionMap: vec4<f32> = vec4<f32>(1.);
  var _emissionMap: vec4<f32> = vec4<f32>(0.);

  //VTK::Color::Impl

  //VTK::TCoord::Impl

  //VTK::Normal::Impl

  var computedColor: vec4<f32> = vec4<f32>(diffuseColor.rgb, 1.0);

  //VTK::Light::Impl

  //VTK::Select::Impl

  // Use texture alpha for transparency
  computedColor.a = mapperUBO.Opacity * _diffuseMap.a;
  if (computedColor.a == 0.0) { discard; };

  //VTK::Position::Impl

  //VTK::RenderEncoder::Impl

  return output;
}
`;function Ag(t){return t.indexOf("edge")>=0}function em(t,e){e.classHierarchy.push("vtkWebGPUCellArrayMapper"),t.buildPass=n=>{n&&(e.is2D?(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.forceZValue=!0):(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.forceZValue=!1),e.coordinateSystem=e.WebGPUActor.getRenderable().getCoordinateSystem(),e.useRendererMatrix=e.coordinateSystem!==QL.DISPLAY,e.WebGPURenderer=e.WebGPUActor.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice())},t.translucentPass=n=>{n&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.opaquePass=n=>{n&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.updateUBO=()=>{const r=e.WebGPUActor.getRenderable().getProperty(),a=e.UBO.getSendTime();if(t.getMTime()<=a&&r.getMTime()<=a&&e.renderable.getMTime()<=a)return;const s=e.WebGPUActor.getKeyMatrices(e.WebGPURenderer);if(e.UBO.setArray("BCWCMatrix",s.bcwc),e.UBO.setArray("BCSCMatrix",s.bcsc),e.UBO.setArray("MCWCNormals",s.normalMatrix),e.is2D){const o=r.getDisplayLocation?.()??Hg.BACKGROUND;e.UBO.setValue("ZValue",o===Hg.FOREGROUND?1:0);const c=r.getColorByReference();e.UBO.setValue("AmbientIntensity",1),e.UBO.setArray("DiffuseColor",[...c,1]),e.UBO.setValue("DiffuseIntensity",0),e.UBO.setValue("SpecularIntensity",0)}else e.UBO.setValue("AmbientIntensity",r.getAmbient()),e.UBO.setArray("AmbientColor",[...r.getAmbientColorByReference(),1]),e.UBO.setValue("DiffuseIntensity",r.getDiffuse()),e.UBO.setArray("DiffuseColor",[...r.getDiffuseColorByReference(),1]),e.UBO.setValue("Roughness",r.getRoughness()),e.UBO.setValue("BaseIOR",r.getBaseIOR()),e.UBO.setValue("Metallic",r.getMetallic()),e.UBO.setValue("NormalStrength",r.getNormalStrength()),e.UBO.setValue("Emission",r.getEmission()),e.UBO.setValue("SpecularIntensity",r.getSpecular()),r.getSpecularColorByReference()&&e.UBO.setArray("SpecularColor",[...r.getSpecularColorByReference(),1]);const i=r.getEdgeColorByReference?.();i&&e.UBO.setArray("EdgeColor",[...i,1]),e.UBO.setValue("LineWidth",r.getLineWidth()),e.UBO.setValue("Opacity",r.getOpacity()),e.UBO.setValue("PropID",e.WebGPUActor.getPropID()),e.UBO.sendIfNeeded(e.WebGPURenderWindow.getDevice())},t.haveWideLines=()=>{const n=e.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();return n.getProperty().getLineWidth()<=1||e.primitiveType===rt.Verts?!1:e.primitiveType===rt.Triangles||e.primitiveType===rt.TriangleStrips?r===ys.WIREFRAME:!0},t.replaceShaderPosition=(n,r,a)=>{const s=r.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),s.hasOutput("vertexVC")||s.addOutput("vec4<f32>","vertexVC");let i=s.getCode();e.useRendererMatrix?(i=ae.substitute(i,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = rendererUBO.SCPCMatrix*mapperUBO.BCSCMatrix*vertexBC;","    output.vertexVC = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);","//VTK::Position::Impl"]).result,e.forceZValue&&(i=ae.substitute(i,"//VTK::Position::Impl",["pCoord = vec4<f32>(pCoord.xyz/pCoord.w, 1.0);","pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)):(i=ae.substitute(i,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = mapperUBO.BCSCMatrix*vertexBC;","    pCoord.x = 2.0* pCoord.x / rendererUBO.viewportSize.x - 1.0;","    pCoord.y = 2.0* pCoord.y / rendererUBO.viewportSize.y - 1.0;","    pCoord.z = 0.5 - 0.5 * pCoord.z;","//VTK::Position::Impl"]).result,e.forceZValue&&(i=ae.substitute(i,"//VTK::Position::Impl",["    pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)),t.haveWideLines()&&(s.addBuiltinInput("u32","@builtin(instance_index) instanceIndex"),i=ae.substitute(i,"//VTK::Position::Impl",["    var tmpPos: vec4<f32> = pCoord;","    var numSteps: f32 = ceil(mapperUBO.LineWidth - 1.0);","    var offset: f32 = (mapperUBO.LineWidth - 1.0) * (f32(input.instanceIndex / 2u) - numSteps/2.0) / numSteps;","    var tmpPos2: vec3<f32> = tmpPos.xyz / tmpPos.w;","    tmpPos2.x = tmpPos2.x + 2.0 * (f32(input.instanceIndex) % 2.0) * offset / rendererUBO.viewportSize.x;","    tmpPos2.y = tmpPos2.y + 2.0 * (f32(input.instanceIndex + 1u) % 2.0) * offset / rendererUBO.viewportSize.y;","    tmpPos2.z = min(1.0, tmpPos2.z + 0.00001);","    pCoord = vec4<f32>(tmpPos2.xyz * tmpPos.w, tmpPos.w);","//VTK::Position::Impl"]).result),i=ae.substitute(i,"//VTK::Position::Impl",["    output.Position = pCoord;"]).result,s.setCode(i)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderNormal=(n,r,a)=>{const s=a.getBuffer("normalMC"),i=e.WebGPUActor.getRenderable();if(s){const o=r.getShaderDescription("vertex");o.hasOutput("normalVC")||o.addOutput("vec3<f32>","normalVC",s.getArrayInformation()[0].interpolation),o.hasOutput("tangentVC")||o.addOutput("vec3<f32>","tangentVC",s.getArrayInformation()[0].interpolation),o.hasOutput("bitangentVC")||o.addOutput("vec3<f32>","bitangentVC",s.getArrayInformation()[0].interpolation);let c=o.getCode();c=ae.substitute(c,"//VTK::Normal::Impl",["  output.normalVC = normalize((rendererUBO.WCVCNormals * mapperUBO.MCWCNormals * normalMC).xyz);","  var c1: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 0, 1));","  var c2: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 1, 0));","  var tangent: vec3<f32> = mix(c1, c2, distance(c1, c2));","  output.tangentVC = normalize(tangent);","  output.bitangentVC = normalize(cross(output.normalVC, tangent));"]).result,o.setCode(c);const u=r.getShaderDescription("fragment");c=u.getCode(),i.getProperty().getNormalTexture()?c=ae.substitute(c,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  var tangent: vec3<f32> = input.tangentVC;","  var bitangent: vec3<f32> = input.bitangentVC;","  var TCVCMatrix: mat3x3<f32> = mat3x3<f32>(","    tangent.x, bitangent.x, normal.x,","    tangent.y, bitangent.y, normal.y,","    tangent.z, bitangent.z, normal.z,","  );","  var mappedNormal: vec3<f32> = TCVCMatrix * (_normalMap.xyz * 2 - 1);","  normal = mix(normal, mappedNormal, mapperUBO.NormalStrength);","  normal = normalize(normal);"]).result:c=ae.substitute(c,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  normal = normalize(normal);"]).result,u.setCode(c)}},e.shaderReplacements.set("replaceShaderNormal",t.replaceShaderNormal),t.replaceShaderLight=(n,r,a)=>{if(n.includes("sel"))return;const s=r.getShaderDescription("vertex");s.hasOutput("vertexVC")||s.addOutput("vec4<f32>","vertexVC");const i=e.WebGPURenderer.getRenderable(),o=r.getShaderDescription("fragment");let c=o.getCode();if(c.includes("var normal:")&&e.useRendererMatrix&&!Ag(n)&&!e.is2D&&!n.includes("sel")){const u=["  let fragPos = vec3<f32>(input.vertexVC.xyz);","  let V = mix(normalize(-fragPos), vec3<f32>(0, 0, 1), f32(rendererUBO.cameraParallel)); // View Vector","  let baseColor = _diffuseMap.rgb * diffuseColor.rgb;","  let roughness = max(0.000001, mapperUBO.Roughness * _roughnessMap.r);","  let metallic = mapperUBO.Metallic * _metallicMap.r;","  let alpha = roughness * roughness;","  let k = alpha * alpha / 2.0;","  var diffuse = vec3<f32>(0.);","  var specular = vec3<f32>(0.);","  let emission = _emissionMap.rgb * mapperUBO.Emission;","","  // Material struct","  let mat = Material(ior, roughness, metallic, baseColor);","","  {","    var i = 0;","    loop {","      if (!(i < rendererUBO.LightCount)) { break; }","      switch (i32(rendererLightSSBO.values[i].LightData.x)) {","         // Point Light","         case 0 {","           let color = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           let pos = (rendererLightSSBO.values[i].LightPos).xyz;","           let pointLight = PointLight(pos, color);","           let result = calcPointLight(normal, V, fragPos, mat, pointLight);","           diffuse += max(vec3<f32>(0), result.diffuse);","           specular += max(vec3<f32>(0), result.specular);","          }","         // Directional light","         case 1 {","           let dir = normalize((rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz);","           let color = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           let dirLight = DirectionalLight(dir, color);","           let result = calcDirectionalLight(normal, V, mat, dirLight); // diffuseColor.rgb needs to be fixed with a more dynamic diffuse color","           diffuse += max(vec3<f32>(0), result.diffuse);","           specular += max(vec3<f32>(0), result.specular);","         }","         // Spot Light","         case 2 {","           let color = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           let pos = (rendererLightSSBO.values[i].LightPos).xyz;","           let dir = normalize((rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz);","           let cones = vec2<f32>(rendererLightSSBO.values[i].LightData.y, rendererLightSSBO.values[i].LightData.z);","           let spotLight = SpotLight(pos, dir, cones, color);","           let result = calcSpotLight(normal, V, fragPos, mat, spotLight);","           diffuse += max(vec3<f32>(0), result.diffuse);","           specular += max(vec3<f32>(0), result.specular);","         }","         default { continue; }","       }","      continuing { i++; }","    }","  }","  let fresnel = min(1.0, schlickFresnelIOR(V, normal, ior, k)); // Fresnel","  // This could be controlled with its own variable (that isnt base color) for better artistic control","  let fresnelMetallic = schlickFresnelRGB(V, normal, baseColor); // Fresnel for metal, takes color into account","  let kS = min(vec3<f32>(1.0), mix(vec3<f32>(fresnel), fresnelMetallic, metallic));","  let kD = (1.0 - kS) * (1.0 - metallic);","  let PBR = mapperUBO.DiffuseIntensity * kD * diffuse + kS * specular;","  computedColor = vec4<f32>(PBR + emission, mapperUBO.Opacity);"];i.getEnvironmentTexture()?.getImageLoaded()&&u.push("  // To get diffuse IBL, the texture is sampled with normals in worldspace","  let diffuseIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(normal, 1.)).xyz;","  let diffuseCoords = vecToRectCoord(diffuseIBLCoords);","  // To get specular IBL, the texture is sampled as the worldspace reflection between the normal and view vectors","  // Reflections are first calculated in viewspace, then converted to worldspace to sample the environment","  let VreflN = normalize(reflect(-V, normal));","  let reflectionIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(VreflN, 1.)).xyz;","  let specularCoords = vecToRectCoord(reflectionIBLCoords);","  let diffuseIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, diffuseCoords, rendererUBO.MaxEnvironmentMipLevel);","  let level = roughness * rendererUBO.MaxEnvironmentMipLevel;","  let specularIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, specularCoords, level);","  let specularIBLContribution = specularIBL.rgb * rendererUBO.BackgroundSpecularStrength;","  computedColor += vec4<f32>(specularIBLContribution * kS, 0);","  let diffuseIBLContribution = diffuseIBL.rgb * rendererUBO.BackgroundDiffuseStrength;","  computedColor += vec4<f32>(diffuseIBLContribution * baseColor * _ambientOcclusionMap.rgb * kD, 0);"),c=ae.substitute(c,"//VTK::Light::Impl",u).result,o.setCode(c)}else c=ae.substitute(c,"//VTK::Light::Impl",["  let diffuse = diffuseColor.rgb;","  let specular = mapperUBO.SpecularColor.rgb * mapperUBO.SpecularColor.a;","  computedColor = vec4<f32>(diffuse * _diffuseMap.rgb, mapperUBO.Opacity);"]).result,o.setCode(c)},e.shaderReplacements.set("replaceShaderLight",t.replaceShaderLight),t.replaceShaderColor=(n,r,a)=>{if(Ag(n)){const u=r.getShaderDescription("fragment");let g=u.getCode();g=ae.substitute(g,"//VTK::Color::Impl",["ambientColor = mapperUBO.EdgeColor;","diffuseColor = mapperUBO.EdgeColor;"]).result,u.setCode(g);return}const s=a.getBuffer("colorVI");if(!s)return;const i=r.getShaderDescription("vertex");i.addOutput("vec4<f32>","color",s.getArrayInformation()[0].interpolation);let o=i.getCode();o=ae.substitute(o,"//VTK::Color::Impl",["  output.color = colorVI;"]).result,i.setCode(o);const c=r.getShaderDescription("fragment");o=c.getCode(),o=ae.substitute(o,"//VTK::Color::Impl",["ambientColor = input.color;","diffuseColor = input.color;","opacity = mapperUBO.Opacity * input.color.a;"]).result,c.setCode(o)},e.shaderReplacements.set("replaceShaderColor",t.replaceShaderColor),t.replaceShaderTCoord=(n,r,a)=>{if(!a.hasAttribute("tcoord"))return;const s=r.getShaderDescription("vertex"),i=a.getBuffer("tcoord"),o=Xe.getNumberOfComponentsFromBufferFormat(i.getArrayInformation()[0].format);let c=s.getCode();s.addOutput(`vec${o}<f32>`,"tcoordVS"),c=ae.substitute(c,"//VTK::TCoord::Impl",["  output.tcoordVS = tcoord;"]).result,s.setCode(c);const u=r.getShaderDescription("fragment");c=u.getCode();const g=e.WebGPUActor.getRenderable(),f=g.getProperty(),l=w=>w?w.getDimensionality()===o:!1,p=[],v=f.getDiffuseTexture?.();(v?.getImageLoaded()||g.getTextures()[0]||e.colorTexture)&&(l(v)||l(g.getTextures()[0])||l(e.colorTexture))&&p.push("_diffuseMap = textureSample(DiffuseTexture, DiffuseTextureSampler, input.tcoordVS);");const h=f.getORMTexture?.(),d=f.getRMTexture?.(),T=f.getRoughnessTexture?.(),S=f.getMetallicTexture?.(),x=f.getAmbientOcclusionTexture?.(),y=f.getEmissionTexture?.(),C=f.getNormalTexture?.();h?.getImageLoaded()?l(h)&&p.push("_ambientOcclusionMap = textureSample(ORMTexture, ORMTextureSampler, input.tcoordVS).rrra;","_roughnessMap = textureSample(ORMTexture, ORMTextureSampler, input.tcoordVS).ggga;","_metallicMap = textureSample(ORMTexture, ORMTextureSampler, input.tcoordVS).bbba;"):d?.getImageLoaded()?l(d)&&p.push("_roughnessMap = textureSample(RMTexture, RMTextureSampler, input.tcoordVS).ggga;","_metallicMap = textureSample(RMTexture, RMTextureSampler, input.tcoordVS).bbba;"):(T?.getImageLoaded()&&l(T)&&p.push("_roughnessMap = textureSample(RoughnessTexture, RoughnessTextureSampler, input.tcoordVS).ggga;"),S?.getImageLoaded()&&l(S)&&p.push("_metallicMap = textureSample(MetallicTexture, MetallicTextureSampler, input.tcoordVS).bbba;"),x?.getImageLoaded()&&l(x)&&p.push("_ambientOcclusionMap = textureSample(AmbientOcclusionTexture, AmbientOcclusionTextureSampler, input.tcoordVS).rrra;")),y?.getImageLoaded()&&l(y)&&p.push("_emissionMap = textureSample(EmissionTexture, EmissionTextureSampler, input.tcoordVS);"),C?.getImageLoaded()&&l(C)&&p.push("_normalMap = textureSample(NormalTexture, NormalTextureSampler, input.tcoordVS);"),c=ae.substitute(c,"//VTK::TCoord::Impl",p).result,u.setCode(c)},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderSelect=(n,r,a)=>{if(n.includes("sel")){const s=r.getShaderDescription("fragment");let i=s.getCode();i=ae.substitute(i,"//VTK::Select::Impl",["  var compositeID: u32 = 0u;"]).result,s.setCode(i)}},e.shaderReplacements.set("replaceShaderSelect",t.replaceShaderSelect),t.getUsage=(n,r)=>n===ys.POINTS||r===rt.Points?Ke.Verts:r===rt.Lines?Ke.Lines:n===ys.WIREFRAME?r===rt.Triangles?Ke.LinesFromTriangles:Ke.LinesFromStrips:r===rt.Triangles?Ke.Triangles:r===rt.TriangleStrips?Ke.Strips:r===rt.TriangleEdges?Ke.LinesFromTriangles:Ke.LinesFromStrips,t.getHashFromUsage=n=>`pt${n}`,t.getTopologyFromUsage=n=>{switch(n){case Ke.Triangles:return"triangle-list";case Ke.Verts:return"point-list";case Ke.Lines:default:return"line-list"}},t.buildVertexInput=()=>{const n=e.currentInput,r=e.cellArray,a=e.primitiveType;let i=e.WebGPUActor.getRenderable().getProperty().getRepresentation();const o=e.WebGPURenderWindow.getDevice();let c=!1;a===rt.TriangleEdges&&(c=!0,i=ys.WIREFRAME);const u=e.vertexInput,g=n.getPoints();let f=null;if(r?(f=o.getBufferManager().getBuffer({hash:`R${i}P${a}${r.getMTime()}`,usage:Ke.Index,cells:r,numberOfPoints:g.getNumberOfPoints(),primitiveType:a,representation:i}),u.setIndexBuffer(f)):u.setIndexBuffer(null),g){const h=e.WebGPUActor.getBufferShift(e.WebGPURenderer);u.addBuffer(o.getBufferManager().getBuffer({hash:`${g.getMTime()}I${f?.getMTime?.()??0}${h.join()}float32x4`,usage:Ke.PointArray,format:"float32x4",dataArray:g,indexBuffer:f,shift:h,packExtra:!0}),["vertexBC"])}else u.removeBufferIfPresent("vertexBC");const l=t.getUsage(i,a);if(e._usesCellNormals=!1,!e.is2D&&(l===Ke.Triangles||l===Ke.Strips)){const h=n.getPointData().getNormals(),d={format:"snorm8x4",indexBuffer:f,packExtra:!0,shift:0,scale:127};h?(d.hash=`${h.getMTime()}I${f.getMTime()}snorm8x4`,d.dataArray=h,d.usage=Ke.PointArray,u.addBuffer(o.getBufferManager().getBuffer(d),["normalMC"])):a===rt.Triangles?(e._usesCellNormals=!0,d.hash=`PFN${g.getMTime()}I${f.getMTime()}snorm8x4`,d.dataArray=g,d.cells=r,d.usage=Ke.NormalsFromPoints,u.addBuffer(o.getBufferManager().getBuffer(d),["normalMC"])):u.removeBufferIfPresent("normalMC")}else u.removeBufferIfPresent("normalMC");let p=!1;if(e.renderable.getScalarVisibility()){const h=e.renderable.getColorMapColors();if(h&&!c){const d=e.renderable.getScalarMode(),T=(d===Ts.USE_CELL_DATA||d===Ts.USE_CELL_FIELD_DATA||d===Ts.USE_FIELD_DATA||!n.getPointData().getScalars())&&d!==Ts.USE_POINT_FIELD_DATA&&h;u.addBuffer(o.getBufferManager().getBuffer({usage:Ke.PointArray,format:"unorm8x4",hash:`${T}${h.getMTime()}I${f.getMTime()}unorm8x4`,dataArray:h,indexBuffer:f,cellData:T,cellOffset:0}),["colorVI"]),p=!0}}p||u.removeBufferIfPresent("colorVI");let v=null;e.renderable.getInterpolateScalarsBeforeMapping?.()&&e.renderable.getColorCoordinates()?v=e.renderable.getColorCoordinates():v=n.getPointData().getTCoords(),v&&!c?u.addBuffer(o.getBufferManager().getBufferForPointArray(v,u.getIndexBuffer()),["tcoord"]):u.removeBufferIfPresent("tcoord")},t.updateTextures=()=>{const n=[],r=[],a=e.renderable.getColorTextureMap?.();a&&!e.colorTexture&&(e.colorTexture=za.newInstance({label:"polyDataColor"})),a&&(e.colorTexture.setInputData(a),r.push(["DiffuseTexture",e.colorTexture]));const s=e.WebGPUActor.getRenderable(),i=e.WebGPURenderer.getRenderable();[["DiffuseTexture",s.getProperty().getDiffuseTexture?.()],["DiffuseTexture",s.getTextures()[0]],["DiffuseTexture",e.colorTexture],["ORMTexture",s.getProperty().getORMTexture?.()],["RMTexture",s.getProperty().getRMTexture?.()],["RoughnessTexture",s.getProperty().getRoughnessTexture?.()],["MetallicTexture",s.getProperty().getMetallicTexture?.()],["NormalTexture",s.getProperty().getNormalTexture?.()],["AmbientOcclusionTexture",s.getProperty().getAmbientOcclusionTexture?.()],["EmissionTexture",s.getProperty().getEmissionTexture?.()],["EnvironmentTexture",i.getEnvironmentTexture?.()]].forEach(c=>{let[u,g]=c;g&&((g.getInputData()||g.getJsImageData()||g.getCanvas()||g.getImageBitmap())&&r.push([u,g]),g.getImage()&&g.getImageLoaded()&&r.push([u,g]))}),r.forEach(c=>{let[u,g]=c;const f=e.device.getTextureManager().getTextureForVTKTexture(g,u);if(!f.getReady())return;let l=!1;for(let p=0;p<e.textures.length;++p)if(e.textures[p]===f){l=!0,n[p]=!0;break}if(!l){n[e.textures.length]=!0;const p=f.createView(u);e.textures.push(f),e.textureViews.push(p);const v=g.getInterpolate()?"linear":"nearest";let h=null;g.getEdgeClamp()&&g.getRepeat()?h="mirror-repeat":g.getEdgeClamp()?h="clamp-to-edge":g.getRepeat()&&(h="repeat");let d={addressModeU:h,addressModeV:h,addressModeW:h,minFilter:v,magFilter:v};u==="EnvironmentTexture"&&(d={addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:v,magFilter:v,mipmapFilter:"linear"}),p.addSampler(e.device,d)}});for(let c=e.textures.length-1;c>=0;c--)n[c]||(e.textures.splice(c,1),e.textureViews.splice(c,1))},t.computePipelineHash=()=>{let n=`pd${e.useRendererMatrix?"r":""}${e.forceZValue?"z":""}`;if(e.primitiveType===rt.TriangleEdges||e.primitiveType===rt.TriangleStripEdges)n+="edge";else{if(e.vertexInput.hasAttribute("normalMC")&&(n+="n"),e.vertexInput.hasAttribute("colorVI")&&(n+="c"),e.vertexInput.hasAttribute("tcoord")){const a=e.vertexInput.getBuffer("tcoord"),s=Xe.getNumberOfComponentsFromBufferFormat(a.getArrayInformation()[0].format);n+=`t${s}`}e.textures.length&&(n+=`tx${e.textures.length}`)}e._usesCellNormals&&(n+="cn"),e.SSBO&&(n+="ssbo");const r=t.getHashFromUsage(e.usage);n+=r,n+=e.renderEncoder.getPipelineHash(),e.pipelineHash=n},t.updateBuffers=()=>{e.primitiveType!==rt.TriangleEdges&&e.primitiveType!==rt.TriangleStripEdges&&t.updateTextures();const n=e.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();e.usage=t.getUsage(r,e.primitiveType),t.buildVertexInput();const a=e.vertexInput.getBuffer("vertexBC");if(t.setNumberOfVertices(a.getSizeInBytes()/a.getStrideInBytes()),t.setTopology(t.getTopologyFromUsage(e.usage)),t.updateUBO(),t.haveWideLines()){const s=n.getProperty();t.setNumberOfInstances(Math.ceil(s.getLineWidth()*2))}else t.setNumberOfInstances(1)}}const tm={is2D:!1,cellArray:null,currentInput:null,cellOffset:0,primitiveType:0,colorTexture:null,renderEncoder:null,textures:null};function z1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tm,n),xf.extend(t,e,n),e.fragmentShaderTemplate=JL,e.vertexShaderTemplate=ZL,e._tmpMat3=Kn(new Float64Array(9)),e._tmpMat4=ue(new Float64Array(16)),e.UBO=lr.newInstance({label:"mapperUBO"}),e.UBO.addEntry("BCWCMatrix","mat4x4<f32>"),e.UBO.addEntry("BCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("MCWCNormals","mat4x4<f32>"),e.UBO.addEntry("AmbientColor","vec4<f32>"),e.UBO.addEntry("DiffuseColor","vec4<f32>"),e.UBO.addEntry("EdgeColor","vec4<f32>"),e.UBO.addEntry("SpecularColor","vec4<f32>"),e.UBO.addEntry("AmbientIntensity","f32"),e.UBO.addEntry("DiffuseIntensity","f32"),e.UBO.addEntry("Roughness","f32"),e.UBO.addEntry("Metallic","f32"),e.UBO.addEntry("Ambient","f32"),e.UBO.addEntry("Normal","f32"),e.UBO.addEntry("Emission","f32"),e.UBO.addEntry("NormalStrength","f32"),e.UBO.addEntry("BaseIOR","f32"),e.UBO.addEntry("SpecularIntensity","f32"),e.UBO.addEntry("LineWidth","f32"),e.UBO.addEntry("Opacity","f32"),e.UBO.addEntry("ZValue","f32"),e.UBO.addEntry("PropID","u32"),e.UBO.addEntry("ClipNear","f32"),e.UBO.addEntry("ClipFar","f32"),e.UBO.addEntry("Time","u32"),He(t,e,["cellArray","currentInput","cellOffset","is2D","primitiveType","renderEncoder"]),e.textures=[],em(t,e)}const nm=we(z1,"vtkWebGPUCellArrayMapper");var H1={newInstance:nm,extend:z1};const{PrimitiveTypes:Dt}=Cr;function rm(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper"),t.createCellArrayMapper=()=>H1.newInstance(),t.buildPass=n=>{if(n){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.renderable.getStatic()||e.renderable.update();const r=e.renderable.getInputData();e.renderable.mapScalars(r,1),t.updateCellArrayMappers(r)}},t.updateCellArrayMappers=n=>{if(!n){ie("No input!");return}const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],a=[];let s=0;for(let i=Dt.Points;i<=Dt.TriangleStrips;i++)if(r[i].getNumberOfValues()>0){e.primitives[i]||(e.primitives[i]=t.createCellArrayMapper());const o=e.primitives[i];o.setCellArray(r[i]),o.setCurrentInput(n),o.setCellOffset(s),o.setPrimitiveType(i),o.setRenderable(e.renderable),s+=r[i].getNumberOfCells(),a.push(o)}else e.primitives[i]=null;if(e.WebGPUActor.getRenderable().getProperty().getEdgeVisibility()){if(r[Dt.Triangles].getNumberOfValues()>0){const i=Dt.TriangleEdges;e.primitives[i]||(e.primitives[i]=t.createCellArrayMapper());const o=e.primitives[i];o.setCellArray(r[Dt.Triangles]),o.setCurrentInput(n),o.setCellOffset(e.primitives[Dt.Triangles].getCellOffset()),o.setPrimitiveType(i),o.setRenderable(e.renderable),a.push(o)}else e.primitives[Dt.TriangleEdges]=null;if(r[Dt.TriangleStrips].getNumberOfValues()>0){const i=Dt.TriangleStripEdges;e.primitives[i]||(e.primitives[i]=t.createCellArrayMapper());const o=e.primitives[i];o.setCellArray(r[Dt.TriangleStrips]),o.setCurrentInput(n),o.setCellOffset(e.primitives[Dt.TriangleStrips].getCellOffset()),o.setPrimitiveType(i),o.setRenderable(e.renderable),a.push(o)}else e.primitives[Dt.TriangleStripEdges]=null}t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}const am={primitives:null};function sm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,am,n),Be.extend(t,e,n),e.primitives=[],rm(t,e)}const im=we(sm,"vtkWebGPUPolyDataMapper");rn("vtkMapper",im);const{PrimitiveTypes:jg}=Cr;function om(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper2D"),t.createCellArrayMapper=()=>H1.newInstance(),t.buildPass=n=>{if(n){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.renderable.getStatic()||e.renderable.update();const r=e.renderable.getInputData();e.renderable.mapScalars(r,1),t.updateCellArrayMappers(r)}},t.updateCellArrayMappers=n=>{const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],a=[];let s=0;for(let i=jg.Points;i<=jg.Triangles;i++)if(r[i].getNumberOfValues()>0){e.primitives[i]||(e.primitives[i]=t.createCellArrayMapper());const o=e.primitives[i];o.setCellArray(r[i]),o.setCurrentInput(n),o.setCellOffset(s),o.setPrimitiveType(i),o.setRenderable(e.renderable),o.setIs2D(!0),s+=r[i].getNumberOfCells(),a.push(o)}else e.primitives[i]=null;t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}function cm(t){return{primitives:[],...t}}function fm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cm(n)),Be.extend(t,e,n),e.primitives=[],om(t,e)}const um=we(fm,"vtkWebGPUPolyDataMapper2D");rn("vtkMapper2D",um);function gm(t,e){e.classHierarchy.push("vtkWebGPUScalarBarActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,s=e.WebGPURenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([s.usize,s.vsize],a,e.WebGPURenderWindow.getRenderable())}}}const lm={};function pm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lm,n),Be.extend(t,e,n),e.scalarBarActorHelper=R1.newScalarBarActorHelper(),gm(t,e)}const hm=we(pm,"vtkWebGPUScalarBarActor");rn("vtkScalarBarActor",hm);function dm(t,e){e.classHierarchy.push("vtkWebGPUSampler"),t.create=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.device=n,e.options.addressModeU=r.addressModeU?r.addressModeU:"clamp-to-edge",e.options.addressModeV=r.addressModeV?r.addressModeV:"clamp-to-edge",e.options.addressModeW=r.addressModeW?r.addressModeW:"clamp-to-edge",e.options.magFilter=r.magFilter?r.magFilter:"nearest",e.options.minFilter=r.minFilter?r.minFilter:"nearest",e.options.mipmapFilter=r.mipmapFilter?r.mipmapFilter:"nearest",e.options.label=e.label,e.handle=e.device.getHandle().createSampler(e.options),e.bindGroupTime.modified()},t.getShaderCode=(n,r)=>`@binding(${n}) @group(${r}) var ${e.label}: sampler;`,t.getBindGroupEntry=()=>({resource:e.handle})}const vm={device:null,handle:null,label:null,options:null};function A1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vm,n),E.obj(t,e),e.options={},e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,sampler:{}},e.bindGroupTime={},E.obj(e.bindGroupTime,{mtime:0}),E.get(t,e,["bindGroupTime","handle","options"]),E.setGet(t,e,["bindGroupLayoutEntry","device","label"]),dm(t,e)}const ym=E.newInstance(A1);var Sf={newInstance:ym,extend:A1};function Tm(t,e){e.classHierarchy.push("vtkWebGPUTextureView"),t.create=(n,r)=>{e.texture=n,e.options=r,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=n.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;const a=Xe.getDetailsFromTextureFormat(e.texture.getFormat());e.bindGroupLayoutEntry.texture.sampleType=a.sampleType},t.createFromTextureHandle=(n,r)=>{e.texture=null,e.options=r,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=n,e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;const a=Xe.getDetailsFromTextureFormat(r.format);e.bindGroupLayoutEntry.texture.sampleType=a.sampleType,e.bindGroupTime.modified()},t.getBindGroupEntry=()=>({resource:t.getHandle()}),t.getShaderCode=(n,r)=>{let a="f32";e.bindGroupLayoutEntry.texture.sampleType==="sint"?a="i32":e.bindGroupLayoutEntry.texture.sampleType==="uint"&&(a="u32");let s=`@binding(${n}) @group(${r}) var ${e.label}: texture_${e.options.dimension}<${a}>;`;return e.bindGroupLayoutEntry.texture.sampleType==="depth"&&(s=`@binding(${n}) @group(${r}) var ${e.label}: texture_depth_${e.options.dimension};`),s},t.addSampler=(n,r)=>{const a=Sf.newInstance({label:`${e.label}Sampler`});a.create(n,r),t.setSampler(a)},t.getBindGroupTime=()=>(e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.bindGroupTime),t.getHandle=()=>(e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.handle)}const xm={texture:null,handle:null,sampler:null,label:null};function j1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xm,n),E.obj(t,e),e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d"}},e.bindGroupTime={},E.obj(e.bindGroupTime,{mtime:0}),E.get(t,e,["bindGroupTime","texture"]),E.setGet(t,e,["bindGroupLayoutEntry","label","sampler"]),Tm(t,e)}const Sm=E.newInstance(j1);var K1={newInstance:Sm,extend:j1};function Cm(t,e){e.classHierarchy.push("vtkWebGPUTexture"),t.create=(n,r)=>{e.device=n,e.width=r.width,e.height=r.height,e.depth=r.depth?r.depth:1;const a=e.depth===1?"2d":"3d";e.format=r.format?r.format:"rgba8unorm",e.mipLevel=r.mipLevel?r.mipLevel:0,e.usage=r.usage?r.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label,dimension:a,mipLevelCount:e.mipLevel+1})},t.assignFromHandle=(n,r,a)=>{e.device=n,e.handle=r,e.width=a.width,e.height=a.height,e.depth=a.depth?a.depth:1,e.format=a.format?a.format:"rgba8unorm",e.usage=a.usage?a.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},t.writeImageData=n=>{let r=[];const a=f=>{e.device.getHandle().queue.copyExternalImageToTexture({source:f,flipY:n.flip},{texture:e.handle,premultipliedAlpha:!0,mipLevel:0,origin:{x:0,y:0,z:0}},[f.width,f.height,e.depth]),t.getDimensionality()!==3&&e.mipLevel>0&&za.generateMipmaps(e.device.getHandle(),e.handle,e.mipLevel+1),e.ready=!0};if(n.canvas){a(n.canvas);return}if(n.imageBitmap){n.width=n.imageBitmap.width,n.height=n.imageBitmap.height,n.depth=1,n.format="rgba8unorm",n.flip=!0,a(n.imageBitmap);return}if(n.jsImageData){n.width=n.jsImageData.width,n.height=n.jsImageData.height,n.depth=1,n.format="rgba8unorm",n.flip=!0,a(n.jsImageData);return}if(n.image){n.width=n.image.width,n.height=n.image.height,n.depth=1,n.format="rgba8unorm",n.flip=!0,a(n.image);return}const s=Xe.getDetailsFromTextureFormat(e.format);let i=e.width*s.stride;const o=(f,l,p)=>{const v=s.elementSize===2&&s.sampleType==="float",h=f.BYTES_PER_ELEMENT,d=f.length/(l*p)*h;if(!v&&d%256===0)return[f,d];const T=d/h,S=s.elementSize,x=256*Math.floor((T*S+255)/256),y=x/S,C=E.newTypedArray(v?"Uint16Array":f.constructor.name,y*l*p),w=l*p;if(v)for(let R=0;R<w;R++){const O=R*T,V=R*y;for(let L=0;L<T;L++)C[V+L]=kt.toHalf(f[O+L])}else if(y===T)C.set(f);else for(let R=0;R<w;R++)C.set(f.subarray(R*T,(R+1)*T),R*y);return[C,x]};n.nativeArray&&(r=n.nativeArray);const c=t.getDimensionality()===3,u=o(r,e.height,c?e.depth:1);i=u[1];const g=u[0];e.device.getHandle().queue.writeTexture({texture:e.handle,mipLevel:0,origin:{x:0,y:0,z:0}},g,{offset:0,bytesPerRow:i,rowsPerImage:e.height},{width:e.width,height:e.height,depthOrArrayLayers:c?e.depth:1}),!c&&e.mipLevel>0&&za.generateMipmaps(e.device.getHandle(),e.handle,e.mipLevel+1),e.ready=!0},t.getScale=()=>{const n=Xe.getDetailsFromTextureFormat(e.format);return n.elementSize===2&&n.sampleType==="float"?1:255},t.getNumberOfComponents=()=>Xe.getDetailsFromTextureFormat(e.format).numComponents,t.getDimensionality=()=>{let n=0;return e.width>1&&n++,e.height>1&&n++,e.depth>1&&n++,n},t.resizeToMatch=n=>{(n.getWidth()!==e.width||n.getHeight()!==e.height||n.getDepth()!==e.depth)&&(e.width=n.getWidth(),e.height=n.getHeight(),e.depth=n.getDepth(),e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.resize=function(n,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;(n!==e.width||r!==e.height||a!==e.depth)&&(e.width=n,e.height=r,e.depth=a,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.createView=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};r.dimension||(r.dimension=e.depth===1?"2d":"3d");const a=K1.newInstance({label:n});return a.create(t,r),a}}const wm={device:null,handle:null,buffer:null,ready:!1,label:null};function P1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wm,n),E.obj(t,e),E.get(t,e,["handle","ready","width","height","depth","format","usage"]),E.setGet(t,e,["device","label"]),Cm(t,e)}const Em=E.newInstance(P1);var en={newInstance:Em,extend:P1};function Rm(t,e){e.classHierarchy.push("vtkWebGPUPixelSpaceCallbackMapper"),t.opaquePass=(n,r)=>{e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent();const a=e.WebGPURenderer.getAspectRatio(),s=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,i=e.WebGPURenderer.getTiledSizeAndOrigin(),o=null;e.renderable.getUseZValues(),e.renderable.invokeCallback(e.renderable.getInputData(),s,a,i,o)}}const Om={};function Mm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Om,n),Be.extend(t,e,n),Rm(t,e)}const Dm=E.newInstance(Mm,"vtkWebGPUPixelSpaceCallbackMapper");rn("vtkPixelSpaceCallbackMapper",Dm);const{vtkDebugMacro:xs}=E;function Lm(t,e){e.classHierarchy.push("vtkCamera");const n=new Float64Array(3),r=new Float64Array([0,0,-1]),a=new Float64Array([0,1,0]),s=ue(new Float64Array(16)),i=ue(new Float64Array(16)),o=new Float64Array(3),c=new Float64Array(3),u=new Float64Array(3),g=ue(new Float64Array(16)),f=ue(new Float64Array(16)),l=new Float64Array(3),p=new Float64Array(3);function v(){e.viewPlaneNormal[0]=-e.directionOfProjection[0],e.viewPlaneNormal[1]=-e.directionOfProjection[1],e.viewPlaneNormal[2]=-e.directionOfProjection[2]}t.orthogonalizeViewUp=()=>{const h=t.getViewMatrix();e.viewUp[0]=h[4],e.viewUp[1]=h[5],e.viewUp[2]=h[6],t.modified()},t.setPosition=(h,d,T)=>{h===e.position[0]&&d===e.position[1]&&T===e.position[2]||(e.position[0]=h,e.position[1]=d,e.position[2]=T,t.computeDistance(),t.modified())},t.setFocalPoint=(h,d,T)=>{h===e.focalPoint[0]&&d===e.focalPoint[1]&&T===e.focalPoint[2]||(e.focalPoint[0]=h,e.focalPoint[1]=d,e.focalPoint[2]=T,t.computeDistance(),t.modified())},t.setDistance=h=>{if(e.distance===h)return;e.distance=h,e.distance<1e-20&&(e.distance=1e-20,xs("Distance is set to minimum."));const d=e.directionOfProjection;e.focalPoint[0]=e.position[0]+d[0]*e.distance,e.focalPoint[1]=e.position[1]+d[1]*e.distance,e.focalPoint[2]=e.position[2]+d[2]*e.distance,t.modified()},t.computeDistance=()=>{const h=e.focalPoint[0]-e.position[0],d=e.focalPoint[1]-e.position[1],T=e.focalPoint[2]-e.position[2];if(e.distance=Math.sqrt(h*h+d*d+T*T),e.distance<1e-20){e.distance=1e-20,xs("Distance is set to minimum.");const S=e.directionOfProjection;e.focalPoint[0]=e.position[0]+S[0]*e.distance,e.focalPoint[1]=e.position[1]+S[1]*e.distance,e.focalPoint[2]=e.position[2]+S[2]*e.distance}e.directionOfProjection[0]=h/e.distance,e.directionOfProjection[1]=d/e.distance,e.directionOfProjection[2]=T/e.distance,v()},t.dolly=h=>{if(h<=0)return;const d=e.distance/h;t.setPosition(e.focalPoint[0]-d*e.directionOfProjection[0],e.focalPoint[1]-d*e.directionOfProjection[1],e.focalPoint[2]-d*e.directionOfProjection[2])},t.roll=h=>{const d=e.position,T=e.focalPoint,S=e.viewUp,x=new Float64Array([S[0],S[1],S[2],0]);ue(g);const y=new Float64Array([T[0]-d[0],T[1]-d[1],T[2]-d[2]]);Bt(g,g,Ve(h),y),ta(x,x,g),e.viewUp[0]=x[0],e.viewUp[1]=x[1],e.viewUp[2]=x[2],t.modified()},t.azimuth=h=>{const d=e.focalPoint;ue(f),Ue(f,f,d),Bt(f,f,Ve(h),e.viewUp),Ue(f,f,[-d[0],-d[1],-d[2]]),Te(l,e.position,f),t.setPosition(l[0],l[1],l[2])},t.yaw=h=>{const d=e.position;ue(f),Ue(f,f,d),Bt(f,f,Ve(h),e.viewUp),Ue(f,f,[-d[0],-d[1],-d[2]]),Te(p,e.focalPoint,f),t.setFocalPoint(p[0],p[1],p[2])},t.elevation=h=>{const d=e.focalPoint,T=t.getViewMatrix(),S=[-T[0],-T[1],-T[2]];ue(f),Ue(f,f,d),Bt(f,f,Ve(h),S),Ue(f,f,[-d[0],-d[1],-d[2]]),Te(l,e.position,f),t.setPosition(l[0],l[1],l[2])},t.pitch=h=>{const d=e.position,T=t.getViewMatrix(),S=[T[0],T[1],T[2]];ue(f),Ue(f,f,d),Bt(f,f,Ve(h),S),Ue(f,f,[-d[0],-d[1],-d[2]]),Te(p,e.focalPoint,f),t.setFocalPoint(...p)},t.zoom=h=>{h<=0||(e.parallelProjection?e.parallelScale/=h:e.viewAngle/=h,t.modified())},t.translate=(h,d,T)=>{const S=[h,d,T];Hr(e.position,S,e.position),Hr(e.focalPoint,S,e.focalPoint),t.computeDistance(),t.modified()},t.applyTransform=h=>{const d=[...e.viewUp,1],T=[],S=[],x=[];d[0]+=e.position[0],d[1]+=e.position[1],d[2]+=e.position[2],ta(T,[...e.position,1],h),ta(S,[...e.focalPoint,1],h),ta(x,d,h),x[0]-=T[0],x[1]-=T[1],x[2]-=T[2],t.setPosition(...T.slice(0,3)),t.setFocalPoint(...S.slice(0,3)),t.setViewUp(...x.slice(0,3))},t.getThickness=()=>e.clippingRange[1]-e.clippingRange[0],t.setThickness=h=>{let d=h;d<1e-20&&(d=1e-20,xs("Thickness is set to minimum.")),t.setClippingRange(e.clippingRange[0],e.clippingRange[0]+d)},t.setThicknessFromFocalPoint=h=>{let d=h;d<1e-20&&(d=1e-20,xs("Thickness is set to minimum.")),t.setClippingRange(e.distance-d/2,e.distance+d/2)},t.setRoll=h=>{},t.getRoll=()=>{},t.setObliqueAngles=(h,d)=>{},t.getOrientation=()=>{},t.getOrientationWXYZ=()=>{},t.getFrustumPlanes=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Float64Array(24);const T=[[1,0,0,1],[-1,0,0,1],[0,1,0,1],[0,-1,0,1],[0,0,1,1],[0,0,-1,1]],S=t.getCompositeProjectionMatrix(h,-1,1);for(let x=0;x<6;x++)ta(T[x],T[x],S),TC(T[x]),d[4*x+0]=T[x][0],d[4*x+1]=T[x][1],d[4*x+2]=T[x][2],d[4*x+3]=T[x][3];return d},t.getCameraLightTransformMatrix=h=>(Qe(h,e.cameraLightTransform),h),t.computeCameraLightTransform=()=>{Qe(s,t.getViewMatrix()),ut(s,s),g0(i,[e.distance,e.distance,e.distance]),Ne(s,s,i),ue(e.cameraLightTransform),Ue(e.cameraLightTransform,s,[0,0,-1])},t.deepCopy=h=>{},t.physicalOrientationToWorldDirection=h=>{const d=gu(h[0],h[1],h[2],h[3]),T=hr(),S=gu(0,0,1,0);return mx(T,d),uu(S,d,S),uu(S,S,T),[S[0],S[1],S[2]]},t.getPhysicalToWorldMatrix=h=>{t.getWorldToPhysicalMatrix(h),ut(h,h)},t.getWorldToPhysicalMatrix=h=>{ue(h);const d=[3];gt(e.physicalViewNorth,e.physicalViewUp,d),h[0]=d[0],h[1]=d[1],h[2]=d[2],h[4]=e.physicalViewUp[0],h[5]=e.physicalViewUp[1],h[6]=e.physicalViewUp[2],h[8]=-e.physicalViewNorth[0],h[9]=-e.physicalViewNorth[1],h[10]=-e.physicalViewNorth[2],De(h,h),qt(o,1/e.physicalScale,1/e.physicalScale,1/e.physicalScale),pr(h,h,o),Ue(h,h,e.physicalTranslation)},t.computeViewParametersFromViewMatrix=h=>{ut(s,h),Te(o,n,s),t.computeDistance();const d=e.distance;t.setPosition(o[0],o[1],o[2]),Te(c,r,s),Gn(c,c,o),Wn(c,c),t.setDirectionOfProjection(c[0],c[1],c[2]),Te(u,a,s),Gn(u,u,o),Wn(u,u),t.setViewUp(u[0],u[1],u[2]),t.setDistance(d)},t.computeViewParametersFromPhysicalMatrix=h=>{t.getWorldToPhysicalMatrix(s),Ne(s,h,s),t.computeViewParametersFromViewMatrix(s)},t.setModelTransformMatrix=h=>{e.modelTransformMatrix=h},t.getModelTransformMatrix=()=>e.modelTransformMatrix,t.setViewMatrix=h=>{e.viewMatrix=h,e.viewMatrix&&(Qe(s,e.viewMatrix),t.computeViewParametersFromViewMatrix(s),De(e.viewMatrix,e.viewMatrix))},t.getViewMatrix=()=>{if(e.viewMatrix)return e.modelTransformMatrix?(Ne(s,e.viewMatrix,e.modelTransformMatrix),s):e.viewMatrix;x0(s,e.position,e.focalPoint,e.viewUp),De(s,s);const h=new Float64Array(16);return e.modelTransformMatrix?Ne(h,s,e.modelTransformMatrix):Qe(h,s),h},t.setProjectionMatrix=h=>{e.projectionMatrix=h},t.getProjectionMatrix=(h,d,T)=>{const S=new Float64Array(16);if(ue(S),e.projectionMatrix){const C=1/e.physicalScale;return qt(o,C,C,C),Qe(S,e.projectionMatrix),pr(S,S,o),De(S,S),S}ue(s);const x=e.clippingRange[1]-e.clippingRange[0],y=[e.clippingRange[0]+(d+1)*x/2,e.clippingRange[0]+(T+1)*x/2];if(e.parallelProjection){const C=e.parallelScale*h,w=e.parallelScale,R=(e.windowCenter[0]-1)*C,O=(e.windowCenter[0]+1)*C,V=(e.windowCenter[1]-1)*w,L=(e.windowCenter[1]+1)*w;T0(s,R,O,V,L,y[0],y[1]),De(s,s)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const C=Math.tan(Ve(e.viewAngle)/2);let w,R;e.useHorizontalViewAngle===!0?(w=e.clippingRange[0]*C,R=e.clippingRange[0]*C/h):(w=e.clippingRange[0]*C*h,R=e.clippingRange[0]*C);const O=(e.windowCenter[0]-1)*w,V=(e.windowCenter[0]+1)*w,L=(e.windowCenter[1]-1)*R,m=(e.windowCenter[1]+1)*R,F=y[0],B=y[1];s[0]=2*F/(V-O),s[5]=2*F/(m-L),s[2]=(O+V)/(V-O),s[6]=(L+m)/(m-L),s[10]=-(F+B)/(B-F),s[14]=-1,s[11]=-2*F*B/(B-F),s[15]=0}}return Qe(S,s),S},t.getCompositeProjectionMatrix=(h,d,T)=>{const S=t.getViewMatrix(),x=t.getProjectionMatrix(h,d,T);return Ne(x,S,x),x},t.setDirectionOfProjection=(h,d,T)=>{if(e.directionOfProjection[0]===h&&e.directionOfProjection[1]===d&&e.directionOfProjection[2]===T)return;e.directionOfProjection[0]=h,e.directionOfProjection[1]=d,e.directionOfProjection[2]=T;const S=e.directionOfProjection;e.focalPoint[0]=e.position[0]+S[0]*e.distance,e.focalPoint[1]=e.position[1]+S[1]*e.distance,e.focalPoint[2]=e.position[2]+S[2]*e.distance,v()},t.setDeviceAngles=(h,d,T,S)=>{const x=[3];gt(e.physicalViewNorth,e.physicalViewUp,x);const y=ue(new Float64Array(16));Bt(y,y,Ve(h),e.physicalViewUp),Bt(y,y,Ve(d),x),Bt(y,y,Ve(T),e.physicalViewNorth),Bt(y,y,Ve(-S),e.physicalViewUp);const C=new Float64Array([-e.physicalViewUp[0],-e.physicalViewUp[1],-e.physicalViewUp[2]]),w=new Float64Array(e.physicalViewNorth);Te(C,C,y),Te(w,w,y),t.setDirectionOfProjection(C[0],C[1],C[2]),t.setViewUp(w[0],w[1],w[2]),t.modified()},t.setOrientationWXYZ=(h,d,T,S)=>{const x=ue(new Float64Array(16));if(h!==0&&(d!==0||T!==0||S!==0)){const w=Ve(h),R=hr();Wc(R,[d,T,S],w),Oa(x,R)}const y=new Float64Array(3);Te(y,[0,0,-1],x);const C=new Float64Array(3);Te(C,[0,1,0],x),t.setDirectionOfProjection(...y),t.setViewUp(...C),t.modified()},t.computeClippingRange=h=>{let d=null,T=null;d=e.viewPlaneNormal,T=e.position;const S=-d[0],x=-d[1],y=-d[2],C=-(S*T[0]+x*T[1]+y*T[2]),w=[S*h[0]+x*h[2]+y*h[4]+C,1e-18];for(let R=0;R<2;R++)for(let O=0;O<2;O++)for(let V=0;V<2;V++){const L=S*h[V]+x*h[2+O]+y*h[4+R]+C;w[0]=L<w[0]?L:w[0],w[1]=L>w[1]?L:w[1]}return w}}const mm={position:[0,0,1],focalPoint:[0,0,0],viewUp:[0,1,0],directionOfProjection:[0,0,-1],parallelProjection:!1,useHorizontalViewAngle:!1,viewAngle:30,parallelScale:1,clippingRange:[.01,1000.01],windowCenter:[0,0],viewPlaneNormal:[0,0,1],useOffAxisProjection:!1,screenBottomLeft:[-.5,-.5,-.5],screenBottomRight:[.5,-.5,-.5],screenTopRight:[.5,.5,-.5],freezeFocalPoint:!1,projectionMatrix:null,viewMatrix:null,modelTransformMatrix:null,cameraLightTransform:xi(),physicalTranslation:[0,0,0],physicalScale:1,physicalViewUp:[0,1,0],physicalViewNorth:[0,0,-1]};function X1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mm,n),E.obj(t,e),E.get(t,e,["distance"]),E.setGet(t,e,["parallelProjection","useHorizontalViewAngle","viewAngle","parallelScale","useOffAxisProjection","freezeFocalPoint","physicalScale"]),E.getArray(t,e,["directionOfProjection","viewPlaneNormal","position","focalPoint"]),E.setGetArray(t,e,["clippingRange","windowCenter"],2),E.setGetArray(t,e,["viewUp","screenBottomLeft","screenBottomRight","screenTopRight","physicalTranslation","physicalViewUp","physicalViewNorth"],3),Lm(t,e)}const Vm=E.newInstance(X1,"vtkCamera");var Fm={newInstance:Vm,extend:X1};function Bm(t,e){e.classHierarchy.push("vtkLight");const n=new Float64Array(3);t.getTransformedPosition=()=>(e.transformMatrix?Te(n,e.position,e.transformMatrix):qt(n,e.position[0],e.position[1],e.position[2]),n),t.getTransformedFocalPoint=()=>(e.transformMatrix?Te(n,e.focalPoint,e.transformMatrix):qt(n,e.focalPoint[0],e.focalPoint[1],e.focalPoint[2]),n),t.getDirection=()=>(e.directionMTime<e.mtime&&(Ho(e.direction,e.focalPoint,e.position),Rt(e.direction),e.directionMTime=e.mtime),e.direction),t.setDirection=r=>{const a=new Float64Array(3);Ho(a,e.position,r),e.focalPoint=a},t.setDirectionAngle=(r,a)=>{const s=Ve(r),i=Ve(a);t.setPosition(Math.cos(s)*Math.sin(i),Math.sin(s),Math.cos(s)*Math.cos(i)),t.setFocalPoint(0,0,0),t.setPositional(0)},t.setLightTypeToHeadLight=()=>{t.setLightType("HeadLight")},t.setLightTypeToCameraLight=()=>{t.setLightType("CameraLight")},t.setLightTypeToSceneLight=()=>{t.setTransformMatrix(null),t.setLightType("SceneLight")},t.lightTypeIsHeadLight=()=>e.lightType==="HeadLight",t.lightTypeIsSceneLight=()=>e.lightType==="SceneLight",t.lightTypeIsCameraLight=()=>e.lightType==="CameraLight"}const _m={switch:!0,intensity:1,color:[1,1,1],position:[0,0,1],focalPoint:[0,0,0],positional:!1,exponent:1,coneAngle:30,coneFalloff:5,attenuationValues:[1,0,0],transformMatrix:null,lightType:"SceneLight",shadowAttenuation:1,direction:[0,0,0],directionMTime:0};function Um(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_m,n),E.obj(t,e),E.setGet(t,e,["intensity","switch","positional","exponent","coneAngle","coneFalloff","transformMatrix","lightType","shadowAttenuation","attenuationValues"]),E.setGetArray(t,e,["color","position","focalPoint","attenuationValues"],3),Bm(t,e)}const Nm=E.newInstance(Um,"vtkLight");var km={newInstance:Nm};const{vtkErrorMacro:Hs}=E;function Gm(t){return()=>Hs(`vtkViewport::${t} - NOT IMPLEMENTED`)}function bm(t,e){e.classHierarchy.push("vtkViewport"),t.getViewProps=()=>e.props,t.hasViewProp=r=>e.props.includes(r),t.addViewProp=r=>{r&&!t.hasViewProp(r)&&e.props.push(r)},t.removeViewProp=r=>{const a=e.props.filter(s=>s!==r);e.props.length!==a.length&&(e.props=a)},t.removeAllViewProps=()=>{e.props=[]};function n(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];a.push(r);const s=r.getNestedProps();if(s&&s.length)for(let i=0;i<s.length;i++)n(s[i],a);return a}t.getViewPropsWithNestedProps=()=>{let r=[];e.actors2D=[];for(let a=0;a<e.props.length;a++){const s=e.props[a].getActors2D();s&&(!Array.isArray(s)||s.length>0)?e.actors2D=e.actors2D.concat(s):n(e.props[a],r)}return e.actors2D.sort((a,s)=>a.getLayerNumber()-s.getLayerNumber()),r=r.concat(e.actors2D),r},t.addActor2D=t.addViewProp,t.removeActor2D=r=>{t.removeViewProp(r)},t.getActors2D=()=>(e.actors2D=[],e.props.forEach(r=>{e.actors2D=e.actors2D.concat(r.getActors2D())}),e.actors2D),t.displayToView=()=>Hs("call displayToView on your view instead"),t.viewToDisplay=()=>Hs("callviewtodisplay on your view instead"),t.getSize=()=>Hs("call getSize on your View instead"),t.normalizedDisplayToProjection=(r,a,s)=>{const i=t.normalizedDisplayToNormalizedViewport(r,a,s);return t.normalizedViewportToProjection(i[0],i[1],i[2])},t.normalizedDisplayToNormalizedViewport=(r,a,s)=>{const i=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[(r-e.viewport[0])/i[0],(a-e.viewport[1])/i[1],s]},t.normalizedViewportToProjection=(r,a,s)=>[r*2-1,a*2-1,s*2-1],t.projectionToNormalizedDisplay=(r,a,s)=>{const i=t.projectionToNormalizedViewport(r,a,s);return t.normalizedViewportToNormalizedDisplay(i[0],i[1],i[2])},t.normalizedViewportToNormalizedDisplay=(r,a,s)=>{const i=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[r*i[0]+e.viewport[0],a*i[1]+e.viewport[1],s]},t.projectionToNormalizedViewport=(r,a,s)=>[(r+1)*.5,(a+1)*.5,(s+1)*.5],t.PickPropFrom=Gm("PickPropFrom")}const $m={background:[0,0,0],background2:[.2,.2,.2],gradientBackground:!1,viewport:[0,0,1,1],aspect:[1,1],pixelAspect:[1,1],props:[],actors2D:[]};function I1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$m,n),E.obj(t,e),E.event(t,e,"event"),E.setGetArray(t,e,["viewport"],4),E.setGetArray(t,e,["background","background2"],3),bm(t,e)}const Wm=E.newInstance(I1,"vtkViewport");var zm={newInstance:Wm,extend:I1};const{vtkDebugMacro:ia,vtkErrorMacro:Vn,vtkWarningMacro:Hm}=nn;function Kg(t){return()=>Vn(`vtkRenderer::${t} - NOT IMPLEMENTED`)}function Am(t,e){e.classHierarchy.push("vtkRenderer");const n={type:"ComputeVisiblePropBoundsEvent",renderer:t},r={type:"ResetCameraClippingRangeEvent",renderer:t},a={type:"ResetCameraEvent",renderer:t};t.updateCamera=()=>(e.activeCamera||(ia("No cameras are on, creating one."),t.getActiveCameraAndResetIfCreated()),e.activeCamera.render(t),!0),t.updateLightsGeometryToFollowCamera=()=>{const s=t.getActiveCameraAndResetIfCreated();e.lights.forEach(i=>{i.lightTypeIsSceneLight()||(i.lightTypeIsHeadLight()?(i.setPositionFrom(s.getPositionByReference()),i.setFocalPointFrom(s.getFocalPointByReference()),i.modified(s.getMTime())):i.lightTypeIsCameraLight()?i.setTransformMatrix(s.getCameraLightTransformMatrix(xi())):Vn("light has unknown light type",i.get()))})},t.updateLightGeometry=()=>e.lightFollowCamera?t.updateLightsGeometryToFollowCamera():!0,t.allocateTime=Kg("allocateTime"),t.updateGeometry=Kg("updateGeometry"),t.getVTKWindow=()=>e._renderWindow,t.setLayer=s=>{ia(t.getClassName(),t,"setting Layer to ",s),e.layer!==s&&(e.layer=s,t.modified()),t.setPreserveColorBuffer(!!s)},t.setActiveCamera=s=>e.activeCamera===s?!1:(e.activeCamera=s,t.modified(),t.invokeEvent({type:"ActiveCameraEvent",camera:s}),!0),t.makeCamera=()=>{const s=Fm.newInstance();return t.invokeEvent({type:"CreateCameraEvent",camera:s}),s},t.getActiveCamera=()=>(e.activeCamera||(e.activeCamera=t.makeCamera()),e.activeCamera),t.getActiveCameraAndResetIfCreated=()=>(e.activeCamera||(t.getActiveCamera(),t.resetCamera()),e.activeCamera),t.getActors=()=>(e.actors=[],e.props.forEach(s=>{e.actors=e.actors.concat(s.getActors())}),e.actors),t.addActor=t.addViewProp,t.removeActor=s=>{e.actors=e.actors.filter(i=>i!==s),t.removeViewProp(s),t.modified()},t.removeAllActors=()=>{t.getActors().forEach(i=>{t.removeViewProp(i)}),e.actors=[],t.modified()},t.getVolumes=()=>(e.volumes=[],e.props.forEach(s=>{e.volumes=e.volumes.concat(s.getVolumes())}),e.volumes),t.addVolume=t.addViewProp,t.removeVolume=s=>{e.volumes=e.volumes.filter(i=>i!==s),t.removeViewProp(s),t.modified()},t.removeAllVolumes=()=>{t.getVolumes().forEach(i=>{t.removeViewProp(i)}),e.volumes=[],t.modified()},t.hasLight=s=>e.lights.includes(s),t.addLight=s=>{s&&!t.hasLight(s)&&(e.lights.push(s),t.modified())},t.removeLight=s=>{e.lights=e.lights.filter(i=>i!==s),t.modified()},t.removeAllLights=()=>{e.lights=[],t.modified()},t.setLightCollection=s=>{e.lights=s,t.modified()},t.makeLight=km.newInstance,t.createLight=()=>{e.automaticLightCreation&&(e._createdLight&&(t.removeLight(e._createdLight),e._createdLight.delete(),e._createdLight=null),e._createdLight=t.makeLight(),t.addLight(e._createdLight),e._createdLight.setLightTypeToHeadLight(),e._createdLight.setPosition(t.getActiveCamera().getPosition()),e._createdLight.setFocalPoint(t.getActiveCamera().getFocalPoint()))},t.normalizedDisplayToWorld=(s,i,o,c)=>{let u=t.normalizedDisplayToProjection(s,i,o);return u=t.projectionToView(u[0],u[1],u[2],c),t.viewToWorld(u[0],u[1],u[2])},t.worldToNormalizedDisplay=(s,i,o,c)=>{let u=t.worldToView(s,i,o);return u=t.viewToProjection(u[0],u[1],u[2],c),t.projectionToNormalizedDisplay(u[0],u[1],u[2])},t.viewToWorld=(s,i,o)=>{if(e.activeCamera===null)return Vn("ViewToWorld: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const c=e.activeCamera.getViewMatrix();ut(c,c),De(c,c);const u=new Float64Array([s,i,o]);return Te(u,u,c),u},t.projectionToView=(s,i,o,c)=>{if(e.activeCamera===null)return Vn("ProjectionToView: no active camera, cannot compute projection to view, returning 0,0,0"),[0,0,0];const u=e.activeCamera.getProjectionMatrix(c,-1,1);ut(u,u),De(u,u);const g=new Float64Array([s,i,o]);return Te(g,g,u),g},t.worldToView=(s,i,o)=>{if(e.activeCamera===null)return Vn("WorldToView: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const c=e.activeCamera.getViewMatrix();De(c,c);const u=new Float64Array([s,i,o]);return Te(u,u,c),u},t.viewToProjection=(s,i,o,c)=>{if(e.activeCamera===null)return Vn("ViewToProjection: no active camera, cannot compute view to projection, returning 0,0,0"),[0,0,0];const u=e.activeCamera.getProjectionMatrix(c,-1,1);De(u,u);const g=new Float64Array([s,i,o]);return Te(g,g,u),g},t.computeVisiblePropBounds=()=>{e.allBounds[0]=pe.INIT_BOUNDS[0],e.allBounds[1]=pe.INIT_BOUNDS[1],e.allBounds[2]=pe.INIT_BOUNDS[2],e.allBounds[3]=pe.INIT_BOUNDS[3],e.allBounds[4]=pe.INIT_BOUNDS[4],e.allBounds[5]=pe.INIT_BOUNDS[5];let s=!0;t.invokeEvent(n);for(let i=0;i<e.props.length;++i){const o=e.props[i];if(o.getVisibility()&&o.getUseBounds()){const c=o.getBounds();c&&bs(c)&&(s=!1,c[0]<e.allBounds[0]&&(e.allBounds[0]=c[0]),c[1]>e.allBounds[1]&&(e.allBounds[1]=c[1]),c[2]<e.allBounds[2]&&(e.allBounds[2]=c[2]),c[3]>e.allBounds[3]&&(e.allBounds[3]=c[3]),c[4]<e.allBounds[4]&&(e.allBounds[4]=c[4]),c[5]>e.allBounds[5]&&(e.allBounds[5]=c[5]))}}return s&&(af(e.allBounds),ia("Can't compute bounds, no 3D props are visible")),e.allBounds},t.resetCamera=function(){const i=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:null)||t.computeVisiblePropBounds(),o=[0,0,0];if(!bs(i))return ia("Cannot reset camera!"),!1;let c=null;if(t.getActiveCamera())c=e.activeCamera.getViewPlaneNormal();else return Vn("Trying to reset non-existent camera"),!1;e.activeCamera.setViewAngle(30),o[0]=(i[0]+i[1])/2,o[1]=(i[2]+i[3])/2,o[2]=(i[4]+i[5])/2;let u=i[1]-i[0],g=i[3]-i[2],f=i[5]-i[4];u*=u,g*=g,f*=f;let l=u+g+f;l=l===0?1:l,l=Math.sqrt(l)*.5;const p=Ve(e.activeCamera.getViewAngle()),v=l,h=l/Math.sin(p*.5),d=e.activeCamera.getViewUp();return Math.abs(ee(d,c))>.999&&(Hm("Resetting view-up since view plane normal is parallel"),e.activeCamera.setViewUp(-d[2],d[0],d[1])),e.activeCamera.setFocalPoint(o[0],o[1],o[2]),e.activeCamera.setPosition(o[0]+h*c[0],o[1]+h*c[1],o[2]+h*c[2]),t.resetCameraClippingRange(i),e.activeCamera.setParallelScale(v),e.activeCamera.setPhysicalScale(l),e.activeCamera.setPhysicalTranslation(-o[0],-o[1],-o[2]),t.invokeEvent(a),!0},t.resetCameraClippingRange=function(){const i=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:null)||t.computeVisiblePropBounds();if(!bs(i))return ia("Cannot reset camera clipping range!"),!1;if(t.getActiveCameraAndResetIfCreated(),!e.activeCamera)return Vn("Trying to reset clipping range of non-existent camera"),!1;const o=e.activeCamera.computeClippingRange(i);let c=0;if(e.activeCamera.getParallelProjection())c=.2*e.activeCamera.getParallelScale();else{const u=Ve(e.activeCamera.getViewAngle());c=.2*Math.tan(u/2)*o[1]}return o[1]-o[0]<c&&(c=c-o[1]+o[0],o[1]+=c/2,o[0]-=c/2),o[0]<0&&(o[0]=0),o[0]=.99*o[0]-(o[1]-o[0])*e.clippingRangeExpansion,o[1]=1.01*o[1]+(o[1]-o[0])*e.clippingRangeExpansion,o[0]=o[0]>=o[1]?.01*o[1]:o[0],e.nearClippingPlaneTolerance||(e.nearClippingPlaneTolerance=.01),o[0]<e.nearClippingPlaneTolerance*o[1]&&(o[0]=e.nearClippingPlaneTolerance*o[1]),e.activeCamera.setClippingRange(o[0],o[1]),t.invokeEvent(r),!1},t.setRenderWindow=s=>{s!==e._renderWindow&&(e._vtkWindow=s,e._renderWindow=s)},t.visibleActorCount=()=>e.props.filter(s=>s.getVisibility()).length,t.visibleVolumeCount=t.visibleActorCount,t.getMTime=()=>{let s=e.mtime;const i=e.activeCamera?e.activeCamera.getMTime():0;i>s&&(s=i);const o=e._createdLight?e._createdLight.getMTime():0;return o>s&&(s=o),s},t.getTransparent=()=>!!e.preserveColorBuffer,t.isActiveCameraCreated=()=>!!e.activeCamera}const jm={pickedProp:null,activeCamera:null,allBounds:[],ambient:[1,1,1],allocatedRenderTime:100,timeFactor:1,automaticLightCreation:!0,twoSidedLighting:!0,lastRenderTimeInSeconds:-1,renderWindow:null,lights:[],actors:[],volumes:[],lightFollowCamera:!0,numberOfPropsRendered:0,propArray:null,pathArray:null,layer:0,preserveColorBuffer:!1,preserveDepthBuffer:!1,computeVisiblePropBounds:Ri(),interactive:!0,nearClippingPlaneTolerance:0,clippingRangeExpansion:.05,erase:!0,draw:!0,useShadows:!1,useDepthPeeling:!1,occlusionRatio:0,maximumNumberOfPeels:4,selector:null,delegate:null,texturedBackground:!1,backgroundTexture:null,environmentTexture:null,environmentTextureDiffuseStrength:1,environmentTextureSpecularStrength:1,useEnvironmentTextureAsBackground:!1,pass:0};function Y1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};for(Object.assign(e,jm,n),zm.extend(t,e,n),e.background||(e.background=[0,0,0,1]);e.background.length<3;)e.background.push(0);e.background.length===3&&e.background.push(1),pt(t,e,["_renderWindow","allocatedRenderTime","timeFactor","lastRenderTimeInSeconds","numberOfPropsRendered","lastRenderingUsedDepthPeeling","selector"]),He(t,e,["twoSidedLighting","lightFollowCamera","automaticLightCreation","erase","draw","nearClippingPlaneTolerance","clippingRangeExpansion","backingStore","interactive","layer","preserveColorBuffer","preserveDepthBuffer","useDepthPeeling","occlusionRatio","maximumNumberOfPeels","delegate","backgroundTexture","texturedBackground","environmentTexture","environmentTextureDiffuseStrength","environmentTextureSpecularStrength","useEnvironmentTextureAsBackground","useShadows","pass"]),Yr(t,e,["actors","volumes","lights"]),jc(t,e,["background"],4,1),Ka(t,e,["renderWindow"]),Am(t,e)}const Km=we(Y1,"vtkRenderer");var Pm={newInstance:Km,extend:Y1};const Xm="WebGL",fi=Object.create(null);function Cf(t,e){fi[t]=e}function Im(){return Object.keys(fi)}function q1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fi[t]&&fi[t](e)}function Ym(t,e){e.classHierarchy.push("vtkRenderWindow"),t.addRenderer=n=>{t.hasRenderer(n)||(n.setRenderWindow(t),e.renderers.push(n),t.modified())},t.removeRenderer=n=>{e.renderers=e.renderers.filter(r=>r!==n),t.modified()},t.hasRenderer=n=>e.renderers.indexOf(n)!==-1,t.newAPISpecificView=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return q1(n||e.defaultViewAPI,r)},t.addView=n=>{t.hasView(n)||(n.setRenderable(t),e._views.push(n),t.modified())},t.removeView=n=>{e._views=e._views.filter(r=>r!==n),t.modified()},t.hasView=n=>e._views.indexOf(n)!==-1,t.preRender=()=>{e.renderers.forEach(n=>{n.isActiveCameraCreated()||n.resetCamera()})},t.render=()=>{t.preRender(),e.interactor?e.interactor.render():e._views.forEach(n=>n.traverseAllPasses())},t.getStatistics=()=>{const n={propCount:0,invisiblePropCount:0,gpuMemoryMB:0};return e._views.forEach(r=>{r.getGraphicsMemoryInfo&&(n.gpuMemoryMB+=r.getGraphicsMemoryInfo()/1e6)}),e.renderers.forEach(r=>{const a=r.getViewProps(),s=e._views[0].getViewNodeFor(r);a.forEach(i=>{if(i.getVisibility()){n.propCount+=1;const o=i.getMapper&&i.getMapper();if(o&&o.getPrimitiveCount){const c=s.getViewNodeFor(o);if(c){c.getAllocatedGPUMemoryInBytes&&(n.gpuMemoryMB+=c.getAllocatedGPUMemoryInBytes()/1e6);const u=o.getPrimitiveCount();Object.keys(u).forEach(g=>{n[g]||(n[g]=0),n[g]+=u[g]})}}}else n.invisiblePropCount+=1})}),n.str=Object.keys(n).map(r=>`${r}: ${n[r]}`).join(`
`),n},t.captureImages=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return E.setImmediate(t.render),e._views.map(a=>a.captureNextImage?a.captureNextImage(n,r):void 0).filter(a=>!!a)},t.addRenderWindow=n=>e.childRenderWindows.includes(n)?!1:(e.childRenderWindows.push(n),t.modified(),!0),t.removeRenderWindow=n=>{const r=e.childRenderWindows.findIndex(a=>a===n);return r<0?!1:(e.childRenderWindows.splice(r,1),t.modified(),!0)}}const qm={defaultViewAPI:Xm,renderers:[],views:[],interactor:null,neverRendered:!0,numberOfLayers:1,childRenderWindows:[]};function Q1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,qm,n),E.obj(t,e),E.setGet(t,e,["interactor","numberOfLayers","_views","defaultViewAPI"]),E.get(t,e,["neverRendered"]),E.getArray(t,e,["renderers","childRenderWindows"]),E.moveToProtected(t,e,["views"]),E.event(t,e,"completion"),Ym(t,e)}const Qm=E.newInstance(Q1,"vtkRenderWindow");var Zm={newInstance:Qm,extend:Q1,registerViewConstructor:Cf,listViewAPIs:Im,newAPISpecificView:q1};const lc={Unknown:0,LeftController:1,RightController:2},va={Unknown:0,Trigger:1,TrackPad:2,Grip:3,Thumbstick:4,A:5,B:6,ApplicationMenu:7},Jm={Unknown:0,TouchpadX:1,TouchpadY:2,ThumbstickX:3,ThumbstickY:4},eV={LeftButton:1,MiddleButton:2,RightButton:3};var Z1={Device:lc,Input:va,Axis:Jm,MouseButton:eV};const{Device:Ss,Input:sr}=Z1,{vtkWarningMacro:Cs,vtkErrorMacro:ws,normalizeWheel:tV,vtkOnceErrorMacro:nV}=E,Mr={ctrlKey:!1,altKey:!1,shiftKey:!1},So={"xr-standard":[sr.Trigger,sr.Grip,sr.TrackPad,sr.Thumbstick,sr.A,sr.B]},wf=["StartAnimation","Animation","EndAnimation","PointerEnter","PointerLeave","MouseEnter","MouseLeave","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteraction","Interaction","EndInteraction","AnimationFrameRateUpdate"];function oa(t){t.cancelable&&t.preventDefault()}function Es(t){const e=Object.create(null);return t.forEach(n=>{let{pointerId:r,position:a}=n;e[r]=a}),e}function rV(t,e){e.classHierarchy.push("vtkRenderWindowInteractor");const n={...t},r=new Set,a=new Map;let s=1;t.start=()=>{!e.initialized&&(t.initialize(),!e.initialized)||t.startEventLoop()},t.setRenderWindow=h=>{ws("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},t.setInteractorStyle=h=>{e.interactorStyle!==h&&(e.interactorStyle!=null&&e.interactorStyle.setInteractor(null),e.interactorStyle=h,e.interactorStyle!=null&&e.interactorStyle.getInteractor()!==t&&e.interactorStyle.setInteractor(t))},t.initialize=()=>{e.initialized=!0,t.enable(),t.render()},t.enable=()=>t.setEnabled(!0),t.disable=()=>t.setEnabled(!1),t.startEventLoop=()=>Cs("empty event loop");function i(h,d){e._forcedRenderer||(e.currentRenderer=t.findPokedRenderer(h,d))}t.getCurrentRenderer=()=>(e.currentRenderer||i(0,0),e.currentRenderer);function o(h){const d=e._view.getCanvas(),T=d.getBoundingClientRect(),S=d.width/T.width,x=d.height/T.height,y={x:S*(h.clientX-T.left),y:x*(T.height-h.clientY+T.top),z:0,movementX:S*h.movementX,movementY:x*h.movementY};return(a.size<=1||!e.currentRenderer)&&i(y.x,y.y),y}const c=e._getScreenEventPositionFor||o;function u(h){return{controlKey:h.ctrlKey,altKey:h.altKey,shiftKey:h.shiftKey}}function g(h){const d=u(h);return{key:h.key,keyCode:h.charCode,...d}}function f(h){return h.pointerType||""}const l=()=>{if(e.container===null)return;const{container:h}=e;h.addEventListener("contextmenu",oa),h.addEventListener("wheel",t.handleWheel),h.addEventListener("DOMMouseScroll",t.handleWheel),h.addEventListener("pointerenter",t.handlePointerEnter),h.addEventListener("pointerleave",t.handlePointerLeave),h.addEventListener("pointermove",t.handlePointerMove,{passive:!1}),h.addEventListener("pointerdown",t.handlePointerDown,{passive:!1}),h.addEventListener("pointerup",t.handlePointerUp),h.addEventListener("pointercancel",t.handlePointerCancel),h.addEventListener("keypress",t.handleKeyPress),h.addEventListener("keydown",t.handleKeyDown),document.addEventListener("keyup",t.handleKeyUp),document.addEventListener("pointerlockchange",t.handlePointerLockChange),h.tabIndex=0,h.style.touchAction="none",h.style.userSelect="none",h.style.webkitTapHighlightColor="rgba(0,0,0,0)"};t.bindEvents=h=>{if(h===null)return;n.setContainer(h)&&l()};const p=()=>{clearTimeout(e.moveTimeoutID),clearTimeout(e.wheelTimeoutID),e.moveTimeoutID=0,e.wheelTimeoutID=0,s=1;const{container:h}=e;h&&(h.removeEventListener("contextmenu",oa),h.removeEventListener("wheel",t.handleWheel),h.removeEventListener("DOMMouseScroll",t.handleWheel),h.removeEventListener("pointerenter",t.handlePointerEnter),h.removeEventListener("pointerleave",t.handlePointerLeave),h.removeEventListener("pointermove",t.handlePointerMove,{passive:!1}),h.removeEventListener("pointerdown",t.handlePointerDown,{passive:!1}),h.removeEventListener("pointerup",t.handlePointerUp),h.removeEventListener("pointercancel",t.handlePointerCancel),h.removeEventListener("keypress",t.handleKeyPress),h.removeEventListener("keydown",t.handleKeyDown)),document.removeEventListener("keyup",t.handleKeyUp),document.removeEventListener("pointerlockchange",t.handlePointerLockChange),a.clear()};t.unbindEvents=()=>{p(),n.setContainer(null)},t.handleKeyPress=h=>{const d=g(h);t.keyPressEvent(d)},t.handleKeyDown=h=>{const d=g(h);t.keyDownEvent(d)},t.handleKeyUp=h=>{const d=g(h);t.keyUpEvent(d)},t.handlePointerEnter=h=>{const d={...u(h),position:c(h),deviceType:f(h)};t.pointerEnterEvent(d),d.deviceType==="mouse"&&t.mouseEnterEvent(d)},t.handlePointerLeave=h=>{const d={...u(h),position:c(h),deviceType:f(h)};t.pointerLeaveEvent(d),d.deviceType==="mouse"&&t.mouseLeaveEvent(d)},t.handlePointerDown=h=>{if(!(h.button>2||t.isPointerLocked()))switch(e.preventDefaultOnPointerDown&&oa(h),h.target.hasPointerCapture(h.pointerId)&&h.target.releasePointerCapture(h.pointerId),e.container.setPointerCapture(h.pointerId),a.has(h.pointerId)&&Cs("[RenderWindowInteractor] duplicate pointerId detected"),a.set(h.pointerId,{pointerId:h.pointerId,position:c(h)}),h.pointerType){case"pen":case"touch":t.handleTouchStart(h);break;case"mouse":default:t.handleMouseDown(h);break}},t.handlePointerUp=h=>{if(a.has(h.pointerId))switch(e.preventDefaultOnPointerUp&&oa(h),a.delete(h.pointerId),e.container.releasePointerCapture(h.pointerId),h.pointerType){case"pen":case"touch":t.handleTouchEnd(h);break;case"mouse":default:t.handleMouseUp(h);break}},t.handlePointerCancel=h=>{if(a.has(h.pointerId))switch(a.delete(h.pointerId),h.pointerType){case"pen":case"touch":t.handleTouchEnd(h);break;case"mouse":default:t.handleMouseUp(h);break}},t.handlePointerMove=h=>{if(a.has(h.pointerId)){const d=a.get(h.pointerId);d.position=c(h)}switch(h.pointerType){case"pen":case"touch":t.handleTouchMove(h);break;case"mouse":default:t.handleMouseMove(h);break}},t.handleMouseDown=h=>{const d={...u(h),position:c(h),deviceType:f(h)};switch(h.button){case 0:t.leftButtonPressEvent(d);break;case 1:t.middleButtonPressEvent(d);break;case 2:t.rightButtonPressEvent(d);break;default:ws(`Unknown mouse button pressed: ${h.button}`);break}},t.requestPointerLock=()=>{e.container&&e.container.requestPointerLock()},t.exitPointerLock=()=>document.exitPointerLock?.(),t.isPointerLocked=()=>!!e.container&&document.pointerLockElement===e.container,t.handlePointerLockChange=()=>{t.isPointerLocked()?t.startPointerLockEvent():t.endPointerLockEvent()};function v(){e._view&&e.enabled&&e.enableRender&&(e.inRender=!0,e._view.traverseAllPasses(),e.inRender=!1),t.invokeRenderEvent()}t.requestAnimation=h=>{if(h===void 0){ws("undefined requester, can not start animating");return}if(r.has(h)){Cs("requester is already registered for animating");return}r.add(h),!e.animationRequest&&r.size===1&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.extendAnimation=h=>{const d=Date.now()+h;e._animationExtendedEnd=Math.max(e._animationExtendedEnd,d),!e.animationRequest&&r.size===0&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.isAnimating=()=>e.xrAnimation||e.animationRequest!==null,t.cancelAnimation=function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r.has(h)){if(!d){const T=h&&h.getClassName?h.getClassName():h;Cs(`${T} did not request an animation`)}return}r.delete(h),e.animationRequest&&r.size===0&&Date.now()>e._animationExtendedEnd&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.switchToXRAnimation=()=>{e.animationRequest&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null),e.xrAnimation=!0},t.returnFromXRAnimation=()=>{e.xrAnimation=!1,r.size!==0&&(e.recentAnimationFrameRate=10,e.animationRequest=requestAnimationFrame(t.handleAnimation))},t.updateXRGamepads=(h,d,T)=>{h.inputSources.forEach(S=>{const x=S.gripSpace==null?null:d.getPose(S.gripSpace,T),y=S.gripSpace==null?null:d.getPose(S.targetRaySpace,T),C=S.gamepad,w=S.handedness;if(C){C.index in e.lastGamepadValues||(e.lastGamepadValues[C.index]={left:{buttons:{}},right:{buttons:{}},none:{buttons:{}}});for(let R=0;R<C.buttons.length;++R)R in e.lastGamepadValues[C.index][w].buttons||(e.lastGamepadValues[C.index][w].buttons[R]=!1),e.lastGamepadValues[C.index][w].buttons[R]!==C.buttons[R].pressed&&x!=null&&(t.button3DEvent({gamepad:C,position:x.transform.position,orientation:x.transform.orientation,targetPosition:y.transform.position,targetOrientation:y.transform.orientation,pressed:C.buttons[R].pressed,device:S.handedness==="left"?Ss.LeftController:Ss.RightController,input:So[C.mapping]&&So[C.mapping][R]?So[C.mapping][R]:sr.Trigger}),e.lastGamepadValues[C.index][w].buttons[R]=C.buttons[R].pressed),e.lastGamepadValues[C.index][w].buttons[R]&&x!=null&&t.move3DEvent({gamepad:C,position:x.transform.position,orientation:x.transform.orientation,targetPosition:y.transform.position,targetOrientation:y.transform.orientation,device:S.handedness==="left"?Ss.LeftController:Ss.RightController})}})},t.handleMouseMove=h=>{const d={...u(h),position:c(h),deviceType:f(h)};e.moveTimeoutID===0?t.startMouseMoveEvent(d):(t.mouseMoveEvent(d),clearTimeout(e.moveTimeoutID)),e.moveTimeoutID=setTimeout(()=>{t.endMouseMoveEvent(),e.moveTimeoutID=0},200)},t.handleAnimation=()=>{const h=Date.now();e._animationFrameCount++,h-e._animationStartTime>1e3&&e._animationFrameCount>1&&(e.recentAnimationFrameRate=1e3*(e._animationFrameCount-1)/(h-e._animationStartTime),e.lastFrameTime=1/e.recentAnimationFrameRate,t.animationFrameRateUpdateEvent(),e._animationStartTime=h,e._animationFrameCount=1),t.animationEvent(),v(),r.size>0||Date.now()<e._animationExtendedEnd?e.animationRequest=requestAnimationFrame(t.handleAnimation):(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.handleWheel=h=>{oa(h);const d={...tV(h),...u(h),position:c(h),deviceType:f(h)};e.wheelTimeoutID===0&&(Math.abs(d.spinY)>=.3?s=Math.abs(d.spinY):s=1),d.spinY/=s,e.wheelTimeoutID===0?(t.startMouseWheelEvent(d),t.mouseWheelEvent(d)):(t.mouseWheelEvent(d),clearTimeout(e.wheelTimeoutID)),e.mouseScrollDebounceByPass?(t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0):e.wheelTimeoutID=setTimeout(()=>{t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0},200)},t.handleMouseUp=h=>{const d={...u(h),position:c(h),deviceType:f(h)};switch(h.button){case 0:t.leftButtonReleaseEvent(d);break;case 1:t.middleButtonReleaseEvent(d);break;case 2:t.rightButtonReleaseEvent(d);break;default:ws(`Unknown mouse button released: ${h.button}`);break}},t.handleTouchStart=h=>{const d=[...a.values()];if(e.recognizeGestures&&d.length>1){const T=Es(a);if(d.length===2){const S={...u(Mr),position:d[0].position,deviceType:f(h)};t.leftButtonReleaseEvent(S)}t.recognizeGesture("TouchStart",T)}else if(d.length===1){const T={...u(Mr),position:c(h),deviceType:f(h)};t.leftButtonPressEvent(T)}},t.handleTouchMove=h=>{const d=[...a.values()];if(e.recognizeGestures&&d.length>1){const T=Es(a);t.recognizeGesture("TouchMove",T)}else if(d.length===1){const T={...u(Mr),position:d[0].position,deviceType:f(h)};t.mouseMoveEvent(T)}},t.handleTouchEnd=h=>{const d=[...a.values()];if(e.recognizeGestures)if(d.length===0){const T={...u(Mr),position:c(h),deviceType:f(h)};t.leftButtonReleaseEvent(T)}else if(d.length===1){const T=Es(a);t.recognizeGesture("TouchEnd",T);const S={...u(Mr),position:d[0].position,deviceType:f(h)};t.leftButtonPressEvent(S)}else{const T=Es(a);t.recognizeGesture("TouchMove",T)}else if(d.length===1){const T={...u(Mr),position:d[0].position,deviceType:f(h)};t.leftButtonReleaseEvent(T)}},t.setView=h=>{e._view!==h&&(e._view=h,e._view.getRenderable().setInteractor(t),t.modified())},t.getFirstRenderer=()=>e._view?.getRenderable()?.getRenderersByReference()?.[0],t.findPokedRenderer=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!e._view)return null;const T=e._view?.getRenderable()?.getRenderers();if(!T||T.length===0)return null;T.sort((w,R)=>w.getLayer()-R.getLayer());let S=null,x=null,y=null,C=T.length;for(;C--;){const w=T[C];if(e._view.isInViewport(h,d,w)&&w.getInteractive()){y=w;break}S===null&&w.getInteractive()&&(S=w),x===null&&e._view.isInViewport(h,d,w)&&(x=w)}return y===null&&(y=S),y===null&&(y=x),y==null&&(y=T[0]),y},t.render=()=>{!t.isAnimating()&&!e.inRender&&v()},wf.forEach(h=>{const d=h.charAt(0).toLowerCase()+h.slice(1);t[`${d}Event`]=T=>{if(!e.enabled)return;if(!t.getCurrentRenderer()){nV(`
          Can not forward events without a current renderer on the interactor.
        `);return}const x={type:h,pokedRenderer:e.currentRenderer,firstRenderer:t.getFirstRenderer(),...T};t[`invoke${h}`](x)}}),t.recognizeGesture=(h,d)=>{if(Object.keys(d).length>2)return;if(e.startingEventPositions||(e.startingEventPositions={}),h==="TouchStart"){Object.keys(d).forEach(L=>{e.startingEventPositions[L]=d[L]}),e.currentGesture="Start";return}if(h==="TouchEnd"){e.currentGesture==="Pinch"&&(t.render(),t.endPinchEvent()),e.currentGesture==="Rotate"&&(t.render(),t.endRotateEvent()),e.currentGesture==="Pan"&&(t.render(),t.endPanEvent()),e.currentGesture="Start",e.startingEventPositions={};return}let T=0;const S=[],x=[];Object.keys(d).forEach(L=>{S[T]=d[L],x[T]=e.startingEventPositions[L],T++});const y=Math.sqrt((x[0].x-x[1].x)*(x[0].x-x[1].x)+(x[0].y-x[1].y)*(x[0].y-x[1].y)),C=Math.sqrt((S[0].x-S[1].x)*(S[0].x-S[1].x)+(S[0].y-S[1].y)*(S[0].y-S[1].y));let w=zr(Math.atan2(x[1].y-x[0].y,x[1].x-x[0].x)),R=zr(Math.atan2(S[1].y-S[0].y,S[1].x-S[0].x)),O=R-w;R=R+180>=360?R-180:R+180,w=w+180>=360?w-180:w+180,Math.abs(R-w)<Math.abs(O)&&(O=R-w);const V=[];if(V[0]=(S[0].x-x[0].x+S[1].x-x[1].x)/2,V[1]=(S[0].y-x[0].y+S[1].y-x[1].y)/2,h==="TouchMove")if(e.currentGesture==="Start"){let L=.01*Math.sqrt(e.container.clientWidth*e.container.clientWidth+e.container.clientHeight*e.container.clientHeight);L<15&&(L=15);const m=Math.abs(C-y),F=C*3.1415926*Math.abs(O)/360,B=Math.sqrt(V[0]*V[0]+V[1]*V[1]);if(m>L&&m>F&&m>B){e.currentGesture="Pinch";const _={scale:1,touches:d};t.startPinchEvent(_)}else if(F>L&&F>B){e.currentGesture="Rotate";const _={rotation:0,touches:d};t.startRotateEvent(_)}else if(B>L){e.currentGesture="Pan";const _={translation:[0,0],touches:d};t.startPanEvent(_)}}else{if(e.currentGesture==="Rotate"){const L={rotation:O,touches:d};t.rotateEvent(L)}if(e.currentGesture==="Pinch"){const L={scale:C/y,touches:d};t.pinchEvent(L)}if(e.currentGesture==="Pan"){const L={translation:V,touches:d};t.panEvent(L)}}},t.handleVisibilityChange=()=>{e._animationStartTime=Date.now(),e._animationFrameCount=0},t.setCurrentRenderer=h=>{e._forcedRenderer=!!h,e.currentRenderer=h},t.setContainer=h=>{p();const d=n.setContainer(h??null);return d&&l(),d},t.delete=()=>{for(;r.size;)t.cancelAnimation(r.values().next().value);typeof document.hidden<"u"&&document.removeEventListener("visibilitychange",t.handleVisibilityChange),e.container&&t.setContainer(null),n.delete()},typeof document.hidden<"u"&&document.addEventListener("visibilitychange",t.handleVisibilityChange,!1)}const aV={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,recentAnimationFrameRate:10,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{},preventDefaultOnPointerDown:!1,preventDefaultOnPointerUp:!1,mouseScrollDebounceByPass:!1};function J1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aV,n),E.obj(t,e),e._animationExtendedEnd=0,E.event(t,e,"RenderEvent"),wf.forEach(r=>E.event(t,e,r)),E.get(t,e,["initialized","interactorStyle","lastFrameTime","recentAnimationFrameRate","_view"]),E.setGet(t,e,["container","lightFollowCamera","enabled","enableRender","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker","preventDefaultOnPointerDown","preventDefaultOnPointerUp","mouseScrollDebounceByPass"]),E.moveToProtected(t,e,["view"]),rV(t,e)}const sV=E.newInstance(J1,"vtkRenderWindowInteractor");var ed={newInstance:sV,extend:J1,handledEvents:wf,...Z1};const{vtkErrorMacro:iV,VOID:oV}=E;function cV(t,e,n,r){return t.getRenderWindow().getViews()[0].worldToDisplay(e,n,r,t)}function fV(t,e,n,r){return t.getRenderWindow().getViews()[0].displayToWorld(e,n,r,t)}const uV={computeWorldToDisplay:cV,computeDisplayToWorld:fV};function gV(t,e){e.classHierarchy.push("vtkInteractorObserver");const n={...t};function r(){for(;e.subscribedEvents.length;)e.subscribedEvents.pop().unsubscribe()}function a(){ed.handledEvents.forEach(s=>{t[`handle${s}`]&&e.subscribedEvents.push(e._interactor[`on${s}`](i=>e.processEvents?t[`handle${s}`](i):oV,e.priority))})}t.setInteractor=s=>{s!==e._interactor&&(r(),e._interactor=s,s&&e.enabled&&a(),t.modified())},t.setEnabled=s=>{s!==e.enabled&&(r(),s&&(e._interactor?a():iV(`
          The interactor must be set before subscribing to events
        `)),e.enabled=s,t.modified())},t.computeDisplayToWorld=(s,i,o,c)=>s?e._interactor.getView().displayToWorld(i,o,c,s):null,t.computeWorldToDisplay=(s,i,o,c)=>s?e._interactor.getView().worldToDisplay(i,o,c,s):null,t.setPriority=s=>{n.setPriority(s)&&e._interactor&&(r(),a())}}const lV={enabled:!0,priority:0,processEvents:!0,subscribedEvents:[]};function td(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lV,n),E.obj(t,e),E.event(t,e,"InteractionEvent"),E.event(t,e,"StartInteractionEvent"),E.event(t,e,"EndInteractionEvent"),E.get(t,e,["_interactor","enabled"]),E.setGet(t,e,["priority","processEvents"]),E.moveToProtected(t,e,["interactor"]),gV(t,e)}const pV=E.newInstance(td,"vtkInteractorObserver");var hV={newInstance:pV,extend:td,...uV};const dV={IS_START:0,IS_NONE:0,IS_ROTATE:1,IS_PAN:2,IS_SPIN:3,IS_DOLLY:4,IS_CAMERA_POSE:11,IS_WINDOW_LEVEL:1024,IS_SLICE:1025};var Ef={States:dV};const{States:It}=Ef,Co={Rotate:It.IS_ROTATE,Pan:It.IS_PAN,Spin:It.IS_SPIN,Dolly:It.IS_DOLLY,CameraPose:It.IS_CAMERA_POSE,WindowLevel:It.IS_WINDOW_LEVEL,Slice:It.IS_SLICE};function vV(t,e){e.classHierarchy.push("vtkInteractorStyle"),Object.keys(Co).forEach(n=>{E.event(t,e,`Start${n}Event`),t[`start${n}`]=()=>{e.state===It.IS_NONE&&(e.state=Co[n],e._interactor.requestAnimation(t),t.invokeStartInteractionEvent({type:"StartInteractionEvent"}),t[`invokeStart${n}Event`]({type:`Start${n}Event`}))},E.event(t,e,`End${n}Event`),t[`end${n}`]=()=>{e.state===Co[n]&&(e.state=It.IS_NONE,e._interactor.cancelAnimation(t),t.invokeEndInteractionEvent({type:"EndInteractionEvent"}),t[`invokeEnd${n}Event`]({type:`End${n}Event`}),e._interactor.render())}}),e.getRenderer=n=>e.focusedRenderer||n.pokedRenderer,t.handleKeyPress=n=>{const r=e._interactor;let a=null;switch(n.key){case"r":case"R":e.getRenderer(n).resetCamera(),r.render();break;case"w":case"W":a=e.getRenderer(n).getActors(),a.forEach(s=>{const i=s.getProperty();i.setRepresentationToWireframe&&i.setRepresentationToWireframe()}),r.render();break;case"s":case"S":a=e.getRenderer(n).getActors(),a.forEach(s=>{const i=s.getProperty();i.setRepresentationToSurface&&i.setRepresentationToSurface()}),r.render();break;case"v":case"V":a=e.getRenderer(n).getActors(),a.forEach(s=>{const i=s.getProperty();i.setRepresentationToPoints&&i.setRepresentationToPoints()}),r.render();break}}}const yV={state:It.IS_NONE,handleObservers:1,autoAdjustCameraClippingRange:1};function nd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,yV,n),hV.extend(t,e,n),E.setGet(t,e,["focusedRenderer"]),vV(t,e)}const TV=E.newInstance(nd,"vtkInteractorStyle");var xV={newInstance:TV,extend:nd,...Ef};const{States:Kt}=Ef;function SV(t,e){e.classHierarchy.push("vtkInteractorStyleTrackballCamera"),t.handleMouseMove=n=>{const r=n.position,a=e.getRenderer(n);switch(e.state){case Kt.IS_ROTATE:t.handleMouseRotate(a,r),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_PAN:t.handleMousePan(a,r),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_DOLLY:t.handleMouseDolly(a,r),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_SPIN:t.handleMouseSpin(a,r),t.invokeInteractionEvent({type:"InteractionEvent"});break}e.previousPosition=r},t.handleButton3D=n=>{if(n&&n.pressed&&n.device===lc.RightController&&(n.input===va.Trigger||n.input===va.TrackPad)){t.startCameraPose();return}n&&!n.pressed&&n.device===lc.RightController&&(n.input===va.Trigger||n.input===va.TrackPad)&&e.state===Kt.IS_CAMERA_POSE&&t.endCameraPose()},t.handleMove3D=n=>{switch(e.state){case Kt.IS_CAMERA_POSE:t.updateCameraPose(n);break}},t.updateCameraPose=n=>{const r=e.getRenderer(n).getActiveCamera(),a=r.getPhysicalTranslation(),i=.5*.05*r.getPhysicalScale(),o=r.physicalOrientationToWorldDirection([n.orientation.x,n.orientation.y,n.orientation.z,n.orientation.w]);r.setPhysicalTranslation(a[0]+o[0]*i,a[1]+o[1]*i,a[2]+o[2]*i)},t.handleLeftButtonPress=n=>{const r=n.position;e.previousPosition=r,n.shiftKey?n.controlKey||n.altKey?t.startDolly():t.startPan():n.controlKey||n.altKey?t.startSpin():t.startRotate()},t.handleLeftButtonRelease=()=>{switch(e.state){case Kt.IS_DOLLY:t.endDolly();break;case Kt.IS_PAN:t.endPan();break;case Kt.IS_SPIN:t.endSpin();break;case Kt.IS_ROTATE:t.endRotate();break}},t.handleStartMouseWheel=()=>{t.startDolly()},t.handleEndMouseWheel=()=>{t.endDolly()},t.handleStartPinch=n=>{e.previousScale=n.scale,t.startDolly()},t.handleEndPinch=()=>{t.endDolly()},t.handleStartRotate=n=>{e.previousRotation=n.rotation,t.startRotate()},t.handleEndRotate=()=>{t.endRotate()},t.handleStartPan=n=>{e.previousTranslation=n.translation,t.startPan()},t.handleEndPan=()=>{t.endPan()},t.handlePinch=n=>{t.dollyByFactor(e.getRenderer(n),n.scale/e.previousScale),e.previousScale=n.scale},t.handlePan=n=>{const r=e.getRenderer(n).getActiveCamera();let a=r.getFocalPoint();a=t.computeWorldToDisplay(e.getRenderer(n),a[0],a[1],a[2]);const s=a[2],i=n.translation,o=e.previousTranslation,c=t.computeDisplayToWorld(e.getRenderer(n),a[0]+i[0]-o[0],a[1]+i[1]-o[1],s),u=t.computeDisplayToWorld(e.getRenderer(n),a[0],a[1],s),g=[];g[0]=u[0]-c[0],g[1]=u[1]-c[1],g[2]=u[2]-c[2],a=r.getFocalPoint();const f=r.getPosition();r.setFocalPoint(g[0]+a[0],g[1]+a[1],g[2]+a[2]),r.setPosition(g[0]+f[0],g[1]+f[1],g[2]+f[2]),e._interactor.getLightFollowCamera()&&e.getRenderer(n).updateLightsGeometryToFollowCamera(),r.orthogonalizeViewUp(),e.previousTranslation=n.translation},t.handleRotate=n=>{const r=e.getRenderer(n).getActiveCamera();r.roll(n.rotation-e.previousRotation),r.orthogonalizeViewUp(),e.previousRotation=n.rotation},t.handleMouseRotate=(n,r)=>{if(!e.previousPosition)return;const a=e._interactor,s=r.x-e.previousPosition.x,i=r.y-e.previousPosition.y,o=a.getView().getViewportSize(n);let c=-.1,u=-.1;o[0]&&o[1]&&(c=-20/o[1],u=-20/o[0]);const g=s*u*e.motionFactor,f=i*c*e.motionFactor,l=n.getActiveCamera();!Number.isNaN(g)&&!Number.isNaN(f)&&(l.azimuth(g),l.elevation(f),l.orthogonalizeViewUp()),e.autoAdjustCameraClippingRange&&n.resetCameraClippingRange(),a.getLightFollowCamera()&&n.updateLightsGeometryToFollowCamera()},t.handleMouseSpin=(n,r)=>{if(!e.previousPosition)return;const a=e._interactor,s=n.getActiveCamera(),i=a.getView().getViewportCenter(n),o=zr(Math.atan2(e.previousPosition.y-i[1],e.previousPosition.x-i[0])),c=zr(Math.atan2(r.y-i[1],r.x-i[0]))-o;Number.isNaN(c)||(s.roll(c),s.orthogonalizeViewUp())},t.handleMousePan=(n,r)=>{if(!e.previousPosition)return;const a=n.getActiveCamera();let s=a.getFocalPoint();s=t.computeWorldToDisplay(n,s[0],s[1],s[2]);const i=s[2],o=t.computeDisplayToWorld(n,r.x,r.y,i),c=t.computeDisplayToWorld(n,e.previousPosition.x,e.previousPosition.y,i),u=[];u[0]=c[0]-o[0],u[1]=c[1]-o[1],u[2]=c[2]-o[2],s=a.getFocalPoint();const g=a.getPosition();a.setFocalPoint(u[0]+s[0],u[1]+s[1],u[2]+s[2]),a.setPosition(u[0]+g[0],u[1]+g[1],u[2]+g[2]),e._interactor.getLightFollowCamera()&&n.updateLightsGeometryToFollowCamera()},t.handleMouseDolly=(n,r)=>{if(!e.previousPosition)return;const a=r.y-e.previousPosition.y,i=e._interactor.getView().getViewportCenter(n),o=e.motionFactor*a/i[1];t.dollyByFactor(n,1.1**o)},t.handleMouseWheel=n=>{const r=1-n.spinY/e.zoomFactor;t.dollyByFactor(e.getRenderer(n),r)},t.dollyByFactor=(n,r)=>{if(Number.isNaN(r))return;const a=n.getActiveCamera();a.getParallelProjection()?a.setParallelScale(a.getParallelScale()/r):(a.dolly(r),e.autoAdjustCameraClippingRange&&n.resetCameraClippingRange()),e._interactor.getLightFollowCamera()&&n.updateLightsGeometryToFollowCamera()}}const CV={motionFactor:10,zoomFactor:10};function rd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CV,n),xV.extend(t,e,n),E.setGet(t,e,["motionFactor","zoomFactor"]),SV(t,e)}const wV=E.newInstance(rd,"vtkInteractorStyleTrackballCamera");var EV={newInstance:wV,extend:rd};function RV(t){return t}function Rf(t){if(t===null||t==="null")return null;if(t==="true")return!0;if(t==="false")return!1;if(!(t===void 0||t==="undefined"))return t[0]==="["&&t[t.length-1]==="]"?t.substring(1,t.length-1).split(",").map(e=>Rf(e.trim())):t===""||Number.isNaN(Number(t))?t:Number(t)}function OV(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window.location.search;const n={},r=t?Rf:RV;return new URLSearchParams(e).forEach((s,i)=>{i&&(n[i]=s?r(s):!0)}),n}var MV={toNativeType:Rf,extractURLParameters:OV};function DV(t,e){e.classHierarchy.push("vtkFramebuffer"),t.getBothMode=()=>e.context.FRAMEBUFFER,t.saveCurrentBindingsAndBuffers=n=>{const r=typeof n<"u"?n:t.getBothMode();t.saveCurrentBindings(r),t.saveCurrentBuffers(r)},t.saveCurrentBindings=n=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling saveCurrentBindings");return}const r=e.context;e.previousDrawBinding=r.getParameter(e.context.FRAMEBUFFER_BINDING),e.previousActiveFramebuffer=e._openGLRenderWindow.getActiveFramebuffer()},t.saveCurrentBuffers=n=>{},t.restorePreviousBindingsAndBuffers=n=>{const r=typeof n<"u"?n:t.getBothMode();t.restorePreviousBindings(r),t.restorePreviousBuffers(r)},t.restorePreviousBindings=n=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling restorePreviousBindings");return}const r=e.context;r.bindFramebuffer(r.FRAMEBUFFER,e.previousDrawBinding),e._openGLRenderWindow.setActiveFramebuffer(e.previousActiveFramebuffer)},t.restorePreviousBuffers=n=>{},t.bind=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;r===null&&(r=e.context.FRAMEBUFFER),e.context.bindFramebuffer(r,e.glFramebuffer);for(let a=0;a<e.colorBuffers.length;a++)e.colorBuffers[a].bind();e._openGLRenderWindow.setActiveFramebuffer(t)},t.create=(n,r)=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling create");return}e.glFramebuffer=e.context.createFramebuffer(),e.glFramebuffer.width=n,e.glFramebuffer.height=r},t.setColorBuffer=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const a=e.context;if(!a){ie("you must set the OpenGLRenderWindow before calling setColorBuffer");return}let s=a.COLOR_ATTACHMENT0;if(r>0)if(e._openGLRenderWindow.getWebgl2())s+=r;else{ie("Using multiple framebuffer attachments requires WebGL 2");return}e.colorBuffers[r]=n,a.framebufferTexture2D(a.FRAMEBUFFER,s,a.TEXTURE_2D,n.getHandle(),0)},t.removeColorBuffer=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const r=e.context;if(!r){ie("you must set the OpenGLRenderWindow before calling removeColorBuffer");return}let a=r.COLOR_ATTACHMENT0;if(n>0)if(e._openGLRenderWindow.getWebgl2())a+=n;else{ie("Using multiple framebuffer attachments requires WebGL 2");return}r.framebufferTexture2D(r.FRAMEBUFFER,a,r.TEXTURE_2D,null,0),e.colorBuffers=e.colorBuffers.splice(n,1)},t.setDepthBuffer=n=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling setDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){const r=e.context;r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,n.getHandle(),0)}else ie("Attaching depth buffer textures to fbo requires WebGL 2")},t.removeDepthBuffer=()=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling removeDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){const n=e.context;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,null,0)}else ie("Attaching depth buffer textures to framebuffers requires WebGL 2")},t.getGLFramebuffer=()=>e.glFramebuffer,t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))},t.releaseGraphicsResources=()=>{e.glFramebuffer&&e.context.deleteFramebuffer(e.glFramebuffer)},t.getSize=()=>e.glFramebuffer==null?null:[e.glFramebuffer.width,e.glFramebuffer.height],t.populateFramebuffer=()=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling populateFrameBuffer");return}t.bind();const n=e.context,r=hn.newInstance();r.setOpenGLRenderWindow(e._openGLRenderWindow),r.setMinificationFilter(fc.LINEAR),r.setMagnificationFilter(fc.LINEAR),r.create2DFromRaw({width:e.glFramebuffer.width,height:e.glFramebuffer.height,numComps:4,dataType:Pe.UNSIGNED_CHAR,data:null}),t.setColorBuffer(r),e.depthTexture=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,e.depthTexture),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e.glFramebuffer.width,e.glFramebuffer.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e.depthTexture)},t.getColorTexture=()=>e.colorBuffers[0]}const LV={glFramebuffer:null,colorBuffers:null,depthTexture:null,previousDrawBinding:0,previousReadBinding:0,previousDrawBuffer:0,previousReadBuffer:0,previousActiveFramebuffer:null};function ad(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LV,n),qe(t,e),e.colorBuffers&&ie("you cannot initialize colorBuffers through the constructor. You should call setColorBuffer() instead."),e.colorBuffers=[],Yr(t,e,["colorBuffers"]),DV(t,e)}const mV=we(ad,"vtkFramebuffer");var Of={newInstance:mV,extend:ad};function VV(t,e){e.classHierarchy.push("vtkRenderPass"),t.getOperation=()=>e.currentOperation,t.setCurrentOperation=n=>{e.currentOperation=n,e.currentTraverseOperation=`traverse${E.capitalize(e.currentOperation)}`},t.getTraverseOperation=()=>e.currentTraverseOperation,t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;e.deleted||(e._currentParent=r,e.preDelegateOperations.forEach(a=>{t.setCurrentOperation(a),n.traverse(t)}),e.delegates.forEach(a=>{a.traverse(n,t)}),e.postDelegateOperations.forEach(a=>{t.setCurrentOperation(a),n.traverse(t)}))}}const FV={delegates:[],currentOperation:null,preDelegateOperations:[],postDelegateOperations:[],currentParent:null};function sd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,FV,n),E.obj(t,e),E.get(t,e,["currentOperation"]),E.setGet(t,e,["delegates","_currentParent","preDelegateOperations","postDelegateOperations"]),E.moveToProtected(t,e,["currentParent"]),VV(t,e)}const BV=E.newInstance(sd,"vtkRenderPass");var Cn={newInstance:BV,extend:sd};const{Representation:_V}=qr,{vtkErrorMacro:Pg}=E;function UV(t){const e=N.substitute(t.Fragment,"//VTK::RenderPassFragmentShader::Impl",`
      float weight = gl_FragData[0].a * pow(max(1.1 - gl_FragCoord.z, 0.0), 2.0);
      gl_FragData[0] = vec4(gl_FragData[0].rgb*weight, gl_FragData[0].a);
      gl_FragData[1].r = weight;
    `,!1);t.Fragment=e.result}const NV=`//VTK::System::Dec

in vec2 tcoord;

uniform sampler2D translucentRTexture;
uniform sampler2D translucentRGBATexture;

// the output of this shader
//VTK::Output::Dec

void main()
{
  vec4 t1Color = texture(translucentRGBATexture, tcoord);
  float t2Color = texture(translucentRTexture, tcoord).r;
  gl_FragData[0] = vec4(t1Color.rgb/max(t2Color,0.01), 1.0 - t1Color.a);
}
`;function kV(t,e){e.classHierarchy.push("vtkOpenGLOrderIndependentTranslucentPass"),t.createVertexBuffer=()=>{const n=new Float32Array([-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),r=new Float32Array([0,0,1,0,0,1,1,1]),a=new Uint16Array([4,0,1,3,2]),s=xe.newInstance({numberOfComponents:3,values:n});s.setName("points");const i=xe.newInstance({numberOfComponents:2,values:r});i.setName("tcoords");const o=xe.newInstance({numberOfComponents:1,values:a});e.tris.getCABO().createVBO(o,"polys",_V.SURFACE,{points:s,tcoords:i,cellOffset:0}),e.VBOBuildTime.modified()},t.createFramebuffer=n=>{const r=n.getSize(),a=n.getContext();e.framebuffer=Of.newInstance(),e.framebuffer.setOpenGLRenderWindow(n),e.framebuffer.create(...r),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind(),e.translucentRGBATexture=hn.newInstance(),e.translucentRGBATexture.setInternalFormat(a.RGBA16F),e.translucentRGBATexture.setFormat(a.RGBA),e.translucentRGBATexture.setOpenGLDataType(a.HALF_FLOAT),e.translucentRGBATexture.setOpenGLRenderWindow(n),e.translucentRGBATexture.create2DFromRaw({width:r[0],height:r[1],numComps:4,dataType:"Float32Array",data:null}),e.translucentRTexture=hn.newInstance(),e.translucentRTexture.setInternalFormat(a.R16F),e.translucentRTexture.setFormat(a.RED),e.translucentRTexture.setOpenGLDataType(a.HALF_FLOAT),e.translucentRTexture.setOpenGLRenderWindow(n),e.translucentRTexture.create2DFromRaw({width:r[0],height:r[1],numComps:1,dataType:"Float32Array",data:null}),e.translucentZTexture=hn.newInstance(),e.translucentZTexture.setOpenGLRenderWindow(n),e.translucentZTexture.createDepthFromRaw({width:r[0],height:r[1],dataType:"Float32Array",data:null}),e.framebuffer.setColorBuffer(e.translucentRGBATexture,0),e.framebuffer.setColorBuffer(e.translucentRTexture,1),e.framebuffer.setDepthBuffer(e.translucentZTexture)},t.createCopyShader=n=>{e.copyShader=n.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","attribute vec2 tcoordTC;","varying vec2 tcoord;","void main() { tcoord = tcoordTC; gl_Position = vertexDC; }"].join(`
`),NV,"")},t.createVBO=n=>{const r=n.getContext();e.tris.setOpenGLRenderWindow(n),t.createVertexBuffer();const a=e.copyShader;e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(a,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),r.FLOAT,3,r.FALSE)||Pg("Error setting vertexDC in copy shader VAO."),e.copyVAO.addAttributeArray(a,e.tris.getCABO(),"tcoordTC",e.tris.getCABO().getTCoordOffset(),e.tris.getCABO().getStride(),r.FLOAT,2,r.FALSE)||Pg("Error setting vertexDC in copy shader VAO.")},t.traverse=(n,r,a)=>{if(e.deleted)return;const s=n.getSize(),i=n.getContext();if(e._supported=!1,r.getSelector()||!i||!n.getWebgl2()||!i.getExtension("EXT_color_buffer_half_float")&&!i.getExtension("EXT_color_buffer_float")){t.setCurrentOperation("translucentPass"),r.traverse(t);return}if(e._supported=!0,e.framebuffer===null)t.createFramebuffer(n);else{const c=e.framebuffer.getSize();c===null||c[0]!==s[0]||c[1]!==s[1]?(e.framebuffer.releaseGraphicsResources(),e.translucentRGBATexture.releaseGraphicsResources(n),e.translucentRTexture.releaseGraphicsResources(n),e.translucentZTexture.releaseGraphicsResources(n),t.createFramebuffer(n)):(e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind())}i.drawBuffers([i.COLOR_ATTACHMENT0]),i.clearBufferfv(i.COLOR,0,[0,0,0,0]),i.clearBufferfv(i.DEPTH,0,[1]),i.colorMask(!1,!1,!1,!1),a.getOpaqueActorCount()>0&&(a.setCurrentOperation("opaqueZBufferPass"),r.traverse(a)),i.colorMask(!0,!0,!0,!0),i.drawBuffers([i.COLOR_ATTACHMENT0,i.COLOR_ATTACHMENT1]),i.viewport(0,0,s[0],s[1]),i.scissor(0,0,s[0],s[1]),i.clearBufferfv(i.COLOR,0,[0,0,0,1]),i.clearBufferfv(i.COLOR,1,[0,0,0,0]),i.enable(i.DEPTH_TEST),i.enable(i.BLEND),i.blendFuncSeparate(i.ONE,i.ONE,i.ZERO,i.ONE_MINUS_SRC_ALPHA),t.setCurrentOperation("translucentPass"),r.traverse(t),i.drawBuffers([i.NONE]),e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null?t.createCopyShader(n):n.getShaderCache().readyShaderProgram(e.copyShader),e.copyVAO||(e.copyVAO=l1.newInstance(),e.copyVAO.setOpenGLRenderWindow(n)),e.copyVAO.bind(),e.VBOBuildTime.getMTime()<t.getMTime()&&t.createVBO(n),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),i.depthMask(!1),i.depthFunc(i.ALWAYS),i.viewport(0,0,s[0],s[1]),i.scissor(0,0,s[0],s[1]),e.translucentRGBATexture.activate(),e.copyShader.setUniformi("translucentRGBATexture",e.translucentRGBATexture.getTextureUnit()),e.translucentRTexture.activate(),e.copyShader.setUniformi("translucentRTexture",e.translucentRTexture.getTextureUnit()),i.drawArrays(i.TRIANGLES,0,e.tris.getCABO().getElementCount()),i.depthMask(!0),i.depthFunc(i.LEQUAL),e.translucentRGBATexture.deactivate(),e.translucentRTexture.deactivate();const o=r.getTiledSizeAndOrigin();i.scissor(o.lowerLeftU,o.lowerLeftV,o.usize,o.vsize),i.viewport(o.lowerLeftU,o.lowerLeftV,o.usize,o.vsize)},t.getShaderReplacement=()=>e._supported?UV:null,t.releaseGraphicsResources=n=>{e.framebuffer&&(e.framebuffer.releaseGraphicsResources(n),e.framebuffer=null),e.translucentRGBATexture&&(e.translucentRGBATexture.releaseGraphicsResources(n),e.translucentRGBATexture=null),e.translucentRTexture&&(e.translucentRTexture.releaseGraphicsResources(n),e.translucentRTexture=null),e.translucentZTexture&&(e.translucentZTexture.releaseGraphicsResources(n),e.translucentZTexture=null),e.copyVAO&&(e.copyVAO.releaseGraphicsResources(n),e.copyVAO=null),e.copyShader&&(e.copyShader.releaseGraphicsResources(n),e.copyShader=null),e.tris&&(e.tris.releaseGraphicsResources(n),e.tris=null),t.modified()}}const GV={framebuffer:null,copyShader:null,tris:null};function id(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,GV,n),Cn.extend(t,e,n),e.VBOBuildTime={},E.obj(e.VBOBuildTime,{mtime:0}),e.tris=Qr.newInstance(),E.get(t,e,["framebuffer"]),kV(t,e)}const bV=E.newInstance(id,"vtkOpenGLOrderIndependentTranslucentPass");var $V={newInstance:bV,extend:id};function WV(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(e.deleted)return;e._currentParent=r,t.setCurrentOperation("buildPass"),n.traverse(t);const a=n.getRenderable().getNumberOfLayers(),s=n.getRenderable().getRenderersByReference();for(let i=0;i<a;i++)for(let o=0;o<s.length;o++){const c=s[o],u=n.getViewNodeFor(c);if(c.getDraw()&&c.getLayer()===i){if(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumeCount=0,e.overlayActorCount=0,t.setCurrentOperation("queryPass"),u.traverse(t),(e.opaqueActorCount>0||e.translucentActorCount>0)&&e.volumeCount>0||e.depthRequested){const g=n.getFramebufferSize();e.framebuffer===null&&(e.framebuffer=Of.newInstance()),e.framebuffer.setOpenGLRenderWindow(n),e.framebuffer.saveCurrentBindingsAndBuffers();const f=e.framebuffer.getSize();(f===null||f[0]!==g[0]||f[1]!==g[1])&&(e.framebuffer.create(g[0],g[1]),e.framebuffer.populateFramebuffer()),e.framebuffer.bind(),t.setCurrentOperation("zBufferPass"),u.traverse(t),e.framebuffer.restorePreviousBindingsAndBuffers(),e.depthRequested=!1}t.setCurrentOperation("cameraPass"),u.traverse(t),e.opaqueActorCount>0&&(t.setCurrentOperation("opaquePass"),u.traverse(t)),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=$V.newInstance()),e.translucentPass.traverse(n,u,t)),e.volumeCount>0&&(t.setCurrentOperation("volumePass"),u.traverse(t)),e.overlayActorCount>0&&(t.setCurrentOperation("overlayPass"),u.traverse(t))}}},t.getZBufferTexture=()=>e.framebuffer?e.framebuffer.getColorTexture():null,t.requestDepth=()=>{e.depthRequested=!0},t.incrementOpaqueActorCount=()=>e.opaqueActorCount++,t.incrementTranslucentActorCount=()=>e.translucentActorCount++,t.incrementVolumeCount=()=>e.volumeCount++,t.incrementOverlayActorCount=()=>e.overlayActorCount++}const zV={opaqueActorCount:0,translucentActorCount:0,volumeCount:0,overlayActorCount:0,framebuffer:null,depthRequested:!1};function od(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zV,n),Cn.extend(t,e,n),E.get(t,e,["framebuffer","opaqueActorCount","translucentActorCount","volumeCount"]),WV(t,e)}const HV=E.newInstance(od,"vtkForwardPass");var AV={newInstance:HV,extend:od};const{FieldAssociations:jV}=Sr;function KV(t,e){e.classHierarchy.push("vtkHardwareSelector"),t.getSourceDataAsync=async(n,r,a,s,i)=>{},t.selectAsync=async(n,r,a,s,i)=>{const o=await t.getSourceDataAsync(n,r,a,s,i);return o?o.generateSelection(r,a,s,i):[]}}const PV={fieldAssociation:jV.FIELD_ASSOCIATION_CELLS,captureZValues:!1};function cd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,PV,n),E.obj(t,e),E.setGet(t,e,["fieldAssociation","captureZValues"]),KV(t,e)}const XV=E.newInstance(cd,"vtkHardwareSelector");var fd={newInstance:XV,extend:cd};const IV={GLOBALIDS:0,PEDIGREEIDS:1,VALUES:2,INDICES:3,FRUSTUM:4,LOCATIONS:5,THRESHOLDS:6,BLOCKS:7,QUERY:8},YV={CELL:0,POINT:1,FIELD:2,VERTEX:3,EDGE:4,ROW:5};var qV={SelectionContent:IV,SelectionField:YV};function QV(t,e){e.classHierarchy.push("vtkSelectionNode"),t.getBounds=()=>e.points.getBounds()}const ZV={contentType:-1,fieldType:-1,properties:null,selectionList:[]};function ud(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZV,n),E.obj(t,e),e.properties={},E.setGet(t,e,["contentType","fieldType","properties","selectionList"]),QV(t,e)}const JV=E.newInstance(ud,"vtkSelectionNode");var Vi={newInstance:JV,extend:ud,...qV};const{PassTypes:_e}=Bh,{SelectionContent:eF,SelectionField:Xg}=Vi,{FieldAssociations:ma}=Sr,{vtkErrorMacro:gd}=E,kn=1;function ld(t){return`${t.propID} ${t.compositeID}`}function pd(t,e,n,r){if(!n)return 0;const a=(e*(r[2]-r[0]+1)+t)*4;return n[a+3]}function ln(t,e,n,r){if(!n)return 0;const a=(e*(r[2]-r[0]+1)+t)*4,s=n[a],i=n[a+1];return(n[a+2]*256+i)*256+s}function hd(t,e){let n=e;return n<<=24,n|=t,n}function tF(t,e,n,r){{if(r[0]=e[0],r[1]=e[1],e[0]<t.area[0]||e[0]>t.area[2]||e[1]<t.area[1]||e[1]>t.area[3])return null;const a=[e[0]-t.area[0],e[1]-t.area[1]],s=ln(a[0],a[1],t.pixBuffer[_e.ACTOR_PASS],t.area);if(s<=0||s-kn>=t.props.length)return null;const i={};i.valid=!0,i.propID=s-kn,i.prop=t.props[i.propID];let o=ln(a[0],a[1],t.pixBuffer[_e.COMPOSITE_INDEX_PASS],t.area);if((o<0||o>16777215)&&(o=0),i.compositeID=o-kn,t.captureZValues){const g=(a[1]*(t.area[2]-t.area[0]+1)+a[0])*4;i.zValue=(256*t.zBuffer[g]+t.zBuffer[g+1])/65535,i.displayPosition=e}if(t.pixBuffer[_e.ID_LOW24]&&pd(a[0],a[1],t.pixBuffer[_e.ID_LOW24],t.area)===0)return i;const c=ln(a[0],a[1],t.pixBuffer[_e.ID_LOW24],t.area),u=ln(a[0],a[1],t.pixBuffer[_e.ID_HIGH24],t.area);return i.attributeID=hd(c,u),i}}function dd(t,e,n,r,a){const s=[];let i=0;return e.forEach((o,c)=>{const u=Vi.newInstance();switch(u.setContentType(eF.INDICES),t){case ma.FIELD_ASSOCIATION_CELLS:u.setFieldType(Xg.CELL);break;case ma.FIELD_ASSOCIATION_POINTS:u.setFieldType(Xg.POINT);break;default:gd("Unknown field association")}u.getProperties().propID=o.info.propID,u.getProperties().prop=o.info.prop,u.getProperties().compositeID=o.info.compositeID,u.getProperties().attributeID=o.info.attributeID,u.getProperties().pixelCount=o.pixelCount,n&&(u.getProperties().displayPosition=[o.info.displayPosition[0],o.info.displayPosition[1],o.info.zValue],u.getProperties().worldPosition=a.displayToWorld(o.info.displayPosition[0],o.info.displayPosition[1],o.info.zValue,r)),u.setSelectionList(o.attributeIDs),s[i]=u,i++}),s}function nF(t,e,n,r,a){const s=Math.floor(e),i=Math.floor(n),o=Math.floor(r),c=Math.floor(a),u=new Map,g=[0,0];for(let f=i;f<=c;f++)for(let l=s;l<=o;l++){const v=tF(t,[l,f],0,g);if(v&&v.valid){const h=ld(v);if(!u.has(h))u.set(h,{info:v,pixelCount:1,attributeIDs:[v.attributeID]});else{const d=u.get(h);d.pixelCount++,t.captureZValues&&v.zValue<d.info.zValue&&(d.info=v),d.attributeIDs.indexOf(v.attributeID)===-1&&d.attributeIDs.push(v.attributeID)}}}return dd(t.fieldAssociation,u,t.captureZValues,t.renderer,t.openGLRenderWindow)}function rF(t,e){e.classHierarchy.push("vtkOpenGLHardwareSelector"),t.releasePixBuffers=()=>{e.rawPixBuffer=[],e.pixBuffer=[],e.zBuffer=null},t.beginSelection=()=>{e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer,e._openGLRenderer),e.maxAttributeId=0;const r=e._openGLRenderWindow.getSize();if(!e.framebuffer)e.framebuffer=Of.newInstance(),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.create(r[0],r[1]),e.framebuffer.populateFramebuffer();else{e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers();const a=e.framebuffer.getSize();!a||a[0]!==r[0]||a[1]!==r[1]?(e.framebuffer.create(r[0],r[1]),e.framebuffer.populateFramebuffer()):e.framebuffer.bind()}if(e._openGLRenderer.clear(),e._openGLRenderer.setSelector(t),e.hitProps={},e.propPixels={},e.props=[],t.releasePixBuffers(),e.fieldAssociation===ma.FIELD_ASSOCIATION_POINTS){const a=e._openGLRenderWindow.getContext(),s=a.isEnabled(a.BLEND);a.disable(a.BLEND),e._openGLRenderWindow.traverseAllPasses(),s&&a.enable(a.BLEND)}},t.endSelection=()=>{e.hitProps={},e._openGLRenderer.setSelector(null),e.framebuffer.restorePreviousBindingsAndBuffers()},t.preCapturePass=()=>{const r=e._openGLRenderWindow.getContext();e.originalBlending=r.isEnabled(r.BLEND),r.disable(r.BLEND)},t.postCapturePass=()=>{const r=e._openGLRenderWindow.getContext();e.originalBlending&&r.enable(r.BLEND)},t.select=()=>{let r=null;return t.captureBuffers()&&(r=t.generateSelection(e.area[0],e.area[1],e.area[2],e.area[3]),t.releasePixBuffers()),r},t.getSourceDataAsync=async(r,a,s,i,o)=>{if(e._renderer=r,a===void 0){const u=e._openGLRenderWindow.getSize();t.setArea(0,0,u[0]-1,u[1]-1)}else t.setArea(a,s,i,o);if(!t.captureBuffers())return!1;const c={area:[...e.area],pixBuffer:[...e.pixBuffer],captureZValues:e.captureZValues,zBuffer:e.zBuffer,props:[...e.props],fieldAssociation:e.fieldAssociation,renderer:r,openGLRenderWindow:e._openGLRenderWindow};return c.generateSelection=function(){for(var u=arguments.length,g=new Array(u),f=0;f<u;f++)g[f]=arguments[f];return nF(c,...g)},c},t.captureBuffers=()=>{if(!e._renderer||!e._openGLRenderWindow)return gd("Renderer and view must be set before calling Select."),!1;e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer,e._openGLRenderer),e._openGLRenderWindow.getRenderable().preRender(),t.invokeEvent({type:"StartEvent"}),e.originalBackground=e._renderer.getBackgroundByReference(),e._renderer.setBackground(0,0,0,0);const r=e._openGLRenderWindow.getRenderPasses();t.beginSelection();const a=[];for(e.currentPass=_e.MIN_KNOWN_PASS;e.currentPass<=_e.MAX_KNOWN_PASS;e.currentPass++)t.passRequired(e.currentPass)&&(t.preCapturePass(e.currentPass),e.captureZValues&&e.currentPass===_e.ACTOR_PASS&&typeof r[0].requestDepth=="function"&&typeof r[0].getFramebuffer=="function"&&r[0].requestDepth(),e._openGLRenderWindow.traverseAllPasses(),t.postCapturePass(e.currentPass),t.savePixelBuffer(e.currentPass),a.push(e.currentPass));return a.forEach(s=>{e.currentPass=s,t.processPixelBuffers()}),e.currentPass=_e.MAX_KNOWN_PASS,t.endSelection(),e._renderer.setBackground(e.originalBackground),t.invokeEvent({type:"EndEvent"}),!0},t.processPixelBuffers=()=>{e.props.forEach((r,a)=>{t.isPropHit(a)&&r.processSelectorPixelBuffers(t,e.propPixels[a])})},t.passRequired=r=>{if(r===_e.ID_HIGH24){if(e.fieldAssociation===ma.FIELD_ASSOCIATION_POINTS)return e.maximumPointId>16777215;if(e.fieldAssociation===ma.FIELD_ASSOCIATION_CELLS)return e.maximumCellId>16777215}return!0},t.savePixelBuffer=r=>{if(e.pixBuffer[r]=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),!e.rawPixBuffer[r]){const a=(e.area[2]-e.area[0]+1)*(e.area[3]-e.area[1]+1)*4;e.rawPixBuffer[r]=new Uint8Array(a),e.rawPixBuffer[r].set(e.pixBuffer[r])}if(r===_e.ACTOR_PASS){if(e.captureZValues){const a=e._openGLRenderWindow.getRenderPasses();if(typeof a[0].requestDepth=="function"&&typeof a[0].getFramebuffer=="function"){const s=a[0].getFramebuffer();s.saveCurrentBindingsAndBuffers(),s.bind(),e.zBuffer=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),s.restorePreviousBindingsAndBuffers()}}t.buildPropHitList(e.rawPixBuffer[r])}},t.buildPropHitList=r=>{let a=0;for(let s=0;s<=e.area[3]-e.area[1];s++)for(let i=0;i<=e.area[2]-e.area[0];i++){let o=ln(i,s,r,e.area);o>0&&(o--,o in e.hitProps||(e.hitProps[o]=!0,e.propPixels[o]=[]),e.propPixels[o].push(a*4)),++a}},t.renderProp=r=>{e.currentPass===_e.ACTOR_PASS&&(t.setPropColorValueFromInt(e.props.length+kn),e.props.push(r))},t.renderCompositeIndex=r=>{e.currentPass===_e.COMPOSITE_INDEX_PASS&&t.setPropColorValueFromInt(r+kn)},t.renderAttributeId=r=>{r<0||(e.maxAttributeId=r>e.maxAttributeId?r:e.maxAttributeId)},t.passTypeToString=r=>E.enumToString(_e,r),t.isPropHit=r=>!!e.hitProps[r],t.setPropColorValueFromInt=r=>{e.propColorValue[0]=r%256/255,e.propColorValue[1]=Math.floor(r/256)%256/255,e.propColorValue[2]=Math.floor(r/65536)%256/255},t.getPixelInformation=(r,a,s)=>{const i=a<0?0:a;if(console.log("getPixelInformation called",i),i===0){if(s[0]=r[0],s[1]=r[1],r[0]<e.area[0]||r[0]>e.area[2]||r[1]<e.area[1]||r[1]>e.area[3])return null;console.log(r),console.log(e.area);const g=[r[0]-e.area[0],r[1]-e.area[1]];console.log("adjusted displayPosition",g);const f=ln(g[0],g[1],e.pixBuffer[_e.ACTOR_PASS],e.area);if(console.log("actorid",f),f<=0||f-kn>=e.props.length)return null;const l={};l.valid=!0,l.propID=f-kn,l.prop=e.props[l.propID];let p=ln(g[0],g[1],e.pixBuffer[_e.COMPOSITE_INDEX_PASS],e.area);if((p<0||p>16777215)&&(p=0),l.compositeID=p-kn,e.captureZValues){const d=(g[1]*(e.area[2]-e.area[0]+1)+g[0])*4;l.zValue=(256*e.zBuffer[d]+e.zBuffer[d+1])/65535,l.displayPosition=r}if(e.pixBuffer[_e.ID_LOW24]&&pd(g[0],g[1],e.pixBuffer[_e.ID_LOW24],e.area)===0)return l;const v=ln(g[0],g[1],e.pixBuffer[_e.ID_LOW24],e.area),h=ln(g[0],g[1],e.pixBuffer[_e.ID_HIGH24],e.area);return l.attributeID=hd(v,h),l}const o=[r[0],r[1]],c=[0,0];let u=t.getPixelInformation(r,0,s);if(u&&u.valid)return u;for(let g=1;g<i;++g){for(let f=o[1]>g?o[1]-g:0;f<=o[1]+g;++f)if(c[1]=f,o[0]>=g&&(c[0]=o[0]-g,u=t.getPixelInformation(c,0,s),u&&u.valid)||(c[0]=o[0]+g,u=t.getPixelInformation(c,0,s),u&&u.valid))return u;for(let f=o[0]>=g?o[0]-(g-1):0;f<=o[0]+(g-1);++f)if(c[0]=f,o[1]>=g&&(c[1]=o[1]-g,u=t.getPixelInformation(c,0,s),u&&u.valid)||(c[1]=o[1]+g,u=t.getPixelInformation(c,0,s),u&&u.valid))return u}return s[0]=r[0],s[1]=r[1],null},t.generateSelection=(r,a,s,i)=>{const o=Math.floor(r),c=Math.floor(a),u=Math.floor(s),g=Math.floor(i),f=new Map,l=[0,0];for(let p=c;p<=g;p++)for(let v=o;v<=u;v++){const h=[v,p],d=t.getPixelInformation(h,0,l);if(d&&d.valid){const T=ld(d);if(!f.has(T))f.set(T,{info:d,pixelCount:1,attributeIDs:[d.attributeID]});else{const S=f.get(T);S.pixelCount++,e.captureZValues&&d.zValue<S.info.zValue&&(S.info=d),S.attributeIDs.indexOf(d.attributeID)===-1&&S.attributeIDs.push(d.attributeID)}}}return dd(e.fieldAssociation,f,e.captureZValues,e._renderer,e._openGLRenderWindow)},t.getRawPixelBuffer=r=>e.rawPixBuffer[r],t.getPixelBuffer=r=>e.pixBuffer[r],t.attach=(r,a)=>{e._openGLRenderWindow=r,e._renderer=a};const n=t.setArea;t.setArea=function(){return n(...arguments)?(e.area[0]=Math.floor(e.area[0]),e.area[1]=Math.floor(e.area[1]),e.area[2]=Math.floor(e.area[2]),e.area[3]=Math.floor(e.area[3]),!0):!1}}const aF={area:void 0,currentPass:-1,propColorValue:null,props:null,maximumPointId:0,maximumCellId:0,idOffset:1};function vd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aF,n),fd.extend(t,e,n),e.propColorValue=[0,0,0],e.props=[],e.area||(e.area=[0,0,0,0]),E.setGetArray(t,e,["area"],4),E.setGet(t,e,["_renderer","currentPass","_openGLRenderWindow","maximumPointId","maximumCellId"]),E.setGetArray(t,e,["propColorValue"],3),E.moveToProtected(t,e,["renderer","openGLRenderWindow"]),E.event(t,e,"event"),rF(t,e)}const sF=E.newInstance(vd,"vtkOpenGLHardwareSelector");var yd={newInstance:sF,extend:vd,...Bh},wo={exports:{}},Ig;function iF(){return Ig||(Ig=1,(function(t,e){(function(n){t.exports=n()})(function(n){var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function a(T,S){var x=T[0],y=T[1],C=T[2],w=T[3];x+=(y&C|~y&w)+S[0]-680876936|0,x=(x<<7|x>>>25)+y|0,w+=(x&y|~x&C)+S[1]-389564586|0,w=(w<<12|w>>>20)+x|0,C+=(w&x|~w&y)+S[2]+606105819|0,C=(C<<17|C>>>15)+w|0,y+=(C&w|~C&x)+S[3]-1044525330|0,y=(y<<22|y>>>10)+C|0,x+=(y&C|~y&w)+S[4]-176418897|0,x=(x<<7|x>>>25)+y|0,w+=(x&y|~x&C)+S[5]+1200080426|0,w=(w<<12|w>>>20)+x|0,C+=(w&x|~w&y)+S[6]-1473231341|0,C=(C<<17|C>>>15)+w|0,y+=(C&w|~C&x)+S[7]-45705983|0,y=(y<<22|y>>>10)+C|0,x+=(y&C|~y&w)+S[8]+1770035416|0,x=(x<<7|x>>>25)+y|0,w+=(x&y|~x&C)+S[9]-1958414417|0,w=(w<<12|w>>>20)+x|0,C+=(w&x|~w&y)+S[10]-42063|0,C=(C<<17|C>>>15)+w|0,y+=(C&w|~C&x)+S[11]-1990404162|0,y=(y<<22|y>>>10)+C|0,x+=(y&C|~y&w)+S[12]+1804603682|0,x=(x<<7|x>>>25)+y|0,w+=(x&y|~x&C)+S[13]-40341101|0,w=(w<<12|w>>>20)+x|0,C+=(w&x|~w&y)+S[14]-1502002290|0,C=(C<<17|C>>>15)+w|0,y+=(C&w|~C&x)+S[15]+1236535329|0,y=(y<<22|y>>>10)+C|0,x+=(y&w|C&~w)+S[1]-165796510|0,x=(x<<5|x>>>27)+y|0,w+=(x&C|y&~C)+S[6]-1069501632|0,w=(w<<9|w>>>23)+x|0,C+=(w&y|x&~y)+S[11]+643717713|0,C=(C<<14|C>>>18)+w|0,y+=(C&x|w&~x)+S[0]-373897302|0,y=(y<<20|y>>>12)+C|0,x+=(y&w|C&~w)+S[5]-701558691|0,x=(x<<5|x>>>27)+y|0,w+=(x&C|y&~C)+S[10]+38016083|0,w=(w<<9|w>>>23)+x|0,C+=(w&y|x&~y)+S[15]-660478335|0,C=(C<<14|C>>>18)+w|0,y+=(C&x|w&~x)+S[4]-405537848|0,y=(y<<20|y>>>12)+C|0,x+=(y&w|C&~w)+S[9]+568446438|0,x=(x<<5|x>>>27)+y|0,w+=(x&C|y&~C)+S[14]-1019803690|0,w=(w<<9|w>>>23)+x|0,C+=(w&y|x&~y)+S[3]-187363961|0,C=(C<<14|C>>>18)+w|0,y+=(C&x|w&~x)+S[8]+1163531501|0,y=(y<<20|y>>>12)+C|0,x+=(y&w|C&~w)+S[13]-1444681467|0,x=(x<<5|x>>>27)+y|0,w+=(x&C|y&~C)+S[2]-51403784|0,w=(w<<9|w>>>23)+x|0,C+=(w&y|x&~y)+S[7]+1735328473|0,C=(C<<14|C>>>18)+w|0,y+=(C&x|w&~x)+S[12]-1926607734|0,y=(y<<20|y>>>12)+C|0,x+=(y^C^w)+S[5]-378558|0,x=(x<<4|x>>>28)+y|0,w+=(x^y^C)+S[8]-2022574463|0,w=(w<<11|w>>>21)+x|0,C+=(w^x^y)+S[11]+1839030562|0,C=(C<<16|C>>>16)+w|0,y+=(C^w^x)+S[14]-35309556|0,y=(y<<23|y>>>9)+C|0,x+=(y^C^w)+S[1]-1530992060|0,x=(x<<4|x>>>28)+y|0,w+=(x^y^C)+S[4]+1272893353|0,w=(w<<11|w>>>21)+x|0,C+=(w^x^y)+S[7]-155497632|0,C=(C<<16|C>>>16)+w|0,y+=(C^w^x)+S[10]-1094730640|0,y=(y<<23|y>>>9)+C|0,x+=(y^C^w)+S[13]+681279174|0,x=(x<<4|x>>>28)+y|0,w+=(x^y^C)+S[0]-358537222|0,w=(w<<11|w>>>21)+x|0,C+=(w^x^y)+S[3]-722521979|0,C=(C<<16|C>>>16)+w|0,y+=(C^w^x)+S[6]+76029189|0,y=(y<<23|y>>>9)+C|0,x+=(y^C^w)+S[9]-640364487|0,x=(x<<4|x>>>28)+y|0,w+=(x^y^C)+S[12]-421815835|0,w=(w<<11|w>>>21)+x|0,C+=(w^x^y)+S[15]+530742520|0,C=(C<<16|C>>>16)+w|0,y+=(C^w^x)+S[2]-995338651|0,y=(y<<23|y>>>9)+C|0,x+=(C^(y|~w))+S[0]-198630844|0,x=(x<<6|x>>>26)+y|0,w+=(y^(x|~C))+S[7]+1126891415|0,w=(w<<10|w>>>22)+x|0,C+=(x^(w|~y))+S[14]-1416354905|0,C=(C<<15|C>>>17)+w|0,y+=(w^(C|~x))+S[5]-57434055|0,y=(y<<21|y>>>11)+C|0,x+=(C^(y|~w))+S[12]+1700485571|0,x=(x<<6|x>>>26)+y|0,w+=(y^(x|~C))+S[3]-1894986606|0,w=(w<<10|w>>>22)+x|0,C+=(x^(w|~y))+S[10]-1051523|0,C=(C<<15|C>>>17)+w|0,y+=(w^(C|~x))+S[1]-2054922799|0,y=(y<<21|y>>>11)+C|0,x+=(C^(y|~w))+S[8]+1873313359|0,x=(x<<6|x>>>26)+y|0,w+=(y^(x|~C))+S[15]-30611744|0,w=(w<<10|w>>>22)+x|0,C+=(x^(w|~y))+S[6]-1560198380|0,C=(C<<15|C>>>17)+w|0,y+=(w^(C|~x))+S[13]+1309151649|0,y=(y<<21|y>>>11)+C|0,x+=(C^(y|~w))+S[4]-145523070|0,x=(x<<6|x>>>26)+y|0,w+=(y^(x|~C))+S[11]-1120210379|0,w=(w<<10|w>>>22)+x|0,C+=(x^(w|~y))+S[2]+718787259|0,C=(C<<15|C>>>17)+w|0,y+=(w^(C|~x))+S[9]-343485551|0,y=(y<<21|y>>>11)+C|0,T[0]=x+T[0]|0,T[1]=y+T[1]|0,T[2]=C+T[2]|0,T[3]=w+T[3]|0}function s(T){var S=[],x;for(x=0;x<64;x+=4)S[x>>2]=T.charCodeAt(x)+(T.charCodeAt(x+1)<<8)+(T.charCodeAt(x+2)<<16)+(T.charCodeAt(x+3)<<24);return S}function i(T){var S=[],x;for(x=0;x<64;x+=4)S[x>>2]=T[x]+(T[x+1]<<8)+(T[x+2]<<16)+(T[x+3]<<24);return S}function o(T){var S=T.length,x=[1732584193,-271733879,-1732584194,271733878],y,C,w,R,O,V;for(y=64;y<=S;y+=64)a(x,s(T.substring(y-64,y)));for(T=T.substring(y-64),C=T.length,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],y=0;y<C;y+=1)w[y>>2]|=T.charCodeAt(y)<<(y%4<<3);if(w[y>>2]|=128<<(y%4<<3),y>55)for(a(x,w),y=0;y<16;y+=1)w[y]=0;return R=S*8,R=R.toString(16).match(/(.*?)(.{0,8})$/),O=parseInt(R[2],16),V=parseInt(R[1],16)||0,w[14]=O,w[15]=V,a(x,w),x}function c(T){var S=T.length,x=[1732584193,-271733879,-1732584194,271733878],y,C,w,R,O,V;for(y=64;y<=S;y+=64)a(x,i(T.subarray(y-64,y)));for(T=y-64<S?T.subarray(y-64):new Uint8Array(0),C=T.length,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],y=0;y<C;y+=1)w[y>>2]|=T[y]<<(y%4<<3);if(w[y>>2]|=128<<(y%4<<3),y>55)for(a(x,w),y=0;y<16;y+=1)w[y]=0;return R=S*8,R=R.toString(16).match(/(.*?)(.{0,8})$/),O=parseInt(R[2],16),V=parseInt(R[1],16)||0,w[14]=O,w[15]=V,a(x,w),x}function u(T){var S="",x;for(x=0;x<4;x+=1)S+=r[T>>x*8+4&15]+r[T>>x*8&15];return S}function g(T){var S;for(S=0;S<T.length;S+=1)T[S]=u(T[S]);return T.join("")}g(o("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&(function(){function T(S,x){return S=S|0||0,S<0?Math.max(S+x,0):Math.min(S,x)}ArrayBuffer.prototype.slice=function(S,x){var y=this.byteLength,C=T(S,y),w=y,R,O,V,L;return x!==n&&(w=T(x,y)),C>w?new ArrayBuffer(0):(R=w-C,O=new ArrayBuffer(R),V=new Uint8Array(O),L=new Uint8Array(this,C,R),V.set(L),O)}})();function f(T){return/[\u0080-\uFFFF]/.test(T)&&(T=unescape(encodeURIComponent(T))),T}function l(T,S){var x=T.length,y=new ArrayBuffer(x),C=new Uint8Array(y),w;for(w=0;w<x;w+=1)C[w]=T.charCodeAt(w);return S?C:y}function p(T){return String.fromCharCode.apply(null,new Uint8Array(T))}function v(T,S,x){var y=new Uint8Array(T.byteLength+S.byteLength);return y.set(new Uint8Array(T)),y.set(new Uint8Array(S),T.byteLength),y}function h(T){var S=[],x=T.length,y;for(y=0;y<x-1;y+=2)S.push(parseInt(T.substr(y,2),16));return String.fromCharCode.apply(String,S)}function d(){this.reset()}return d.prototype.append=function(T){return this.appendBinary(f(T)),this},d.prototype.appendBinary=function(T){this._buff+=T,this._length+=T.length;var S=this._buff.length,x;for(x=64;x<=S;x+=64)a(this._hash,s(this._buff.substring(x-64,x)));return this._buff=this._buff.substring(x-64),this},d.prototype.end=function(T){var S=this._buff,x=S.length,y,C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w;for(y=0;y<x;y+=1)C[y>>2]|=S.charCodeAt(y)<<(y%4<<3);return this._finish(C,x),w=g(this._hash),T&&(w=h(w)),this.reset(),w},d.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},d.prototype.setState=function(T){return this._buff=T.buff,this._length=T.length,this._hash=T.hash,this},d.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},d.prototype._finish=function(T,S){var x=S,y,C,w;if(T[x>>2]|=128<<(x%4<<3),x>55)for(a(this._hash,T),x=0;x<16;x+=1)T[x]=0;y=this._length*8,y=y.toString(16).match(/(.*?)(.{0,8})$/),C=parseInt(y[2],16),w=parseInt(y[1],16)||0,T[14]=C,T[15]=w,a(this._hash,T)},d.hash=function(T,S){return d.hashBinary(f(T),S)},d.hashBinary=function(T,S){var x=o(T),y=g(x);return S?h(y):y},d.ArrayBuffer=function(){this.reset()},d.ArrayBuffer.prototype.append=function(T){var S=v(this._buff.buffer,T),x=S.length,y;for(this._length+=T.byteLength,y=64;y<=x;y+=64)a(this._hash,i(S.subarray(y-64,y)));return this._buff=y-64<x?new Uint8Array(S.buffer.slice(y-64)):new Uint8Array(0),this},d.ArrayBuffer.prototype.end=function(T){var S=this._buff,x=S.length,y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],C,w;for(C=0;C<x;C+=1)y[C>>2]|=S[C]<<(C%4<<3);return this._finish(y,x),w=g(this._hash),T&&(w=h(w)),this.reset(),w},d.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.ArrayBuffer.prototype.getState=function(){var T=d.prototype.getState.call(this);return T.buff=p(T.buff),T},d.ArrayBuffer.prototype.setState=function(T){return T.buff=l(T.buff,!0),d.prototype.setState.call(this,T)},d.ArrayBuffer.prototype.destroy=d.prototype.destroy,d.ArrayBuffer.prototype._finish=d.prototype._finish,d.ArrayBuffer.hash=function(T,S){var x=c(new Uint8Array(T)),y=g(x);return S?h(y):y},d})})(wo)),wo.exports}var oF=iF();const cF=Si(oF),fF=["lastShaderProgramBound","context","_openGLRenderWindow"];function uF(t,e){e.classHierarchy.push("vtkShaderCache"),t.replaceShaderValues=(n,r,a)=>{let s=r;a.length>0&&(s=N.substitute(s,"VSOut","GSOut").result);const i=e._openGLRenderWindow.getWebgl2();let o=`
`,c=`#version 100
`;i?c=`#version 300 es
#define attribute in
#define textureCube texture
#define texture2D texture
#define textureCubeLod textureLod
#define texture2DLod textureLod
`:(e.context.getExtension("OES_standard_derivatives"),e.context.getExtension("EXT_frag_depth")&&(o=`#extension GL_EXT_frag_depth : enable
`),e.context.getExtension("EXT_shader_texture_lod")&&(o+=`#extension GL_EXT_shader_texture_lod : enable
#define textureCubeLod textureCubeLodEXT
#define texture2DLod texture2DLodEXT`)),s=N.substitute(s,"//VTK::System::Dec",[`${c}
`,i?"":`#extension GL_OES_standard_derivatives : enable
`,o,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;let u=N.substitute(n,"//VTK::System::Dec",[`${c}
`,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;if(i){u=N.substitute(u,"varying","out").result,s=N.substitute(s,"varying","in").result;let f="",l=0;for(;s.includes(`gl_FragData[${l}]`);)s=N.substitute(s,`gl_FragData\\[${l}\\]`,`fragOutput${l}`).result,f+=`layout(location = ${l}) out vec4 fragOutput${l};
`,l++;s=N.substitute(s,"//VTK::Output::Dec",f).result}const g=N.substitute(a,"//VTK::System::Dec",c).result;return{VSSource:u,FSSource:s,GSSource:g}},t.readyShaderProgramArray=(n,r,a)=>{const s=t.replaceShaderValues(n,r,a),i=t.getShaderProgram(s.VSSource,s.FSSource,s.GSSource);return t.readyShaderProgram(i)},t.readyShaderProgram=n=>!n||!n.getCompiled()&&!n.compileShader()||!t.bindShaderProgram(n)?null:n,t.getShaderProgram=(n,r,a)=>{const s=`${n}${r}${a}`,i=cF.hash(s);if(!(i in e.shaderPrograms)){const o=N.newInstance();return o.setContext(e.context),o.getVertexShader().setSource(n),o.getFragmentShader().setSource(r),a&&o.getGeometryShader().setSource(a),o.setMd5Hash(i),e.shaderPrograms[i]=o,o}return e.shaderPrograms[i]},t.releaseGraphicsResources=n=>{t.releaseCurrentShaderProgram(),Object.keys(e.shaderPrograms).map(r=>e.shaderPrograms[r]).forEach(r=>r.cleanup()),e.shaderPrograms={}},t.releaseCurrentShaderProgram=()=>{e.lastShaderProgramBound&&(e.lastShaderProgramBound.cleanup(),e.lastShaderProgramBound=null)},t.bindShaderProgram=n=>(e.lastShaderProgramBound===n||(e.lastShaderProgramBound&&e.lastShaderProgramBound.release(),n.bind(),e.lastShaderProgramBound=n),1)}const gF={lastShaderProgramBound:null,shaderPrograms:null,context:null};function Td(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gF,n),e.shaderPrograms={},E.obj(t,e),E.setGet(t,e,fF),E.moveToProtected(t,e,["openGLRenderWindow"]),uF(t,e)}const lF=E.newInstance(Td,"vtkShaderCache");var pF={newInstance:lF,extend:Td};const{vtkErrorMacro:hF}=E;function dF(t,e){e.classHierarchy.push("vtkOpenGLTextureUnitManager"),t.deleteTable=()=>{for(let n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]===!0&&hF("some texture units  were not properly released");e.textureUnits=[],e.numberOfTextureUnits=0},t.setContext=n=>{if(e.context!==n){if(e.context!==0&&t.deleteTable(),e.context=n,e.context){e.numberOfTextureUnits=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS);for(let r=0;r<e.numberOfTextureUnits;++r)e.textureUnits[r]=!1}t.modified()}},t.allocate=()=>{for(let n=0;n<e.numberOfTextureUnits;n++)if(!t.isAllocated(n))return e.textureUnits[n]=!0,n;return-1},t.allocateUnit=n=>t.isAllocated(n)?-1:(e.textureUnits[n]=!0,n),t.isAllocated=n=>e.textureUnits[n],t.free=n=>{e.textureUnits[n]=!1},t.freeAll=()=>{for(let n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]=!1}}const vF={context:null,numberOfTextureUnits:0,textureUnits:0};function xd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vF,n),E.obj(t,e),e.textureUnits=[],E.get(t,e,["numberOfTextureUnits"]),E.setGet(t,e,["context"]),dF(t,e)}const yF=E.newInstance(xd,"vtkOpenGLTextureUnitManager");var TF={newInstance:yF,extend:xd};function xF(t,e){e.classHierarchy.push("vtkRenderWindowViewNode"),t.getViewNodeFactory=()=>null,t.getAspectRatio=()=>e.size[0]/e.size[1],t.getAspectRatioForRenderer=n=>{const r=n.getViewportByReference();return e.size[0]*(r[2]-r[0])/((r[3]-r[1])*e.size[1])},t.isInViewport=(n,r,a)=>{const s=a.getViewportByReference(),i=t.getFramebufferSize();return s[0]*i[0]<=n&&s[2]*i[0]>=n&&s[1]*i[1]<=r&&s[3]*i[1]>=r},t.getViewportSize=n=>{const r=n.getViewportByReference(),a=t.getFramebufferSize();return[(r[2]-r[0])*a[0],(r[3]-r[1])*a[1]]},t.getViewportCenter=n=>{const r=t.getViewportSize(n);return[r[0]*.5,r[1]*.5]},t.displayToNormalizedDisplay=(n,r,a)=>{const s=t.getFramebufferSize();return[n/s[0],r/s[1],a]},t.normalizedDisplayToDisplay=(n,r,a)=>{const s=t.getFramebufferSize();return[n*s[0],r*s[1],a]},t.worldToView=(n,r,a,s)=>s.worldToView(n,r,a),t.viewToWorld=(n,r,a,s)=>s.viewToWorld(n,r,a),t.worldToDisplay=(n,r,a,s)=>{const i=s.worldToView(n,r,a),o=t.getViewportSize(s),c=s.viewToProjection(i[0],i[1],i[2],o[0]/o[1]),u=s.projectionToNormalizedDisplay(c[0],c[1],c[2]);return t.normalizedDisplayToDisplay(u[0],u[1],u[2])},t.displayToWorld=(n,r,a,s)=>{const i=t.displayToNormalizedDisplay(n,r,a),o=s.normalizedDisplayToProjection(i[0],i[1],i[2]),c=t.getViewportSize(s),u=s.projectionToView(o[0],o[1],o[2],c[0]/c[1]);return s.viewToWorld(u[0],u[1],u[2])},t.normalizedDisplayToViewport=(n,r,a,s)=>{let i=s.getViewportByReference();i=t.normalizedDisplayToDisplay(i[0],i[1],0);const o=t.normalizedDisplayToDisplay(n,r,a);return[o[0]-i[0]-.5,o[1]-i[1]-.5,a]},t.viewportToNormalizedViewport=(n,r,a,s)=>{const i=t.getViewportSize(s);return i&&i[0]!==0&&i[1]!==0?[n/(i[0]-1),r/(i[1]-1),a]:[n,r,a]},t.normalizedViewportToViewport=(n,r,a,s)=>{const i=t.getViewportSize(s);return[n*(i[0]-1),r*(i[1]-1),a]},t.displayToLocalDisplay=(n,r,a)=>{const s=t.getFramebufferSize();return[n,s[1]-r-1,a]},t.viewportToNormalizedDisplay=(n,r,a,s)=>{let i=s.getViewportByReference();i=t.normalizedDisplayToDisplay(i[0],i[1],0);const o=n+i[0]+.5,c=r+i[1]+.5;return t.displayToNormalizedDisplay(o,c,a)},t.getComputedDevicePixelRatio=()=>e.size[0]/t.getContainerSize()[0],t.getContainerSize=()=>{E.vtkErrorMacro("not implemented")},t.getPixelData=(n,r,a,s)=>{E.vtkErrorMacro("not implemented")},t.createSelector=()=>{E.vtkErrorMacro("not implemented")}}const SF={size:void 0,selector:void 0};function Sd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,SF,n),e.size||(e.size=[300,300]),E.getArray(t,e,["size"],2),E.get(t,e,["selector"]),Be.extend(t,e,n),xF(t,e)}const CF=E.newInstance(Sd,"vtkRenderWindowViewNode");var Cd={newInstance:CF,extend:Sd};const wF="__getUnderlyingContext";function EF(){const t=new Map,e={apply(a,s,i){return t.has(i[0])?t.get(i[0]):a.apply(s,i)}};function n(a){return{apply(s,i,o){return t.set(a,o[0]),s.apply(i,o)}}}const r=Object.create(null);return r.getParameter=(a,s,i,o)=>new Proxy(o.bind(a),e),r.depthMask=(a,s,i,o)=>new Proxy(o.bind(a),n(a.DEPTH_WRITEMASK)),{get(a,s,i){if(s===wF)return()=>a;let o=Reflect.get(a,s,a);o instanceof Function&&(o=o.bind(a));const c=r[s];return c?c(a,s,i,o):o}}}const{vtkDebugMacro:Yg,vtkErrorMacro:qg}=E,RF={position:"absolute",top:0,left:0,width:"100%",height:"100%"},OF=["activateTexture","deactivateTexture","disableCullFace","enableCullFace","get3DContext","getActiveFramebuffer","getContext","getDefaultTextureByteSize","getDefaultTextureInternalFormat","getDefaultToWebgl2","getGLInformations","getGraphicsMemoryInfo","getGraphicsResourceForObject","getHardwareMaximumLineWidth","getPixelData","getShaderCache","getTextureUnitForTexture","getTextureUnitManager","getWebgl2","makeCurrent","releaseGraphicsResources","registerGraphicsResourceUser","unregisterGraphicsResourceUser","restoreContext","setActiveFramebuffer","setContext","setDefaultToWebgl2","setGraphicsResourceForObject"];function at(t,e,n){const r=t.createFramebuffer(),a=t.createTexture();t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,e,2,2,0,e,n,null),t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER);return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),s===t.FRAMEBUFFER_COMPLETE}let ui=0;const wd=[];function MF(){ui++,wd.forEach(t=>t(ui))}function DF(){ui--,wd.forEach(t=>t(ui))}function Qg(t){t.preventDefault()}function LF(t,e){e.classHierarchy.push("vtkOpenGLRenderWindow");let n;function r(){return n||(n=EF()),n}t.getViewNodeFactory=()=>e.myFactory,e.canvas.addEventListener("webglcontextlost",Qg,!1),e.canvas.addEventListener("webglcontextrestored",t.restoreContext,!1);const a=[0,0];function s(){e.renderable&&(e.size[0]!==a[0]||e.size[1]!==a[1])&&(a[0]=e.size[0],a[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1])),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(s),t.buildPass=f=>{if(f){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.addMissingNodes(e.renderable.getChildRenderWindowsByReference()),t.removeUnusedNodes(),t.initialize(),e.children.forEach(l=>{l.setOpenGLRenderWindow?.(t)})}},t.initialize=()=>{if(!e.initialized){if(e.rootOpenGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.rootOpenGLRenderWindow)e.context2D=t.get2DContext();else{e.context=t.get3DContext(),t.resizeFromChildRenderWindows(),e.context&&MF(),e.textureUnitManager=TF.newInstance(),e.textureUnitManager.setContext(e.context),e.shaderCache.setContext(e.context);const f=e.context;f.blendFuncSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA),f.depthFunc(f.LEQUAL),f.enable(f.BLEND)}e.initialized=!0}},t.makeCurrent=()=>{e.context.makeCurrent()},t.setContainer=f=>{e.el&&e.el!==f&&(e.canvas.parentNode!==e.el&&qg("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==f&&(e.el=f,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=()=>e.el,t.getContainerSize=()=>{if(!e.containerSize&&e.el){const{width:f,height:l}=e.el.getBoundingClientRect();e.containerSize=[f,l]}return e.containerSize||e.size},t.getFramebufferSize=()=>e.activeFramebuffer?.getSize()||e.size,t.getPixelData=(f,l,p,v)=>{const h=new Uint8Array((p-f+1)*(v-l+1)*4);return e.context.readPixels(f,l,p-f+1,v-l+1,e.context.RGBA,e.context.UNSIGNED_BYTE,h),h},t.get3DContext=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{preserveDrawingBuffer:!1,depth:!0,alpha:!0,powerPreference:"high-performance"},l=null;const p=typeof WebGL2RenderingContext<"u";return e.webgl2=!1,e.defaultToWebgl2&&p&&(l=e.canvas.getContext("webgl2",f),l&&(e.webgl2=!0,Yg("using webgl2"))),l||(Yg("using webgl1"),l=e.canvas.getContext("webgl",f)||e.canvas.getContext("experimental-webgl",f)),new Proxy(l,r())},t.get2DContext=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e.canvas.getContext("2d",f)},t.restoreContext=()=>{const f=Cn.newInstance();f.setCurrentOperation("Release"),f.traverse(t,null)},t.activateTexture=f=>{const l=e._textureResourceIds.get(f);if(l!==void 0){e.context.activeTexture(e.context.TEXTURE0+l);return}const p=t.getTextureUnitManager().allocate();if(p<0){qg("Hardware does not support the number of textures defined.");return}e._textureResourceIds.set(f,p),e.context.activeTexture(e.context.TEXTURE0+p)},t.deactivateTexture=f=>{const l=e._textureResourceIds.get(f);l!==void 0&&(t.getTextureUnitManager().free(l),e._textureResourceIds.delete(f))},t.getTextureUnitForTexture=f=>{const l=e._textureResourceIds.get(f);return l!==void 0?l:-1},t.getDefaultTextureByteSize=function(f){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e.webgl2)switch(f){case Pe.CHAR:case Pe.SIGNED_CHAR:case Pe.UNSIGNED_CHAR:return 1;case l:case p:case Pe.UNSIGNED_SHORT:case Pe.SHORT:case Pe.VOID:return 2;default:return 4}return 1},t.getDefaultTextureInternalFormat=function(f,l){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e.webgl2)switch(f){case Pe.UNSIGNED_CHAR:switch(l){case 1:return e.context.R8;case 2:return e.context.RG8;case 3:return e.context.RGB8;case 4:default:return e.context.RGBA8}case(p&&!v&&Pe.UNSIGNED_SHORT):switch(l){case 1:return p.R16_EXT;case 2:return p.RG16_EXT;case 3:return p.RGB16_EXT;case 4:default:return p.RGBA16_EXT}case(p&&!v&&Pe.SHORT):switch(l){case 1:return p.R16_SNORM_EXT;case 2:return p.RG16_SNORM_EXT;case 3:return p.RGB16_SNORM_EXT;case 4:default:return p.RGBA16_SNORM_EXT}case Pe.UNSIGNED_SHORT:case Pe.SHORT:case Pe.FLOAT:default:switch(l){case 1:return v?e.context.R16F:e.context.R32F;case 2:return v?e.context.RG16F:e.context.RG32F;case 3:return v?e.context.RGB16F:e.context.RGB32F;case 4:default:return v?e.context.RGBA16F:e.context.RGBA32F}}switch(l){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:default:return e.context.RGBA}},t.setBackgroundImage=f=>{e.bgImage.src=f.src},t.setUseBackgroundImage=f=>{e.useBackgroundImage=f,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};function i(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.imageFormat;const l=document.createElement("canvas"),p=l.getContext("2d");l.width=e.canvas.width,l.height=e.canvas.height,p.drawImage(e.canvas,0,0);const v=e.canvas.getBoundingClientRect();e.renderable.getRenderers().forEach(S=>{S.getViewProps().forEach(y=>{if(y.getContainer){const w=y.getContainer().getElementsByTagName("canvas");for(let R=0;R<w.length;R++){const O=w[R],V=O.getBoundingClientRect(),L=V.x-v.x,m=V.y-v.y;p.drawImage(O,L,m)}}})});const T=l.toDataURL(f);l.remove(),t.invokeImageReady(T)}t.captureNextImage=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",{resetCamera:l=!1,size:p=null,scale:v=1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.deleted)return null;e.imageFormat=f;const h=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:p||v!==1?p||e.size.map(d=>d*v):null},new Promise((d,T)=>{const S=t.onImageReady(x=>{if(e._screenshot.size===null)e.notifyStartCaptureImage=h,S.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(y=>{let{restoreParamsFn:C,arg:w}=y;return C(w)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),d(x);else{const y=document.createElement("img");if(y.style=RF,y.src=x,e._screenshot.placeHolder=e.el.appendChild(y),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e.rootOpenGLRenderWindow?.resizeFromChildRenderWindows(),e._screenshot.size=null,t.modified(),l){const C=l!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(w=>{const R=w.getActiveCamera(),O=R.get("focalPoint","position","parallelScale");return{resetCameraArgs:C?{renderer:w}:void 0,resetCameraFn:C?l:w.resetCamera,restoreParamsFn:R.set,arg:JSON.parse(JSON.stringify(O))}}),e._screenshot.cameras.forEach(w=>{let{resetCameraFn:R,resetCameraArgs:O}=w;return R(O)})}t.traverseAllPasses()}})})};let o;t.getHardwareMaximumLineWidth=()=>{if(o!=null)return o;const f=t.get3DContext(),l=f.getParameter(f.ALIASED_LINE_WIDTH_RANGE);return o=l[1],l[1]},t.getGLInformations=()=>{if(e._glInformation)return e._glInformation;const f=t.get3DContext(),l=f.getExtension("OES_texture_float"),p=f.getExtension("OES_texture_half_float"),v=f.getExtension("WEBGL_debug_renderer_info"),h=f.getExtension("WEBGL_draw_buffers"),d=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),T=[["Max Vertex Attributes","MAX_VERTEX_ATTRIBS",f.getParameter(f.MAX_VERTEX_ATTRIBS)],["Max Varying Vectors","MAX_VARYING_VECTORS",f.getParameter(f.MAX_VARYING_VECTORS)],["Max Vertex Uniform Vectors","MAX_VERTEX_UNIFORM_VECTORS",f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS)],["Max Fragment Uniform Vectors","MAX_FRAGMENT_UNIFORM_VECTORS",f.getParameter(f.MAX_FRAGMENT_UNIFORM_VECTORS)],["Max Fragment Texture Image Units","MAX_TEXTURE_IMAGE_UNITS",f.getParameter(f.MAX_TEXTURE_IMAGE_UNITS)],["Max Vertex Texture Image Units","MAX_VERTEX_TEXTURE_IMAGE_UNITS",f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS)],["Max Combined Texture Image Units","MAX_COMBINED_TEXTURE_IMAGE_UNITS",f.getParameter(f.MAX_COMBINED_TEXTURE_IMAGE_UNITS)],["Max 2D Texture Size","MAX_TEXTURE_SIZE",f.getParameter(f.MAX_TEXTURE_SIZE)],["Max Cube Texture Size","MAX_CUBE_MAP_TEXTURE_SIZE",f.getParameter(f.MAX_CUBE_MAP_TEXTURE_SIZE)],["Max Texture Anisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT",d&&f.getParameter(d.MAX_TEXTURE_MAX_ANISOTROPY_EXT)],["Point Size Range","ALIASED_POINT_SIZE_RANGE",f.getParameter(f.ALIASED_POINT_SIZE_RANGE).join(" - ")],["Line Width Range","ALIASED_LINE_WIDTH_RANGE",f.getParameter(f.ALIASED_LINE_WIDTH_RANGE).join(" - ")],["Max Viewport Dimensions","MAX_VIEWPORT_DIMS",f.getParameter(f.MAX_VIEWPORT_DIMS).join(" - ")],["Max Renderbuffer Size","MAX_RENDERBUFFER_SIZE",f.getParameter(f.MAX_RENDERBUFFER_SIZE)],["Framebuffer Red Bits","RED_BITS",f.getParameter(f.RED_BITS)],["Framebuffer Green Bits","GREEN_BITS",f.getParameter(f.GREEN_BITS)],["Framebuffer Blue Bits","BLUE_BITS",f.getParameter(f.BLUE_BITS)],["Framebuffer Alpha Bits","ALPHA_BITS",f.getParameter(f.ALPHA_BITS)],["Framebuffer Depth Bits","DEPTH_BITS",f.getParameter(f.DEPTH_BITS)],["Framebuffer Stencil Bits","STENCIL_BITS",f.getParameter(f.STENCIL_BITS)],["Framebuffer Subpixel Bits","SUBPIXEL_BITS",f.getParameter(f.SUBPIXEL_BITS)],["MSAA Samples","SAMPLES",f.getParameter(f.SAMPLES)],["MSAA Sample Buffers","SAMPLE_BUFFERS",f.getParameter(f.SAMPLE_BUFFERS)],["Supported Formats for UByte Render Targets     ","UNSIGNED_BYTE RENDER TARGET FORMATS",[l&&at(f,f.RGBA,f.UNSIGNED_BYTE)?"RGBA":"",l&&at(f,f.RGB,f.UNSIGNED_BYTE)?"RGB":"",l&&at(f,f.LUMINANCE,f.UNSIGNED_BYTE)?"LUMINANCE":"",l&&at(f,f.ALPHA,f.UNSIGNED_BYTE)?"ALPHA":"",l&&at(f,f.LUMINANCE_ALPHA,f.UNSIGNED_BYTE)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Half Float Render Targets","HALF FLOAT RENDER TARGET FORMATS",[p&&at(f,f.RGBA,p.HALF_FLOAT_OES)?"RGBA":"",p&&at(f,f.RGB,p.HALF_FLOAT_OES)?"RGB":"",p&&at(f,f.LUMINANCE,p.HALF_FLOAT_OES)?"LUMINANCE":"",p&&at(f,f.ALPHA,p.HALF_FLOAT_OES)?"ALPHA":"",p&&at(f,f.LUMINANCE_ALPHA,p.HALF_FLOAT_OES)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Full Float Render Targets","FLOAT RENDER TARGET FORMATS",[l&&at(f,f.RGBA,f.FLOAT)?"RGBA":"",l&&at(f,f.RGB,f.FLOAT)?"RGB":"",l&&at(f,f.LUMINANCE,f.FLOAT)?"LUMINANCE":"",l&&at(f,f.ALPHA,f.FLOAT)?"ALPHA":"",l&&at(f,f.LUMINANCE_ALPHA,f.FLOAT)?"LUMINANCE_ALPHA":""].join(" ")],["Max Multiple Render Targets Buffers","MAX_DRAW_BUFFERS_WEBGL",h?f.getParameter(h.MAX_DRAW_BUFFERS_WEBGL):0],["High Float Precision in Vertex Shader","HIGH_FLOAT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Vertex Shader","MEDIUM_FLOAT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Vertex Shader","LOW_FLOAT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Float Precision in Fragment Shader","HIGH_FLOAT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Fragment Shader","MEDIUM_FLOAT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Fragment Shader","LOW_FLOAT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Int Precision in Vertex Shader","HIGH_INT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Vertex Shader","MEDIUM_INT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Vertex Shader","LOW_INT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT).rangeMax,"</sup>)"].join("")],["High Int Precision in Fragment Shader","HIGH_INT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Fragment Shader","MEDIUM_INT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Fragment Shader","LOW_INT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_INT).rangeMax,"</sup>)"].join("")],["Supported Extensions","EXTENSIONS",f.getSupportedExtensions().join("<br/>					    ")],["WebGL Renderer","RENDERER",f.getParameter(f.RENDERER)],["WebGL Vendor","VENDOR",f.getParameter(f.VENDOR)],["WebGL Version","VERSION",f.getParameter(f.VERSION)],["Shading Language Version","SHADING_LANGUAGE_VERSION",f.getParameter(f.SHADING_LANGUAGE_VERSION)],["Unmasked Renderer","UNMASKED_RENDERER",v&&f.getParameter(v.UNMASKED_RENDERER_WEBGL)],["Unmasked Vendor","UNMASKED_VENDOR",v&&f.getParameter(v.UNMASKED_VENDOR_WEBGL)],["WebGL Version","WEBGL_VERSION",e.webgl2?2:1]],S={};for(;T.length;){const[x,y,C]=T.pop();y&&(S[y]={label:x,value:C})}return e._glInformation=S,S},t.traverseAllPasses=()=>{if(e.renderPasses)for(let l=0;l<e.renderPasses.length;++l)e.renderPasses[l].traverse(t,null);t.copyParentContent(),e.notifyStartCaptureImage&&i();const f=e.renderable.getChildRenderWindowsByReference();for(let l=0;l<f.length;++l)t.getViewNodeFor(f[l])?.traverseAllPasses()},t.copyParentContent=()=>{const f=e.rootOpenGLRenderWindow;if(!f||!e.context2D||e.children.some(v=>!!v.getSelector?.()))return;const l=f.getCanvas(),p=e.canvas;e.context2D.drawImage(l,0,l.height-p.height,p.width,p.height,0,0,p.width,p.height)},t.resizeFromChildRenderWindows=()=>{const f=e.renderable.getChildRenderWindowsByReference();if(f.length>0){const l=[0,0];for(let p=0;p<f.length;++p){const v=t.getViewNodeFor(f[p])?.getSize();v&&(l[0]=v[0]>l[0]?v[0]:l[0],l[1]=v[1]>l[1]?v[1]:l[1])}t.setSize(...l)}},t.disableCullFace=()=>{e.cullFaceEnabled&&(e.context.disable(e.context.CULL_FACE),e.cullFaceEnabled=!1)},t.enableCullFace=()=>{e.cullFaceEnabled||(e.context.enable(e.context.CULL_FACE),e.cullFaceEnabled=!0)},t.setViewStream=f=>{if(e.viewStream===f)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=f,e.viewStream){const l=e.renderable.getRenderers()[0];l.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(p=>t.setBackgroundImage(p.image)),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.createSelector=()=>{const f=yd.newInstance();return f.setOpenGLRenderWindow(t),f};function c(){e.canvas.removeEventListener("webglcontextlost",Qg),e.canvas.removeEventListener("webglcontextrestored",t.restoreContext)}t.delete=E.chain(()=>{e.context&&DF(),t.setContainer(),t.setViewStream()},c,t.delete),t.setActiveFramebuffer=f=>{e.activeFramebuffer=f};const u=t.setSize;t.setSize=(f,l)=>{const p=u(f,l);return p&&t.invokeWindowResizeEvent({width:f,height:l}),p},t.registerGraphicsResourceUser=(f,l)=>{e._graphicsResources.has(f)||t.setGraphicsResourceForObject(f,null,null),e._graphicsResources.get(f)?.users.add(l)},t.unregisterGraphicsResourceUser=(f,l)=>{const p=e._graphicsResources.get(f);p&&(p.users.delete(l),p.users.size||(p.oglObject?.releaseGraphicsResources(t),e._graphicsResources.delete(f)))},t.getGraphicsResourceForObject=f=>e._graphicsResources.get(f),t.setGraphicsResourceForObject=(f,l,p)=>{if(!f)return;const v=e._graphicsResources.get(f);v?.oglObject?.releaseGraphicsResources(t),e._graphicsResources.set(f,{coreObject:f,oglObject:l,hash:p,users:v?.users??new Set})},t.getGraphicsMemoryInfo=()=>{let f=0;return e._graphicsResources.forEach(l=>{let{oglObject:p}=l;f+=p.getAllocatedGPUMemoryInBytes()}),f},t.releaseGraphicsResources=()=>{e.shaderCache!==null&&e.shaderCache.releaseGraphicsResources(t),e._graphicsResources.forEach(f=>{let{oglObject:l}=f;l.releaseGraphicsResources(t)}),e._graphicsResources.clear(),e.textureUnitManager!==null&&e.textureUnitManager.freeAll(),e.renderable.getRenderersByReference().forEach(f=>{t.getViewNodeFor(f)?.releaseGraphicsResources()})};const g={...t};OF.forEach(f=>{t[f]=function(){return e.rootOpenGLRenderWindow?e.rootOpenGLRenderWindow[f](...arguments):g[f](...arguments)}})}const mF={cullFaceEnabled:!1,shaderCache:null,initialized:!1,context:null,context2D:null,canvas:null,cursorVisibility:!0,cursor:"pointer",textureUnitManager:null,textureResourceIds:null,containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,webgl2:!1,defaultToWebgl2:!0,activeFramebuffer:null,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1};function VF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mF,n),Cd.extend(t,e,n),e.canvas||(e.canvas=document.createElement("canvas"),e.canvas.style.width="100%"),e.selector||(e.selector=yd.newInstance(),e.selector.setOpenGLRenderWindow(t)),e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",e._textureResourceIds=new Map,e._graphicsResources=new Map,e._glInformation=null,e.myFactory=gS.newInstance(),e.shaderCache=pF.newInstance(),e.shaderCache.setOpenGLRenderWindow(t),e.renderPasses[0]=AV.newInstance(),E.get(t,e,["shaderCache","textureUnitManager","webgl2","useBackgroundImage","activeFramebuffer","rootOpenGLRenderWindow"]),E.setGet(t,e,["initialized","context","context2D","canvas","renderPasses","notifyStartCaptureImage","defaultToWebgl2","cursor","useOffScreen"]),E.setGetArray(t,e,["size"],2),E.event(t,e,"imageReady"),E.event(t,e,"windowResizeEvent"),LF(t,e)}const Ed=E.newInstance(VF,"vtkOpenGLRenderWindow");Cf("WebGL",Ed);Ft("vtkRenderWindow",Ed);const Eo=["setBindGroup","setIndexBuffer","setVertexBuffer","draw","drawIndexed"];function FF(t,e){e.classHierarchy.push("vtkWebGPURenderEncoder"),t.begin=n=>{e.drawCallbacks=[],e.handle=n.beginRenderPass(e.description),e.label&&e.handle.pushDebugGroup(e.label)},t.end=()=>{for(let n=0;n<e.drawCallbacks.length;n++){const r=e.drawCallbacks[n],a=r.pipeline;t.setPipeline(a);for(let s=0;s<r.callbacks.length;s++)r.callbacks[s](t)}e.label&&e.handle.popDebugGroup(),e.handle.end(),e.boundPipeline=null},t.setPipeline=n=>{if(e.boundPipeline===n)return;e.handle.setPipeline(n.getHandle());const r=n.getPipelineDescription();if(e.colorTextureViews.length!==r.fragment.targets.length)console.log(`mismatched attachment counts on pipeline ${r.fragment.targets.length} while encoder has ${e.colorTextureViews.length}`),console.trace();else for(let a=0;a<e.colorTextureViews.length;a++){const s=e.colorTextureViews[a].getTexture()?.getFormat();s&&s!==r.fragment.targets[a].format&&(console.log(`mismatched attachments for attachment ${a} on pipeline ${r.fragment.targets[a].format} while encoder has ${s}`),console.trace())}if(!e.depthTextureView!=!("depthStencil"in r))console.log("mismatched depth attachments"),console.trace();else if(e.depthTextureView){const a=e.depthTextureView.getTexture()?.getFormat();a&&a!==r.depthStencil.format&&(console.log(`mismatched depth attachments on pipeline ${r.depthStencil.format} while encoder has ${a}`),console.trace())}e.boundPipeline=n},t.replaceShaderCode=n=>{e.replaceShaderCodeFunction(n)},t.setColorTextureView=(n,r)=>{e.colorTextureViews[n]!==r&&(e.colorTextureViews[n]=r)},t.activateBindGroup=n=>{const r=e.boundPipeline.getDevice(),a=e.boundPipeline.getBindGroupLayoutCount(n.getLabel());e.handle.setBindGroup(a,n.getBindGroup(r));const s=r.getBindGroupLayoutDescription(n.getBindGroupLayout(r)),i=r.getBindGroupLayoutDescription(e.boundPipeline.getBindGroupLayout(a));s!==i&&(console.log(`renderEncoder ${e.pipelineHash} mismatched bind group layouts bind group has
${s}
 versus pipeline
${i}
`),console.trace())},t.attachTextureViews=()=>{for(let n=0;n<e.colorTextureViews.length;n++)e.description.colorAttachments[n]?e.description.colorAttachments[n].view=e.colorTextureViews[n].getHandle():e.description.colorAttachments[n]={view:e.colorTextureViews[n].getHandle()};e.depthTextureView&&(e.description.depthStencilAttachment.view=e.depthTextureView.getHandle())},t.registerDrawCallback=(n,r)=>{for(let a=0;a<e.drawCallbacks.length;a++)if(e.drawCallbacks[a].pipeline===n){e.drawCallbacks[a].callbacks.push(r);return}e.drawCallbacks.push({pipeline:n,callbacks:[r]})};for(let n=0;n<Eo.length;n++)t[Eo[n]]=function(){return e.handle[Eo[n]](...arguments)}}const BF={description:null,handle:null,boundPipeline:null,pipelineHash:null,pipelineSettings:null,replaceShaderCodeFunction:null,depthTextureView:null,label:null};function Rd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,BF,n),qe(t,e),e.description={colorAttachments:[{view:void 0,loadOp:"load",storeOp:"store"}],depthStencilAttachment:{view:void 0,depthLoadOp:"clear",depthClearValue:0,depthStoreOp:"store"}},e.replaceShaderCodeFunction=r=>{const a=r.getShaderDescription("fragment");a.addOutput("vec4<f32>","outColor");let s=a.getCode();s=ae.substitute(s,"//VTK::RenderEncoder::Impl",["output.outColor = computedColor;"]).result,a.setCode(s)},e.pipelineSettings={primitive:{cullMode:"none"},depthStencil:{depthWriteEnabled:!0,depthCompare:"greater-equal",format:"depth32float"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}},e.colorTextureViews=[],pt(t,e,["boundPipeline","colorTextureViews"]),He(t,e,["depthTextureView","description","handle","label","pipelineHash","pipelineSettings","replaceShaderCodeFunction"]),FF(t,e)}const _F=we(Rd,"vtkWebGPURenderEncoder");var pn={newInstance:_F,extend:Rd};function UF(t,e){e.classHierarchy.push("vtkWebGPUOpaquePass"),t.traverse=(n,r)=>{if(e.deleted)return;e._currentParent=r;const a=r.getDevice();if(e.renderEncoder)e.colorTexture.resize(r.getCanvas().width,r.getCanvas().height),e.depthTexture.resize(r.getCanvas().width,r.getCanvas().height);else{t.createRenderEncoder(),e.colorTexture=en.newInstance({label:"opaquePassColor"}),e.colorTexture.create(a,{width:r.getCanvas().width,height:r.getCanvas().height,format:"rgba16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC});const s=e.colorTexture.createView("opaquePassColorTexture");e.renderEncoder.setColorTextureView(0,s),e.depthFormat="depth32float",e.depthTexture=en.newInstance({label:"opaquePassDepth"}),e.depthTexture.create(a,{width:r.getCanvas().width,height:r.getCanvas().height,format:e.depthFormat,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC});const i=e.depthTexture.createView("opaquePassDepthTexture");e.renderEncoder.setDepthTextureView(i)}e.renderEncoder.attachTextureViews(),t.setCurrentOperation("opaquePass"),n.setRenderEncoder(e.renderEncoder),n.traverse(t)},t.getColorTextureView=()=>e.renderEncoder.getColorTextureViews()[0],t.getDepthTextureView=()=>e.renderEncoder.getDepthTextureView(),t.createRenderEncoder=()=>{e.renderEncoder=pn.newInstance({label:"OpaquePass"}),e.renderEncoder.setPipelineHash("op")}}const NF={renderEncoder:null,colorTexture:null,depthTexture:null};function Od(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,NF,n),Cn.extend(t,e,n),E.get(t,e,["colorTexture","depthTexture"]),UF(t,e)}const kF=E.newInstance(Od,"vtkWebGPUOpaquePass");var GF={newInstance:kF,extend:Od};const bF=`
//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec2<i32> = vec2<i32>(i32(input.fragPos.x), i32(input.fragPos.y));
  var reveal: f32 = textureLoad(oitpAccumTexture, tcoord, 0).r;
  if (reveal == 1.0) { discard; }
  var tcolor: vec4<f32> = textureLoad(oitpColorTexture, tcoord, 0);
  var total: f32 = max(tcolor.a, 0.01);
  var computedColor: vec4<f32> = vec4<f32>(tcolor.r/total, tcolor.g/total, tcolor.b/total, 1.0 - reveal);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function $F(t,e){e.classHierarchy.push("vtkWebGPUOrderIndependentTranslucentPass"),t.traverse=(n,r)=>{if(e.deleted)return;e._currentParent=r;const a=r.getDevice();if(e.translucentRenderEncoder)e.translucentColorTexture.resizeToMatch(e.colorTextureView.getTexture()),e.translucentAccumulateTexture.resizeToMatch(e.colorTextureView.getTexture());else{t.createRenderEncoder(),t.createFinalEncoder(),e.translucentColorTexture=en.newInstance({label:"translucentPassColor"}),e.translucentColorTexture.create(a,{width:r.getCanvas().width,height:r.getCanvas().height,format:"rgba16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});const s=e.translucentColorTexture.createView("oitpColorTexture");e.translucentRenderEncoder.setColorTextureView(0,s),e.translucentAccumulateTexture=en.newInstance({label:"translucentPassAccumulate"}),e.translucentAccumulateTexture.create(a,{width:r.getCanvas().width,height:r.getCanvas().height,format:"r16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});const i=e.translucentAccumulateTexture.createView("oitpAccumTexture");e.translucentRenderEncoder.setColorTextureView(1,i),e.fullScreenQuad=jr.newInstance(),e.fullScreenQuad.setDevice(r.getDevice()),e.fullScreenQuad.setPipelineHash("oitpfsq"),e.fullScreenQuad.setTextureViews(e.translucentRenderEncoder.getColorTextureViews()),e.fullScreenQuad.setFragmentShaderTemplate(bF)}e.translucentRenderEncoder.setDepthTextureView(e.depthTextureView),e.translucentRenderEncoder.attachTextureViews(),t.setCurrentOperation("translucentPass"),n.setRenderEncoder(e.translucentRenderEncoder),n.traverse(t),t.finalPass(r,n)},t.finalPass=(n,r)=>{e.translucentFinalEncoder.setColorTextureView(0,e.colorTextureView),e.translucentFinalEncoder.attachTextureViews(),e.translucentFinalEncoder.begin(n.getCommandEncoder()),r.scissorAndViewport(e.translucentFinalEncoder),e.fullScreenQuad.prepareAndDraw(e.translucentFinalEncoder),e.translucentFinalEncoder.end()},t.getTextures=()=>[e.translucentColorTexture,e.translucentAccumulateTexture],t.createRenderEncoder=()=>{e.translucentRenderEncoder=pn.newInstance({label:"translucentRender"});const n=e.translucentRenderEncoder.getDescription();n.colorAttachments=[{view:void 0,clearValue:[0,0,0,0],loadOp:"clear",storeOp:"store"},{view:void 0,clearValue:[1,0,0,0],loadOp:"clear",storeOp:"store"}],n.depthStencilAttachment={view:void 0,depthLoadOp:"load",depthStoreOp:"store"},e.translucentRenderEncoder.setReplaceShaderCodeFunction(r=>{const a=r.getShaderDescription("fragment");a.addOutput("vec4<f32>","outColor"),a.addOutput("f32","outAccum"),a.addBuiltinInput("vec4<f32>","@builtin(position) fragPos");let s=a.getCode();s=ae.substitute(s,"//VTK::RenderEncoder::Impl",["var w: f32 = computedColor.a * pow(0.1 + input.fragPos.z, 2.0);","output.outColor = vec4<f32>(computedColor.rgb*w, w);","output.outAccum = computedColor.a;"]).result,a.setCode(s)}),e.translucentRenderEncoder.setPipelineHash("oitpr"),e.translucentRenderEncoder.setPipelineSettings({primitive:{cullMode:"none"},depthStencil:{depthWriteEnabled:!1,depthCompare:"greater",format:"depth32float"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"one",dstFactor:"one"},alpha:{srcFactor:"one",dstFactor:"one"}}},{format:"r16float",blend:{color:{srcFactor:"zero",dstFactor:"one-minus-src"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.createFinalEncoder=()=>{e.translucentFinalEncoder=pn.newInstance({label:"translucentFinal"}),e.translucentFinalEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e.translucentFinalEncoder.setReplaceShaderCodeFunction(n=>{const r=n.getShaderDescription("fragment");r.addOutput("vec4<f32>","outColor"),r.addBuiltinInput("vec4<f32>","@builtin(position) fragPos");let a=r.getCode();a=ae.substitute(a,"//VTK::RenderEncoder::Impl",["output.outColor = vec4<f32>(computedColor.rgb, computedColor.a);"]).result,r.setCode(a)}),e.translucentFinalEncoder.setPipelineHash("oitpf"),e.translucentFinalEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})}}const WF={colorTextureView:null,depthTextureView:null};function Md(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,WF,n),Cn.extend(t,e,n),E.setGet(t,e,["colorTextureView","depthTextureView"]),$F(t,e)}const zF=E.newInstance(Md,"vtkWebGPUOrderIndependentTranslucentPass");var HF={newInstance:zF,extend:Md};const Dr={COMPOSITE_BLEND:0,MAXIMUM_INTENSITY_BLEND:1,MINIMUM_INTENSITY_BLEND:2,AVERAGE_INTENSITY_BLEND:3,ADDITIVE_INTENSITY_BLEND:4},AF=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::Volume::TraverseDec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

fn getTextureValue(vTex: texture_3d<f32>, tpos: vec4<f32>) -> f32
{
  // todo multicomponent support
  return textureSampleLevel(vTex, clampSampler, tpos.xyz, 0.0).r;
}

fn getGradient(vTex: texture_3d<f32>, tpos: vec4<f32>, vNum: i32, scalar: f32) -> vec4<f32>
{
  var result: vec4<f32>;

  var tstep: vec4<f32> = volumeSSBO.values[vNum].tstep;
  result.x = getTextureValue(vTex, tpos + vec4<f32>(tstep.x, 0.0, 0.0, 1.0)) - scalar;
  result.y = getTextureValue(vTex, tpos + vec4<f32>(0.0, tstep.y, 0.0, 1.0)) - scalar;
  result.z = getTextureValue(vTex, tpos + vec4<f32>(0.0, 0.0, tstep.z, 1.0)) - scalar;
  result.w = 0.0;

  // divide by spacing as that is our delta
  result = result / volumeSSBO.values[vNum].spacing;
  // now we have a gradient in unit tcoords

  var grad: f32 = length(result.xyz);
  if (grad > 0.0)
  {
    // rotate to View Coords, needed for lighting and shading
    var nMat: mat4x4<f32> = rendererUBO.SCVCMatrix * volumeSSBO.values[vNum].planeNormals;
    result = nMat * result;
    result = result / length(result);
  }

  // store gradient magnitude in .w
  result.w = grad;

  return result;
}

fn processVolume(vTex: texture_3d<f32>, vNum: i32, cNum: i32, posSC: vec4<f32>, tfunRows: f32) -> vec4<f32>
{
  var outColor: vec4<f32> = vec4<f32>(0.0, 0.0, 0.0, 0.0);

  // convert to tcoords and reject if outside the volume
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*posSC;
  if (tpos.x < 0.0 || tpos.y < 0.0 || tpos.z < 0.0 ||
      tpos.x > 1.0 || tpos.y > 1.0 || tpos.z > 1.0) { return outColor; }

  var scalar: f32 = getTextureValue(vTex, tpos);

  var coord: vec2<f32> =
    vec2<f32>(scalar * componentSSBO.values[cNum].cScale + componentSSBO.values[cNum].cShift,
      (0.5 + 2.0 * f32(vNum)) / tfunRows);
  var color: vec4<f32> = textureSampleLevel(tfunTexture, clampSampler, coord, 0.0);

  var gofactor: f32 = 1.0;
  var normal: vec4<f32> = vec4<f32>(0.0,0.0,0.0,0.0);
  if (componentSSBO.values[cNum].gomin <  1.0 || volumeSSBO.values[vNum].shade[0] > 0.0)
  {
    normal = getGradient(vTex, tpos, vNum, scalar);
    if (componentSSBO.values[cNum].gomin <  1.0)
    {
      gofactor = clamp(normal.a*componentSSBO.values[cNum].goScale + componentSSBO.values[cNum].goShift,
      componentSSBO.values[cNum].gomin, componentSSBO.values[cNum].gomax);
    }
  }

  coord.x = (scalar * componentSSBO.values[cNum].oScale + componentSSBO.values[cNum].oShift);
  var opacity: f32 = textureSampleLevel(ofunTexture, clampSampler, coord, 0.0).r;

  if (volumeSSBO.values[vNum].shade[0] > 0.0)
  {
    color = color*abs(normal.z);
  }

  outColor = vec4<f32>(color.rgb, gofactor * opacity);

  return outColor;
}

// adjust the start and end point of a raycast such that it intersects the unit cube.
// This function is used to take a raycast starting point and step vector
// and numSteps and return the startijng and ending steps for intersecting the
// unit cube. Recall for a 3D texture, the unit cube is the range of texture coordsinates
// that have valid values. So this funtion can be used to take a ray in texture coordinates
// and bound it to intersecting the texture.
//
fn adjustBounds(tpos: vec4<f32>, tstep: vec4<f32>, numSteps: f32) -> vec2<f32>
{
  var result: vec2<f32> = vec2<f32>(0.0, numSteps);
  var tpos2: vec4<f32> = tpos + tstep*numSteps;

  // move tpos to the start of the volume
  var adjust: f32 =
    min(
      max(tpos.x/tstep.x, (tpos.x - 1.0)/tstep.x),
      min(
        max((tpos.y - 1.0)/tstep.y, tpos.y/tstep.y),
        max((tpos.z - 1.0)/tstep.z, tpos.z/tstep.z)));
  if (adjust < 0.0)
  {
    result.x = result.x - adjust;
  }

  // adjust length to the end
  adjust =
    max(
      min(tpos2.x/tstep.x, (tpos2.x - 1.0)/tstep.x),
      max(
        min((tpos2.y - 1.0)/tstep.y, tpos2.y/tstep.y),
        min((tpos2.z - 1.0)/tstep.z, tpos2.z/tstep.z)));
  if (adjust > 0.0)
  {
    result.y = result.y - adjust;
  }

  return result;
}

fn getSimpleColor(scalar: f32, vNum: i32, cNum: i32) -> vec4<f32>
{
  // how many rows (tfuns) do we have in our tfunTexture
  var tfunRows: f32 = f32(textureDimensions(tfunTexture).y);

  var coord: vec2<f32> =
    vec2<f32>(scalar * componentSSBO.values[cNum].cScale + componentSSBO.values[cNum].cShift,
      (0.5 + 2.0 * f32(vNum)) / tfunRows);
  var color: vec4<f32> = textureSampleLevel(tfunTexture, clampSampler, coord, 0.0);
  coord.x = (scalar * componentSSBO.values[cNum].oScale + componentSSBO.values[cNum].oShift);
  var opacity: f32 = textureSampleLevel(ofunTexture, clampSampler, coord, 0.0).r;
  return vec4<f32>(color.rgb, opacity);
}

fn traverseMax(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var maxVal: f32 = -1.0e37;
  loop
  {
    var scalar: f32 = getTextureValue(vTex, tpos);
    if (scalar > maxVal)
    {
      maxVal = scalar;
    }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(maxVal, vNum, cNum);
}

fn traverseMin(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var minVal: f32 = 1.0e37;
  loop
  {
    var scalar: f32 = getTextureValue(vTex, tpos);
    if (scalar < minVal)
    {
      minVal = scalar;
    }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(minVal, vNum, cNum);
}

fn traverseAverage(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  let ipRange: vec4<f32> = volumeSSBO.values[vNum].ipScalarRange;
  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var avgVal: f32 = 0.0;
  var sampleCount: f32 = 0.0;
  loop
  {
    var sample: f32 = getTextureValue(vTex, tpos);
    // right now leave filtering off until WebGL changes get merged
    // if (ipRange.z == 0.0 || sample >= ipRange.x && sample <= ipRange.y)
    // {
      avgVal = avgVal + sample;
      sampleCount = sampleCount + 1.0;
    // }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  if (sampleCount <= 0.0)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(avgVal/sampleCount, vNum, cNum);
}

fn traverseAdditive(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  let ipRange: vec4<f32> = volumeSSBO.values[vNum].ipScalarRange;
  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var sumVal: f32 = 0.0;
  loop
  {
    var sample: f32 = getTextureValue(vTex, tpos);
    // right now leave filtering off until WebGL changes get merged
    // if (ipRange.z == 0.0 || sample >= ipRange.x && sample <= ipRange.y)
    // {
      sumVal = sumVal + sample;
    // }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(sumVal, vNum, cNum);
}

fn composite(rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>) -> vec4<f32>
{
  // initial ray position is at the beginning
  var rayPosSC: vec4<f32> = minPosSC;

  // how many rows (tfuns) do we have in our tfunTexture
  var tfunRows: f32 = f32(textureDimensions(tfunTexture).y);

  var curDist: f32 = 0.0;
  var computedColor: vec4<f32> = vec4<f32>(0.0, 0.0, 0.0, 0.0);
  var sampleColor: vec4<f32>;
//VTK::Volume::TraverseCalls

  loop
  {
    // for each volume, sample and accumulate color
//VTK::Volume::CompositeCalls

    // increment position
    curDist = curDist + mapperUBO.SampleDistance;
    rayPosSC = rayPosSC + rayStepSC;

    // check if we have reached a terminating condition
    if (curDist > rayLengthSC) { break; }
    if (computedColor.a > 0.98) { break; }
  }
  return computedColor;
}

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var rayMax: f32 = textureSampleLevel(maxTexture, clampSampler, input.tcoordVS, 0.0).r;
  var rayMin: f32 = textureSampleLevel(minTexture, clampSampler, input.tcoordVS, 0.0).r;

  // discard empty rays
  if (rayMax <= rayMin) { discard; }
  else
  {
    // compute start and end ray positions in view coordinates
    var minPosSC: vec4<f32> = rendererUBO.PCSCMatrix*vec4<f32>(2.0 * input.tcoordVS.x - 1.0, 1.0 - 2.0 * input.tcoordVS.y, rayMax, 1.0);
    minPosSC = minPosSC * (1.0 / minPosSC.w);
    var maxPosSC: vec4<f32> = rendererUBO.PCSCMatrix*vec4<f32>(2.0 * input.tcoordVS.x - 1.0, 1.0 - 2.0 * input.tcoordVS.y, rayMin, 1.0);
    maxPosSC = maxPosSC * (1.0 / maxPosSC.w);

    var rayLengthSC: f32 = distance(minPosSC.xyz, maxPosSC.xyz);
    var rayStepSC: vec4<f32> = (maxPosSC - minPosSC)*(mapperUBO.SampleDistance/rayLengthSC);
    rayStepSC.w = 0.0;

    var computedColor: vec4<f32>;

//VTK::Volume::Loop

//VTK::RenderEncoder::Impl
  }

  return output;
}
`,st=new Float64Array(16),Dn=new Float64Array(16);function jF(t,e){e.classHierarchy.push("vtkWebGPUVolumePassFSQ"),t.replaceShaderPosition=(a,s,i)=>{const o=s.getShaderDescription("vertex");o.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let c=o.getCode();c=ae.substitute(c,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);"]).result,o.setCode(c),s.getShaderDescription("fragment").addBuiltinInput("vec4<f32>","@builtin(position) fragPos")},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderVolume=(a,s,i)=>{const o=s.getShaderDescription("fragment");let c=o.getCode();const u=[],g=[];for(let l=0;l<e.volumes.length;l++)e.volumes[l].getRenderable().getMapper().getBlendMode()===Dr.COMPOSITE_BLEND?(u.push(`    sampleColor = processVolume(volTexture${l}, ${l}, ${e.rowStarts[l]}, rayPosSC, tfunRows);`),u.push(`    computedColor = vec4<f32>(
          sampleColor.a * sampleColor.rgb * (1.0 - computedColor.a) + computedColor.rgb,
          (1.0 - computedColor.a)*sampleColor.a + computedColor.a);`)):(g.push(`  sampleColor = traverseVals[${l}];`),g.push(`  computedColor = vec4<f32>(
          sampleColor.a * sampleColor.rgb * (1.0 - computedColor.a) + computedColor.rgb,
          (1.0 - computedColor.a)*sampleColor.a + computedColor.a);`));c=ae.substitute(c,"//VTK::Volume::CompositeCalls",u).result,c=ae.substitute(c,"//VTK::Volume::TraverseCalls",g).result,c=ae.substitute(c,"//VTK::Volume::TraverseDec",[`var<private> traverseVals: array<vec4<f32>,${e.volumes.length}>;`]).result;let f=!1;for(let l=0;l<e.volumes.length;l++){const p=e.volumes[l].getRenderable().getMapper().getBlendMode();p===Dr.COMPOSITE_BLEND?f=!0:p===Dr.MAXIMUM_INTENSITY_BLEND?c=ae.substitute(c,"//VTK::Volume::Loop",[`    traverseMax(volTexture${l}, ${l}, ${l}, rayLengthSC, minPosSC, rayStepSC);`,`    computedColor = traverseVals[${l}];`,"//VTK::Volume::Loop"]).result:p===Dr.MINIMUM_INTENSITY_BLEND?c=ae.substitute(c,"//VTK::Volume::Loop",[`    traverseMin(volTexture${l}, ${l}, ${l}, rayLengthSC, minPosSC, rayStepSC);`,`    computedColor = traverseVals[${l}];`,"//VTK::Volume::Loop"]).result:p===Dr.AVERAGE_INTENSITY_BLEND?c=ae.substitute(c,"//VTK::Volume::Loop",[`    traverseAverage(volTexture${l}, ${l}, ${l}, rayLengthSC, minPosSC, rayStepSC);`,`    computedColor = traverseVals[${l}];`,"//VTK::Volume::Loop"]).result:p===Dr.ADDITIVE_INTENSITY_BLEND&&(c=ae.substitute(c,"//VTK::Volume::Loop",[`    traverseAdditive(volTexture${l}, ${l}, ${l}, rayLengthSC, minPosSC, rayStepSC);`,`    computedColor = traverseVals[${l}];`,"//VTK::Volume::Loop"]).result)}f&&(c=ae.substitute(c,"//VTK::Volume::Loop",["    computedColor = composite(rayLengthSC, minPosSC, rayStepSC);"]).result),o.setCode(c)},e.shaderReplacements.set("replaceShaderVolume",t.replaceShaderVolume),t.updateLUTImage=a=>{let s=t.getMTime();for(let f=0;f<e.volumes.length;f++){const l=e.volumes[f].getRenderable(),p=l.getMapper().getInputData();s=Math.max(s,l.getMTime(),p.getMTime())}if(s<e.lutBuildTime.getMTime())return;e.numRows=0,e.rowStarts=[];for(let f=0;f<e.volumes.length;f++){e.rowStarts.push(e.numRows);const p=e.volumes[f].getRenderable(),v=p.getMapper(),h=p.getProperty(),d=v.getInputData(),S=(d.getPointData()&&d.getPointData().getScalars()).getNumberOfComponents(),y=h.getIndependentComponents()?S:1;e.numRows+=y}const i=new Uint8ClampedArray(e.numRows*2*e.rowLength*4),o=new Float32Array(e.numRows*2*e.rowLength);let c=0;const u=new Float32Array(e.rowLength*3),g=e.rowLength;for(let f=0;f<e.volumes.length;f++){const p=e.volumes[f].getRenderable(),v=p.getMapper(),h=p.getProperty(),d=v.getInputData(),S=(d.getPointData()&&d.getPointData().getScalars()).getNumberOfComponents(),y=h.getIndependentComponents()?S:1;for(let C=0;C<y;++C){const w=h.getRGBTransferFunction(C),R=w.getRange();w.getTable(R[0],R[1],g,u,1);let O=c*g*4;for(let F=0;F<g;++F){i[O+F*4]=255*u[F*3],i[O+F*4+1]=255*u[F*3+1],i[O+F*4+2]=255*u[F*3+2],i[O+F*4+3]=255;for(let B=0;B<4;B++)i[O+(g+F)*4+B]=i[O+F*4+B]}const V=h.getScalarOpacity(C),L=e.sampleDist/h.getScalarOpacityUnitDistance(C),m=V.getRange();V.getTable(m[0],m[1],g,u,1),O=c*g;for(let F=0;F<g;++F)o[O+F]=1-(1-u[F])**L,o[O+F+g]=o[O+F];c+=2}}{const f={nativeArray:i,width:e.rowLength,height:e.numRows*2,depth:1,format:"rgba8unorm"},p=a.getTextureManager().getTexture(f).createView("tfunTexture");e.textureViews[2]=p}{const f={nativeArray:o,width:e.rowLength,height:e.numRows*2,depth:1,format:"r16float"},p=a.getTextureManager().getTexture(f).createView("ofunTexture");e.textureViews[3]=p}e.lutBuildTime.modified()},t.updateSSBO=a=>{let s=Math.max(t.getMTime(),e.WebGPURenderer.getStabilizedTime());for(let w=0;w<e.volumes.length;w++){const R=e.volumes[w].getRenderable(),O=R.getMapper(),V=O.getInputData();s=Math.max(s,R.getMTime(),V.getMTime(),O.getMTime())}if(s<e.SSBO.getSendTime())return;const i=e.WebGPURenderer.getStabilizedCenterByReference();e.SSBO.clearData(),e.SSBO.setNumberOfInstances(e.volumes.length);const o=new Float64Array(e.volumes.length*16),c=new Float64Array(e.volumes.length*16),u=new Float64Array(e.volumes.length*4),g=new Float64Array(e.volumes.length*4),f=new Float64Array(e.volumes.length*4),l=new Float64Array(e.volumes.length*4);for(let w=0;w<e.volumes.length;w++){const O=e.volumes[w].getRenderable(),L=O.getMapper().getInputData();ue(st),Ue(st,st,i);const m=O.getMatrix();De(Dn,m),ut(Dn,Dn),Ne(st,Dn,st);const F=L.getWorldToIndex();Ne(st,F,st);const B=L.getDimensions();ue(Dn),pr(Dn,Dn,[1/B[0],1/B[1],1/B[2]]),Ne(st,Dn,st);for(let A=0;A<16;A++)o[w*16+A]=st[A];ut(st,st);for(let A=0;A<4;A++)c[w*16+A*4]=st[A*4],c[w*16+A*4+1]=st[A*4+1],c[w*16+A*4+2]=st[A*4+2],c[w*16+A*4+3]=0;u[w*4]=1/B[0],u[w*4+1]=1/B[1],u[w*4+2]=1/B[2],u[w*4+3]=1,g[w*4]=O.getProperty().getShade()?1:0;const _=L.getSpacing();f[w*4]=_[0],f[w*4+1]=_[1],f[w*4+2]=_[2],f[w*4+3]=1;const P=e.textureViews[w+4].getTexture().getScale(),z=O.getProperty().getIpScalarRange();l[w*4]=z[0]/P,l[w*4+1]=z[1]/P,l[w*4+2]=O.getProperty().getFilterMode()}e.SSBO.addEntry("SCTCMatrix","mat4x4<f32>"),e.SSBO.addEntry("planeNormals","mat4x4<f32>"),e.SSBO.addEntry("shade","vec4<f32>"),e.SSBO.addEntry("tstep","vec4<f32>"),e.SSBO.addEntry("spacing","vec4<f32>"),e.SSBO.addEntry("ipScalarRange","vec4<f32>"),e.SSBO.setAllInstancesFromArray("SCTCMatrix",o),e.SSBO.setAllInstancesFromArray("planeNormals",c),e.SSBO.setAllInstancesFromArray("shade",g),e.SSBO.setAllInstancesFromArray("tstep",u),e.SSBO.setAllInstancesFromArray("spacing",f),e.SSBO.setAllInstancesFromArray("ipScalarRange",l),e.SSBO.send(a),e.componentSSBO.clearData(),e.componentSSBO.setNumberOfInstances(e.numRows);const p=new Float64Array(e.numRows),v=new Float64Array(e.numRows),h=new Float64Array(e.numRows),d=new Float64Array(e.numRows),T=new Float64Array(e.numRows),S=new Float64Array(e.numRows),x=new Float64Array(e.numRows),y=new Float64Array(e.numRows);let C=0;for(let w=0;w<e.volumes.length;w++){const O=e.volumes[w].getRenderable(),V=O.getMapper(),L=O.getProperty(),m=V.getInputData(),B=(m.getPointData()&&m.getPointData().getScalars()).getNumberOfComponents(),_=L.getIndependentComponents(),P=e.textureViews[w+4].getTexture().getFormat(),z=Xe.getDetailsFromTextureFormat(P),A=z.elementSize===2&&z.sampleType==="float",I={scale:[255],offset:[0]};A&&(I.scale[0]=1);for(let k=0;k<B;k++){const Y=_?k:0,te=I.scale[k],q=L.getScalarOpacity(Y).getRange(),ht=te/(q[1]-q[0]),Ae=(I.offset[k]-q[0])/(q[1]-q[0]);d[C]=Ae,h[C]=ht;const $e=L.getRGBTransferFunction(Y).getRange();if(v[C]=(I.offset[k]-$e[0])/($e[1]-$e[0]),p[C]=te/($e[1]-$e[0]),L.getUseGradientOpacity(Y)){const Je=L.getGradientOpacityMinimumOpacity(Y),je=L.getGradientOpacityMaximumOpacity(Y);T[C]=Je,S[C]=je;const wn=[L.getGradientOpacityMinimumValue(Y),L.getGradientOpacityMaximumValue(Y)];y[C]=te*(je-Je)/(wn[1]-wn[0]),x[C]=-wn[0]*(je-Je)/(wn[1]-wn[0])+Je}else T[C]=1,S[C]=1,y[C]=0,x[C]=1;C++}}e.componentSSBO.addEntry("cScale","f32"),e.componentSSBO.addEntry("cShift","f32"),e.componentSSBO.addEntry("oScale","f32"),e.componentSSBO.addEntry("oShift","f32"),e.componentSSBO.addEntry("goShift","f32"),e.componentSSBO.addEntry("goScale","f32"),e.componentSSBO.addEntry("gomin","f32"),e.componentSSBO.addEntry("gomax","f32"),e.componentSSBO.setAllInstancesFromArray("cScale",p),e.componentSSBO.setAllInstancesFromArray("cShift",v),e.componentSSBO.setAllInstancesFromArray("oScale",h),e.componentSSBO.setAllInstancesFromArray("oShift",d),e.componentSSBO.setAllInstancesFromArray("goScale",y),e.componentSSBO.setAllInstancesFromArray("goShift",x),e.componentSSBO.setAllInstancesFromArray("gomin",T),e.componentSSBO.setAllInstancesFromArray("gomax",S),e.componentSSBO.send(a)};const n=t.updateBuffers;t.updateBuffers=()=>{n();let a=e.volumes[0].getRenderable().getMapper().getSampleDistance();for(let s=0;s<e.volumes.length;s++){const c=e.volumes[s].getRenderable().getMapper().getSampleDistance();c<a&&(a=c)}e.sampleDist!==a&&(e.sampleDist=a,e.UBO.setValue("SampleDistance",a),e.UBO.sendIfNeeded(e.device));for(let s=0;s<e.volumes.length;s++){const u=e.volumes[s].getRenderable().getMapper().getInputData(),g=e.device.getTextureManager().getTextureForImageData(u);if(!e.textureViews[s+4]||e.textureViews[s+4].getTexture()!==g){const f=g.createView(`volTexture${s}`);e.textureViews[s+4]=f}}if(e.volumes.length<e.lastVolumeLength)for(let s=e.volumes.length;s<e.lastVolumeLength;s++)e.textureViews.pop();e.lastVolumeLength=e.volumes.length,t.updateLUTImage(e.device),t.updateSSBO(e.device),e.clampSampler||(e.clampSampler=Sf.newInstance({label:"clampSampler"}),e.clampSampler.create(e.device,{minFilter:"linear",magFilter:"linear"}))},t.computePipelineHash=()=>{e.pipelineHash="volfsq";for(let a=0;a<e.volumes.length;a++){const s=e.volumes[a].getRenderable().getMapper().getBlendMode();e.pipelineHash+=`${s}`}},t.setVolumes=a=>{if(!e.volumes||e.volumes.length!==a.length){e.volumes=[...a],t.modified();return}for(let s=0;s<a.length;s++)if(a[s]!==e.volumes[s]){e.volumes=[...a],t.modified();return}};const r=t.getBindables;t.getBindables=()=>{const a=r();return a.push(e.componentSSBO),a.push(e.clampSampler),a}}const KF={volumes:null,rowLength:1024,lastVolumeLength:0};function Dd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KF,n),jr.extend(t,e,n),e.fragmentShaderTemplate=AF,e.UBO=lr.newInstance({label:"mapperUBO"}),e.UBO.addEntry("SampleDistance","f32"),e.SSBO=uc.newInstance({label:"volumeSSBO"}),e.componentSSBO=uc.newInstance({label:"componentSSBO"}),e.lutBuildTime={},E.obj(e.lutBuildTime,{mtime:0}),jF(t,e)}const PF=E.newInstance(Dd,"vtkWebGPUVolumePassFSQ");var XF={newInstance:PF,extend:Dd};const{Representation:IF}=qr,{BufferUsage:Zg,PrimitiveTypes:YF}=Cr,Ro=[[0,4,6],[0,6,2],[1,3,7],[1,7,5],[0,5,4],[0,1,5],[2,6,7],[2,7,3],[0,3,1],[0,2,3],[4,5,7],[4,7,6]],qF=`
//VTK::Renderer::Dec

//VTK::Select::Dec

//VTK::VolumePass::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Select::Impl

  //VTK::TCoord::Impl

  //VTK::VolumePass::Impl

  // use the maximum (closest) of the current value and the zbuffer
  // the blend func will then take the min to find the farthest stop value
  var stopval: f32 = max(input.fragPos.z, textureLoad(opaquePassDepthTexture, vec2<i32>(i32(input.fragPos.x), i32(input.fragPos.y)), 0));

  //VTK::RenderEncoder::Impl
  return output;
}
`,QF=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = textureSample(volumePassColorTexture,
    volumePassColorTextureSampler, mapperUBO.tscale*input.tcoordVS);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function ZF(t,e){e.classHierarchy.push("vtkWebGPUVolumePass"),t.initialize=n=>{e._clearEncoder||t.createClearEncoder(n),e._mergeEncoder||t.createMergeEncoder(n),e._copyEncoder||t.createCopyEncoder(n),e._depthRangeEncoder||t.createDepthRangeEncoder(n),e.fullScreenQuad||(e.fullScreenQuad=XF.newInstance(),e.fullScreenQuad.setDevice(n.getDevice()),e.fullScreenQuad.setTextureViews([...e._depthRangeEncoder.getColorTextureViews()])),e._volumeCopyQuad||(e._volumeCopyQuad=jr.newInstance(),e._volumeCopyQuad.setPipelineHash("volpassfsq"),e._volumeCopyQuad.setDevice(n.getDevice()),e._volumeCopyQuad.setFragmentShaderTemplate(QF),e._copyUBO=lr.newInstance({label:"mapperUBO"}),e._copyUBO.addEntry("tscale","vec2<f32>"),e._volumeCopyQuad.setUBO(e._copyUBO),e._volumeCopyQuad.setTextureViews([e._colorTextureView]))},t.traverse=(n,r)=>{if(e.deleted)return;e._currentParent=r,t.initialize(r),t.computeTiming(r),t.renderDepthBounds(n,r),e._firstGroup=!0;const a=r.getDevice(),s=a.getHandle().limits.maxSampledTexturesPerShaderStage-4;if(e.volumes.length>s){const i=n.getRenderable().getActiveCamera().getPosition(),o=[];for(let f=0;f<e.volumes.length;f++){const l=e.volumes[f].getRenderable().getBounds(),p=[.5*(l[1]+l[0]),.5*(l[3]+l[2]),.5*(l[5]+l[4])];o[f]=Tt(p,i)}const c=[...Array(e.volumes.length).keys()];c.sort((f,l)=>o[l]-o[f]);let u=[],g=c.length%s;for(let f=0;f<c.length;f++)u.push(e.volumes[c[f]]),u.length>=g&&(t.rayCastPass(r,n,u),u=[],g=s,e._firstGroup=!1)}else t.rayCastPass(r,n,e.volumes);if(e._volumeCopyQuad.setWebGPURenderer(n),e._useSmallViewport){const i=e._colorTextureView.getTexture().getWidth(),o=e._colorTextureView.getTexture().getHeight();e._copyUBO.setArray("tscale",[e._smallViewportWidth/i,e._smallViewportHeight/o])}else e._copyUBO.setArray("tscale",[1,1]);e._copyUBO.sendIfNeeded(a),e._copyEncoder.setColorTextureView(0,e.colorTextureView),e._copyEncoder.attachTextureViews(),e._copyEncoder.begin(r.getCommandEncoder()),n.scissorAndViewport(e._copyEncoder),e._volumeCopyQuad.prepareAndDraw(e._copyEncoder),e._copyEncoder.end()},t.delete=E.chain(()=>{e._animationRateSubscription&&(e._animationRateSubscription.unsubscribe(),e._animationRateSubscription=null)},t.delete),t.computeTiming=n=>{const r=n.getRenderable().getInteractor();if(e._lastScale==null){const a=e.volumes[0].getRenderable().getMapper();e._lastScale=a.getInitialInteractionScale()||1}e._useSmallViewport=!1,r.isAnimating()&&e._lastScale>1.5&&(e._useSmallViewport=!0),e._colorTexture.resize(n.getCanvas().width,n.getCanvas().height),e._animationRateSubscription||(e._animationRateSubscription=r.onAnimationFrameRateUpdate(()=>{const a=e.volumes[0].getRenderable().getMapper();if(a.getAutoAdjustSampleDistances()){const s=r.getRecentAnimationFrameRate(),i=e._lastScale*r.getDesiredUpdateRate()/s;e._lastScale=i,e._lastScale>400&&(e._lastScale=400)}else e._lastScale=a.getImageSampleDistance()*a.getImageSampleDistance();e._lastScale<1.5&&(e._lastScale=1.5)}))},t.rayCastPass=(n,r,a)=>{const s=e._firstGroup?e._clearEncoder:e._mergeEncoder;s.attachTextureViews(),s.begin(n.getCommandEncoder());let i=e._colorTextureView.getTexture().getWidth(),o=e._colorTextureView.getTexture().getHeight();if(e._useSmallViewport){const c=n.getCanvas(),u=1/Math.sqrt(e._lastScale);e._smallViewportWidth=Math.ceil(u*c.width),e._smallViewportHeight=Math.ceil(u*c.height),i=e._smallViewportWidth,o=e._smallViewportHeight}s.getHandle().setViewport(0,0,i,o,0,1),s.getHandle().setScissorRect(0,0,i,o),e.fullScreenQuad.setWebGPURenderer(r),e.fullScreenQuad.setVolumes(a),e.fullScreenQuad.prepareAndDraw(s),s.end()},t.renderDepthBounds=(n,r)=>{t.updateDepthPolyData(n);const a=e._boundsPoly,s=a.getPoints(),i=a.getPolys();let o={hash:`vp${i.getMTime()}`,usage:Zg.Index,cells:i,numberOfPoints:s.getNumberOfPoints(),primitiveType:YF.Triangles,representation:IF.SURFACE};const c=r.getDevice().getBufferManager().getBuffer(o);e._mapper.getVertexInput().setIndexBuffer(c),o={usage:Zg.PointArray,format:"float32x4",hash:`vp${s.getMTime()}${i.getMTime()}`,dataArray:s,indexBuffer:c,packExtra:!0};const u=r.getDevice().getBufferManager().getBuffer(o);e._mapper.getVertexInput().addBuffer(u,["vertexBC"]),e._mapper.setNumberOfVertices(u.getSizeInBytes()/u.getStrideInBytes()),t.drawDepthRange(n,r)},t.updateDepthPolyData=n=>{let r=!1;for(let g=0;g<e.volumes.length;g++){const f=e.volumes[g].getMTime();(!e._lastMTimes[g]||f!==e._lastMTimes[g])&&(r=!0,e._lastMTimes[g]=f)}const a=n.getStabilizedTime();if((e._lastMTimes.length<=e.volumes.length||a!==e._lastMTimes[e.volumes.length])&&(r=!0,e._lastMTimes[e.volumes.length]=a),!r)return;const s=n.getStabilizedCenterByReference(),i=e.volumes.length*8,o=new Float64Array(i*3),c=e.volumes.length*12,u=new Uint16Array(c*4);for(let g=0;g<e.volumes.length;g++){e.volumes[g].getBoundingCubePoints(o,g*24);let f=g*12*4;const l=g*8;for(let p=0;p<12;p++)u[f++]=3,u[f++]=l+Ro[p][0],u[f++]=l+Ro[p][1],u[f++]=l+Ro[p][2]}for(let g=0;g<o.length;g+=3)o[g]-=s[0],o[g+1]-=s[1],o[g+2]-=s[2];e._boundsPoly.getPoints().setData(o,3),e._boundsPoly.getPoints().modified(),e._boundsPoly.getPolys().setData(u,1),e._boundsPoly.getPolys().modified(),e._boundsPoly.modified()},t.drawDepthRange=(n,r)=>{e._depthRangeTexture.resizeToMatch(e.colorTextureView.getTexture()),e._depthRangeTexture2.resizeToMatch(e.colorTextureView.getTexture()),e._depthRangeEncoder.attachTextureViews(),t.setCurrentOperation("volumeDepthRangePass"),n.setRenderEncoder(e._depthRangeEncoder),n.volumeDepthRangePass(!0),e._mapper.setWebGPURenderer(n),e._mapper.prepareToDraw(e._depthRangeEncoder),e._mapper.registerDrawCallback(e._depthRangeEncoder),n.volumeDepthRangePass(!1)},t.createDepthRangeEncoder=n=>{const r=n.getDevice();e._depthRangeEncoder=pn.newInstance({label:"VolumePass DepthRange"}),e._depthRangeEncoder.setPipelineHash("volr"),e._depthRangeEncoder.setReplaceShaderCodeFunction(i=>{const o=i.getShaderDescription("fragment");o.addOutput("vec4<f32>","outColor1"),o.addOutput("vec4<f32>","outColor2");let c=o.getCode();c=ae.substitute(c,"//VTK::RenderEncoder::Impl",["output.outColor1 = vec4<f32>(input.fragPos.z, 0.0, 0.0, 0.0);","output.outColor2 = vec4<f32>(stopval, 0.0, 0.0, 0.0);"]).result,o.setCode(c)}),e._depthRangeEncoder.setDescription({colorAttachments:[{view:null,clearValue:[0,0,0,0],loadOp:"clear",storeOp:"store"},{view:null,clearValue:[1,1,1,1],loadOp:"clear",storeOp:"store"}]}),e._depthRangeEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"r16float",blend:{color:{srcFactor:"one",dstFactor:"one",operation:"max"},alpha:{srcFactor:"one",dstFactor:"one",operation:"max"}}},{format:"r16float",blend:{color:{srcFactor:"one",dstFactor:"one",operation:"min"},alpha:{srcFactor:"one",dstFactor:"one",operation:"min"}}}]}}),e._depthRangeTexture=en.newInstance({label:"volumePassMaxDepth"}),e._depthRangeTexture.create(r,{width:n.getCanvas().width,height:n.getCanvas().height,format:"r16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});const a=e._depthRangeTexture.createView("maxTexture");e._depthRangeEncoder.setColorTextureView(0,a),e._depthRangeTexture2=en.newInstance({label:"volumePassDepthMin"}),e._depthRangeTexture2.create(r,{width:n.getCanvas().width,height:n.getCanvas().height,format:"r16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});const s=e._depthRangeTexture2.createView("minTexture");e._depthRangeEncoder.setColorTextureView(1,s),e._mapper.setDevice(n.getDevice()),e._mapper.setTextureViews([e.depthTextureView])},t.createClearEncoder=n=>{e._colorTexture=en.newInstance({label:"volumePassColor"}),e._colorTexture.create(n.getDevice(),{width:n.getCanvas().width,height:n.getCanvas().height,format:"bgra8unorm",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC}),e._colorTextureView=e._colorTexture.createView("volumePassColorTexture"),e._colorTextureView.addSampler(n.getDevice(),{minFilter:"linear",magFilter:"linear"}),e._clearEncoder=pn.newInstance({label:"VolumePass Clear"}),e._clearEncoder.setColorTextureView(0,e._colorTextureView),e._clearEncoder.setDescription({colorAttachments:[{view:null,clearValue:[0,0,0,0],loadOp:"clear",storeOp:"store"}]}),e._clearEncoder.setPipelineHash("volpf"),e._clearEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"bgra8unorm",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.createCopyEncoder=n=>{e._copyEncoder=pn.newInstance({label:"volumePassCopy"}),e._copyEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e._copyEncoder.setPipelineHash("volcopypf"),e._copyEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"one",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.createMergeEncoder=n=>{e._mergeEncoder=pn.newInstance({label:"volumePassMerge"}),e._mergeEncoder.setColorTextureView(0,e._colorTextureView),e._mergeEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e._mergeEncoder.setReplaceShaderCodeFunction(r=>{const a=r.getShaderDescription("fragment");a.addOutput("vec4<f32>","outColor");let s=a.getCode();s=ae.substitute(s,"//VTK::RenderEncoder::Impl",["output.outColor = vec4<f32>(computedColor.rgb, computedColor.a);"]).result,a.setCode(s)}),e._mergeEncoder.setPipelineHash("volpf"),e._mergeEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"bgra8unorm",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.setVolumes=n=>{if(!e.volumes||e.volumes.length!==n.length){e.volumes=[...n],t.modified();return}for(let r=0;r<n.length;r++)if(n[r]!==e.volumes[r]){e.volumes=[...n],t.modified();return}}}const JF={colorTextureView:null,depthTextureView:null,volumes:null};function Ld(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,JF,n),Cn.extend(t,e,n),e._mapper=xf.newInstance(),e._mapper.setFragmentShaderTemplate(qF),e._mapper.getShaderReplacements().set("replaceShaderVolumePass",(r,a,s)=>{a.getShaderDescription("fragment").addBuiltinInput("vec4<f32>","@builtin(position) fragPos")}),e._boundsPoly=xn.newInstance(),e._lastMTimes=[],E.setGet(t,e,["colorTextureView","depthTextureView"]),ZF(t,e)}const eB=E.newInstance(Ld,"vtkWebGPUVolumePass");var tB={newInstance:eB,extend:Ld};const nB=`
//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = clamp(textureSampleLevel(opaquePassColorTexture, finalPassSampler, input.tcoordVS, 0.0),vec4<f32>(0.0),vec4<f32>(1.0));

  //VTK::RenderEncoder::Impl
  return output;
}
`;function rB(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(e.deleted)return;e._currentParent=r,t.setCurrentOperation("buildPass"),n.traverse(t),e.opaquePass||(e.opaquePass=GF.newInstance());const a=n.getRenderable().getNumberOfLayers(),s=n.getChildren();for(let i=0;i<a;i++)for(let o=0;o<s.length;o++){const c=s[o],u=n.getRenderable().getRenderers()[o];u.getDraw()&&u.getLayer()===i&&(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumes=[],t.setCurrentOperation("queryPass"),c.traverse(t),t.setCurrentOperation("cameraPass"),c.traverse(t),e.opaquePass.traverse(c,n),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=HF.newInstance()),e.translucentPass.setColorTextureView(e.opaquePass.getColorTextureView()),e.translucentPass.setDepthTextureView(e.opaquePass.getDepthTextureView()),e.translucentPass.traverse(c,n)),e.volumes.length>0&&(e.volumePass||(e.volumePass=tB.newInstance()),e.volumePass.setColorTextureView(e.opaquePass.getColorTextureView()),e.volumePass.setDepthTextureView(e.opaquePass.getDepthTextureView()),e.volumePass.setVolumes(e.volumes),e.volumePass.traverse(c,n)),t.finalPass(n,c))}},t.finalPass=(n,r)=>{e._finalBlitEncoder||t.createFinalBlitEncoder(n),e._finalBlitOutputTextureView.createFromTextureHandle(n.getCurrentTexture(),{depth:1,format:n.getPresentationFormat()}),e._finalBlitEncoder.attachTextureViews(),e._finalBlitEncoder.begin(n.getCommandEncoder()),r.scissorAndViewport(e._finalBlitEncoder),e._fullScreenQuad.prepareAndDraw(e._finalBlitEncoder),e._finalBlitEncoder.end()},t.createFinalBlitEncoder=n=>{e._finalBlitEncoder=pn.newInstance({label:"forwardPassBlit"}),e._finalBlitEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e._finalBlitEncoder.setPipelineHash("fpf"),e._finalBlitEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:n.getPresentationFormat(),blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}}),e._fsqSampler=Sf.newInstance({label:"finalPassSampler"}),e._fsqSampler.create(n.getDevice(),{minFilter:"linear",magFilter:"linear"}),e._fullScreenQuad=jr.newInstance(),e._fullScreenQuad.setDevice(n.getDevice()),e._fullScreenQuad.setPipelineHash("fpfsq"),e._fullScreenQuad.setTextureViews([e.opaquePass.getColorTextureView()]),e._fullScreenQuad.setAdditionalBindables([e._fsqSampler]),e._fullScreenQuad.setFragmentShaderTemplate(nB),e._finalBlitOutputTextureView=K1.newInstance(),e._finalBlitEncoder.setColorTextureView(0,e._finalBlitOutputTextureView)},t.incrementOpaqueActorCount=()=>e.opaqueActorCount++,t.incrementTranslucentActorCount=()=>e.translucentActorCount++,t.addVolume=n=>{e.volumes.push(n)}}const aB={opaqueActorCount:0,translucentActorCount:0,volumes:null,opaqueRenderEncoder:null,translucentPass:null,volumePass:null};function md(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aB,n),Cn.extend(t,e,n),E.setGet(t,e,["opaquePass","translucentPass","volumePass"]),rB(t,e)}const sB=E.newInstance(md,"vtkForwardPass");var iB={newInstance:sB,extend:md};const{VtkDataTypes:nr}=xe;function oB(t,e){e.classHierarchy.push("vtkWebGPUTextureManager");function n(a){if(a.imageData){a.dataArray=a.imageData.getPointData().getScalars(),a.time=a.dataArray.getMTime(),a.nativeArray=a.dataArray.getData();const s=a.imageData.getDimensions();switch(a.width=s[0],a.height=s[1],a.depth=s[2],a.dataArray.getNumberOfComponents()){case 1:a.format="r";break;case 2:a.format="rg";break;case 3:case 4:default:a.format="rgba";break}switch(a.dataArray.getDataType()){case nr.UNSIGNED_CHAR:a.format+="8unorm";break;case nr.FLOAT:case nr.UNSIGNED_INT:case nr.INT:case nr.DOUBLE:case nr.UNSIGNED_SHORT:case nr.SHORT:default:a.format+="16float";break}}a.image&&(a.width=a.image.width,a.height=a.image.height,a.depth=1,a.format="rgba8unorm",a.flip=!0,a.usage=GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT),a.jsImageData&&(a.width=a.jsImageData.width,a.height=a.jsImageData.height,a.depth=1,a.format="rgba8unorm",a.flip=!0,a.nativeArray=a.jsImageData.data,a.usage=GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT),a.imageBitmap&&(a.width=a.imageBitmap.width,a.height=a.imageBitmap.height,a.depth=1,a.format="rgba8unorm",a.flip=!0,a.usage=GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT),a.canvas&&(a.width=a.canvas.width,a.height=a.canvas.height,a.depth=1,a.format="rgba8unorm",a.flip=!0,a.usage=GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT)}function r(a){const s=en.newInstance({label:a.label});return s.create(e.device,{width:a.width,height:a.height,depth:a.depth,format:a.format,usage:a.usage,mipLevel:a.mipLevel}),(a.nativeArray||a.image||a.canvas||a.imageBitmap)&&s.writeImageData(a),s}t.getTexture=a=>a.hash?e.device.getCachedObject(a.hash,r,a):r(a),t.getTextureForImageData=a=>{const s={time:a.getMTime()};return s.imageData=a,n(s),s.hash=s.time+s.format+s.mipLevel,e.device.getTextureManager().getTexture(s)},t.getTextureForVTKTexture=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const i={time:a.getMTime(),label:s};return a.getInputData()?i.imageData=a.getInputData():a.getImage()?i.image=a.getImage():a.getJsImageData()?i.jsImageData=a.getJsImageData():a.getImageBitmap()?i.imageBitmap=a.getImageBitmap():a.getCanvas()&&(i.canvas=a.getCanvas()),n(i),i.mipLevel=a.getMipLevel(),i.hash=i.time+i.format+i.mipLevel,e.device.getTextureManager().getTexture(i)}}const cB={handle:null,device:null};function Vd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cB,n),E.obj(t,e),E.setGet(t,e,["device"]),oB(t,e)}const fB=E.newInstance(Vd);var uB={newInstance:fB,extend:Vd};class gB extends Map{constructor(){super(),this.registry=new FinalizationRegistry(e=>{const n=super.get(e);n&&n.deref&&n.deref()===void 0&&super.delete(e)})}getValue(e){const n=super.get(e);if(n){const r=n.deref();if(r!==void 0)return r;super.delete(e)}}setValue(e,n){let r;return n&&typeof n=="object"&&(r=new WeakRef(n),this.registry.register(n,e),super.set(e,r)),r}}function lB(t,e){e.classHierarchy.push("vtkWebGPUDevice"),t.initialize=n=>{e.handle=n},t.createCommandEncoder=()=>e.handle.createCommandEncoder(),t.submitCommandEncoder=n=>{e.handle.queue.submit([n.finish()])},t.getShaderModule=n=>e.shaderCache.getShaderModule(n),t.getBindGroupLayout=n=>{if(!n.entries)return null;for(let s=0;s<n.entries.length;s++){const i=n.entries[s];i.binding=i.binding||0,i.visibility=i.visibility||GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT}const r=JSON.stringify(n);for(let s=0;s<e.bindGroupLayouts.length;s++)if(e.bindGroupLayouts[s].sval===r)return e.bindGroupLayouts[s].layout;const a=e.handle.createBindGroupLayout(n);return e.bindGroupLayouts.push({sval:r,layout:a}),a},t.getBindGroupLayoutDescription=n=>{for(let r=0;r<e.bindGroupLayouts.length;r++)if(e.bindGroupLayouts[r].layout===n)return e.bindGroupLayouts[r].sval;return vtkErrorMacro("layout not found"),console.trace(),null},t.getPipeline=n=>n in e.pipelines?e.pipelines[n]:null,t.createPipeline=(n,r)=>{r.initialize(t,n),e.pipelines[n]=r},t.onSubmittedWorkDone=()=>e.handle.queue.onSubmittedWorkDone(),t.hasCachedObject=n=>e.objectCache.getValue(n),t.getCachedObject=function(n,r){if(!n)return vtkErrorMacro("attempt to cache an object without a hash"),null;const a=e.objectCache.getValue(n);if(a)return a;for(var s=arguments.length,i=new Array(s>2?s-2:0),o=2;o<s;o++)i[o-2]=arguments[o];const c=r(...i);return e.objectCache.setValue(n,c),c}}const pB={handle:null,pipelines:null,shaderCache:null,bindGroupLayouts:null,bufferManager:null,textureManager:null};function Fd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pB,n),qe(t,e),He(t,e,["handle"]),pt(t,e,["bufferManager","shaderCache","textureManager"]),e.objectCache=new gB,e.shaderCache=ae.newInstance(),e.shaderCache.setDevice(t),e.bindGroupLayouts=[],e.bufferManager=Cr.newInstance(),e.bufferManager.setDevice(t),e.textureManager=uB.newInstance(),e.textureManager.setDevice(t),e.pipelines={},lB(t,e)}const hB=we(Fd,"vtkWebGPUDevice");var dB={newInstance:hB,extend:Fd};function vB(t,e){e.classHierarchy.push("vtkWebGPUHardwareSelectionPass"),t.traverse=(n,r)=>{if(e.deleted)return;e._currentParent=null,t.setCurrentOperation("buildPass"),n.traverse(t);const a=n.getDevice();if(e.selectionRenderEncoder)e.colorTexture.resize(n.getCanvas().width,n.getCanvas().height),e.depthTexture.resizeToMatch(e.colorTexture);else{t.createRenderEncoder(),e.colorTexture=en.newInstance({label:"hardwareSelectorColor"}),e.colorTexture.create(a,{width:n.getCanvas().width,height:n.getCanvas().height,format:"rgba32uint",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC});const s=e.colorTexture.createView("hardwareSelectColorTexture");e.selectionRenderEncoder.setColorTextureView(0,s),e.depthTexture=en.newInstance({label:"hardwareSelectorDepth"}),e.depthTexture.create(a,{width:n.getCanvas().width,height:n.getCanvas().height,format:"depth32float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC});const i=e.depthTexture.createView("hardwareSelectDepthTexture");e.selectionRenderEncoder.setDepthTextureView(i)}e.selectionRenderEncoder.attachTextureViews(),r.setRenderEncoder(e.selectionRenderEncoder),t.setCurrentOperation("cameraPass"),r.traverse(t),t.setCurrentOperation("opaquePass"),r.traverse(t)},t.createRenderEncoder=()=>{e.selectionRenderEncoder=pn.newInstance({label:"HardwareSelectionPass"}),e.selectionRenderEncoder.setPipelineHash("sel"),e.selectionRenderEncoder.setReplaceShaderCodeFunction(r=>{const a=r.getShaderDescription("fragment");a.addOutput("vec4<u32>","outColor");let s=a.getCode();s=ae.substitute(s,"//VTK::RenderEncoder::Impl",["output.outColor = vec4<u32>(mapperUBO.PropID, compositeID, 0u, 0u);"]).result,a.setCode(s)});const n=e.selectionRenderEncoder.getDescription();n.colorAttachments[0].clearValue=[0,0,0,0],e.selectionRenderEncoder.setPipelineSettings({primitive:{cullMode:"none"},depthStencil:{depthWriteEnabled:!0,depthCompare:"greater",format:"depth32float"},fragment:{targets:[{format:"rgba32uint",blend:void 0}]}})}}const yB={selectionRenderEncoder:null,colorTexture:null,depthTexture:null};function Bd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,yB,n),Cn.extend(t,e,n),E.get(t,e,["colorTexture","depthTexture"]),vB(t,e)}const TB=E.newInstance(Bd,"vtkWebGPUHardwareSelectionPass");var xB={newInstance:TB,extend:Bd};const{SelectionContent:SB,SelectionField:Jg}=Vi,{FieldAssociations:el}=Sr,{vtkErrorMacro:_d}=E;function CB(t){return`${t.propID} ${t.compositeID}`}function tl(t,e,n,r){const a=((n.height-e-1)*n.colorBufferWidth+t)*4+r;return n.colorValues[a]}function wB(t,e,n,r){{if(r[0]=e[0],r[1]=e[1],e[0]<0||e[0]>=t.width||e[1]<0||e[1]>=t.height)return null;const a=tl(e[0],e[1],t,0);if(a<=0)return null;const s={};s.propID=a;let i=tl(e[0],e[1],t,1);if((i<0||i>16777215)&&(i=0),s.compositeID=i,t.captureZValues){const o=(t.height-e[1]-1)*t.zbufferBufferWidth+e[0];s.zValue=t.depthValues[o],s.zValue=t.webGPURenderer.convertToOpenGLDepth(s.zValue),s.displayPosition=e}return s}}function EB(t,e,n){const r=[];let a=0;return e.forEach((s,i)=>{const o=Vi.newInstance();switch(o.setContentType(SB.INDICES),t){case el.FIELD_ASSOCIATION_CELLS:o.setFieldType(Jg.CELL);break;case el.FIELD_ASSOCIATION_POINTS:o.setFieldType(Jg.POINT);break;default:_d("Unknown field association")}o.getProperties().propID=s.info.propID;const c=n.webGPURenderer.getPropFromID(s.info.propID);o.getProperties().prop=c.getRenderable(),o.getProperties().compositeID=s.info.compositeID,o.getProperties().pixelCount=s.pixelCount,n.captureZValues&&(o.getProperties().displayPosition=[s.info.displayPosition[0],s.info.displayPosition[1],s.info.zValue],o.getProperties().worldPosition=n.webGPURenderWindow.displayToWorld(s.info.displayPosition[0],s.info.displayPosition[1],s.info.zValue,n.renderer)),o.setSelectionList(s.attributeIDs),r[a]=o,a++}),r}function RB(t,e,n,r,a){const s=Math.floor(e),i=Math.floor(n),o=Math.floor(r),c=Math.floor(a),u=new Map,g=[0,0];for(let f=i;f<=c;f++)for(let l=s;l<=o;l++){const v=wB(t,[l,f],0,g);if(v){const h=CB(v);if(!u.has(h))u.set(h,{info:v,pixelCount:1,attributeIDs:[v.attributeID]});else{const d=u.get(h);d.pixelCount++,t.captureZValues&&v.zValue<d.info.zValue&&(d.info=v),d.attributeIDs.indexOf(v.attributeID)===-1&&d.attributeIDs.push(v.attributeID)}}}return EB(t.fieldAssociation,u,t)}function OB(t,e){e.classHierarchy.push("vtkWebGPUHardwareSelector"),t.endSelection=()=>{e.WebGPURenderer.setSelector(null)},t.getSourceDataAsync=async n=>{if(!n||!e._WebGPURenderWindow)return _d("Renderer and view must be set before calling Select."),!1;e._WebGPURenderWindow.getRenderable().preRender(),e._WebGPURenderWindow.getInitialized()||(e._WebGPURenderWindow.initialize(),await new Promise(p=>{e._WebGPURenderWindow.onInitialized(p)}));const r=e._WebGPURenderWindow.getViewNodeFor(n);if(!r)return!1;const a=r.getSuppressClear();r.setSuppressClear(!0),e._selectionPass.traverse(e._WebGPURenderWindow,r),r.setSuppressClear(a);const s=e._WebGPURenderWindow.getDevice(),i=e._selectionPass.getColorTexture(),o=e._selectionPass.getDepthTexture(),c={area:[0,0,i.getWidth()-1,i.getHeight()-1],captureZValues:e.captureZValues,fieldAssociation:e.fieldAssociation,renderer:n,webGPURenderer:r,webGPURenderWindow:e._WebGPURenderWindow,width:i.getWidth(),height:i.getHeight()};c.colorBufferWidth=16*Math.floor((c.width+15)/16),c.colorBufferSizeInBytes=c.colorBufferWidth*c.height*4*4;const u=Kr.newInstance({label:"hardwareSelectColorBuffer"});u.setDevice(s),u.create(c.colorBufferSizeInBytes,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);const g=e._WebGPURenderWindow.getCommandEncoder();g.copyTextureToBuffer({texture:i.getHandle()},{buffer:u.getHandle(),bytesPerRow:16*c.colorBufferWidth,rowsPerImage:c.height},{width:c.width,height:c.height,depthOrArrayLayers:1});let f;e.captureZValues&&(c.zbufferBufferWidth=64*Math.floor((c.width+63)/64),f=Kr.newInstance({label:"hardwareSelectDepthBuffer"}),f.setDevice(s),c.zbufferSizeInBytes=c.height*c.zbufferBufferWidth*4,f.create(c.zbufferSizeInBytes,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST),g.copyTextureToBuffer({texture:o.getHandle(),aspect:"depth-only"},{buffer:f.getHandle(),bytesPerRow:4*c.zbufferBufferWidth,rowsPerImage:c.height},{width:c.width,height:c.height,depthOrArrayLayers:1})),s.submitCommandEncoder(g);const l=u.mapAsync(GPUMapMode.READ);if(e.captureZValues){const p=f.mapAsync(GPUMapMode.READ);await Promise.all([l,p]),c.depthValues=new Float32Array(f.getMappedRange().slice()),f.unmap()}else await l;return c.colorValues=new Uint32Array(u.getMappedRange().slice()),u.unmap(),c.generateSelection=(p,v,h,d)=>RB(c,p,v,h,d),c}}const MB={};function Ud(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MB,n),fd.extend(t,e,n),e._selectionPass=xB.newInstance(),E.setGet(t,e,["_WebGPURenderWindow"]),E.moveToProtected(t,e,["WebGPURenderWindow"]),OB(t,e)}const DB=E.newInstance(Ud,"vtkWebGPUHardwareSelector");var Nd={newInstance:DB,extend:Ud};const{vtkErrorMacro:nl}=E,LB={position:"absolute",top:0,left:0,width:"100%",height:"100%"};function mB(t,e){e.classHierarchy.push("vtkWebGPURenderWindow"),t.getViewNodeFactory=()=>e.myFactory;const n=[0,0];function r(){e.renderable&&(e.size[0]!==n[0]||e.size[1]!==n[1])&&(n[0]=e.size[0],n[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1]),t.recreateSwapChain()),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(r),t.recreateSwapChain=()=>{e.context&&(e.context.unconfigure(),e.presentationFormat=navigator.gpu.getPreferredCanvasFormat(e.adapter),e.context.configure({device:e.device.getHandle(),format:e.presentationFormat,alphaMode:"premultiplied",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,width:e.size[0],height:e.size[1]}),e._configured=!0)},t.getCurrentTexture=()=>e.context.getCurrentTexture(),t.buildPass=i=>{if(i){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.removeUnusedNodes(),t.initialize()}else e.initialized&&(e._configured||t.recreateSwapChain(),e.commandEncoder=e.device.createCommandEncoder())},t.initialize=()=>{if(!e.initializing){if(e.initializing=!0,!navigator.gpu){nl("WebGPU is not enabled.");return}t.create3DContextAsync().then(()=>{e.initialized=!0,!e.deleted&&t.invokeInitialized()})}},t.setContainer=i=>{e.el&&e.el!==i&&(e.canvas.parentNode!==e.el&&nl("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==i&&(e.el=i,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=()=>e.el,t.getContainerSize=()=>{if(!e.containerSize&&e.el){const{width:i,height:o}=e.el.getBoundingClientRect();e.containerSize=[i,o]}return e.containerSize||e.size},t.getFramebufferSize=()=>e.size,t.create3DContextAsync=async()=>{if(e.adapter=await navigator.gpu.requestAdapter({powerPreference:"high-performance"}),!e.deleted){if(e.device=dB.newInstance(),e.device.initialize(await e.adapter.requestDevice()),e.deleted){e.device=null;return}e.context=e.canvas.getContext("webgpu")}},t.releaseGraphicsResources=()=>{const i=Cn.newInstance();i.setCurrentOperation("Release"),i.traverse(t,null),e.adapter=null,e.device=null,e.context=null,e.initialized=!1,e.initializing=!1},t.setBackgroundImage=i=>{e.bgImage.src=i.src},t.setUseBackgroundImage=i=>{e.useBackgroundImage=i,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};async function a(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.imageFormat;const o=document.createElement("canvas"),c=o.getContext("2d");o.width=e.canvas.width,o.height=e.canvas.height;const u=await t.getPixelsAsync(),g=new ImageData(u.colorValues,u.width,u.height);c.putImageData(g,0,0);const f=e.canvas.getBoundingClientRect();e.renderable.getRenderers().forEach(h=>{h.getViewProps().forEach(T=>{if(T.getContainer){const x=T.getContainer().getElementsByTagName("canvas");for(let y=0;y<x.length;y++){const C=x[y],w=C.getBoundingClientRect(),R=w.x-f.x,O=w.y-f.y;c.drawImage(C,R,O)}}})});const v=o.toDataURL(i);o.remove(),t.invokeImageReady(v)}t.captureNextImage=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",{resetCamera:o=!1,size:c=null,scale:u=1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.deleted)return null;e.imageFormat=i;const g=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:c||u!==1?c||e.size.map(f=>f*u):null},new Promise((f,l)=>{const p=t.onImageReady(v=>{if(e._screenshot.size===null)e.notifyStartCaptureImage=g,p.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(h=>{let{restoreParamsFn:d,arg:T}=h;return d(T)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),f(v);else{const h=document.createElement("img");if(h.style=LB,h.src=v,e._screenshot.placeHolder=e.el.appendChild(h),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e._screenshot.size=null,t.modified(),o){const d=o!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(T=>{const S=T.getActiveCamera(),x=S.get("focalPoint","position","parallelScale");return{resetCameraArgs:d?{renderer:T}:void 0,resetCameraFn:d?o:T.resetCamera,restoreParamsFn:S.set,arg:JSON.parse(JSON.stringify(x))}}),e._screenshot.cameras.forEach(T=>{let{resetCameraFn:S,resetCameraArgs:x}=T;return S(x)})}t.traverseAllPasses()}})})},t.traverseAllPasses=()=>{if(!e.deleted)if(e.initialized){if(e.renderPasses)for(let i=0;i<e.renderPasses.length;++i)e.renderPasses[i].traverse(t,null);e.commandEncoder&&(e.device.submitCommandEncoder(e.commandEncoder),e.commandEncoder=null,e.notifyStartCaptureImage&&e.device.onSubmittedWorkDone().then(()=>{a()}))}else{t.initialize();const i=t.onInitialized(()=>{i.unsubscribe(),t.traverseAllPasses()})}},t.setViewStream=i=>{if(e.viewStream===i)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=i,e.viewStream){const o=e.renderable.getRenderers()[0];o.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(c=>t.setBackgroundImage(c.image)),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.getUniquePropID=()=>e.nextPropID++,t.getPropFromID=i=>{for(let o=0;o<e.children.length;o++){const c=e.children[o].getPropFromID(i);if(c!==null)return c}return null},t.getPixelsAsync=async()=>{const i=e.device,o=e.renderPasses[0].getOpaquePass().getColorTexture(),c={width:o.getWidth(),height:o.getHeight()};c.colorBufferWidth=32*Math.floor((c.width+31)/32),c.colorBufferSizeInBytes=c.colorBufferWidth*c.height*8;const u=Kr.newInstance();u.setDevice(i),u.create(c.colorBufferSizeInBytes,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);const g=e.device.createCommandEncoder();g.copyTextureToBuffer({texture:o.getHandle()},{buffer:u.getHandle(),bytesPerRow:8*c.colorBufferWidth,rowsPerImage:c.height},{width:c.width,height:c.height,depthOrArrayLayers:1}),i.submitCommandEncoder(g),await u.mapAsync(GPUMapMode.READ),c.colorValues=new Uint16Array(u.getMappedRange().slice()),u.unmap();const l=new Uint8ClampedArray(c.height*c.width*4);for(let p=0;p<c.height;p++)for(let v=0;v<c.width;v++){const h=(p*c.width+v)*4,d=(p*c.colorBufferWidth+v)*4;l[h]=255*kt.fromHalf(c.colorValues[d]),l[h+1]=255*kt.fromHalf(c.colorValues[d+1]),l[h+2]=255*kt.fromHalf(c.colorValues[d+2]),l[h+3]=255*kt.fromHalf(c.colorValues[d+3])}return c.colorValues=l,c},t.createSelector=()=>{const i=Nd.newInstance();return i.setWebGPURenderWindow(t),i};const s=t.setSize;t.setSize=(i,o)=>{const c=s(i,o);return c&&t.invokeWindowResizeEvent({width:i,height:o}),c},t.delete=E.chain(t.delete,t.setViewStream)}const VB={initialized:!1,context:null,adapter:null,device:null,canvas:null,cursorVisibility:!0,cursor:"pointer",containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1,nextPropID:1,xrSupported:!1,presentationFormat:null};function FB(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,VB,n),e.canvas=document.createElement("canvas"),e.canvas.style.width="100%",e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",Cd.extend(t,e,n),e.myFactory=fD.newInstance(),e.renderPasses[0]=iB.newInstance(),e.selector||(e.selector=Nd.newInstance(),e.selector.setWebGPURenderWindow(t)),E.event(t,e,"imageReady"),E.event(t,e,"initialized"),E.get(t,e,["commandEncoder","device","presentationFormat","useBackgroundImage","xrSupported"]),E.setGet(t,e,["initialized","context","canvas","device","renderPasses","notifyStartCaptureImage","cursor","useOffScreen"]),E.setGetArray(t,e,["size"],2),E.event(t,e,"windowResizeEvent"),mB(t,e)}const kd=E.newInstance(FB,"vtkWebGPURenderWindow");Cf("WebGPU",kd);rn("vtkRenderWindow",kd);const BB=MV.extractURLParameters(),_B={margin:"0",padding:"0",position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden"},UB={position:"absolute",left:"25px",top:"25px",backgroundColor:"white",borderRadius:"5px",listStyle:"none",padding:"5px 10px",margin:"0",display:"block",border:"solid 1px black",maxWidth:"calc(100% - 70px)",maxHeight:"calc(100% - 60px)",overflow:"auto"};function rl(t,e){Object.keys(e).forEach(n=>{t.style[n]=e[n]})}function NB(t,e){e.classHierarchy.push("vtkFullScreenRenderWindow");const n=document.querySelector("body");e.rootContainer||(e.rootContainer=n),e.container||(e.container=document.createElement("div"),rl(e.container,e.containerStyle||_B),e.rootContainer.appendChild(e.container)),e.rootContainer===n&&(document.documentElement.style.height="100%",n.style.height="100%",n.style.padding="0",n.style.margin="0"),e.renderWindow=Zm.newInstance(),e.renderer=Pm.newInstance(),e.renderWindow.addRenderer(e.renderer),e.apiSpecificRenderWindow=e.renderWindow.newAPISpecificView(BB.viewAPI??e.defaultViewAPI),e.apiSpecificRenderWindow.setContainer(e.container),e.renderWindow.addView(e.apiSpecificRenderWindow),e.interactor=ed.newInstance(),e.interactor.setInteractorStyle(EV.newInstance()),e.interactor.setView(e.apiSpecificRenderWindow),e.interactor.initialize(),e.interactor.bindEvents(e.container),t.setBackground=e.renderer.setBackground,t.removeController=()=>{const a=e.controlContainer;a&&a.parentNode.removeChild(a)},t.setControllerVisibility=a=>{e.controllerVisibility=a,e.controlContainer&&(a?e.controlContainer.style.display="block":e.controlContainer.style.display="none")},t.toggleControllerVisibility=()=>{t.setControllerVisibility(!e.controllerVisibility)};function r(a){String.fromCharCode(a.charCode)==="c"&&t.toggleControllerVisibility()}t.addController=a=>{e.controlContainer=document.createElement("div"),rl(e.controlContainer,e.controlPanelStyle||UB),e.rootContainer.appendChild(e.controlContainer),e.controlContainer.innerHTML=a,t.setControllerVisibility(e.controllerVisibility),e.rootContainer.addEventListener("keypress",r)},t.setBackground(...e.background),t.addRepresentation=a=>{a.getActors().forEach(s=>{e.renderer.addActor(s)})},t.removeRepresentation=a=>{a.getActors().forEach(s=>e.renderer.removeActor(s))},t.delete=E.chain(t.setContainer,e.apiSpecificRenderWindow.delete,()=>{e.rootContainer?.removeEventListener("keypress",r),window.removeEventListener("resize",t.resize)},t.delete),t.resize=()=>{const a=e.container.getBoundingClientRect(),s=window.devicePixelRatio||1;e.apiSpecificRenderWindow.setSize(Math.floor(a.width*s),Math.floor(a.height*s)),e.resizeCallback&&e.resizeCallback(a),e.renderWindow.render()},t.setResizeCallback=a=>{e.resizeCallback=a,t.resize()},e.listenWindowResize&&window.addEventListener("resize",t.resize),t.resize()}const kB={background:[.32,.34,.43],containerStyle:null,controlPanelStyle:null,listenWindowResize:!0,resizeCallback:null,controllerVisibility:!0};function Gd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kB,n),E.obj(t,e),E.get(t,e,["renderWindow","renderer","apiSpecificRenderWindow","interactor","rootContainer","container","controlContainer"]),NB(t,e)}const GB=E.newInstance(Gd);var bB={newInstance:GB,extend:Gd};function bd(t){return new TextDecoder("latin1").decode(t)}function $B(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const r=bd(t),a=e.exec(r);if(!a)return{text:r};const s=a.index+a[0].length,i=r.substring(0,s);let o=null;const c=n?n.exec(r):null;if(c){const u=r.substr(c.index);o={text:i+u,binaryBuffer:t.slice(s,c.index)}}else o={text:i,binaryBuffer:t.slice(s)};return o}var al={arrayBufferToString:bd,extractBinary:$B};const Mf={};function $d(t){return!!Mf[t]}function WB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Mf[t](e)}function Wd(t,e){Mf[t]=e}var zB={get:WB,has:$d,registerType:Wd};const HB=t=>t,sl=1e-6;class zd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.matrix=ue(new Float64Array(16)),this.tmp=new Float64Array(3),this.angleConv=e?ET:HB}rotateFromDirections(e,n){const r=new Float64Array(3),a=new Float64Array(3),s=new Float64Array(16);qt(r,e[0],e[1],e[2]),qt(a,n[0],n[1],n[2]),Wn(r,r),Wn(a,a);const i=$c(r,a);return i>=1?this:(Nr(this.tmp,r,a),zo(this.tmp)<sl&&(Nr(this.tmp,[1,0,0],e),zo(this.tmp)<sl&&Nr(this.tmp,[0,1,0],e)),l0(s,Math.acos(i),this.tmp),Ne(this.matrix,this.matrix,s),this)}rotate(e,n){return qt(this.tmp,...n),Wn(this.tmp,this.tmp),Bt(this.matrix,this.matrix,this.angleConv(e),this.tmp),this}rotateX(e){return kc(this.matrix,this.matrix,this.angleConv(e)),this}rotateY(e){return Gc(this.matrix,this.matrix,this.angleConv(e)),this}rotateZ(e){return bc(this.matrix,this.matrix,this.angleConv(e)),this}translate(e,n,r){return qt(this.tmp,e,n,r),Ue(this.matrix,this.matrix,this.tmp),this}scale(e,n,r){return qt(this.tmp,e,n,r),pr(this.matrix,this.matrix,this.tmp),this}multiply(e){return Ne(this.matrix,this.matrix,e),this}multiply3x3(e){return Ne(this.matrix,this.matrix,[e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1]),this}invert(){return ut(this.matrix,this.matrix),this}identity(){return ue(this.matrix),this}apply(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;if(Ar(lp,this.matrix))return this;const a=r===-1?e.length:n+r*3;for(let s=n;s<a;s+=3)qt(this.tmp,e[s],e[s+1],e[s+2]),Te(this.tmp,this.tmp,this.matrix),e[s]=this.tmp[0],e[s+1]=this.tmp[1],e[s+2]=this.tmp[2];return this}getMatrix(){return this.matrix}setMatrix(e){return e&&e.length===16&&Qe(this.matrix,e),this}}function AB(){return new zd(!0)}function jB(){return new zd(!1)}var KB={buildFromDegree:AB,buildFromRadian:jB};function Hd(){const t=new ArrayBuffer(4),e=new Uint8Array(t),n=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,n[0]===3569595041?"LittleEndian":n[0]===2712847316?"BigEndian":null}const PB=Hd();function XB(t,e){if(e<2)return;const n=new Int8Array(t),r=n.length,a=[];for(let s=0;s<r;s+=e){for(let i=0;i<e;i++)a.push(n[s+i]);for(let i=0;i<e;i++)n[s+i]=a.pop()}}var Oo={ENDIANNESS:PB,getEndianness:Hd,swapBytes:XB};const{vtkErrorMacro:Ad,vtkDebugMacro:IB}=E,Df=()=>(Ad("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."),Promise.reject(new Error("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead.")));let Pr=0;function Fi(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=new XMLHttpRequest;return r.open(t,e,!0),n.headers&&Object.entries(n.headers).forEach(a=>{let[s,i]=a;return r.setRequestHeader(s,i)}),n.progressCallback&&r.addEventListener("progress",n.progressCallback),r}function YB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,r)=>{const a=Fi("GET",t,e);a.onreadystatechange=s=>{a.readyState===4&&(a.status===200||a.status===0?n(a.response):r({xhr:a,e:s}))},a.responseType="arraybuffer",a.send()})}function qB(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return r&&r.compression?Df():n.ref&&!n.ref.pending?new Promise((a,s)=>{const i=[e,n.ref.basepath,n.ref.id].join("/"),o=Fi("GET",i,r);o.onreadystatechange=c=>{o.readyState===1&&(n.ref.pending=!0,++Pr===1&&t?.invokeBusy&&t.invokeBusy(!0)),o.readyState===4&&(n.ref.pending=!1,o.status===200||o.status===0?(n.buffer=o.response,n.ref.encode==="JSON"?n.values=JSON.parse(n.buffer):(Oo.ENDIANNESS!==n.ref.encode&&Oo.ENDIANNESS&&(IB(`Swap bytes of ${n.name}`),Oo.swapBytes(n.buffer,vh[n.dataType])),n.values=E.newTypedArray(n.dataType,n.buffer)),n.values.length!==n.size&&Ad(`Error in FetchArray: ${n.name}, does not have the proper array size. Got ${n.values.length}, instead of ${n.size}`),delete n.ref,--Pr===0&&t?.invokeBusy&&t.invokeBusy(!1),t?.modified&&t.modified(),a(n)):s({xhr:o,e:c}))},o.responseType=n.dataType!=="string"?"arraybuffer":"text",o.send()}):Promise.resolve(n)}function QB(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return n&&n.compression?Df():new Promise((r,a)=>{const s=Fi("GET",e,n);s.onreadystatechange=i=>{s.readyState===1&&++Pr===1&&t?.invokeBusy&&t.invokeBusy(!0),s.readyState===4&&(--Pr===0&&t?.invokeBusy&&t.invokeBusy(!1),s.status===200||s.status===0?r(JSON.parse(s.responseText)):a({xhr:s,e:i}))},s.responseType="text",s.send()})}function ZB(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return n&&n.compression?Df():new Promise((r,a)=>{const s=Fi("GET",e,n);s.onreadystatechange=i=>{s.readyState===1&&++Pr===1&&t?.invokeBusy&&t.invokeBusy(!0),s.readyState===4&&(--Pr===0&&t?.invokeBusy&&t.invokeBusy(!1),s.status===200||s.status===0?r(s.responseText):a({xhr:s,e:i}))},s.responseType="text",s.send()})}function JB(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise((r,a)=>{const s=new Image;n.crossOrigin&&(s.crossOrigin=n.crossOrigin),s.onload=()=>r(s),s.onerror=a,s.src=e})}const e_={fetchArray:qB,fetchJSON:QB,fetchText:ZB,fetchBinary:YB,fetchImage:JB};$d("http")||Wd("http",t=>e_);const{vtkErrorMacro:Mo}=E;function t_(t){const n=t.split(" ").filter(a=>a.indexOf("=")>-1),r={};for(let a=0;a<n.length;++a){const i=n[a].split("=");i.length===2&&(r[i[0]]=i[1])}return r}function il(t,e){for(let n=0;n<t.length;n++)e.push(t[n])}function n_(t,e,n,r,a){const s=t[e];if(s===void 0)return-1;if(s.indexOf("endfacet")!==-1||s.indexOf("facet")===-1)return e+1;let i=0,o=2;const c=n.length/3,u=s.split(/[ \t]+/).filter(g=>g).slice(-3).map(Number);for(il(u,a);t[e+o].indexOf("vertex")!==-1;){const f=t[e+o].split(/[ \t]+/).filter(l=>l).slice(-3).map(Number);il(f,n),i++,o++}r.push(i);for(let g=0;g<i;g++)r.push(c+g);for(;t[e+o]&&t[e+o].indexOf("endfacet")!==-1;)o++;return e+o+2}function r_(t,e){e.classHierarchy.push("vtkSTLReader"),e.dataAccessHelper||(e.dataAccessHelper=zB.get("http"));function n(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=s.compression!==void 0?s.compression:e.compression,o=s.progressCallback!==void 0?s.progressCallback:e.progressCallback;return s.binary?e.dataAccessHelper.fetchBinary(a,{compression:i,progressCallback:o}):e.dataAccessHelper.fetchText(t,a,{compression:i,progressCallback:o})}function r(a){const s=e.output[0],i=s.getPoints().getData(),o=s.getPolys().getData();if(!i||!o){console.warn("No valid polydata.");return}const c=new Map,u=new Map;let g=0,f=!1;for(let l=0;l<i.length;l+=3){const p=(i[l]*10**a).toFixed(0),v=(i[l+1]*10**a).toFixed(0),h=(i[l+2]*10**a).toFixed(0),d=`${p},${v},${h}`;c.get(d)!==void 0?(u.set(l/3,c.get(d)),f=!0):(u.set(l/3,g),c.set(d,g),g++)}if(f){const l=new Float32Array(c.size*3),p=Array.from(c.keys());for(let h=0;h<p.length;h++){const d=p[h],T=c.get(d)*3,S=d.split(",").map(x=>+x*10**-a);l[T]=S[0],l[T+1]=S[1],l[T+2]=S[2]}const v=new Int32Array(o.length);for(let h=0;h<o.length;h+=4)v[h]=3,v[h+1]=u.get(o[h+1]),v[h+2]=u.get(o[h+2]),v[h+3]=u.get(o[h+3]);s.getPoints().setData(l),s.getPolys().setData(v),s.modified()}}t.setUrl=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{binary:!0};e.url=a;const i=a.split("/");return i.pop(),e.baseURL=i.join("/"),t.loadData(s)},t.loadData=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=n(e.url,a);return s.then(t.parse),s},t.parse=a=>{typeof a=="string"?t.parseAsText(a):t.parseAsArrayBuffer(a)},t.parseAsArrayBuffer=a=>{if(!a)return;if(a!==e.parseData)t.modified();else return;e.parseData=a;let s=!1;if(s=84+new DataView(a,0,84).getUint32(80,!0)*50===a.byteLength,!s){t.parseAsText(al.arrayBufferToString(a));return}const c=a.slice(0,80),u=al.arrayBufferToString(c),g=t_(u),f=new DataView(a,84),l=(a.byteLength-84)/50,p=new Float32Array(l*9),v=new Float32Array(l*3),h=new Uint32Array(l*4),d=new Uint16Array(l);let T=0;for(let y=0;y<l;y++){const C=y*50;v[y*3+0]=f.getFloat32(C+0,!0),v[y*3+1]=f.getFloat32(C+4,!0),v[y*3+2]=f.getFloat32(C+8,!0),p[y*9+0]=f.getFloat32(C+12,!0),p[y*9+1]=f.getFloat32(C+16,!0),p[y*9+2]=f.getFloat32(C+20,!0),p[y*9+3]=f.getFloat32(C+24,!0),p[y*9+4]=f.getFloat32(C+28,!0),p[y*9+5]=f.getFloat32(C+32,!0),p[y*9+6]=f.getFloat32(C+36,!0),p[y*9+7]=f.getFloat32(C+40,!0),p[y*9+8]=f.getFloat32(C+44,!0),h[T++]=3,h[T++]=y*3+0,h[T++]=y*3+1,h[T++]=y*3+2,d[y]=f.getUint16(C+48,!0)}const S="SPACE";if(S in g&&g[S]!=="LPS"){const y=g[S],C=new Float32Array(16);switch(C[15]=1,y[0]){case"L":C[0]=1;break;case"R":C[0]=-1;break;default:Mo(`Can not convert STL file from ${y} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}switch(y[1]){case"P":C[5]=1;break;case"A":C[5]=-1;break;default:Mo(`Can not convert STL file from ${y} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}switch(y[2]){case"S":C[10]=1;break;case"I":C[10]=-1;break;default:Mo(`Can not convert STL file from ${y} to LPS space: permutations not supported. Use itk.js STL reader instead.`);return}KB.buildFromDegree().setMatrix(C).apply(p).apply(v)}const x=xn.newInstance();x.getPoints().setData(p,3),x.getPolys().setData(h),x.getCellData().setScalars(xe.newInstance({name:"Attribute",values:d})),x.getCellData().setNormals(xe.newInstance({name:"Normals",values:v,numberOfComponents:3})),e.output[0]=x,e.removeDuplicateVertices>=0&&r(e.removeDuplicateVertices)},t.parseAsText=a=>{if(!a)return;if(a!==e.parseData)t.modified();else return;e.parseData=a;const s=a.split(`
`);let i=1;const o=[],c=[],u=[];for(;i!==-1;)i=n_(s,i,o,c,u);const g=xn.newInstance();g.getPoints().setData(Float32Array.from(o),3),g.getPolys().setData(Uint32Array.from(c)),g.getCellData().setNormals(xe.newInstance({name:"Normals",values:Float32Array.from(u),numberOfComponents:3})),e.output[0]=g,e.removeDuplicateVertices>=0&&r(e.removeDuplicateVertices)},t.requestData=(a,s)=>{t.parse(e.parseData)}}const a_={removeDuplicateVertices:-1};function jd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,a_,n),E.obj(t,e),E.get(t,e,["url","baseURL"]),E.setGet(t,e,["dataAccessHelper","removeDuplicateVertices"]),E.algo(t,e,0,1),r_(t,e),e.compression||(e.compression=null),e.progressCallback||(e.progressCallback=null)}const s_=E.newInstance(jd,"vtkSTLReader");var i_={extend:jd,newInstance:s_};function o_(t,e){e.classHierarchy.push("vtkPolyDataNormals"),t.vtkPolyDataNormalsExecute=(n,r,a)=>{if(!a)return null;const s=new Float32Array(a.length),i=new Float32Array(3*n);let o=0,c=0;const u=r.length,g=[0,0,0],f=[0,0,0];for(let l=0;l<u;l+=c+1)if(c=r[l],!(c<3)){for(let p=1;p<=3;++p)g[p-1]=3*r[l+p];if(mi.computeNormal(a.slice(g[0],g[0]+3),a.slice(g[1],g[1]+3),a.slice(g[2],g[2]+3),f),i[o++]=f[0],i[o++]=f[1],i[o++]=f[2],e.computePointNormals)for(let p=1;p<=c;++p){let v=3*r[l+p];s[v]+=f[0],s[++v]+=f[1],s[++v]+=f[2]}}if(e.computePointNormals){const l=[0,0,0];for(let p=0;p<a.length;)l[0]=s[p],l[1]=s[p+1],l[2]=s[p+2],tc.normalize(l),s[p++]=l[0],s[p++]=l[1],s[p++]=l[2]}return[i,s]},t.requestData=(n,r)=>{if(!t.getNumberOfInputPorts())return;const s=n[0];if(!s)return;const i=r[0]?.initialize()||xn.newInstance();i.setPoints(s.getPoints()),i.setVerts(s.getVerts()),i.setLines(s.getLines()),i.setPolys(s.getPolys()),i.setStrips(s.getStrips()),i.getPointData().passData(s.getPointData()),i.getCellData().passData(s.getCellData()),i.getFieldData().passData(s.getFieldData());const[o,c]=t.vtkPolyDataNormalsExecute(s.getNumberOfPolys(),s.getPolys().getData(),s.getPoints().getData());if(e.computePointNormals){const u=xe.newInstance({numberOfComponents:3,name:"Normals",values:c});i.getPointData().setNormals(u)}if(e.computeCellNormals){const u=xe.newInstance({numberOfComponents:3,name:"Normals",values:o});i.getCellData().setNormals(u)}r[0]=i}}function c_(t){return{computeCellNormals:!1,computePointNormals:!0,...t}}function Kd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,c_(n)),E.obj(t,e),E.algo(t,e,1,1),E.setGet(t,e,["computeCellNormals","computePointNormals"]),o_(t,e)}const f_=E.newInstance(Kd,"vtkPolyDataNormals");var u_={newInstance:f_,extend:Kd};const g_=(t,e)=>{const n=t.__vccOpts||t;for(const[r,a]of e)n[r]=a;return n},l_={name:"AppInput",setup(){const t=Uf(null),e=Uf(2),n=i_.newInstance();n.setRemoveDuplicateVertices(5);const r=yr.newInstance({scalarVisibility:!1}),a=vr.newInstance();a.setMapper(r);const s=u_.newInstance();s.setInputConnection(n.getOutputPort()),r.setInputConnection(s.getOutputPort());let i=null,o=null,c=null;function u(){!o||!c||(o.resetCamera(),c.render())}function g(l){l.preventDefault();const p=l.dataTransfer,v=l.target.files||p&&p.files;if(v&&v.length===1){const h=new FileReader;h.onload=function(){n.parseAsArrayBuffer(h.result),u()},h.readAsArrayBuffer(v[0])}}function f(l){const p=Number(l);e.value=p;try{a.getProperty().setRepresentation(p)}catch{}c&&c.render()}return Nl(()=>{i=bB.newInstance({rootContainer:t.value}),o=i.getRenderer(),c=i.getRenderWindow(),o.addActor(a),a.getProperty().setRepresentation(e.value),u()}),kl(()=>{i&&(i.delete(),i=null);try{a.delete(),r.delete()}catch{}}),{handleFile:g,representation:e,setRepresentation:f,vtkContainer:t}}},p_={class:"app-container"},h_={class:"main-layout"},d_={ref:"vtkContainer",class:"vtk-canvas"},v_={class:"controls",style:{"font-size":"14px"}},y_=["value"];function T_(t,e,n,r,a,s){return Fy(),Uy("div",p_,[e[6]||(e[6]=Ge("h1",{class:"title"},"My VTK Application",-1)),Ge("div",h_,[Ge("div",d_,null,512),e[2]||(e[2]=by('<div class="info-panel" data-v-17796f7a><h2 data-v-17796f7a>3D Cone Visualization</h2><p data-v-17796f7a> This is an interactive 3D visualization of a cone model using VTK.js. The cone is rendered in real-time with adjustable parameters. </p><h3 data-v-17796f7a>Features:</h3><ul data-v-17796f7a><li data-v-17796f7a>Interactive 3D rotation and zoom</li><li data-v-17796f7a>Real-time rendering updates</li><li data-v-17796f7a>Customizable cone resolution</li><li data-v-17796f7a>Multiple rendering modes</li></ul><h3 data-v-17796f7a>How to Use:</h3><ul data-v-17796f7a><li data-v-17796f7a>Drag to rotate the view</li><li data-v-17796f7a>Scroll to zoom in/out</li><li data-v-17796f7a>Use controls to adjust parameters</li></ul></div>',1))]),Ge("table",v_,[Ge("tbody",null,[Ge("tr",null,[e[4]||(e[4]=Ge("td",null,[Ge("label",null,"Representation:")],-1)),Ge("td",null,[Ge("select",{value:r.representation,onChange:e[0]||(e[0]=i=>r.setRepresentation(i.target.value))},[...e[3]||(e[3]=[Ge("option",{value:"0"},"Points",-1),Ge("option",{value:"1"},"Wireframe",-1),Ge("option",{value:"2"},"Surface",-1)])],40,y_)])]),Ge("tr",null,[e[5]||(e[5]=Ge("td",null,[Ge("label",null,"Load file:")],-1)),Ge("td",null,[Ge("input",{type:"file",onChange:e[1]||(e[1]=(...i)=>r.handleFile&&r.handleFile(...i))},null,32)])])])])])}const x_=g_(l_,[["render",T_],["__scopeId","data-v-17796f7a"]]);xT(x_).mount("#app");
