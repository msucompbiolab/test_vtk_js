(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();function fc(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Re={},Fr=[],Zt=()=>{},el=()=>!1,gi=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),uc=t=>t.startsWith("onUpdate:"),lt=Object.assign,gc=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Fd=Object.prototype.hasOwnProperty,ye=(t,e)=>Fd.call(t,e),ce=Array.isArray,va=t=>li(t)==="[object Map]",Bd=t=>li(t)==="[object Set]",oe=t=>typeof t=="function",Ie=t=>typeof t=="string",Pr=t=>typeof t=="symbol",ke=t=>t!==null&&typeof t=="object",tl=t=>(ke(t)||oe(t))&&oe(t.then)&&oe(t.catch),_d=Object.prototype.toString,li=t=>_d.call(t),Ud=t=>li(t).slice(8,-1),Nd=t=>li(t)==="[object Object]",lc=t=>Ie(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ya=fc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),hi=t=>{const e=Object.create(null);return(n=>e[n]||(e[n]=t(n)))},kd=/-\w/g,Wn=hi(t=>t.replace(kd,e=>e.slice(1).toUpperCase())),Gd=/\B([A-Z])/g,xr=hi(t=>t.replace(Gd,"-$1").toLowerCase()),nl=hi(t=>t.charAt(0).toUpperCase()+t.slice(1)),mi=hi(t=>t?`on${nl(t)}`:""),Gn=(t,e)=>!Object.is(t,e),Fi=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},rl=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},bd=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Df;const pi=()=>Df||(Df=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function hc(t){if(ce(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],a=Ie(r)?Hd(r):hc(r);if(a)for(const s in a)e[s]=a[s]}return e}else if(Ie(t)||ke(t))return t}const $d=/;(?![^(]*\))/g,Wd=/:([^]+)/,zd=/\/\*[^]*?\*\//g;function Hd(t){const e={};return t.replace(zd,"").split($d).forEach(n=>{if(n){const r=n.split(Wd);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function pc(t){let e="";if(Ie(t))e=t;else if(ce(t))for(let n=0;n<t.length;n++){const r=pc(t[n]);r&&(e+=r+" ")}else if(ke(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Ad="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",jd=fc(Ad);function al(t){return!!t||t===""}let yt;class Kd{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=yt,!e&&yt&&(this.index=(yt.scopes||(yt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=yt;try{return yt=this,e()}finally{yt=n}}}on(){++this._on===1&&(this.prevScope=yt,yt=this)}off(){this._on>0&&--this._on===0&&(yt=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.parent=void 0}}}function Pd(){return yt}let Ee;const Bi=new WeakSet;class sl{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,yt&&yt.active&&yt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Bi.has(this)&&(Bi.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ol(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Lf(this),cl(this);const e=Ee,n=bt;Ee=this,bt=!0;try{return this.fn()}finally{fl(this),Ee=e,bt=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)yc(e);this.deps=this.depsTail=void 0,Lf(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Bi.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Eo(this)&&this.run()}get dirty(){return Eo(this)}}let il=0,Ta,xa;function ol(t,e=!1){if(t.flags|=8,e){t.next=xa,xa=t;return}t.next=Ta,Ta=t}function dc(){il++}function vc(){if(--il>0)return;if(xa){let e=xa;for(xa=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Ta;){let e=Ta;for(Ta=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}function cl(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function fl(t){let e,n=t.depsTail,r=n;for(;r;){const a=r.prevDep;r.version===-1?(r===n&&(n=a),yc(r),Xd(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=a}t.deps=e,t.depsTail=n}function Eo(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(ul(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function ul(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Va)||(t.globalVersion=Va,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Eo(t))))return;t.flags|=2;const e=t.dep,n=Ee,r=bt;Ee=t,bt=!0;try{cl(t);const a=t.fn(t._value);(e.version===0||Gn(a,t._value))&&(t.flags|=128,t._value=a,e.version++)}catch(a){throw e.version++,a}finally{Ee=n,bt=r,fl(t),t.flags&=-3}}function yc(t,e=!1){const{dep:n,prevSub:r,nextSub:a}=t;if(r&&(r.nextSub=a,t.prevSub=void 0),a&&(a.prevSub=r,t.nextSub=void 0),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let s=n.computed.deps;s;s=s.nextDep)yc(s,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function Xd(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let bt=!0;const gl=[];function dn(){gl.push(bt),bt=!1}function vn(){const t=gl.pop();bt=t===void 0?!0:t}function Lf(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Ee;Ee=void 0;try{e()}finally{Ee=n}}}let Va=0;class Id{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Tc{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Ee||!bt||Ee===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Ee)n=this.activeLink=new Id(Ee,this),Ee.deps?(n.prevDep=Ee.depsTail,Ee.depsTail.nextDep=n,Ee.depsTail=n):Ee.deps=Ee.depsTail=n,ll(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=Ee.depsTail,n.nextDep=void 0,Ee.depsTail.nextDep=n,Ee.depsTail=n,Ee.deps===n&&(Ee.deps=r)}return n}trigger(e){this.version++,Va++,this.notify(e)}notify(e){dc();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{vc()}}}function ll(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)ll(r)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Ro=new WeakMap,fr=Symbol(""),Mo=Symbol(""),ma=Symbol("");function tt(t,e,n){if(bt&&Ee){let r=Ro.get(t);r||Ro.set(t,r=new Map);let a=r.get(n);a||(r.set(n,a=new Tc),a.map=r,a.key=n),a.track()}}function gn(t,e,n,r,a,s){const i=Ro.get(t);if(!i){Va++;return}const o=c=>{c&&c.trigger()};if(dc(),e==="clear")i.forEach(o);else{const c=ce(t),u=c&&lc(n);if(c&&n==="length"){const g=Number(r);i.forEach((f,l)=>{(l==="length"||l===ma||!Pr(l)&&l>=g)&&o(f)})}else switch((n!==void 0||i.has(void 0))&&o(i.get(n)),u&&o(i.get(ma)),e){case"add":c?u&&o(i.get("length")):(o(i.get(fr)),va(t)&&o(i.get(Mo)));break;case"delete":c||(o(i.get(fr)),va(t)&&o(i.get(Mo)));break;case"set":va(t)&&o(i.get(fr));break}}vc()}function wr(t){const e=ve(t);return e===t?e:(tt(e,"iterate",ma),$t(t)?e:e.map(yn))}function xc(t){return tt(t=ve(t),"iterate",ma),t}function mn(t,e){return zn(t)?Br(t)?Fa(yn(e)):Fa(e):yn(e)}const Yd={__proto__:null,[Symbol.iterator](){return _i(this,Symbol.iterator,t=>mn(this,t))},concat(...t){return wr(this).concat(...t.map(e=>ce(e)?wr(e):e))},entries(){return _i(this,"entries",t=>(t[1]=mn(this,t[1]),t))},every(t,e){return an(this,"every",t,e,void 0,arguments)},filter(t,e){return an(this,"filter",t,e,n=>n.map(r=>mn(this,r)),arguments)},find(t,e){return an(this,"find",t,e,n=>mn(this,n),arguments)},findIndex(t,e){return an(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return an(this,"findLast",t,e,n=>mn(this,n),arguments)},findLastIndex(t,e){return an(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return an(this,"forEach",t,e,void 0,arguments)},includes(...t){return Ui(this,"includes",t)},indexOf(...t){return Ui(this,"indexOf",t)},join(t){return wr(this).join(t)},lastIndexOf(...t){return Ui(this,"lastIndexOf",t)},map(t,e){return an(this,"map",t,e,void 0,arguments)},pop(){return Zr(this,"pop")},push(...t){return Zr(this,"push",t)},reduce(t,...e){return Vf(this,"reduce",t,e)},reduceRight(t,...e){return Vf(this,"reduceRight",t,e)},shift(){return Zr(this,"shift")},some(t,e){return an(this,"some",t,e,void 0,arguments)},splice(...t){return Zr(this,"splice",t)},toReversed(){return wr(this).toReversed()},toSorted(t){return wr(this).toSorted(t)},toSpliced(...t){return wr(this).toSpliced(...t)},unshift(...t){return Zr(this,"unshift",t)},values(){return _i(this,"values",t=>mn(this,t))}};function _i(t,e,n){const r=xc(t),a=r[e]();return r!==t&&!$t(t)&&(a._next=a.next,a.next=()=>{const s=a._next();return s.done||(s.value=n(s.value)),s}),a}const qd=Array.prototype;function an(t,e,n,r,a,s){const i=xc(t),o=i!==t&&!$t(t),c=i[e];if(c!==qd[e]){const f=c.apply(t,s);return o?yn(f):f}let u=n;i!==t&&(o?u=function(f,l){return n.call(this,mn(t,f),l,t)}:n.length>2&&(u=function(f,l){return n.call(this,f,l,t)}));const g=c.call(i,u,r);return o&&a?a(g):g}function Vf(t,e,n,r){const a=xc(t);let s=n;return a!==t&&($t(t)?n.length>3&&(s=function(i,o,c){return n.call(this,i,o,c,t)}):s=function(i,o,c){return n.call(this,i,mn(t,o),c,t)}),a[e](s,...r)}function Ui(t,e,n){const r=ve(t);tt(r,"iterate",ma);const a=r[e](...n);return(a===-1||a===!1)&&Ec(n[0])?(n[0]=ve(n[0]),r[e](...n)):a}function Zr(t,e,n=[]){dn(),dc();const r=ve(t)[e].apply(t,n);return vc(),vn(),r}const Qd=fc("__proto__,__v_isRef,__isVue"),hl=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Pr));function Zd(t){Pr(t)||(t=String(t));const e=ve(this);return tt(e,"has",t),e.hasOwnProperty(t)}class pl{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const a=this._isReadonly,s=this._isShallow;if(n==="__v_isReactive")return!a;if(n==="__v_isReadonly")return a;if(n==="__v_isShallow")return s;if(n==="__v_raw")return r===(a?s?cv:Tl:s?yl:vl).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const i=ce(e);if(!a){let c;if(i&&(c=Yd[n]))return c;if(n==="hasOwnProperty")return Zd}const o=Reflect.get(e,n,nt(e)?e:r);if((Pr(n)?hl.has(n):Qd(n))||(a||tt(e,"get",n),s))return o;if(nt(o)){const c=i&&lc(n)?o:o.value;return a&&ke(c)?Do(c):c}return ke(o)?a?Do(o):Cc(o):o}}class dl extends pl{constructor(e=!1){super(!1,e)}set(e,n,r,a){let s=e[n];const i=ce(e)&&lc(n);if(!this._isShallow){const u=zn(s);if(!$t(r)&&!zn(r)&&(s=ve(s),r=ve(r)),!i&&nt(s)&&!nt(r))return u||(s.value=r),!0}const o=i?Number(n)<e.length:ye(e,n),c=Reflect.set(e,n,r,nt(e)?e:a);return e===ve(a)&&(o?Gn(r,s)&&gn(e,"set",n,r):gn(e,"add",n,r)),c}deleteProperty(e,n){const r=ye(e,n);e[n];const a=Reflect.deleteProperty(e,n);return a&&r&&gn(e,"delete",n,void 0),a}has(e,n){const r=Reflect.has(e,n);return(!Pr(n)||!hl.has(n))&&tt(e,"has",n),r}ownKeys(e){return tt(e,"iterate",ce(e)?"length":fr),Reflect.ownKeys(e)}}class Jd extends pl{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const ev=new dl,tv=new Jd,nv=new dl(!0);const Oo=t=>t,Qa=t=>Reflect.getPrototypeOf(t);function rv(t,e,n){return function(...r){const a=this.__v_raw,s=ve(a),i=va(s),o=t==="entries"||t===Symbol.iterator&&i,c=t==="keys"&&i,u=a[t](...r),g=n?Oo:e?Fa:yn;return!e&&tt(s,"iterate",c?Mo:fr),{next(){const{value:f,done:l}=u.next();return l?{value:f,done:l}:{value:o?[g(f[0]),g(f[1])]:g(f),done:l}},[Symbol.iterator](){return this}}}}function Za(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function av(t,e){const n={get(a){const s=this.__v_raw,i=ve(s),o=ve(a);t||(Gn(a,o)&&tt(i,"get",a),tt(i,"get",o));const{has:c}=Qa(i),u=e?Oo:t?Fa:yn;if(c.call(i,a))return u(s.get(a));if(c.call(i,o))return u(s.get(o));s!==i&&s.get(a)},get size(){const a=this.__v_raw;return!t&&tt(ve(a),"iterate",fr),a.size},has(a){const s=this.__v_raw,i=ve(s),o=ve(a);return t||(Gn(a,o)&&tt(i,"has",a),tt(i,"has",o)),a===o?s.has(a):s.has(a)||s.has(o)},forEach(a,s){const i=this,o=i.__v_raw,c=ve(o),u=e?Oo:t?Fa:yn;return!t&&tt(c,"iterate",fr),o.forEach((g,f)=>a.call(s,u(g),u(f),i))}};return lt(n,t?{add:Za("add"),set:Za("set"),delete:Za("delete"),clear:Za("clear")}:{add(a){!e&&!$t(a)&&!zn(a)&&(a=ve(a));const s=ve(this);return Qa(s).has.call(s,a)||(s.add(a),gn(s,"add",a,a)),this},set(a,s){!e&&!$t(s)&&!zn(s)&&(s=ve(s));const i=ve(this),{has:o,get:c}=Qa(i);let u=o.call(i,a);u||(a=ve(a),u=o.call(i,a));const g=c.call(i,a);return i.set(a,s),u?Gn(s,g)&&gn(i,"set",a,s):gn(i,"add",a,s),this},delete(a){const s=ve(this),{has:i,get:o}=Qa(s);let c=i.call(s,a);c||(a=ve(a),c=i.call(s,a)),o&&o.call(s,a);const u=s.delete(a);return c&&gn(s,"delete",a,void 0),u},clear(){const a=ve(this),s=a.size!==0,i=a.clear();return s&&gn(a,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(a=>{n[a]=rv(a,t,e)}),n}function Sc(t,e){const n=av(t,e);return(r,a,s)=>a==="__v_isReactive"?!t:a==="__v_isReadonly"?t:a==="__v_raw"?r:Reflect.get(ye(n,a)&&a in r?n:r,a,s)}const sv={get:Sc(!1,!1)},iv={get:Sc(!1,!0)},ov={get:Sc(!0,!1)};const vl=new WeakMap,yl=new WeakMap,Tl=new WeakMap,cv=new WeakMap;function fv(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function uv(t){return t.__v_skip||!Object.isExtensible(t)?0:fv(Ud(t))}function Cc(t){return zn(t)?t:wc(t,!1,ev,sv,vl)}function gv(t){return wc(t,!1,nv,iv,yl)}function Do(t){return wc(t,!0,tv,ov,Tl)}function wc(t,e,n,r,a){if(!ke(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=uv(t);if(s===0)return t;const i=a.get(t);if(i)return i;const o=new Proxy(t,s===2?r:n);return a.set(t,o),o}function Br(t){return zn(t)?Br(t.__v_raw):!!(t&&t.__v_isReactive)}function zn(t){return!!(t&&t.__v_isReadonly)}function $t(t){return!!(t&&t.__v_isShallow)}function Ec(t){return t?!!t.__v_raw:!1}function ve(t){const e=t&&t.__v_raw;return e?ve(e):t}function lv(t){return!ye(t,"__v_skip")&&Object.isExtensible(t)&&rl(t,"__v_skip",!0),t}const yn=t=>ke(t)?Cc(t):t,Fa=t=>ke(t)?Do(t):t;function nt(t){return t?t.__v_isRef===!0:!1}function Ja(t){return hv(t,!1)}function hv(t,e){return nt(t)?t:new pv(t,e)}class pv{constructor(e,n){this.dep=new Tc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:ve(e),this._value=n?e:yn(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,r=this.__v_isShallow||$t(e)||zn(e);e=r?e:ve(e),Gn(e,n)&&(this._rawValue=e,this._value=r?e:yn(e),this.dep.trigger())}}function Lo(t){return nt(t)?t.value:t}const dv={get:(t,e,n)=>e==="__v_raw"?t:Lo(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const a=t[e];return nt(a)&&!nt(n)?(a.value=n,!0):Reflect.set(t,e,n,r)}};function xl(t){return Br(t)?t:new Proxy(t,dv)}class vv{constructor(e,n,r){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Tc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Va-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Ee!==this)return ol(this,!0),!0}get value(){const e=this.dep.track();return ul(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function yv(t,e,n=!1){let r,a;return oe(t)?r=t:(r=t.get,a=t.set),new vv(r,a,n)}const es={},As=new WeakMap;let nr;function Tv(t,e=!1,n=nr){if(n){let r=As.get(n);r||As.set(n,r=[]),r.push(t)}}function xv(t,e,n=Re){const{immediate:r,deep:a,once:s,scheduler:i,augmentJob:o,call:c}=n,u=T=>a?T:$t(T)||a===!1||a===0?Un(T,1):Un(T);let g,f,l,h,v=!1,p=!1;if(nt(t)?(f=()=>t.value,v=$t(t)):Br(t)?(f=()=>u(t),v=!0):ce(t)?(p=!0,v=t.some(T=>Br(T)||$t(T)),f=()=>t.map(T=>{if(nt(T))return T.value;if(Br(T))return u(T);if(oe(T))return c?c(T,2):T()})):oe(t)?e?f=c?()=>c(t,2):t:f=()=>{if(l){dn();try{l()}finally{vn()}}const T=nr;nr=g;try{return c?c(t,3,[h]):t(h)}finally{nr=T}}:f=Zt,e&&a){const T=f,w=a===!0?1/0:a;f=()=>Un(T(),w)}const d=Pd(),y=()=>{g.stop(),d&&d.active&&gc(d.effects,g)};if(s&&e){const T=e;e=(...w)=>{T(...w),y()}}let S=p?new Array(t.length).fill(es):es;const x=T=>{if(!(!(g.flags&1)||!g.dirty&&!T))if(e){const w=g.run();if(a||v||(p?w.some((C,R)=>Gn(C,S[R])):Gn(w,S))){l&&l();const C=nr;nr=g;try{const R=[w,S===es?void 0:p&&S[0]===es?[]:S,h];S=w,c?c(e,3,R):e(...R)}finally{nr=C}}}else g.run()};return o&&o(x),g=new sl(f),g.scheduler=i?()=>i(x,!1):x,h=T=>Tv(T,!1,g),l=g.onStop=()=>{const T=As.get(g);if(T){if(c)c(T,4);else for(const w of T)w();As.delete(g)}},e?r?x(!0):S=g.run():i?i(x.bind(null,!0),!0):g.run(),y.pause=g.pause.bind(g),y.resume=g.resume.bind(g),y.stop=y,y}function Un(t,e=1/0,n){if(e<=0||!ke(t)||t.__v_skip||(n=n||new Map,(n.get(t)||0)>=e))return t;if(n.set(t,e),e--,nt(t))Un(t.value,e,n);else if(ce(t))for(let r=0;r<t.length;r++)Un(t[r],e,n);else if(Bd(t)||va(t))t.forEach(r=>{Un(r,e,n)});else if(Nd(t)){for(const r in t)Un(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&Un(t[r],e,n)}return t}function za(t,e,n,r){try{return r?t(...r):t()}catch(a){di(a,e,n)}}function tn(t,e,n,r){if(oe(t)){const a=za(t,e,n,r);return a&&tl(a)&&a.catch(s=>{di(s,e,n)}),a}if(ce(t)){const a=[];for(let s=0;s<t.length;s++)a.push(tn(t[s],e,n,r));return a}}function di(t,e,n,r=!0){const a=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:i}=e&&e.appContext.config||Re;if(e){let o=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;o;){const g=o.ec;if(g){for(let f=0;f<g.length;f++)if(g[f](t,c,u)===!1)return}o=o.parent}if(s){dn(),za(s,null,10,[t,c,u]),vn();return}}Sv(t,n,a,r,i)}function Sv(t,e,n,r=!0,a=!1){if(a)throw t;console.error(t)}const ot=[];let Xt=-1;const _r=[];let Fn=null,Lr=0;const Sl=Promise.resolve();let js=null;function Cv(t){const e=js||Sl;return t?e.then(this?t.bind(this):t):e}function wv(t){let e=Xt+1,n=ot.length;for(;e<n;){const r=e+n>>>1,a=ot[r],s=Ba(a);s<t||s===t&&a.flags&2?e=r+1:n=r}return e}function Rc(t){if(!(t.flags&1)){const e=Ba(t),n=ot[ot.length-1];!n||!(t.flags&2)&&e>=Ba(n)?ot.push(t):ot.splice(wv(e),0,t),t.flags|=1,Cl()}}function Cl(){js||(js=Sl.then(El))}function Ev(t){ce(t)?_r.push(...t):Fn&&t.id===-1?Fn.splice(Lr+1,0,t):t.flags&1||(_r.push(t),t.flags|=1),Cl()}function mf(t,e,n=Xt+1){for(;n<ot.length;n++){const r=ot[n];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;ot.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function wl(t){if(_r.length){const e=[...new Set(_r)].sort((n,r)=>Ba(n)-Ba(r));if(_r.length=0,Fn){Fn.push(...e);return}for(Fn=e,Lr=0;Lr<Fn.length;Lr++){const n=Fn[Lr];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Fn=null,Lr=0}}const Ba=t=>t.id==null?t.flags&2?-1:1/0:t.id;function El(t){try{for(Xt=0;Xt<ot.length;Xt++){const e=ot[Xt];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),za(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Xt<ot.length;Xt++){const e=ot[Xt];e&&(e.flags&=-2)}Xt=-1,ot.length=0,wl(),js=null,(ot.length||_r.length)&&El()}}let Qt=null,Rl=null;function Ks(t){const e=Qt;return Qt=t,Rl=t&&t.type.__scopeId||null,e}function Rv(t,e=Qt,n){if(!e||t._n)return t;const r=(...a)=>{r._d&&Wf(-1);const s=Ks(e);let i;try{i=t(...a)}finally{Ks(s),r._d&&Wf(1)}return i};return r._n=!0,r._c=!0,r._d=!0,r}function Pn(t,e,n,r){const a=t.dirs,s=e&&e.dirs;for(let i=0;i<a.length;i++){const o=a[i];s&&(o.oldValue=s[i].value);let c=o.dir[r];c&&(dn(),tn(c,n,8,[t.el,o,t,e]),vn())}}const Mv=Symbol("_vte"),Ov=t=>t.__isTeleport,Dv=Symbol("_leaveCb");function Mc(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Mc(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Ml(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const Ps=new WeakMap;function Sa(t,e,n,r,a=!1){if(ce(t)){t.forEach((v,p)=>Sa(v,e&&(ce(e)?e[p]:e),n,r,a));return}if(Ca(r)&&!a){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Sa(t,e,n,r.component.subTree);return}const s=r.shapeFlag&4?mc(r.component):r.el,i=a?null:s,{i:o,r:c}=t,u=e&&e.r,g=o.refs===Re?o.refs={}:o.refs,f=o.setupState,l=ve(f),h=f===Re?el:v=>ye(l,v);if(u!=null&&u!==c){if(Ff(e),Ie(u))g[u]=null,h(u)&&(f[u]=null);else if(nt(u)){u.value=null;const v=e;v.k&&(g[v.k]=null)}}if(oe(c))za(c,o,12,[i,g]);else{const v=Ie(c),p=nt(c);if(v||p){const d=()=>{if(t.f){const y=v?h(c)?f[c]:g[c]:c.value;if(a)ce(y)&&gc(y,s);else if(ce(y))y.includes(s)||y.push(s);else if(v)g[c]=[s],h(c)&&(f[c]=g[c]);else{const S=[s];c.value=S,t.k&&(g[t.k]=S)}}else v?(g[c]=i,h(c)&&(f[c]=i)):p&&(c.value=i,t.k&&(g[t.k]=i))};if(i){const y=()=>{d(),Ps.delete(t)};y.id=-1,Ps.set(t,y),Ct(y,n)}else Ff(t),d()}}}function Ff(t){const e=Ps.get(t);e&&(e.flags|=8,Ps.delete(t))}pi().requestIdleCallback;pi().cancelIdleCallback;const Ca=t=>!!t.type.__asyncLoader,Ol=t=>t.type.__isKeepAlive;function Lv(t,e){Dl(t,"a",e)}function Vv(t,e){Dl(t,"da",e)}function Dl(t,e,n=ft){const r=t.__wdc||(t.__wdc=()=>{let a=n;for(;a;){if(a.isDeactivated)return;a=a.parent}return t()});if(vi(e,r,n),n){let a=n.parent;for(;a&&a.parent;)Ol(a.parent.vnode)&&mv(r,e,n,a),a=a.parent}}function mv(t,e,n,r){const a=vi(e,t,r,!0);ml(()=>{gc(r[e],a)},n)}function vi(t,e,n=ft,r=!1){if(n){const a=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...i)=>{dn();const o=Ha(n),c=tn(e,n,t,i);return o(),vn(),c});return r?a.unshift(s):a.push(s),s}}const xn=t=>(e,n=ft)=>{(!Ua||t==="sp")&&vi(t,(...r)=>e(...r),n)},Fv=xn("bm"),Ll=xn("m"),Bv=xn("bu"),_v=xn("u"),Vl=xn("bum"),ml=xn("um"),Uv=xn("sp"),Nv=xn("rtg"),kv=xn("rtc");function Gv(t,e=ft){vi("ec",t,e)}const bv=Symbol.for("v-ndc"),Vo=t=>t?Yl(t)?mc(t):Vo(t.parent):null,wa=lt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Vo(t.parent),$root:t=>Vo(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Bl(t),$forceUpdate:t=>t.f||(t.f=()=>{Rc(t.update)}),$nextTick:t=>t.n||(t.n=Cv.bind(t.proxy)),$watch:t=>Qv.bind(t)}),Ni=(t,e)=>t!==Re&&!t.__isScriptSetup&&ye(t,e),$v={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:a,props:s,accessCache:i,type:o,appContext:c}=t;if(e[0]!=="$"){const l=i[e];if(l!==void 0)switch(l){case 1:return r[e];case 2:return a[e];case 4:return n[e];case 3:return s[e]}else{if(Ni(r,e))return i[e]=1,r[e];if(a!==Re&&ye(a,e))return i[e]=2,a[e];if(ye(s,e))return i[e]=3,s[e];if(n!==Re&&ye(n,e))return i[e]=4,n[e];mo&&(i[e]=0)}}const u=wa[e];let g,f;if(u)return e==="$attrs"&&tt(t.attrs,"get",""),u(t);if((g=o.__cssModules)&&(g=g[e]))return g;if(n!==Re&&ye(n,e))return i[e]=4,n[e];if(f=c.config.globalProperties,ye(f,e))return f[e]},set({_:t},e,n){const{data:r,setupState:a,ctx:s}=t;return Ni(a,e)?(a[e]=n,!0):r!==Re&&ye(r,e)?(r[e]=n,!0):ye(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:a,props:s,type:i}},o){let c;return!!(n[o]||t!==Re&&o[0]!=="$"&&ye(t,o)||Ni(e,o)||ye(s,o)||ye(r,o)||ye(wa,o)||ye(a.config.globalProperties,o)||(c=i.__cssModules)&&c[o])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ye(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Bf(t){return ce(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let mo=!0;function Wv(t){const e=Bl(t),n=t.proxy,r=t.ctx;mo=!1,e.beforeCreate&&_f(e.beforeCreate,t,"bc");const{data:a,computed:s,methods:i,watch:o,provide:c,inject:u,created:g,beforeMount:f,mounted:l,beforeUpdate:h,updated:v,activated:p,deactivated:d,beforeDestroy:y,beforeUnmount:S,destroyed:x,unmounted:T,render:w,renderTracked:C,renderTriggered:R,errorCaptured:M,serverPrefetch:m,expose:L,inheritAttrs:V,components:F,directives:B,filters:_}=e;if(u&&zv(u,r,null),i)for(const A in i){const I=i[A];oe(I)&&(r[A]=I.bind(n))}if(a){const A=a.call(n,n);ke(A)&&(t.data=Cc(A))}if(mo=!0,s)for(const A in s){const I=s[A],k=oe(I)?I.bind(n,n):oe(I.get)?I.get.bind(n,n):Zt,Y=!oe(I)&&oe(I.set)?I.set.bind(n):Zt,te=Uy({get:k,set:Y});Object.defineProperty(r,A,{enumerable:!0,configurable:!0,get:()=>te.value,set:J=>te.value=J})}if(o)for(const A in o)Fl(o[A],r,n,A);if(c){const A=oe(c)?c.call(n):c;Reflect.ownKeys(A).forEach(I=>{Xv(I,A[I])})}g&&_f(g,t,"c");function z(A,I){ce(I)?I.forEach(k=>A(k.bind(n))):I&&A(I.bind(n))}if(z(Fv,f),z(Ll,l),z(Bv,h),z(_v,v),z(Lv,p),z(Vv,d),z(Gv,M),z(kv,C),z(Nv,R),z(Vl,S),z(ml,T),z(Uv,m),ce(L))if(L.length){const A=t.exposed||(t.exposed={});L.forEach(I=>{Object.defineProperty(A,I,{get:()=>n[I],set:k=>n[I]=k,enumerable:!0})})}else t.exposed||(t.exposed={});w&&t.render===Zt&&(t.render=w),V!=null&&(t.inheritAttrs=V),F&&(t.components=F),B&&(t.directives=B),m&&Ml(t)}function zv(t,e,n=Zt){ce(t)&&(t=Fo(t));for(const r in t){const a=t[r];let s;ke(a)?"default"in a?s=Rs(a.from||r,a.default,!0):s=Rs(a.from||r):s=Rs(a),nt(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:i=>s.value=i}):e[r]=s}}function _f(t,e,n){tn(ce(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function Fl(t,e,n,r){let a=r.includes(".")?Ul(n,r):()=>n[r];if(Ie(t)){const s=e[t];oe(s)&&ki(a,s)}else if(oe(t))ki(a,t.bind(n));else if(ke(t))if(ce(t))t.forEach(s=>Fl(s,e,n,r));else{const s=oe(t.handler)?t.handler.bind(n):e[t.handler];oe(s)&&ki(a,s,t)}}function Bl(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:a,optionsCache:s,config:{optionMergeStrategies:i}}=t.appContext,o=s.get(e);let c;return o?c=o:!a.length&&!n&&!r?c=e:(c={},a.length&&a.forEach(u=>Xs(c,u,i,!0)),Xs(c,e,i)),ke(e)&&s.set(e,c),c}function Xs(t,e,n,r=!1){const{mixins:a,extends:s}=e;s&&Xs(t,s,n,!0),a&&a.forEach(i=>Xs(t,i,n,!0));for(const i in e)if(!(r&&i==="expose")){const o=Hv[i]||n&&n[i];t[i]=o?o(t[i],e[i]):e[i]}return t}const Hv={data:Uf,props:Nf,emits:Nf,methods:oa,computed:oa,beforeCreate:it,created:it,beforeMount:it,mounted:it,beforeUpdate:it,updated:it,beforeDestroy:it,beforeUnmount:it,destroyed:it,unmounted:it,activated:it,deactivated:it,errorCaptured:it,serverPrefetch:it,components:oa,directives:oa,watch:jv,provide:Uf,inject:Av};function Uf(t,e){return e?t?function(){return lt(oe(t)?t.call(this,this):t,oe(e)?e.call(this,this):e)}:e:t}function Av(t,e){return oa(Fo(t),Fo(e))}function Fo(t){if(ce(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function it(t,e){return t?[...new Set([].concat(t,e))]:e}function oa(t,e){return t?lt(Object.create(null),t,e):e}function Nf(t,e){return t?ce(t)&&ce(e)?[...new Set([...t,...e])]:lt(Object.create(null),Bf(t),Bf(e??{})):e}function jv(t,e){if(!t)return e;if(!e)return t;const n=lt(Object.create(null),t);for(const r in e)n[r]=it(t[r],e[r]);return n}function _l(){return{app:null,config:{isNativeTag:el,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Kv=0;function Pv(t,e){return function(r,a=null){oe(r)||(r=lt({},r)),a!=null&&!ke(a)&&(a=null);const s=_l(),i=new WeakSet,o=[];let c=!1;const u=s.app={_uid:Kv++,_component:r,_props:a,_container:null,_context:s,_instance:null,version:Ny,get config(){return s.config},set config(g){},use(g,...f){return i.has(g)||(g&&oe(g.install)?(i.add(g),g.install(u,...f)):oe(g)&&(i.add(g),g(u,...f))),u},mixin(g){return s.mixins.includes(g)||s.mixins.push(g),u},component(g,f){return f?(s.components[g]=f,u):s.components[g]},directive(g,f){return f?(s.directives[g]=f,u):s.directives[g]},mount(g,f,l){if(!c){const h=u._ceVNode||bn(r,a);return h.appContext=s,l===!0?l="svg":l===!1&&(l=void 0),t(h,g,l),c=!0,u._container=g,g.__vue_app__=u,mc(h.component)}},onUnmount(g){o.push(g)},unmount(){c&&(tn(o,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(g,f){return s.provides[g]=f,u},runWithContext(g){const f=Ur;Ur=u;try{return g()}finally{Ur=f}}};return u}}let Ur=null;function Xv(t,e){if(ft){let n=ft.provides;const r=ft.parent&&ft.parent.provides;r===n&&(n=ft.provides=Object.create(r)),n[t]=e}}function Rs(t,e,n=!1){const r=Ly();if(r||Ur){let a=Ur?Ur._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(a&&t in a)return a[t];if(arguments.length>1)return n&&oe(e)?e.call(r&&r.proxy):e}}const Iv=Symbol.for("v-scx"),Yv=()=>Rs(Iv);function qv(t,e){return Oc(t,null,e)}function ki(t,e,n){return Oc(t,e,n)}function Oc(t,e,n=Re){const{immediate:r,deep:a,flush:s,once:i}=n,o=lt({},n),c=e&&r||!e&&s!=="post";let u;if(Ua){if(s==="sync"){const h=Yv();u=h.__watcherHandles||(h.__watcherHandles=[])}else if(!c){const h=()=>{};return h.stop=Zt,h.resume=Zt,h.pause=Zt,h}}const g=ft;o.call=(h,v,p)=>tn(h,g,v,p);let f=!1;s==="post"?o.scheduler=h=>{Ct(h,g&&g.suspense)}:s!=="sync"&&(f=!0,o.scheduler=(h,v)=>{v?h():Rc(h)}),o.augmentJob=h=>{e&&(h.flags|=4),f&&(h.flags|=2,g&&(h.id=g.uid,h.i=g))};const l=xv(t,e,o);return Ua&&(u?u.push(l):c&&l()),l}function Qv(t,e,n){const r=this.proxy,a=Ie(t)?t.includes(".")?Ul(r,t):()=>r[t]:t.bind(r,r);let s;oe(e)?s=e:(s=e.handler,n=e);const i=Ha(this),o=Oc(a,s.bind(r),n);return i(),o}function Ul(t,e){const n=e.split(".");return()=>{let r=t;for(let a=0;a<n.length&&r;a++)r=r[n[a]];return r}}const Zv=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Wn(e)}Modifiers`]||t[`${xr(e)}Modifiers`];function Jv(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Re;let a=n;const s=e.startsWith("update:"),i=s&&Zv(r,e.slice(7));i&&(i.trim&&(a=n.map(g=>Ie(g)?g.trim():g)),i.number&&(a=n.map(bd)));let o,c=r[o=mi(e)]||r[o=mi(Wn(e))];!c&&s&&(c=r[o=mi(xr(e))]),c&&tn(c,t,6,a);const u=r[o+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,tn(u,t,6,a)}}const ey=new WeakMap;function Nl(t,e,n=!1){const r=n?ey:e.emitsCache,a=r.get(t);if(a!==void 0)return a;const s=t.emits;let i={},o=!1;if(!oe(t)){const c=u=>{const g=Nl(u,e,!0);g&&(o=!0,lt(i,g))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!s&&!o?(ke(t)&&r.set(t,null),null):(ce(s)?s.forEach(c=>i[c]=null):lt(i,s),ke(t)&&r.set(t,i),i)}function yi(t,e){return!t||!gi(e)?!1:(e=e.slice(2).replace(/Once$/,""),ye(t,e[0].toLowerCase()+e.slice(1))||ye(t,xr(e))||ye(t,e))}function kf(t){const{type:e,vnode:n,proxy:r,withProxy:a,propsOptions:[s],slots:i,attrs:o,emit:c,render:u,renderCache:g,props:f,data:l,setupState:h,ctx:v,inheritAttrs:p}=t,d=Ks(t);let y,S;try{if(n.shapeFlag&4){const T=a||r,w=T;y=Yt(u.call(w,T,g,f,h,l,v)),S=o}else{const T=e;y=Yt(T.length>1?T(f,{attrs:o,slots:i,emit:c}):T(f,null)),S=e.props?o:ty(o)}}catch(T){Ea.length=0,di(T,t,1),y=bn(br)}let x=y;if(S&&p!==!1){const T=Object.keys(S),{shapeFlag:w}=x;T.length&&w&7&&(s&&T.some(uc)&&(S=ny(S,s)),x=$r(x,S,!1,!0))}return n.dirs&&(x=$r(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(n.dirs):n.dirs),n.transition&&Mc(x,n.transition),y=x,Ks(d),y}const ty=t=>{let e;for(const n in t)(n==="class"||n==="style"||gi(n))&&((e||(e={}))[n]=t[n]);return e},ny=(t,e)=>{const n={};for(const r in t)(!uc(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function ry(t,e,n){const{props:r,children:a,component:s}=t,{props:i,children:o,patchFlag:c}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?Gf(r,i,u):!!i;if(c&8){const g=e.dynamicProps;for(let f=0;f<g.length;f++){const l=g[f];if(i[l]!==r[l]&&!yi(u,l))return!0}}}else return(a||o)&&(!o||!o.$stable)?!0:r===i?!1:r?i?Gf(r,i,u):!0:!!i;return!1}function Gf(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let a=0;a<r.length;a++){const s=r[a];if(e[s]!==t[s]&&!yi(n,s))return!0}return!1}function ay({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const kl={},Gl=()=>Object.create(kl),bl=t=>Object.getPrototypeOf(t)===kl;function sy(t,e,n,r=!1){const a={},s=Gl();t.propsDefaults=Object.create(null),$l(t,e,a,s);for(const i in t.propsOptions[0])i in a||(a[i]=void 0);n?t.props=r?a:gv(a):t.type.props?t.props=a:t.props=s,t.attrs=s}function iy(t,e,n,r){const{props:a,attrs:s,vnode:{patchFlag:i}}=t,o=ve(a),[c]=t.propsOptions;let u=!1;if((r||i>0)&&!(i&16)){if(i&8){const g=t.vnode.dynamicProps;for(let f=0;f<g.length;f++){let l=g[f];if(yi(t.emitsOptions,l))continue;const h=e[l];if(c)if(ye(s,l))h!==s[l]&&(s[l]=h,u=!0);else{const v=Wn(l);a[v]=Bo(c,o,v,h,t,!1)}else h!==s[l]&&(s[l]=h,u=!0)}}}else{$l(t,e,a,s)&&(u=!0);let g;for(const f in o)(!e||!ye(e,f)&&((g=xr(f))===f||!ye(e,g)))&&(c?n&&(n[f]!==void 0||n[g]!==void 0)&&(a[f]=Bo(c,o,f,void 0,t,!0)):delete a[f]);if(s!==o)for(const f in s)(!e||!ye(e,f))&&(delete s[f],u=!0)}u&&gn(t.attrs,"set","")}function $l(t,e,n,r){const[a,s]=t.propsOptions;let i=!1,o;if(e)for(let c in e){if(ya(c))continue;const u=e[c];let g;a&&ye(a,g=Wn(c))?!s||!s.includes(g)?n[g]=u:(o||(o={}))[g]=u:yi(t.emitsOptions,c)||(!(c in r)||u!==r[c])&&(r[c]=u,i=!0)}if(s){const c=ve(n),u=o||Re;for(let g=0;g<s.length;g++){const f=s[g];n[f]=Bo(a,c,f,u[f],t,!ye(u,f))}}return i}function Bo(t,e,n,r,a,s){const i=t[n];if(i!=null){const o=ye(i,"default");if(o&&r===void 0){const c=i.default;if(i.type!==Function&&!i.skipFactory&&oe(c)){const{propsDefaults:u}=a;if(n in u)r=u[n];else{const g=Ha(a);r=u[n]=c.call(null,e),g()}}else r=c;a.ce&&a.ce._setProp(n,r)}i[0]&&(s&&!o?r=!1:i[1]&&(r===""||r===xr(n))&&(r=!0))}return r}const oy=new WeakMap;function Wl(t,e,n=!1){const r=n?oy:e.propsCache,a=r.get(t);if(a)return a;const s=t.props,i={},o=[];let c=!1;if(!oe(t)){const g=f=>{c=!0;const[l,h]=Wl(f,e,!0);lt(i,l),h&&o.push(...h)};!n&&e.mixins.length&&e.mixins.forEach(g),t.extends&&g(t.extends),t.mixins&&t.mixins.forEach(g)}if(!s&&!c)return ke(t)&&r.set(t,Fr),Fr;if(ce(s))for(let g=0;g<s.length;g++){const f=Wn(s[g]);bf(f)&&(i[f]=Re)}else if(s)for(const g in s){const f=Wn(g);if(bf(f)){const l=s[g],h=i[f]=ce(l)||oe(l)?{type:l}:lt({},l),v=h.type;let p=!1,d=!0;if(ce(v))for(let y=0;y<v.length;++y){const S=v[y],x=oe(S)&&S.name;if(x==="Boolean"){p=!0;break}else x==="String"&&(d=!1)}else p=oe(v)&&v.name==="Boolean";h[0]=p,h[1]=d,(p||ye(h,"default"))&&o.push(f)}}const u=[i,o];return ke(t)&&r.set(t,u),u}function bf(t){return t[0]!=="$"&&!ya(t)}const Dc=t=>t==="_"||t==="_ctx"||t==="$stable",Lc=t=>ce(t)?t.map(Yt):[Yt(t)],cy=(t,e,n)=>{if(e._n)return e;const r=Rv((...a)=>Lc(e(...a)),n);return r._c=!1,r},zl=(t,e,n)=>{const r=t._ctx;for(const a in t){if(Dc(a))continue;const s=t[a];if(oe(s))e[a]=cy(a,s,r);else if(s!=null){const i=Lc(s);e[a]=()=>i}}},Hl=(t,e)=>{const n=Lc(e);t.slots.default=()=>n},Al=(t,e,n)=>{for(const r in e)(n||!Dc(r))&&(t[r]=e[r])},fy=(t,e,n)=>{const r=t.slots=Gl();if(t.vnode.shapeFlag&32){const a=e._;a?(Al(r,e,n),n&&rl(r,"_",a,!0)):zl(e,r)}else e&&Hl(t,e)},uy=(t,e,n)=>{const{vnode:r,slots:a}=t;let s=!0,i=Re;if(r.shapeFlag&32){const o=e._;o?n&&o===1?s=!1:Al(a,e,n):(s=!e.$stable,zl(e,a)),i=e}else e&&(Hl(t,e),i={default:1});if(s)for(const o in a)!Dc(o)&&i[o]==null&&delete a[o]},Ct=dy;function gy(t){return ly(t)}function ly(t,e){const n=pi();n.__VUE__=!0;const{insert:r,remove:a,patchProp:s,createElement:i,createText:o,createComment:c,setText:u,setElementText:g,parentNode:f,nextSibling:l,setScopeId:h=Zt,insertStaticContent:v}=t,p=(O,D,U,W=null,G=null,b=null,K=void 0,j=null,H=!!D.dynamicChildren)=>{if(O===D)return;O&&!Jr(O,D)&&(W=$e(O),J(O,G,b,!0),O=null),D.patchFlag===-2&&(H=!1,D.dynamicChildren=null);const{type:$,ref:Z,shapeFlag:X}=D;switch($){case Ti:d(O,D,U,W);break;case br:y(O,D,U,W);break;case Ms:O==null&&S(D,U,W,K);break;case fn:F(O,D,U,W,G,b,K,j,H);break;default:X&1?w(O,D,U,W,G,b,K,j,H):X&6?B(O,D,U,W,G,b,K,j,H):(X&64||X&128)&&$.process(O,D,U,W,G,b,K,j,H,je)}Z!=null&&G?Sa(Z,O&&O.ref,b,D||O,!D):Z==null&&O&&O.ref!=null&&Sa(O.ref,null,b,O,!0)},d=(O,D,U,W)=>{if(O==null)r(D.el=o(D.children),U,W);else{const G=D.el=O.el;D.children!==O.children&&u(G,D.children)}},y=(O,D,U,W)=>{O==null?r(D.el=c(D.children||""),U,W):D.el=O.el},S=(O,D,U,W)=>{[O.el,O.anchor]=v(O.children,D,U,W,O.el,O.anchor)},x=({el:O,anchor:D},U,W)=>{let G;for(;O&&O!==D;)G=l(O),r(O,U,W),O=G;r(D,U,W)},T=({el:O,anchor:D})=>{let U;for(;O&&O!==D;)U=l(O),a(O),O=U;a(D)},w=(O,D,U,W,G,b,K,j,H)=>{if(D.type==="svg"?K="svg":D.type==="math"&&(K="mathml"),O==null)C(D,U,W,G,b,K,j,H);else{const $=O.el&&O.el._isVueCE?O.el:null;try{$&&$._beginPatch(),m(O,D,G,b,K,j,H)}finally{$&&$._endPatch()}}},C=(O,D,U,W,G,b,K,j)=>{let H,$;const{props:Z,shapeFlag:X,transition:Q,dirs:ne}=O;if(H=O.el=i(O.type,b,Z&&Z.is,Z),X&8?g(H,O.children):X&16&&M(O.children,H,null,W,G,Gi(O,b),K,j),ne&&Pn(O,null,W,"created"),R(H,O,O.scopeId,K,W),Z){for(const we in Z)we!=="value"&&!ya(we)&&s(H,we,null,Z[we],b,W);"value"in Z&&s(H,"value",null,Z.value,b),($=Z.onVnodeBeforeMount)&&At($,W,O)}ne&&Pn(O,null,W,"beforeMount");const le=hy(G,Q);le&&Q.beforeEnter(H),r(H,D,U),(($=Z&&Z.onVnodeMounted)||le||ne)&&Ct(()=>{$&&At($,W,O),le&&Q.enter(H),ne&&Pn(O,null,W,"mounted")},G)},R=(O,D,U,W,G)=>{if(U&&h(O,U),W)for(let b=0;b<W.length;b++)h(O,W[b]);if(G){let b=G.subTree;if(D===b||Pl(b.type)&&(b.ssContent===D||b.ssFallback===D)){const K=G.vnode;R(O,K,K.scopeId,K.slotScopeIds,G.parent)}}},M=(O,D,U,W,G,b,K,j,H=0)=>{for(let $=H;$<O.length;$++){const Z=O[$]=j?Bn(O[$]):Yt(O[$]);p(null,Z,D,U,W,G,b,K,j)}},m=(O,D,U,W,G,b,K)=>{const j=D.el=O.el;let{patchFlag:H,dynamicChildren:$,dirs:Z}=D;H|=O.patchFlag&16;const X=O.props||Re,Q=D.props||Re;let ne;if(U&&Xn(U,!1),(ne=Q.onVnodeBeforeUpdate)&&At(ne,U,D,O),Z&&Pn(D,O,U,"beforeUpdate"),U&&Xn(U,!0),(X.innerHTML&&Q.innerHTML==null||X.textContent&&Q.textContent==null)&&g(j,""),$?L(O.dynamicChildren,$,j,U,W,Gi(D,G),b):K||I(O,D,j,null,U,W,Gi(D,G),b,!1),H>0){if(H&16)V(j,X,Q,U,G);else if(H&2&&X.class!==Q.class&&s(j,"class",null,Q.class,G),H&4&&s(j,"style",X.style,Q.style,G),H&8){const le=D.dynamicProps;for(let we=0;we<le.length;we++){const xe=le[we],dt=X[xe],vt=Q[xe];(vt!==dt||xe==="value")&&s(j,xe,dt,vt,G,U)}}H&1&&O.children!==D.children&&g(j,D.children)}else!K&&$==null&&V(j,X,Q,U,G);((ne=Q.onVnodeUpdated)||Z)&&Ct(()=>{ne&&At(ne,U,D,O),Z&&Pn(D,O,U,"updated")},W)},L=(O,D,U,W,G,b,K)=>{for(let j=0;j<D.length;j++){const H=O[j],$=D[j],Z=H.el&&(H.type===fn||!Jr(H,$)||H.shapeFlag&198)?f(H.el):U;p(H,$,Z,null,W,G,b,K,!0)}},V=(O,D,U,W,G)=>{if(D!==U){if(D!==Re)for(const b in D)!ya(b)&&!(b in U)&&s(O,b,D[b],null,G,W);for(const b in U){if(ya(b))continue;const K=U[b],j=D[b];K!==j&&b!=="value"&&s(O,b,j,K,G,W)}"value"in U&&s(O,"value",D.value,U.value,G)}},F=(O,D,U,W,G,b,K,j,H)=>{const $=D.el=O?O.el:o(""),Z=D.anchor=O?O.anchor:o("");let{patchFlag:X,dynamicChildren:Q,slotScopeIds:ne}=D;ne&&(j=j?j.concat(ne):ne),O==null?(r($,U,W),r(Z,U,W),M(D.children||[],U,Z,G,b,K,j,H)):X>0&&X&64&&Q&&O.dynamicChildren?(L(O.dynamicChildren,Q,U,G,b,K,j),(D.key!=null||G&&D===G.subTree)&&jl(O,D,!0)):I(O,D,U,Z,G,b,K,j,H)},B=(O,D,U,W,G,b,K,j,H)=>{D.slotScopeIds=j,O==null?D.shapeFlag&512?G.ctx.activate(D,U,W,K,H):_(D,U,W,G,b,K,H):P(O,D,H)},_=(O,D,U,W,G,b,K)=>{const j=O.component=Dy(O,W,G);if(Ol(O)&&(j.ctx.renderer=je),Vy(j,!1,K),j.asyncDep){if(G&&G.registerDep(j,z,K),!O.el){const H=j.subTree=bn(br);y(null,H,D,U),O.placeholder=H.el}}else z(j,O,D,U,G,b,K)},P=(O,D,U)=>{const W=D.component=O.component;if(ry(O,D,U))if(W.asyncDep&&!W.asyncResolved){A(W,D,U);return}else W.next=D,W.update();else D.el=O.el,W.vnode=D},z=(O,D,U,W,G,b,K)=>{const j=()=>{if(O.isMounted){let{next:X,bu:Q,u:ne,parent:le,vnode:we}=O;{const zt=Kl(O);if(zt){X&&(X.el=we.el,A(O,X,K)),zt.asyncDep.then(()=>{O.isUnmounted||j()});return}}let xe=X,dt;Xn(O,!1),X?(X.el=we.el,A(O,X,K)):X=we,Q&&Fi(Q),(dt=X.props&&X.props.onVnodeBeforeUpdate)&&At(dt,le,X,we),Xn(O,!0);const vt=kf(O),Wt=O.subTree;O.subTree=vt,p(Wt,vt,f(Wt.el),$e(Wt),O,G,b),X.el=vt.el,xe===null&&ay(O,vt.el),ne&&Ct(ne,G),(dt=X.props&&X.props.onVnodeUpdated)&&Ct(()=>At(dt,le,X,we),G)}else{let X;const{el:Q,props:ne}=D,{bm:le,m:we,parent:xe,root:dt,type:vt}=O,Wt=Ca(D);Xn(O,!1),le&&Fi(le),!Wt&&(X=ne&&ne.onVnodeBeforeMount)&&At(X,xe,D),Xn(O,!0);{dt.ce&&dt.ce._def.shadowRoot!==!1&&dt.ce._injectChildStyle(vt);const zt=O.subTree=kf(O);p(null,zt,U,W,O,G,b),D.el=zt.el}if(we&&Ct(we,G),!Wt&&(X=ne&&ne.onVnodeMounted)){const zt=D;Ct(()=>At(X,xe,zt),G)}(D.shapeFlag&256||xe&&Ca(xe.vnode)&&xe.vnode.shapeFlag&256)&&O.a&&Ct(O.a,G),O.isMounted=!0,D=U=W=null}};O.scope.on();const H=O.effect=new sl(j);O.scope.off();const $=O.update=H.run.bind(H),Z=O.job=H.runIfDirty.bind(H);Z.i=O,Z.id=O.uid,H.scheduler=()=>Rc(Z),Xn(O,!0),$()},A=(O,D,U)=>{D.component=O;const W=O.vnode.props;O.vnode=D,O.next=null,iy(O,D.props,W,U),uy(O,D.children,U),dn(),mf(O),vn()},I=(O,D,U,W,G,b,K,j,H=!1)=>{const $=O&&O.children,Z=O?O.shapeFlag:0,X=D.children,{patchFlag:Q,shapeFlag:ne}=D;if(Q>0){if(Q&128){Y($,X,U,W,G,b,K,j,H);return}else if(Q&256){k($,X,U,W,G,b,K,j,H);return}}ne&8?(Z&16&&Se($,G,b),X!==$&&g(U,X)):Z&16?ne&16?Y($,X,U,W,G,b,K,j,H):Se($,G,b,!0):(Z&8&&g(U,""),ne&16&&M(X,U,W,G,b,K,j,H))},k=(O,D,U,W,G,b,K,j,H)=>{O=O||Fr,D=D||Fr;const $=O.length,Z=D.length,X=Math.min($,Z);let Q;for(Q=0;Q<X;Q++){const ne=D[Q]=H?Bn(D[Q]):Yt(D[Q]);p(O[Q],ne,U,null,G,b,K,j,H)}$>Z?Se(O,G,b,!0,!1,X):M(D,U,W,G,b,K,j,H,X)},Y=(O,D,U,W,G,b,K,j,H)=>{let $=0;const Z=D.length;let X=O.length-1,Q=Z-1;for(;$<=X&&$<=Q;){const ne=O[$],le=D[$]=H?Bn(D[$]):Yt(D[$]);if(Jr(ne,le))p(ne,le,U,null,G,b,K,j,H);else break;$++}for(;$<=X&&$<=Q;){const ne=O[X],le=D[Q]=H?Bn(D[Q]):Yt(D[Q]);if(Jr(ne,le))p(ne,le,U,null,G,b,K,j,H);else break;X--,Q--}if($>X){if($<=Q){const ne=Q+1,le=ne<Z?D[ne].el:W;for(;$<=Q;)p(null,D[$]=H?Bn(D[$]):Yt(D[$]),U,le,G,b,K,j,H),$++}}else if($>Q)for(;$<=X;)J(O[$],G,b,!0),$++;else{const ne=$,le=$,we=new Map;for($=le;$<=Q;$++){const St=D[$]=H?Bn(D[$]):Yt(D[$]);St.key!=null&&we.set(St.key,$)}let xe,dt=0;const vt=Q-le+1;let Wt=!1,zt=0;const Qr=new Array(vt);for($=0;$<vt;$++)Qr[$]=0;for($=ne;$<=X;$++){const St=O[$];if(dt>=vt){J(St,G,b,!0);continue}let Ht;if(St.key!=null)Ht=we.get(St.key);else for(xe=le;xe<=Q;xe++)if(Qr[xe-le]===0&&Jr(St,D[xe])){Ht=xe;break}Ht===void 0?J(St,G,b,!0):(Qr[Ht-le]=$+1,Ht>=zt?zt=Ht:Wt=!0,p(St,D[Ht],U,null,G,b,K,j,H),dt++)}const Rf=Wt?py(Qr):Fr;for(xe=Rf.length-1,$=vt-1;$>=0;$--){const St=le+$,Ht=D[St],Mf=D[St+1],Of=St+1<Z?Mf.el||Mf.placeholder:W;Qr[$]===0?p(null,Ht,U,Of,G,b,K,j,H):Wt&&(xe<0||$!==Rf[xe]?te(Ht,U,Of,2):xe--)}}},te=(O,D,U,W,G=null)=>{const{el:b,type:K,transition:j,children:H,shapeFlag:$}=O;if($&6){te(O.component.subTree,D,U,W);return}if($&128){O.suspense.move(D,U,W);return}if($&64){K.move(O,D,U,je);return}if(K===fn){r(b,D,U);for(let X=0;X<H.length;X++)te(H[X],D,U,W);r(O.anchor,D,U);return}if(K===Ms){x(O,D,U);return}if(W!==2&&$&1&&j)if(W===0)j.beforeEnter(b),r(b,D,U),Ct(()=>j.enter(b),G);else{const{leave:X,delayLeave:Q,afterLeave:ne}=j,le=()=>{O.ctx.isUnmounted?a(b):r(b,D,U)},we=()=>{b._isLeaving&&b[Dv](!0),X(b,()=>{le(),ne&&ne()})};Q?Q(b,le,we):we()}else r(b,D,U)},J=(O,D,U,W=!1,G=!1)=>{const{type:b,props:K,ref:j,children:H,dynamicChildren:$,shapeFlag:Z,patchFlag:X,dirs:Q,cacheIndex:ne}=O;if(X===-2&&(G=!1),j!=null&&(dn(),Sa(j,null,U,O,!0),vn()),ne!=null&&(D.renderCache[ne]=void 0),Z&256){D.ctx.deactivate(O);return}const le=Z&1&&Q,we=!Ca(O);let xe;if(we&&(xe=K&&K.onVnodeBeforeUnmount)&&At(xe,D,O),Z&6)Ae(O.component,U,W);else{if(Z&128){O.suspense.unmount(U,W);return}le&&Pn(O,null,D,"beforeUnmount"),Z&64?O.type.remove(O,D,U,je,W):$&&!$.hasOnce&&(b!==fn||X>0&&X&64)?Se($,D,U,!1,!0):(b===fn&&X&384||!G&&Z&16)&&Se(H,D,U),W&&q(O)}(we&&(xe=K&&K.onVnodeUnmounted)||le)&&Ct(()=>{xe&&At(xe,D,O),le&&Pn(O,null,D,"unmounted")},U)},q=O=>{const{type:D,el:U,anchor:W,transition:G}=O;if(D===fn){pt(U,W);return}if(D===Ms){T(O);return}const b=()=>{a(U),G&&!G.persisted&&G.afterLeave&&G.afterLeave()};if(O.shapeFlag&1&&G&&!G.persisted){const{leave:K,delayLeave:j}=G,H=()=>K(U,b);j?j(O.el,b,H):H()}else b()},pt=(O,D)=>{let U;for(;O!==D;)U=l(O),a(O),O=U;a(D)},Ae=(O,D,U)=>{const{bum:W,scope:G,job:b,subTree:K,um:j,m:H,a:$}=O;$f(H),$f($),W&&Fi(W),G.stop(),b&&(b.flags|=8,J(K,O,D,U)),j&&Ct(j,D),Ct(()=>{O.isUnmounted=!0},D)},Se=(O,D,U,W=!1,G=!1,b=0)=>{for(let K=b;K<O.length;K++)J(O[K],D,U,W,G)},$e=O=>{if(O.shapeFlag&6)return $e(O.component.subTree);if(O.shapeFlag&128)return O.suspense.next();const D=l(O.anchor||O.el),U=D&&D[Mv];return U?l(U):D};let Mt=!1;const Je=(O,D,U)=>{O==null?D._vnode&&J(D._vnode,null,null,!0):p(D._vnode||null,O,D,null,null,null,U),D._vnode=O,Mt||(Mt=!0,mf(),wl(),Mt=!1)},je={p,um:J,m:te,r:q,mt:_,mc:M,pc:I,pbc:L,n:$e,o:t};return{render:Je,hydrate:void 0,createApp:Pv(Je)}}function Gi({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Xn({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function hy(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function jl(t,e,n=!1){const r=t.children,a=e.children;if(ce(r)&&ce(a))for(let s=0;s<r.length;s++){const i=r[s];let o=a[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=a[s]=Bn(a[s]),o.el=i.el),!n&&o.patchFlag!==-2&&jl(i,o)),o.type===Ti&&o.patchFlag!==-1&&(o.el=i.el),o.type===br&&!o.el&&(o.el=i.el)}}function py(t){const e=t.slice(),n=[0];let r,a,s,i,o;const c=t.length;for(r=0;r<c;r++){const u=t[r];if(u!==0){if(a=n[n.length-1],t[a]<u){e[r]=a,n.push(r);continue}for(s=0,i=n.length-1;s<i;)o=s+i>>1,t[n[o]]<u?s=o+1:i=o;u<t[n[s]]&&(s>0&&(e[r]=n[s-1]),n[s]=r)}}for(s=n.length,i=n[s-1];s-- >0;)n[s]=i,i=e[i];return n}function Kl(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Kl(e)}function $f(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Pl=t=>t.__isSuspense;function dy(t,e){e&&e.pendingBranch?ce(t)?e.effects.push(...t):e.effects.push(t):Ev(t)}const fn=Symbol.for("v-fgt"),Ti=Symbol.for("v-txt"),br=Symbol.for("v-cmt"),Ms=Symbol.for("v-stc"),Ea=[];let wt=null;function vy(t=!1){Ea.push(wt=t?null:[])}function yy(){Ea.pop(),wt=Ea[Ea.length-1]||null}let _a=1;function Wf(t,e=!1){_a+=t,t<0&&wt&&e&&(wt.hasOnce=!0)}function Ty(t){return t.dynamicChildren=_a>0?wt||Fr:null,yy(),_a>0&&wt&&wt.push(t),t}function xy(t,e,n,r,a,s){return Ty(Ge(t,e,n,r,a,s,!0))}function Xl(t){return t?t.__v_isVNode===!0:!1}function Jr(t,e){return t.type===e.type&&t.key===e.key}const Il=({key:t})=>t??null,Os=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Ie(t)||nt(t)||oe(t)?{i:Qt,r:t,k:e,f:!!n}:t:null);function Ge(t,e=null,n=null,r=0,a=null,s=t===fn?0:1,i=!1,o=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Il(e),ref:e&&Os(e),scopeId:Rl,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:a,dynamicChildren:null,appContext:null,ctx:Qt};return o?(Vc(c,n),s&128&&t.normalize(c)):n&&(c.shapeFlag|=Ie(n)?8:16),_a>0&&!i&&wt&&(c.patchFlag>0||s&6)&&c.patchFlag!==32&&wt.push(c),c}const bn=Sy;function Sy(t,e=null,n=null,r=0,a=null,s=!1){if((!t||t===bv)&&(t=br),Xl(t)){const o=$r(t,e,!0);return n&&Vc(o,n),_a>0&&!s&&wt&&(o.shapeFlag&6?wt[wt.indexOf(t)]=o:wt.push(o)),o.patchFlag=-2,o}if(_y(t)&&(t=t.__vccOpts),e){e=Cy(e);let{class:o,style:c}=e;o&&!Ie(o)&&(e.class=pc(o)),ke(c)&&(Ec(c)&&!ce(c)&&(c=lt({},c)),e.style=hc(c))}const i=Ie(t)?1:Pl(t)?128:Ov(t)?64:ke(t)?4:oe(t)?2:0;return Ge(t,e,n,r,a,i,s,!0)}function Cy(t){return t?Ec(t)||bl(t)?lt({},t):t:null}function $r(t,e,n=!1,r=!1){const{props:a,ref:s,patchFlag:i,children:o,transition:c}=t,u=e?Ry(a||{},e):a,g={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&Il(u),ref:e&&e.ref?n&&s?ce(s)?s.concat(Os(e)):[s,Os(e)]:Os(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==fn?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&$r(t.ssContent),ssFallback:t.ssFallback&&$r(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&r&&Mc(g,c.clone(g)),g}function wy(t=" ",e=0){return bn(Ti,null,t,e)}function Ey(t,e){const n=bn(Ms,null,t);return n.staticCount=e,n}function Yt(t){return t==null||typeof t=="boolean"?bn(br):ce(t)?bn(fn,null,t.slice()):Xl(t)?Bn(t):bn(Ti,null,String(t))}function Bn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:$r(t)}function Vc(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(ce(e))n=16;else if(typeof e=="object")if(r&65){const a=e.default;a&&(a._c&&(a._d=!1),Vc(t,a()),a._c&&(a._d=!0));return}else{n=32;const a=e._;!a&&!bl(e)?e._ctx=Qt:a===3&&Qt&&(Qt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else oe(e)?(e={default:e,_ctx:Qt},n=32):(e=String(e),r&64?(n=16,e=[wy(e)]):n=8);t.children=e,t.shapeFlag|=n}function Ry(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const a in r)if(a==="class")e.class!==r.class&&(e.class=pc([e.class,r.class]));else if(a==="style")e.style=hc([e.style,r.style]);else if(gi(a)){const s=e[a],i=r[a];i&&s!==i&&!(ce(s)&&s.includes(i))&&(e[a]=s?[].concat(s,i):i)}else a!==""&&(e[a]=r[a])}return e}function At(t,e,n,r=null){tn(t,e,7,[n,r])}const My=_l();let Oy=0;function Dy(t,e,n){const r=t.type,a=(e?e.appContext:t.appContext)||My,s={uid:Oy++,vnode:t,type:r,parent:e,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Kd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(a.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Wl(r,a),emitsOptions:Nl(r,a),emit:null,emitted:null,propsDefaults:Re,inheritAttrs:r.inheritAttrs,ctx:Re,data:Re,props:Re,attrs:Re,slots:Re,refs:Re,setupState:Re,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=Jv.bind(null,s),t.ce&&t.ce(s),s}let ft=null;const Ly=()=>ft||Qt;let Is,_o;{const t=pi(),e=(n,r)=>{let a;return(a=t[n])||(a=t[n]=[]),a.push(r),s=>{a.length>1?a.forEach(i=>i(s)):a[0](s)}};Is=e("__VUE_INSTANCE_SETTERS__",n=>ft=n),_o=e("__VUE_SSR_SETTERS__",n=>Ua=n)}const Ha=t=>{const e=ft;return Is(t),t.scope.on(),()=>{t.scope.off(),Is(e)}},zf=()=>{ft&&ft.scope.off(),Is(null)};function Yl(t){return t.vnode.shapeFlag&4}let Ua=!1;function Vy(t,e=!1,n=!1){e&&_o(e);const{props:r,children:a}=t.vnode,s=Yl(t);sy(t,r,s,e),fy(t,a,n||e);const i=s?my(t,e):void 0;return e&&_o(!1),i}function my(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,$v);const{setup:r}=n;if(r){dn();const a=t.setupContext=r.length>1?By(t):null,s=Ha(t),i=za(r,t,0,[t.props,a]),o=tl(i);if(vn(),s(),(o||t.sp)&&!Ca(t)&&Ml(t),o){if(i.then(zf,zf),e)return i.then(c=>{Hf(t,c)}).catch(c=>{di(c,t,0)});t.asyncDep=i}else Hf(t,i)}else ql(t)}function Hf(t,e,n){oe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:ke(e)&&(t.setupState=xl(e)),ql(t)}function ql(t,e,n){const r=t.type;t.render||(t.render=r.render||Zt);{const a=Ha(t);dn();try{Wv(t)}finally{vn(),a()}}}const Fy={get(t,e){return tt(t,"get",""),t[e]}};function By(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Fy),slots:t.slots,emit:t.emit,expose:e}}function mc(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(xl(lv(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in wa)return wa[n](t)},has(e,n){return n in e||n in wa}})):t.proxy}function _y(t){return oe(t)&&"__vccOpts"in t}const Uy=(t,e)=>yv(t,e,Ua),Ny="3.5.25";let Uo;const Af=typeof window<"u"&&window.trustedTypes;if(Af)try{Uo=Af.createPolicy("vue",{createHTML:t=>t})}catch{}const Ql=Uo?t=>Uo.createHTML(t):t=>t,ky="http://www.w3.org/2000/svg",Gy="http://www.w3.org/1998/Math/MathML",on=typeof document<"u"?document:null,jf=on&&on.createElement("template"),by={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const a=e==="svg"?on.createElementNS(ky,t):e==="mathml"?on.createElementNS(Gy,t):n?on.createElement(t,{is:n}):on.createElement(t);return t==="select"&&r&&r.multiple!=null&&a.setAttribute("multiple",r.multiple),a},createText:t=>on.createTextNode(t),createComment:t=>on.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>on.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,a,s){const i=n?n.previousSibling:e.lastChild;if(a&&(a===s||a.nextSibling))for(;e.insertBefore(a.cloneNode(!0),n),!(a===s||!(a=a.nextSibling)););else{jf.innerHTML=Ql(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const o=jf.content;if(r==="svg"||r==="mathml"){const c=o.firstChild;for(;c.firstChild;)o.appendChild(c.firstChild);o.removeChild(c)}e.insertBefore(o,n)}return[i?i.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},$y=Symbol("_vtc");function Wy(t,e,n){const r=t[$y];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Kf=Symbol("_vod"),zy=Symbol("_vsh"),Hy=Symbol(""),Ay=/(?:^|;)\s*display\s*:/;function jy(t,e,n){const r=t.style,a=Ie(n);let s=!1;if(n&&!a){if(e)if(Ie(e))for(const i of e.split(";")){const o=i.slice(0,i.indexOf(":")).trim();n[o]==null&&Ds(r,o,"")}else for(const i in e)n[i]==null&&Ds(r,i,"");for(const i in n)i==="display"&&(s=!0),Ds(r,i,n[i])}else if(a){if(e!==n){const i=r[Hy];i&&(n+=";"+i),r.cssText=n,s=Ay.test(n)}}else e&&t.removeAttribute("style");Kf in t&&(t[Kf]=s?r.display:"",t[zy]&&(r.display="none"))}const Pf=/\s*!important$/;function Ds(t,e,n){if(ce(n))n.forEach(r=>Ds(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=Ky(t,e);Pf.test(n)?t.setProperty(xr(r),n.replace(Pf,""),"important"):t[r]=n}}const Xf=["Webkit","Moz","ms"],bi={};function Ky(t,e){const n=bi[e];if(n)return n;let r=Wn(e);if(r!=="filter"&&r in t)return bi[e]=r;r=nl(r);for(let a=0;a<Xf.length;a++){const s=Xf[a]+r;if(s in t)return bi[e]=s}return e}const If="http://www.w3.org/1999/xlink";function Yf(t,e,n,r,a,s=jd(e)){r&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(If,e.slice(6,e.length)):t.setAttributeNS(If,e,n):n==null||s&&!al(n)?t.removeAttribute(e):t.setAttribute(e,s?"":Pr(n)?String(n):n)}function qf(t,e,n,r,a){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Ql(n):n);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,c=n==null?t.type==="checkbox"?"on":"":String(n);(o!==c||!("_value"in t))&&(t.value=c),n==null&&t.removeAttribute(e),t._value=n;return}let i=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=al(n):n==null&&o==="string"?(n="",i=!0):o==="number"&&(n=0,i=!0)}try{t[e]=n}catch{}i&&t.removeAttribute(a||e)}function Py(t,e,n,r){t.addEventListener(e,n,r)}function Xy(t,e,n,r){t.removeEventListener(e,n,r)}const Qf=Symbol("_vei");function Iy(t,e,n,r,a=null){const s=t[Qf]||(t[Qf]={}),i=s[e];if(r&&i)i.value=r;else{const[o,c]=Yy(e);if(r){const u=s[e]=Zy(r,a);Py(t,o,u,c)}else i&&(Xy(t,o,i,c),s[e]=void 0)}}const Zf=/(?:Once|Passive|Capture)$/;function Yy(t){let e;if(Zf.test(t)){e={};let r;for(;r=t.match(Zf);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):xr(t.slice(2)),e]}let $i=0;const qy=Promise.resolve(),Qy=()=>$i||(qy.then(()=>$i=0),$i=Date.now());function Zy(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;tn(Jy(r,n.value),e,5,[r])};return n.value=t,n.attached=Qy(),n}function Jy(t,e){if(ce(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>a=>!a._stopped&&r&&r(a))}else return e}const Jf=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,eT=(t,e,n,r,a,s)=>{const i=a==="svg";e==="class"?Wy(t,r,i):e==="style"?jy(t,n,r):gi(e)?uc(e)||Iy(t,e,n,r,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):tT(t,e,r,i))?(qf(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Yf(t,e,r,i,s,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Ie(r))?qf(t,Wn(e),r,s,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),Yf(t,e,r,i))};function tT(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&Jf(e)&&oe(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&t.tagName==="IFRAME"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const a=t.tagName;if(a==="IMG"||a==="VIDEO"||a==="CANVAS"||a==="SOURCE")return!1}return Jf(e)&&Ie(n)?!1:e in t}const nT=lt({patchProp:eT},by);let eu;function rT(){return eu||(eu=gy(nT))}const aT=((...t)=>{const e=rT().createApp(...t),{mount:n}=e;return e.mount=r=>{const a=iT(r);if(!a)return;const s=e._component;!oe(s)&&!s.render&&!s.template&&(s.template=a.innerHTML),a.nodeType===1&&(a.textContent="");const i=n(a,!1,sT(a));return a instanceof Element&&(a.removeAttribute("v-cloak"),a.setAttribute("data-v-app","")),i},e});function sT(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function iT(t){return Ie(t)?document.querySelector(t):t}var ge=1e-6,Ye=typeof Float32Array<"u"?Float32Array:Array,oT=Math.PI/180;function cT(t){return t*oT}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Zl(){var t=new Ye(9);return Ye!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Fc(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function fT(t){var e=new Ye(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function uT(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function gT(t,e,n,r,a,s,i,o,c){var u=new Ye(9);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=a,u[5]=s,u[6]=i,u[7]=o,u[8]=c,u}function lT(t,e,n,r,a,s,i,o,c,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=s,t[5]=i,t[6]=o,t[7]=c,t[8]=u,t}function jn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Jl(t,e){if(t===e){var n=e[1],r=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Bc(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],u=e[7],g=e[8],f=g*i-o*u,l=-g*s+o*c,h=u*s-i*c,v=n*f+r*l+a*h;return v?(v=1/v,t[0]=f*v,t[1]=(-g*r+a*u)*v,t[2]=(o*r-a*i)*v,t[3]=l*v,t[4]=(g*n-a*c)*v,t[5]=(-o*n+a*s)*v,t[6]=h*v,t[7]=(-u*n+r*c)*v,t[8]=(i*n-r*s)*v,t):null}function hT(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],u=e[7],g=e[8];return t[0]=i*g-o*u,t[1]=a*u-r*g,t[2]=r*o-a*i,t[3]=o*c-s*g,t[4]=n*g-a*c,t[5]=a*s-n*o,t[6]=s*u-i*c,t[7]=r*c-n*u,t[8]=n*i-r*s,t}function pT(t){var e=t[0],n=t[1],r=t[2],a=t[3],s=t[4],i=t[5],o=t[6],c=t[7],u=t[8];return e*(u*s-i*c)+n*(-u*a+i*o)+r*(c*a-s*o)}function e0(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=e[4],c=e[5],u=e[6],g=e[7],f=e[8],l=n[0],h=n[1],v=n[2],p=n[3],d=n[4],y=n[5],S=n[6],x=n[7],T=n[8];return t[0]=l*r+h*i+v*u,t[1]=l*a+h*o+v*g,t[2]=l*s+h*c+v*f,t[3]=p*r+d*i+y*u,t[4]=p*a+d*o+y*g,t[5]=p*s+d*c+y*f,t[6]=S*r+x*i+T*u,t[7]=S*a+x*o+T*g,t[8]=S*s+x*c+T*f,t}function dT(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=e[4],c=e[5],u=e[6],g=e[7],f=e[8],l=n[0],h=n[1];return t[0]=r,t[1]=a,t[2]=s,t[3]=i,t[4]=o,t[5]=c,t[6]=l*r+h*i+u,t[7]=l*a+h*o+g,t[8]=l*s+h*c+f,t}function vT(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=e[4],c=e[5],u=e[6],g=e[7],f=e[8],l=Math.sin(n),h=Math.cos(n);return t[0]=h*r+l*i,t[1]=h*a+l*o,t[2]=h*s+l*c,t[3]=h*i-l*r,t[4]=h*o-l*a,t[5]=h*c-l*s,t[6]=u,t[7]=g,t[8]=f,t}function yT(t,e,n){var r=n[0],a=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function TT(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function xT(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function ST(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function CT(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function wT(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=n+n,o=r+r,c=a+a,u=n*i,g=r*i,f=r*o,l=a*i,h=a*o,v=a*c,p=s*i,d=s*o,y=s*c;return t[0]=1-f-v,t[3]=g-y,t[6]=l+d,t[1]=g+y,t[4]=1-u-v,t[7]=h-p,t[2]=l-d,t[5]=h+p,t[8]=1-u-f,t}function ET(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],u=e[7],g=e[8],f=e[9],l=e[10],h=e[11],v=e[12],p=e[13],d=e[14],y=e[15],S=n*o-r*i,x=n*c-a*i,T=n*u-s*i,w=r*c-a*o,C=r*u-s*o,R=a*u-s*c,M=g*p-f*v,m=g*d-l*v,L=g*y-h*v,V=f*d-l*p,F=f*y-h*p,B=l*y-h*d,_=S*B-x*F+T*V+w*L-C*m+R*M;return _?(_=1/_,t[0]=(o*B-c*F+u*V)*_,t[1]=(c*L-i*B-u*m)*_,t[2]=(i*F-o*L+u*M)*_,t[3]=(a*F-r*B-s*V)*_,t[4]=(n*B-a*L+s*m)*_,t[5]=(r*L-n*F-s*M)*_,t[6]=(p*R-d*C+y*w)*_,t[7]=(d*T-v*R-y*x)*_,t[8]=(v*C-p*T+y*S)*_,t):null}function RT(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function MT(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function OT(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function DT(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function t0(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function LT(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function VT(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function mT(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function FT(t,e){var n=t[0],r=t[1],a=t[2],s=t[3],i=t[4],o=t[5],c=t[6],u=t[7],g=t[8],f=e[0],l=e[1],h=e[2],v=e[3],p=e[4],d=e[5],y=e[6],S=e[7],x=e[8];return Math.abs(n-f)<=ge*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-l)<=ge*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(a-h)<=ge*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(s-v)<=ge*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(i-p)<=ge*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-d)<=ge*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(c-y)<=ge*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(u-S)<=ge*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(g-x)<=ge*Math.max(1,Math.abs(g),Math.abs(x))}var BT=e0,_T=t0;const UT=Object.freeze(Object.defineProperty({__proto__:null,add:DT,adjoint:hT,clone:fT,copy:uT,create:Zl,determinant:pT,equals:FT,exactEquals:mT,frob:OT,fromMat2d:CT,fromMat4:Fc,fromQuat:wT,fromRotation:xT,fromScaling:ST,fromTranslation:TT,fromValues:gT,identity:jn,invert:Bc,mul:BT,multiply:e0,multiplyScalar:LT,multiplyScalarAndAdd:VT,normalFromMat4:ET,projection:RT,rotate:vT,scale:yT,set:lT,str:MT,sub:_T,subtract:t0,translate:dT,transpose:Jl},Symbol.toStringTag,{value:"Module"}));function xi(){var t=new Ye(16);return Ye!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function NT(t){var e=new Ye(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function kT(t,e,n,r,a,s,i,o,c,u,g,f,l,h,v,p){var d=new Ye(16);return d[0]=t,d[1]=e,d[2]=n,d[3]=r,d[4]=a,d[5]=s,d[6]=i,d[7]=o,d[8]=c,d[9]=u,d[10]=g,d[11]=f,d[12]=l,d[13]=h,d[14]=v,d[15]=p,d}function GT(t,e,n,r,a,s,i,o,c,u,g,f,l,h,v,p,d){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=s,t[5]=i,t[6]=o,t[7]=c,t[8]=u,t[9]=g,t[10]=f,t[11]=l,t[12]=h,t[13]=v,t[14]=p,t[15]=d,t}function ue(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Oe(t,e){if(t===e){var n=e[1],r=e[2],a=e[3],s=e[6],i=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=a,t[13]=i,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ut(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],u=e[7],g=e[8],f=e[9],l=e[10],h=e[11],v=e[12],p=e[13],d=e[14],y=e[15],S=n*o-r*i,x=n*c-a*i,T=n*u-s*i,w=r*c-a*o,C=r*u-s*o,R=a*u-s*c,M=g*p-f*v,m=g*d-l*v,L=g*y-h*v,V=f*d-l*p,F=f*y-h*p,B=l*y-h*d,_=S*B-x*F+T*V+w*L-C*m+R*M;return _?(_=1/_,t[0]=(o*B-c*F+u*V)*_,t[1]=(a*F-r*B-s*V)*_,t[2]=(p*R-d*C+y*w)*_,t[3]=(l*C-f*R-h*w)*_,t[4]=(c*L-i*B-u*m)*_,t[5]=(n*B-a*L+s*m)*_,t[6]=(d*T-v*R-y*x)*_,t[7]=(g*R-l*T+h*x)*_,t[8]=(i*F-o*L+u*M)*_,t[9]=(r*L-n*F-s*M)*_,t[10]=(v*C-p*T+y*S)*_,t[11]=(f*T-g*C-h*S)*_,t[12]=(o*m-i*V-c*M)*_,t[13]=(n*V-r*m+a*M)*_,t[14]=(p*x-v*w-d*S)*_,t[15]=(g*w-f*x+l*S)*_,t):null}function bT(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],u=e[7],g=e[8],f=e[9],l=e[10],h=e[11],v=e[12],p=e[13],d=e[14],y=e[15];return t[0]=o*(l*y-h*d)-f*(c*y-u*d)+p*(c*h-u*l),t[1]=-(r*(l*y-h*d)-f*(a*y-s*d)+p*(a*h-s*l)),t[2]=r*(c*y-u*d)-o*(a*y-s*d)+p*(a*u-s*c),t[3]=-(r*(c*h-u*l)-o*(a*h-s*l)+f*(a*u-s*c)),t[4]=-(i*(l*y-h*d)-g*(c*y-u*d)+v*(c*h-u*l)),t[5]=n*(l*y-h*d)-g*(a*y-s*d)+v*(a*h-s*l),t[6]=-(n*(c*y-u*d)-i*(a*y-s*d)+v*(a*u-s*c)),t[7]=n*(c*h-u*l)-i*(a*h-s*l)+g*(a*u-s*c),t[8]=i*(f*y-h*p)-g*(o*y-u*p)+v*(o*h-u*f),t[9]=-(n*(f*y-h*p)-g*(r*y-s*p)+v*(r*h-s*f)),t[10]=n*(o*y-u*p)-i*(r*y-s*p)+v*(r*u-s*o),t[11]=-(n*(o*h-u*f)-i*(r*h-s*f)+g*(r*u-s*o)),t[12]=-(i*(f*d-l*p)-g*(o*d-c*p)+v*(o*l-c*f)),t[13]=n*(f*d-l*p)-g*(r*d-a*p)+v*(r*l-a*f),t[14]=-(n*(o*d-c*p)-i*(r*d-a*p)+v*(r*c-a*o)),t[15]=n*(o*l-c*f)-i*(r*l-a*f)+g*(r*c-a*o),t}function $T(t){var e=t[0],n=t[1],r=t[2],a=t[3],s=t[4],i=t[5],o=t[6],c=t[7],u=t[8],g=t[9],f=t[10],l=t[11],h=t[12],v=t[13],p=t[14],d=t[15],y=e*i-n*s,S=e*o-r*s,x=e*c-a*s,T=n*o-r*i,w=n*c-a*i,C=r*c-a*o,R=u*v-g*h,M=u*p-f*h,m=u*d-l*h,L=g*p-f*v,V=g*d-l*v,F=f*d-l*p;return y*F-S*V+x*L+T*m-w*M+C*R}function Ne(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=e[4],c=e[5],u=e[6],g=e[7],f=e[8],l=e[9],h=e[10],v=e[11],p=e[12],d=e[13],y=e[14],S=e[15],x=n[0],T=n[1],w=n[2],C=n[3];return t[0]=x*r+T*o+w*f+C*p,t[1]=x*a+T*c+w*l+C*d,t[2]=x*s+T*u+w*h+C*y,t[3]=x*i+T*g+w*v+C*S,x=n[4],T=n[5],w=n[6],C=n[7],t[4]=x*r+T*o+w*f+C*p,t[5]=x*a+T*c+w*l+C*d,t[6]=x*s+T*u+w*h+C*y,t[7]=x*i+T*g+w*v+C*S,x=n[8],T=n[9],w=n[10],C=n[11],t[8]=x*r+T*o+w*f+C*p,t[9]=x*a+T*c+w*l+C*d,t[10]=x*s+T*u+w*h+C*y,t[11]=x*i+T*g+w*v+C*S,x=n[12],T=n[13],w=n[14],C=n[15],t[12]=x*r+T*o+w*f+C*p,t[13]=x*a+T*c+w*l+C*d,t[14]=x*s+T*u+w*h+C*y,t[15]=x*i+T*g+w*v+C*S,t}function Ue(t,e,n){var r=n[0],a=n[1],s=n[2],i,o,c,u,g,f,l,h,v,p,d,y;return e===t?(t[12]=e[0]*r+e[4]*a+e[8]*s+e[12],t[13]=e[1]*r+e[5]*a+e[9]*s+e[13],t[14]=e[2]*r+e[6]*a+e[10]*s+e[14],t[15]=e[3]*r+e[7]*a+e[11]*s+e[15]):(i=e[0],o=e[1],c=e[2],u=e[3],g=e[4],f=e[5],l=e[6],h=e[7],v=e[8],p=e[9],d=e[10],y=e[11],t[0]=i,t[1]=o,t[2]=c,t[3]=u,t[4]=g,t[5]=f,t[6]=l,t[7]=h,t[8]=v,t[9]=p,t[10]=d,t[11]=y,t[12]=i*r+g*a+v*s+e[12],t[13]=o*r+f*a+p*s+e[13],t[14]=c*r+l*a+d*s+e[14],t[15]=u*r+h*a+y*s+e[15]),t}function lr(t,e,n){var r=n[0],a=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Bt(t,e,n,r){var a=r[0],s=r[1],i=r[2],o=Math.hypot(a,s,i),c,u,g,f,l,h,v,p,d,y,S,x,T,w,C,R,M,m,L,V,F,B,_,P;return o<ge?null:(o=1/o,a*=o,s*=o,i*=o,c=Math.sin(n),u=Math.cos(n),g=1-u,f=e[0],l=e[1],h=e[2],v=e[3],p=e[4],d=e[5],y=e[6],S=e[7],x=e[8],T=e[9],w=e[10],C=e[11],R=a*a*g+u,M=s*a*g+i*c,m=i*a*g-s*c,L=a*s*g-i*c,V=s*s*g+u,F=i*s*g+a*c,B=a*i*g+s*c,_=s*i*g-a*c,P=i*i*g+u,t[0]=f*R+p*M+x*m,t[1]=l*R+d*M+T*m,t[2]=h*R+y*M+w*m,t[3]=v*R+S*M+C*m,t[4]=f*L+p*V+x*F,t[5]=l*L+d*V+T*F,t[6]=h*L+y*V+w*F,t[7]=v*L+S*V+C*F,t[8]=f*B+p*_+x*P,t[9]=l*B+d*_+T*P,t[10]=h*B+y*_+w*P,t[11]=v*B+S*_+C*P,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function _c(t,e,n){var r=Math.sin(n),a=Math.cos(n),s=e[4],i=e[5],o=e[6],c=e[7],u=e[8],g=e[9],f=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*a+u*r,t[5]=i*a+g*r,t[6]=o*a+f*r,t[7]=c*a+l*r,t[8]=u*a-s*r,t[9]=g*a-i*r,t[10]=f*a-o*r,t[11]=l*a-c*r,t}function Uc(t,e,n){var r=Math.sin(n),a=Math.cos(n),s=e[0],i=e[1],o=e[2],c=e[3],u=e[8],g=e[9],f=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*a-u*r,t[1]=i*a-g*r,t[2]=o*a-f*r,t[3]=c*a-l*r,t[8]=s*r+u*a,t[9]=i*r+g*a,t[10]=o*r+f*a,t[11]=c*r+l*a,t}function Nc(t,e,n){var r=Math.sin(n),a=Math.cos(n),s=e[0],i=e[1],o=e[2],c=e[3],u=e[4],g=e[5],f=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*a+u*r,t[1]=i*a+g*r,t[2]=o*a+f*r,t[3]=c*a+l*r,t[4]=u*a-s*r,t[5]=g*a-i*r,t[6]=f*a-o*r,t[7]=l*a-c*r,t}function n0(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function r0(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function a0(t,e,n){var r=n[0],a=n[1],s=n[2],i=Math.hypot(r,a,s),o,c,u;return i<ge?null:(i=1/i,r*=i,a*=i,s*=i,o=Math.sin(e),c=Math.cos(e),u=1-c,t[0]=r*r*u+c,t[1]=a*r*u+s*o,t[2]=s*r*u-a*o,t[3]=0,t[4]=r*a*u-s*o,t[5]=a*a*u+c,t[6]=s*a*u+r*o,t[7]=0,t[8]=r*s*u+a*o,t[9]=a*s*u-r*o,t[10]=s*s*u+c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function WT(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function zT(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function HT(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function s0(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=r+r,c=a+a,u=s+s,g=r*o,f=r*c,l=r*u,h=a*c,v=a*u,p=s*u,d=i*o,y=i*c,S=i*u;return t[0]=1-(h+p),t[1]=f+S,t[2]=l-y,t[3]=0,t[4]=f-S,t[5]=1-(g+p),t[6]=v+d,t[7]=0,t[8]=l+y,t[9]=v-d,t[10]=1-(g+h),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function AT(t,e){var n=new Ye(3),r=-e[0],a=-e[1],s=-e[2],i=e[3],o=e[4],c=e[5],u=e[6],g=e[7],f=r*r+a*a+s*s+i*i;return f>0?(n[0]=(o*i+g*r+c*s-u*a)*2/f,n[1]=(c*i+g*a+u*r-o*s)*2/f,n[2]=(u*i+g*s+o*a-c*r)*2/f):(n[0]=(o*i+g*r+c*s-u*a)*2,n[1]=(c*i+g*a+u*r-o*s)*2,n[2]=(u*i+g*s+o*a-c*r)*2),s0(t,e,n),t}function jT(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function i0(t,e){var n=e[0],r=e[1],a=e[2],s=e[4],i=e[5],o=e[6],c=e[8],u=e[9],g=e[10];return t[0]=Math.hypot(n,r,a),t[1]=Math.hypot(s,i,o),t[2]=Math.hypot(c,u,g),t}function No(t,e){var n=new Ye(3);i0(n,e);var r=1/n[0],a=1/n[1],s=1/n[2],i=e[0]*r,o=e[1]*a,c=e[2]*s,u=e[4]*r,g=e[5]*a,f=e[6]*s,l=e[8]*r,h=e[9]*a,v=e[10]*s,p=i+g+v,d=0;return p>0?(d=Math.sqrt(p+1)*2,t[3]=.25*d,t[0]=(f-h)/d,t[1]=(l-c)/d,t[2]=(o-u)/d):i>g&&i>v?(d=Math.sqrt(1+i-g-v)*2,t[3]=(f-h)/d,t[0]=.25*d,t[1]=(o+u)/d,t[2]=(l+c)/d):g>v?(d=Math.sqrt(1+g-i-v)*2,t[3]=(l-c)/d,t[0]=(o+u)/d,t[1]=.25*d,t[2]=(f+h)/d):(d=Math.sqrt(1+v-i-g)*2,t[3]=(o-u)/d,t[0]=(l+c)/d,t[1]=(f+h)/d,t[2]=.25*d),t}function o0(t,e,n,r){var a=e[0],s=e[1],i=e[2],o=e[3],c=a+a,u=s+s,g=i+i,f=a*c,l=a*u,h=a*g,v=s*u,p=s*g,d=i*g,y=o*c,S=o*u,x=o*g,T=r[0],w=r[1],C=r[2];return t[0]=(1-(v+d))*T,t[1]=(l+x)*T,t[2]=(h-S)*T,t[3]=0,t[4]=(l-x)*w,t[5]=(1-(f+d))*w,t[6]=(p+y)*w,t[7]=0,t[8]=(h+S)*C,t[9]=(p-y)*C,t[10]=(1-(f+v))*C,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function KT(t,e,n,r,a){var s=e[0],i=e[1],o=e[2],c=e[3],u=s+s,g=i+i,f=o+o,l=s*u,h=s*g,v=s*f,p=i*g,d=i*f,y=o*f,S=c*u,x=c*g,T=c*f,w=r[0],C=r[1],R=r[2],M=a[0],m=a[1],L=a[2],V=(1-(p+y))*w,F=(h+T)*w,B=(v-x)*w,_=(h-T)*C,P=(1-(l+y))*C,z=(d+S)*C,A=(v+x)*R,I=(d-S)*R,k=(1-(l+p))*R;return t[0]=V,t[1]=F,t[2]=B,t[3]=0,t[4]=_,t[5]=P,t[6]=z,t[7]=0,t[8]=A,t[9]=I,t[10]=k,t[11]=0,t[12]=n[0]+M-(V*M+_*m+A*L),t[13]=n[1]+m-(F*M+P*m+I*L),t[14]=n[2]+L-(B*M+z*m+k*L),t[15]=1,t}function Ra(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=n+n,o=r+r,c=a+a,u=n*i,g=r*i,f=r*o,l=a*i,h=a*o,v=a*c,p=s*i,d=s*o,y=s*c;return t[0]=1-f-v,t[1]=g+y,t[2]=l-d,t[3]=0,t[4]=g-y,t[5]=1-u-v,t[6]=h+p,t[7]=0,t[8]=l+d,t[9]=h-p,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function PT(t,e,n,r,a,s,i){var o=1/(n-e),c=1/(a-r),u=1/(s-i);return t[0]=s*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*c,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(a+r)*c,t[10]=(i+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*s*2*u,t[15]=0,t}function c0(t,e,n,r,a){var s=1/Math.tan(e/2),i;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(i=1/(r-a),t[10]=(a+r)*i,t[14]=2*a*r*i):(t[10]=-1,t[14]=-2*r),t}var XT=c0;function IT(t,e,n,r,a){var s=1/Math.tan(e/2),i;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(i=1/(r-a),t[10]=a*i,t[14]=a*r*i):(t[10]=-1,t[14]=-r),t}function YT(t,e,n,r){var a=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),c=2/(i+o),u=2/(a+s);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((i-o)*c*.5),t[9]=(a-s)*u*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function f0(t,e,n,r,a,s,i){var o=1/(e-n),c=1/(r-a),u=1/(s-i);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*o,t[13]=(a+r)*c,t[14]=(i+s)*u,t[15]=1,t}var u0=f0;function qT(t,e,n,r,a,s,i){var o=1/(e-n),c=1/(r-a),u=1/(s-i);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+n)*o,t[13]=(a+r)*c,t[14]=s*u,t[15]=1,t}function g0(t,e,n,r){var a,s,i,o,c,u,g,f,l,h,v=e[0],p=e[1],d=e[2],y=r[0],S=r[1],x=r[2],T=n[0],w=n[1],C=n[2];return Math.abs(v-T)<ge&&Math.abs(p-w)<ge&&Math.abs(d-C)<ge?ue(t):(g=v-T,f=p-w,l=d-C,h=1/Math.hypot(g,f,l),g*=h,f*=h,l*=h,a=S*l-x*f,s=x*g-y*l,i=y*f-S*g,h=Math.hypot(a,s,i),h?(h=1/h,a*=h,s*=h,i*=h):(a=0,s=0,i=0),o=f*i-l*s,c=l*a-g*i,u=g*s-f*a,h=Math.hypot(o,c,u),h?(h=1/h,o*=h,c*=h,u*=h):(o=0,c=0,u=0),t[0]=a,t[1]=o,t[2]=g,t[3]=0,t[4]=s,t[5]=c,t[6]=f,t[7]=0,t[8]=i,t[9]=u,t[10]=l,t[11]=0,t[12]=-(a*v+s*p+i*d),t[13]=-(o*v+c*p+u*d),t[14]=-(g*v+f*p+l*d),t[15]=1,t)}function QT(t,e,n,r){var a=e[0],s=e[1],i=e[2],o=r[0],c=r[1],u=r[2],g=a-n[0],f=s-n[1],l=i-n[2],h=g*g+f*f+l*l;h>0&&(h=1/Math.sqrt(h),g*=h,f*=h,l*=h);var v=c*l-u*f,p=u*g-o*l,d=o*f-c*g;return h=v*v+p*p+d*d,h>0&&(h=1/Math.sqrt(h),v*=h,p*=h,d*=h),t[0]=v,t[1]=p,t[2]=d,t[3]=0,t[4]=f*d-l*p,t[5]=l*v-g*d,t[6]=g*p-f*v,t[7]=0,t[8]=g,t[9]=f,t[10]=l,t[11]=0,t[12]=a,t[13]=s,t[14]=i,t[15]=1,t}function ZT(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function JT(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function ex(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function l0(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function tx(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function nx(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function rx(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function ax(t,e){var n=t[0],r=t[1],a=t[2],s=t[3],i=t[4],o=t[5],c=t[6],u=t[7],g=t[8],f=t[9],l=t[10],h=t[11],v=t[12],p=t[13],d=t[14],y=t[15],S=e[0],x=e[1],T=e[2],w=e[3],C=e[4],R=e[5],M=e[6],m=e[7],L=e[8],V=e[9],F=e[10],B=e[11],_=e[12],P=e[13],z=e[14],A=e[15];return Math.abs(n-S)<=ge*Math.max(1,Math.abs(n),Math.abs(S))&&Math.abs(r-x)<=ge*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(a-T)<=ge*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(s-w)<=ge*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(i-C)<=ge*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(o-R)<=ge*Math.max(1,Math.abs(o),Math.abs(R))&&Math.abs(c-M)<=ge*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(u-m)<=ge*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(g-L)<=ge*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(f-V)<=ge*Math.max(1,Math.abs(f),Math.abs(V))&&Math.abs(l-F)<=ge*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(h-B)<=ge*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(v-_)<=ge*Math.max(1,Math.abs(v),Math.abs(_))&&Math.abs(p-P)<=ge*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(d-z)<=ge*Math.max(1,Math.abs(d),Math.abs(z))&&Math.abs(y-A)<=ge*Math.max(1,Math.abs(y),Math.abs(A))}var ko=Ne,sx=l0;const Go=Object.freeze(Object.defineProperty({__proto__:null,add:ex,adjoint:bT,clone:NT,copy:Qe,create:xi,determinant:$T,equals:ax,exactEquals:rx,frob:JT,fromQuat:Ra,fromQuat2:AT,fromRotation:a0,fromRotationTranslation:s0,fromRotationTranslationScale:o0,fromRotationTranslationScaleOrigin:KT,fromScaling:r0,fromTranslation:n0,fromValues:kT,fromXRotation:WT,fromYRotation:zT,fromZRotation:HT,frustum:PT,getRotation:No,getScaling:i0,getTranslation:jT,identity:ue,invert:ut,lookAt:g0,mul:ko,multiply:Ne,multiplyScalar:tx,multiplyScalarAndAdd:nx,ortho:u0,orthoNO:f0,orthoZO:qT,perspective:XT,perspectiveFromFieldOfView:YT,perspectiveNO:c0,perspectiveZO:IT,rotate:Bt,rotateX:_c,rotateY:Uc,rotateZ:Nc,scale:lr,set:GT,str:ZT,sub:sx,subtract:l0,targetTo:QT,translate:Ue,transpose:Oe},Symbol.toStringTag,{value:"Module"}));function h0(){var t=new Ye(3);return Ye!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function bo(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function tu(t,e,n){var r=new Ye(3);return r[0]=t,r[1]=e,r[2]=n,r}function ix(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function qt(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function ca(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function kn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Dn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function ox(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return Math.hypot(n,r,a)}function cx(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function $n(t,e){var n=e[0],r=e[1],a=e[2],s=n*n+r*r+a*a;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function kc(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Nr(t,e,n){var r=e[0],a=e[1],s=e[2],i=n[0],o=n[1],c=n[2];return t[0]=a*c-s*o,t[1]=s*i-r*c,t[2]=r*o-a*i,t}function Te(t,e,n){var r=e[0],a=e[1],s=e[2],i=n[3]*r+n[7]*a+n[11]*s+n[15];return i=i||1,t[0]=(n[0]*r+n[4]*a+n[8]*s+n[12])/i,t[1]=(n[1]*r+n[5]*a+n[9]*s+n[13])/i,t[2]=(n[2]*r+n[6]*a+n[10]*s+n[14])/i,t}function nu(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function ru(t,e){var n=t[0],r=t[1],a=t[2],s=e[0],i=e[1],o=e[2];return Math.abs(n-s)<=ge*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-i)<=ge*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-o)<=ge*Math.max(1,Math.abs(a),Math.abs(o))}var $o=kn,fx=ox,p0=bo;(function(){var t=h0();return function(e,n,r,a,s,i){var o,c;for(n||(n=3),r||(r=0),a?c=Math.min(a*n+r,e.length):c=e.length,o=r;o<c;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,i),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();function ux(){var t=new Ye(4);return Ye!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function gx(t,e,n,r){var a=new Ye(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a}function lx(t,e){var n=e[0],r=e[1],a=e[2],s=e[3],i=n*n+r*r+a*a+s*s;return i>0&&(i=1/Math.sqrt(i)),t[0]=n*i,t[1]=r*i,t[2]=a*i,t[3]=s*i,t}function ea(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3];return t[0]=n[0]*r+n[4]*a+n[8]*s+n[12]*i,t[1]=n[1]*r+n[5]*a+n[9]*s+n[13]*i,t[2]=n[2]*r+n[6]*a+n[10]*s+n[14]*i,t[3]=n[3]*r+n[7]*a+n[11]*s+n[15]*i,t}(function(){var t=ux();return function(e,n,r,a,s,i){var o,c;for(n||(n=4),r||(r=0),a?c=Math.min(a*n+r,e.length):c=e.length,o=r;o<c;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,i),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();function hr(){var t=new Ye(4);return Ye!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Gc(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function hx(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>ge?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function au(t,e,n){var r=e[0],a=e[1],s=e[2],i=e[3],o=n[0],c=n[1],u=n[2],g=n[3];return t[0]=r*g+i*o+a*u-s*c,t[1]=a*g+i*c+s*o-r*u,t[2]=s*g+i*u+r*c-a*o,t[3]=i*g-r*o-a*c-s*u,t}function Ls(t,e,n,r){var a=e[0],s=e[1],i=e[2],o=e[3],c=n[0],u=n[1],g=n[2],f=n[3],l,h,v,p,d;return h=a*c+s*u+i*g+o*f,h<0&&(h=-h,c=-c,u=-u,g=-g,f=-f),1-h>ge?(l=Math.acos(h),v=Math.sin(l),p=Math.sin((1-r)*l)/v,d=Math.sin(r*l)/v):(p=1-r,d=r),t[0]=p*a+d*c,t[1]=p*s+d*u,t[2]=p*i+d*g,t[3]=p*o+d*f,t}function px(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function dx(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[a*3+a]&&(a=2);var s=(a+1)%3,i=(a+2)%3;r=Math.sqrt(e[a*3+a]-e[s*3+s]-e[i*3+i]+1),t[a]=.5*r,r=.5/r,t[3]=(e[s*3+i]-e[i*3+s])*r,t[s]=(e[s*3+a]+e[a*3+s])*r,t[i]=(e[i*3+a]+e[a*3+i])*r}return t}var su=gx,d0=lx;(function(){var t=h0(),e=tu(1,0,0),n=tu(0,1,0);return function(r,a,s){var i=kc(a,s);return i<-.999999?(Nr(t,e,a),p0(t)<1e-6&&Nr(t,n,a),$n(t,t),Gc(r,t,Math.PI),r):i>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Nr(t,a,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+i,d0(r,r))}})();(function(){var t=hr(),e=hr();return function(n,r,a,s,i,o){return Ls(t,r,i,o),Ls(e,a,s,o),Ls(n,t,e,2*o*(1-o)),n}})();(function(){var t=Zl();return function(e,n,r,a){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],d0(e,dx(e,t))}})();var ta=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Si(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function vx(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var Wi,iu;function yx(){return iu||(iu=1,Wi=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,a,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(a=r;a--!==0;)if(!t(e[a],n[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(a=r;a--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[a]))return!1;for(a=r;a--!==0;){var i=s[a];if(!t(e[i],n[i]))return!1}return!0}return e!==e&&n!==n}),Wi}var Tx=yx();const v0=Si(Tx);var zi,ou;function y0(){if(ou)return zi;ou=1;var t=Object.prototype.toString;return zi=function(n){var r=t.call(n),a=r==="[object Arguments]";return a||(a=r!=="[object Array]"&&n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t.call(n.callee)==="[object Function]"),a},zi}var Hi,cu;function xx(){if(cu)return Hi;cu=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=y0(),a=Object.prototype.propertyIsEnumerable,s=!a.call({toString:null},"toString"),i=a.call(function(){},"prototype"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(l){var h=l.constructor;return h&&h.prototype===l},u={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},g=(function(){if(typeof window>"u")return!1;for(var l in window)try{if(!u["$"+l]&&e.call(window,l)&&window[l]!==null&&typeof window[l]=="object")try{c(window[l])}catch{return!0}}catch{return!0}return!1})(),f=function(l){if(typeof window>"u"||!g)return c(l);try{return c(l)}catch{return!1}};t=function(h){var v=h!==null&&typeof h=="object",p=n.call(h)==="[object Function]",d=r(h),y=v&&n.call(h)==="[object String]",S=[];if(!v&&!p&&!d)throw new TypeError("Object.keys called on a non-object");var x=i&&p;if(y&&h.length>0&&!e.call(h,0))for(var T=0;T<h.length;++T)S.push(String(T));if(d&&h.length>0)for(var w=0;w<h.length;++w)S.push(String(w));else for(var C in h)!(x&&C==="prototype")&&e.call(h,C)&&S.push(String(C));if(s)for(var R=f(h),M=0;M<o.length;++M)!(R&&o[M]==="constructor")&&e.call(h,o[M])&&S.push(o[M]);return S}}return Hi=t,Hi}var Ai,fu;function Sx(){if(fu)return Ai;fu=1;var t=Array.prototype.slice,e=y0(),n=Object.keys,r=n?function(i){return n(i)}:xx(),a=Object.keys;return r.shim=function(){if(Object.keys){var i=(function(){var o=Object.keys(arguments);return o&&o.length===arguments.length})(1,2);i||(Object.keys=function(c){return e(c)?a(t.call(c)):a(c)})}else Object.keys=r;return Object.keys||r},Ai=r,Ai}var ji,uu;function T0(){if(uu)return ji;uu=1;var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return ji=t,ji}var Ki,gu;function Cx(){return gu||(gu=1,Ki=SyntaxError),Ki}var Pi,lu;function wx(){return lu||(lu=1,Pi=TypeError),Pi}var Xi,hu;function Ex(){return hu||(hu=1,Xi=Object.getOwnPropertyDescriptor),Xi}var Ii,pu;function Rx(){if(pu)return Ii;pu=1;var t=Ex();if(t)try{t([],"length")}catch{t=null}return Ii=t,Ii}var Yi,du;function Mx(){if(du)return Yi;du=1;var t=T0(),e=Cx(),n=wx(),r=Rx();return Yi=function(s,i,o){if(!s||typeof s!="object"&&typeof s!="function")throw new n("`obj` must be an object or a function`");if(typeof i!="string"&&typeof i!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var c=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,g=arguments.length>5?arguments[5]:null,f=arguments.length>6?arguments[6]:!1,l=!!r&&r(s,i);if(t)t(s,i,{configurable:g===null&&l?l.configurable:!g,enumerable:c===null&&l?l.enumerable:!c,value:o,writable:u===null&&l?l.writable:!u});else if(f||!c&&!u&&!g)s[i]=o;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Yi}var qi,vu;function Ox(){if(vu)return qi;vu=1;var t=T0(),e=function(){return!!t};return e.hasArrayLengthDefineBug=function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},qi=e,qi}var Qi,yu;function x0(){if(yu)return Qi;yu=1;var t=Sx(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,r=Array.prototype.concat,a=Mx(),s=function(u){return typeof u=="function"&&n.call(u)==="[object Function]"},i=Ox()(),o=function(u,g,f,l){if(g in u){if(l===!0){if(u[g]===f)return}else if(!s(l)||!l())return}i?a(u,g,f,!0):a(u,g,f)},c=function(u,g){var f=arguments.length>2?arguments[2]:{},l=t(g);e&&(l=r.call(l,Object.getOwnPropertySymbols(g)));for(var h=0;h<l.length;h+=1)o(u,l[h],g[l[h]],f[l[h]])};return c.supportsDescriptors=!!i,Qi=c,Qi}var na={exports:{}},Tu;function S0(){return Tu||(Tu=1,typeof self<"u"?na.exports=self:typeof window<"u"?na.exports=window:na.exports=Function("return this")()),na.exports}var Zi,xu;function C0(){if(xu)return Zi;xu=1;var t=S0();return Zi=function(){return typeof ta!="object"||!ta||ta.Math!==Math||ta.Array!==Array?t:ta},Zi}var Ji,Su;function Dx(){if(Su)return Ji;Su=1;var t=x0(),e=C0();return Ji=function(){var r=e();if(t.supportsDescriptors){var a=Object.getOwnPropertyDescriptor(r,"globalThis");(!a||a.configurable&&(a.enumerable||!a.writable||globalThis!==r))&&Object.defineProperty(r,"globalThis",{configurable:!0,enumerable:!1,value:r,writable:!0})}else(typeof globalThis!="object"||globalThis!==r)&&(r.globalThis=r);return r},Ji}var eo,Cu;function Lx(){if(Cu)return eo;Cu=1;var t=x0(),e=S0(),n=C0(),r=Dx(),a=n(),s=function(){return a};return t(s,{getPolyfill:n,implementation:e,shim:r}),eo=s,eo}var Vx=Lx();const mx=Si(Vx),Ut=mx(),w0={vtkObject:()=>null};function Gt(t){if(t==null||t.isA)return t;if(!t.vtkClass)return Ut.console&&Ut.console.error&&Ut.console.error("Invalid VTK object"),null;const e=w0[t.vtkClass];if(!e)return Ut.console&&Ut.console.error&&Ut.console.error(`No vtk class found for Object of type ${t.vtkClass}`),null;const n={...t};Object.keys(n).forEach(a=>{n[a]&&typeof n[a]=="object"&&n[a].vtkClass&&(n[a]=Gt(n[a]))});const r=e(n);return r&&r.modified&&r.modified(),r}function Fx(t,e){w0[t]=e}Gt.register=Fx;class to extends Array{push(){for(let e=0;e<arguments.length;e++)this.includes(arguments[e])||super.push(arguments[e]);return this.length}}let Wo=0;const E0=t=>{throw new Error(`Named parameter '${t}' is missing`)},R0=Symbol("void");function Bx(){return Wo}const M0={};function sr(){}const _x=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];_x.forEach(t=>{M0[t]=sr});Ut.console=console.hasOwnProperty("log")?console:M0;const Hn={debug:sr,error:Ut.console.error||sr,info:Ut.console.info||sr,log:Ut.console.log||sr,warn:Ut.console.warn||sr};function O0(t,e){Hn[t]&&(Hn[t]=e||sr)}function D0(){Hn.log(...arguments)}function L0(){Hn.info(...arguments)}function Ys(){Hn.debug(...arguments)}function ie(){Hn.error(...arguments)}function Ci(){Hn.warn(...arguments)}const wu={};function V0(t){wu[t]||(Hn.error(t),wu[t]=!0)}const Ze=Object.create(null);Ze.Float32Array=Float32Array;Ze.Float64Array=Float64Array;Ze.Uint8Array=Uint8Array;Ze.Int8Array=Int8Array;Ze.Uint16Array=Uint16Array;Ze.Int16Array=Int16Array;Ze.Uint32Array=Uint32Array;Ze.Int32Array=Int32Array;Ze.Uint8ClampedArray=Uint8ClampedArray;try{Ze.BigInt64Array=BigInt64Array,Ze.BigUint64Array=BigUint64Array}catch{}function Xr(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return new(Ze[t]||Float64Array)(...n)}function bc(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return(Ze[t]||Float64Array).from(...n)}function wi(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Fe(t){return wi(t[0]==="_"?t.slice(1):t)}function m0(t){return t.charAt(0).toLowerCase()+t.slice(1)}function F0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;const r=["TB","GB","MB","KB"];let a=Number(t),s="B";for(;a>n;)a/=n,s=r.pop();return`${a.toFixed(e)} ${s}`}function B0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";const n=[];let r=t;for(;r>1e3;)n.push(`000${r%1e3}`.slice(-3)),r=Math.floor(r/1e3);return r>0&&n.push(r),n.reverse(),n.join(e)}function _0(t){Object.keys(t).forEach(e=>{Array.isArray(t[e])&&(t[e]=[].concat(t[e]))})}function Ux(t){return Object.values(Ze).some(e=>t instanceof e)}function Nx(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return!1}function kx(t,e){return Object.keys(t).find(n=>t[n]===e)}function U0(t){return t&&t.isA?t.getState():t}function $c(t){setTimeout(t,0)}function N0(t,e){const n=performance.now();t.finally(()=>{const r=performance.now()-n;e(r)})}function qe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_0(e);const n=[];if(Number.isInteger(e.mtime)||(e.mtime=++Wo),!("classHierarchy"in e))e.classHierarchy=new to("vtkObject");else if(!(e.classHierarchy instanceof to)){const s=new to;for(let i=0;i<e.classHierarchy.length;i++)s.push(e.classHierarchy[i]);e.classHierarchy=s}function r(s){n[s]=null}function a(s){function i(){r(s)}return Object.freeze({unsubscribe:i})}return t.isDeleted=()=>!!e.deleted,t.modified=s=>{if(e.deleted){ie("instance deleted - cannot call any method");return}s&&s<t.getMTime()||(e.mtime=++Wo,n.forEach(i=>i&&i(t)))},t.onModified=s=>{if(e.deleted)return ie("instance deleted - cannot call any method"),null;const i=n.length;return n.push(s),a(i)},t.getMTime=()=>e.mtime,t.isA=s=>{let i=e.classHierarchy.length;for(;i--;)if(e.classHierarchy[i]===s)return!0;return!1},t.getClassName=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.classHierarchy[e.classHierarchy.length-1-s]},t.set=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,c=!1;return Object.keys(s).forEach(u=>{const g=o?null:t[`set${wi(u)}`];g&&Array.isArray(s[u])&&g.length>1?c=g(...s[u])||c:g?c=g(s[u])||c:(["mtime"].indexOf(u)===-1&&!i&&Ci(`Warning: Set value to model directly ${u}, ${s[u]}`),c=e[u]!==s[u]||c,e[u]=s[u])}),c},t.get=function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];if(!i.length)return e;const c={};return i.forEach(u=>{c[u]=e[u]}),c},t.getReferenceByName=s=>e[s],t.delete=()=>{Object.keys(e).forEach(s=>delete e[s]),n.forEach((s,i)=>r(i)),e.deleted=!0},t.getState=()=>{if(e.deleted)return null;const s={...e,vtkClass:t.getClassName()};Object.keys(s).forEach(o=>{s[o]===null||s[o]===void 0||o[0]==="_"?delete s[o]:s[o].isA?s[o]=s[o].getState():Array.isArray(s[o])?s[o]=s[o].map(U0):Ux(s[o])&&(s[o]=Array.from(s[o]))});const i={};return Object.keys(s).sort().forEach(o=>{i[o]=s[o]}),i.mtime&&delete i.mtime,i},t.shallowCopy=function(s){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(s.getClassName()!==t.getClassName())throw new Error(`Cannot ShallowCopy ${s.getClassName()} into ${t.getClassName()}`);const o=s.get(),c=Object.keys(e).sort();Object.keys(o).sort().forEach(g=>{const f=c.indexOf(g);f===-1?i&&Ys(`add ${g} in shallowCopy`):c.splice(f,1),e[g]=o[g]}),c.length&&i&&Ys(`Untouched keys: ${c.join(", ")}`),t.modified()},t.toJSON=function(){return t.getState()},t}const Gx={object(t,e,n){return function(){return{...e[n.name]}}}};function ht(t,e,n){n.forEach(r=>{if(typeof r=="object"){const a=Gx[r.type];a?t[`get${Fe(r.name)}`]=a(t,e,r):t[`get${Fe(r.name)}`]=()=>e[r.name]}else t[`get${Fe(r)}`]=()=>e[r]})}const k0={enum(t,e,n){const r=`_on${Fe(n.name)}Changed`;return a=>{if(typeof a=="string"){if(n.enum[a]!==void 0)return e[n.name]!==n.enum[a]?(e[n.name]=n.enum[a],t.modified(),!0):!1;throw ie(`Set Enum with invalid argument ${n}, ${a}`),new RangeError("Set Enum with invalid string argument")}if(typeof a=="number"){if(e[n.name]!==a){if(Object.keys(n.enum).map(s=>n.enum[s]).indexOf(a)!==-1){const s=e[n.name];return e[n.name]=a,e[r]?.(t,e,a,s),t.modified(),!0}throw ie(`Set Enum outside numeric range ${n}, ${a}`),new RangeError("Set Enum outside numeric range")}return!1}throw ie(`Set Enum with invalid argument (String/Number) ${n}, ${a}`),new TypeError("Set Enum with invalid argument (String/Number)")}},object(t,e,n){n.params?.length===1&&Ci('Setter of type "object" with a single "param" field is not supported');const r=`_on${Fe(n.name)}Changed`;return function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];let o;if(s.length>1&&n.params?.length?o=n.params.reduce((c,u,g)=>Object.assign(c,{[u]:s[g]}),{}):o=s[0],!v0(e[n.name],o)){const c=e[n.name];return e[n.name]=o,e[r]?.(t,e,o,c),t.modified(),!0}return!1}}};function Eu(t){if(typeof t=="object"){const e=k0[t.type];if(e)return(n,r)=>e(n,r,t);throw ie(`No setter for field ${t}`),new TypeError("No setter for field")}return function(n,r){const a=`_on${Fe(t)}Changed`;return function(i){if(r.deleted)return ie("instance deleted - cannot call any method"),!1;if(r[t]!==i){const o=r[t.name];return r[t]=i,r[a]?.(n,r,i,o),n.modified(),!0}return!1}}}function Aa(t,e,n){n.forEach(r=>{typeof r=="object"?t[`set${Fe(r.name)}`]=Eu(r)(t,e):t[`set${Fe(r)}`]=Eu(r)(t,e)})}function He(t,e,n){ht(t,e,n),Aa(t,e,n)}function Ir(t,e,n){n.forEach(r=>{t[`get${Fe(r)}`]=()=>e[r]?Array.from(e[r]):e[r],t[`get${Fe(r)}ByReference`]=()=>e[r]})}function Wc(t,e,n,r){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;n.forEach(s=>{if(e[s]&&r&&e[s].length!==r)throw new RangeError(`Invalid initial number of values for array (${s})`);const i=`_on${Fe(s)}Changed`;t[`set${Fe(s)}`]=function(){if(e.deleted)return ie("instance deleted - cannot call any method"),!1;for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];let g=c,f,l=!1;if(g.length===1&&(g[0]==null||g[0].length>=0)&&(g=g[0],l=!0),g==null)f=e[s]!==g;else{if(r&&g.length!==r)if(g.length<r&&a!==void 0)for(g=Array.from(g),l=!1;g.length<r;)g.push(a);else throw new RangeError(`Invalid number of values for array setter (${s})`);f=e[s]==null||e[s].length!==g.length;for(let h=0;!f&&h<g.length;++h)f=e[s][h]!==g[h];f&&l&&(g=Array.from(g))}if(f){const h=e[s.name];e[s]=g,e[i]?.(t,e,g,h),t.modified()}return f},t[`set${Fe(s)}From`]=o=>{const c=e[s];o.forEach((u,g)=>{c[g]=u})}})}function zc(t,e,n,r){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;Ir(t,e,n),Wc(t,e,n,r,a)}function ja(t,e,n){for(let r=0;r<n.length;r++){const a=n[r];e[a]!==void 0&&(e[`_${a}`]=e[a],delete e[a])}}function G0(t,e,n,r){e.inputData?e.inputData=e.inputData.map(Gt):e.inputData=[],e.inputConnection?e.inputConnection=e.inputConnection.map(Gt):e.inputConnection=[],e.output?e.output=e.output.map(Gt):e.output=[],e.inputArrayToProcess?e.inputArrayToProcess=e.inputArrayToProcess.map(Gt):e.inputArrayToProcess=[],e.numberOfInputs=n;function a(h){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){ie("instance deleted - cannot call any method");return}if(v>=e.numberOfInputs){ie(`algorithm ${t.getClassName()} only has ${e.numberOfInputs} input ports. To add more input ports, use addInputData()`);return}(e.inputData[v]!==h||e.inputConnection[v])&&(e.inputData[v]=h,e.inputConnection[v]=null,t.modified&&t.modified())}function s(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[h]&&(e.inputData[h]=e.inputConnection[h]()),e.inputData[h]}function i(h){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){ie("instance deleted - cannot call any method");return}if(v>=e.numberOfInputs){let p=`algorithm ${t.getClassName()} only has `;p+=`${e.numberOfInputs}`,p+=" input ports. To add more input ports, use addInputConnection()",ie(p);return}e.inputData[v]=null,e.inputConnection[v]=h}function o(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[h]}function c(){let h=e.numberOfInputs;for(;h&&!e.inputData[h-1]&&!e.inputConnection[h-1];)h--;return h===e.numberOfInputs&&e.numberOfInputs++,h}function u(h){if(e.deleted){ie("instance deleted - cannot call any method");return}i(h,c())}function g(h){if(e.deleted){ie("instance deleted - cannot call any method");return}a(h,c())}function f(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.deleted?(ie("instance deleted - cannot call any method"),null):(t.shouldUpdate()&&t.update(),e.output[h])}t.shouldUpdate=()=>{const h=t.getMTime();let v=1/0,p=r;for(;p--;){if(!e.output[p]||e.output[p].isDeleted())return!0;const d=e.output[p].getMTime();if(d<h)return!0;d<v&&(v=d)}for(p=e.numberOfInputs;p--;)if(e.inputConnection[p]?.filter.shouldUpdate()||t.getInputData(p)?.getMTime()>v)return!0;return!1};function l(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const v=()=>f(h);return v.filter=t,v}if(e.numberOfInputs){let h=e.numberOfInputs;for(;h--;)e.inputData.push(null),e.inputConnection.push(null);t.setInputData=a,t.setInputConnection=i,t.addInputData=g,t.addInputConnection=u,t.getInputData=s,t.getInputConnection=o}r&&(t.getOutputData=f,t.getOutputPort=l),t.update=()=>{const h=[];if(e.numberOfInputs){let v=0;for(;v<e.numberOfInputs;)h[v]=t.getInputData(v),v++}t.requestData&&!t.isDeleted()&&t.shouldUpdate()&&t.requestData(h,e.output)},t.getNumberOfInputPorts=()=>e.numberOfInputs,t.getNumberOfOutputPorts=()=>r||e.output.length,t.getInputArrayToProcess=h=>{const v=e.inputArrayToProcess[h],p=e.inputData[h];return v&&p?p[`get${v.fieldAssociation}`]().getArray(v.arrayName):null},t.setInputArrayToProcess=function(h,v,p){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";for(;e.inputArrayToProcess.length<h;)e.inputArrayToProcess.push(null);e.inputArrayToProcess[h]={arrayName:v,fieldAssociation:p,attributeType:d}}}const Hc=Symbol("Event abort");function b0(t,e,n){const r=[],a=t.delete;let s=1;function i(u){for(let g=0;g<r.length;++g){const[f]=r[g];if(f===u){r.splice(g,1);return}}}function o(u){function g(){i(u)}return Object.freeze({unsubscribe:g})}function c(){if(e.deleted){ie("instance deleted - cannot call any method");return}const u=r.slice();for(let g=0;g<u.length;++g){const[,f,l]=u[g];if(f){if(l<0)setTimeout(()=>f.apply(t,arguments),1-l);else if(f.apply(t,arguments)===Hc)break}}}t[`invoke${Fe(n)}`]=c,t[`on${Fe(n)}`]=function(u){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!u.apply)return console.error(`Invalid callback for event ${n}`),null;if(e.deleted)return ie("instance deleted - cannot call any method"),null;const f=s++;return r.push([f,u,g]),r.sort((l,h)=>h[2]-l[2]),o(f)},t.delete=()=>{a(),r.forEach(u=>{let[g]=u;return i(g)})}}function Ce(t,e){const n=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a={},s={};return t(s,a,r),Object.freeze(s)};return e&&Gt.register(e,n),n}function $0(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return e.filter(i=>!!i).map(i=>i(...a))}}function Ac(t){return t&&t.isA&&t.isA("vtkObject")}function qs(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(Ac(t)){if(r.indexOf(t)>=0)return n;r.push(t);const a=e(t);a!==void 0&&n.push(a);const s=t.get();Object.keys(s).forEach(i=>{const o=s[i];Array.isArray(o)?o.forEach(c=>{qs(c,e,n,r)}):qs(o,e,n,r)})}return n}function W0(t,e,n){var r=this;let a;const s=function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];const u=r,g=()=>{a=null,n||t.apply(u,o)},f=n&&!a;clearTimeout(a),a=setTimeout(g,e),f&&t.apply(u,o)};return s.cancel=()=>clearTimeout(a),s}function z0(t,e){let n=!1,r=null;function a(){n=!1,r!==null&&(s(...r),r=null)}function s(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];if(n){r=o;return}n=!0,t(...o),setTimeout(a,e)}return s}function jc(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};e.keystore=Object.assign(e.keystore||{},n),t.setKey=(r,a)=>{e.keystore[r]=a},t.getKey=r=>e.keystore[r],t.getAllKeys=()=>Object.keys(e.keystore),t.deleteKey=r=>delete e.keystore[r],t.clearKeystore=()=>t.getAllKeys().forEach(r=>delete e.keystore[r])}let bx=1;const ts="__root__";function H0(t,e){jc(t,e);const n=t.delete;e.proxyId=`${bx++}`,e.ui=JSON.parse(JSON.stringify(e.ui||[])),ht(t,e,["proxyId","proxyGroup","proxyName"]),He(t,e,["proxyManager"]);const r={},a={};function s(u,g){a[g]||(a[g]=[]);const f=a[g];for(let l=0;l<u.length;l++)f.push(u[l].name),r[u[l].name]=u[l],u[l].children&&u[l].children.length&&s(u[l].children,u[l].name)}s(e.ui,ts),t.updateUI=u=>{e.ui=JSON.parse(JSON.stringify(u||[])),Object.keys(r).forEach(g=>delete r[g]),Object.keys(a).forEach(g=>delete a[g]),s(e.ui,ts),t.modified()};function i(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ts;return a[u]}t.updateProxyProperty=(u,g)=>{const f=r[u];f?Object.assign(f,g):r[u]={...g}},t.activate=()=>{if(e.proxyManager){const u=`setActive${Fe(t.getProxyGroup().slice(0,-1))}`;e.proxyManager[u]&&e.proxyManager[u](t)}},e.propertyLinkSubscribers={},t.registerPropertyLinkForGC=(u,g)=>{g in e.propertyLinkSubscribers||(e.propertyLinkSubscribers[g]=[]),e.propertyLinkSubscribers[g].push(u)},t.gcPropertyLinks=u=>{const g=e.propertyLinkSubscribers[u]||[];for(;g.length;)g.pop().unbind(t)},e.propertyLinkMap={},t.getPropertyLink=function(u){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.propertyLinkMap[u])return e.propertyLinkMap[u];let f=null;const l=[];let h=0,v=!1;function p(T){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(v)return null;const C=[];let R=null;for(h=l.length;h--;){const m=l[h];m.instance===T?R=m:C.push(m)}if(!R)return null;const M=R.instance[`get${Fe(R.propertyName)}`]();if(!Nx(M,f)||w){for(f=M,v=!0;C.length;){const m=C.pop();m.instance.set({[m.propertyName]:f})}v=!1}return e.propertyLinkMap[u].persistent&&(e.propertyLinkMap[u].value=M),M}function d(T,w){const C=[];for(h=l.length;h--;){const R=l[h];R.instance===T&&(R.propertyName===w||w===void 0)&&(R.subscription.unsubscribe(),C.push(h))}for(;C.length;)l.splice(C.pop(),1)}function y(T,w){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const R=T.onModified(p),M=l[0];return l.push({instance:T,propertyName:w,subscription:R}),C&&(e.propertyLinkMap[u].persistent&&e.propertyLinkMap[u].value!==void 0?T.set({[w]:e.propertyLinkMap[u].value}):M&&p(M.instance,!0)),{unsubscribe:()=>d(T,w)}}function S(){for(;l.length;)l.pop().subscription.unsubscribe()}const x={bind:y,unbind:d,unsubscribe:S,persistent:g};return e.propertyLinkMap[u]=x,x};function o(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ts;const g=[],f=e.proxyId,l=i(u)||[];for(let h=0;h<l.length;h++){const v=l[h],p=t[`get${Fe(v)}`],d=p?p():void 0,y={id:f,name:v,value:d},S=o(v);S.length&&(y.children=S),g.push(y)}return g}t.listPropertyNames=()=>o().map(u=>u.name),t.getPropertyByName=u=>o().find(g=>g.name===u),t.getPropertyDomainByName=u=>(r[u]||{}).domain,t.getProxySection=()=>({id:e.proxyId,name:e.proxyGroup,ui:e.ui,properties:o()}),t.delete=()=>{const u=Object.keys(e.propertyLinkMap);let g=u.length;for(;g--;)e.propertyLinkMap[u[g]].unsubscribe();Object.keys(e.propertyLinkSubscribers).forEach(t.gcPropertyLinks),n()},t.getState=()=>null;function c(){if(e.links)for(let u=0;u<e.links.length;u++){const{link:g,property:f,persistent:l,updateOnBind:h,type:v}=e.links[u];if(v==="application"){const p=e.proxyManager.getPropertyLink(g,l);t.registerPropertyLinkForGC(p,"application"),p.bind(t,f,h)}}}$c(c)}function A0(t,e,n){const r=t.delete,a=[],s=Object.keys(n);let i=s.length;for(;i--;){const o=s[i],{modelKey:c,property:u,modified:g=!0}=n[o],f=Fe(u),l=Fe(o);t[`get${l}`]=e[c][`get${f}`],t[`set${l}`]=e[c][`set${f}`],g&&a.push(e[c].onModified(t.modified))}t.delete=()=>{for(;a.length;)a.pop().unsubscribe();r()}}function j0(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e.this=t;function a(o){const c=Object.keys(o);let u=c.length;for(;u--;){const g=c[u];e[g].set(o[g])}}const s=Object.keys(r);let i=s.length;for(;i--;){const o=s[i];e[o]=r[o];const c=n[o];t[`set${Fe(o)}`]=u=>{if(u!==e[o]){e[o]=u;const g=c[u];a(g),t.modified()}}}s.length&&ht(t,e,s)}const Ru=10,Mu=40,Ou=800;function K0(t){let e=0,n=0,r=0,a=0;return"detail"in t&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=n,n=0),r=e*Ru,a=n*Ru,"deltaY"in t&&(a=t.deltaY),"deltaX"in t&&(r=t.deltaX),(r||a)&&t.deltaMode&&(t.deltaMode===1?(r*=Mu,a*=Mu):(r*=Ou,a*=Ou)),r&&!e&&(e=r<1?-1:1),a&&!n&&(n=a<1?-1:1),{spinX:e,spinY:n||e,pixelX:r,pixelY:a||r}}var E={algo:G0,capitalize:wi,chain:$0,debounce:W0,enumToString:kx,event:b0,EVENT_ABORT:Hc,formatBytesToProperUnit:F0,formatNumbersWithThousandSeparator:B0,get:ht,getArray:Ir,getCurrentGlobalMTime:Bx,getStateArrayMapFunc:U0,isVtkObject:Ac,keystore:jc,measurePromiseExecution:N0,moveToProtected:ja,newInstance:Ce,newTypedArray:Xr,newTypedArrayFrom:bc,normalizeWheel:K0,obj:qe,proxy:H0,proxyPropertyMapping:A0,proxyPropertyState:j0,safeArrays:_0,set:Aa,setArray:Wc,setGet:He,setGetArray:zc,setImmediate:$c,setLoggerFunction:O0,throttle:z0,traverseInstanceTree:qs,TYPED_ARRAYS:Ze,uncapitalize:m0,VOID:R0,vtkDebugMacro:Ys,vtkErrorMacro:ie,vtkInfoMacro:L0,vtkLogMacro:D0,vtkOnceErrorMacro:V0,vtkWarningMacro:Ci,objectSetterMap:k0,requiredParam:E0},nn=Object.freeze({__proto__:null,requiredParam:E0,VOID:R0,setLoggerFunction:O0,vtkLogMacro:D0,vtkInfoMacro:L0,vtkDebugMacro:Ys,vtkErrorMacro:ie,vtkWarningMacro:Ci,vtkOnceErrorMacro:V0,TYPED_ARRAYS:Ze,newTypedArray:Xr,newTypedArrayFrom:bc,capitalize:wi,_capitalize:Fe,uncapitalize:m0,formatBytesToProperUnit:F0,formatNumbersWithThousandSeparator:B0,setImmediateVTK:$c,measurePromiseExecution:N0,obj:qe,get:ht,set:Aa,setGet:He,getArray:Ir,setArray:Wc,setGetArray:zc,moveToProtected:ja,algo:G0,EVENT_ABORT:Hc,event:b0,newInstance:Ce,chain:$0,isVtkObject:Ac,traverseInstanceTree:qs,debounce:W0,throttle:z0,keystore:jc,proxy:H0,proxyPropertyMapping:A0,proxyPropertyState:j0,normalizeWheel:K0,default:E});const{vtkErrorMacro:$x}=E,Wx=["Build","Render"];function zx(t,e){e.classHierarchy.push("vtkViewNode");function n(a,s){for(let i=0;i<e.children.length;++i){const o=(s+1+i)%e.children.length;if(e.children[o]===a)return e.children[o]=e.children[s],e.children[s]=a,!0}return!1}t.build=a=>{},t.render=a=>{},t.traverse=a=>{const s=a.getTraverseOperation(),i=t[s];if(i){i(a);return}t.apply(a,!0);for(let o=0;o<e.children.length;o++)e.children[o].traverse(a);t.apply(a,!1)},t.apply=(a,s)=>{const i=t[a.getOperation()];i&&i(s,a)},t.getViewNodeFor=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(s&&s.renderable===a)return s;if(e.renderable===a)return t;for(let i=0;i<e.children.length;++i){const c=e.children[i].getViewNodeFor(a);if(c)return c}},t.getFirstAncestorOfType=a=>e._parent?e._parent.isA(a)?e._parent:e._parent.getFirstAncestorOfType(a):null,t.getLastAncestorOfType=a=>{if(!e._parent)return null;const s=e._parent.getLastAncestorOfType(a);return s||(e._parent.isA(a)?e._parent:null)},t.addMissingNode=a=>{if(!a)return;const s=e._renderableChildMap.get(a);if(s!==void 0)return s.setVisited(!0),s;const i=t.createViewNode(a);if(i)return i.setParent(t),i.setVisited(!0),e._renderableChildMap.set(a,i),e.children.push(i),i},t.addMissingNodes=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!a||!a.length)return;let i;for(let o=0;o<a.length;++o){const c=a[o],u=t.addMissingNode(c);s&&u!==void 0&&(i===void 0?i=e.children.lastIndexOf(u):e.children[i]!==u&&n(e.children,u),i++)}},t.addMissingChildren=a=>{if(!(!a||!a.length))for(let s=0;s<a.length;++s){const i=a[s];if(e.children.indexOf(i)===-1){i.setParent(t),e.children.push(i);const c=i.getRenderable();c&&e._renderableChildMap.set(c,i)}i.setVisited(!0)}},t.removeNode=a=>{const s=e.children.findIndex(o=>o===a);if(s<0)return!1;const i=a.getRenderable();return i&&e._renderableChildMap.delete(i),a.delete(),e.children.splice(s,1),!0},t.prepareNodes=()=>{for(let a=0;a<e.children.length;++a)e.children[a].setVisited(!1)},t.setVisited=a=>{e.visited=a},t.removeUnusedNodes=()=>{let a=0;for(let s=0;s<e.children.length;++s){const i=e.children[s];if(i.getVisited())e.children[a++]=i,i.setVisited(!1);else{const c=i.getRenderable();c&&e._renderableChildMap.delete(c),i.delete()}}e.children.length=a},t.createViewNode=a=>{if(!e.myFactory)return $x("Cannot create view nodes without my own factory"),null;const s=e.myFactory.createNode(a);return s&&s.setRenderable(a),s};const r=t.delete;t.delete=()=>{for(let a=0;a<e.children.length;a++)e.children[a].delete();r()}}const Hx={renderable:null,myFactory:null,children:[],visited:!1};function P0(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Hx,n),E.obj(t,e),E.event(t,e,"event"),e._renderableChildMap=new Map,E.get(t,e,["visited"]),E.setGet(t,e,["_parent","renderable","myFactory"]),E.getArray(t,e,["children"]),E.moveToProtected(t,e,["parent"]),zx(t,e)}const Ax=E.newInstance(P0,"vtkViewNode");var Be={newInstance:Ax,extend:P0,PASS_TYPES:Wx};function jx(t,e){e.overrides||(e.overrides={}),e.classHierarchy.push("vtkViewNodeFactory"),t.createNode=n=>{if(n.isDeleted())return null;let r=0,a=n.getClassName(r++),s=!1;const i=Object.keys(e.overrides);for(;a&&!s;)i.indexOf(a)!==-1?s=!0:a=n.getClassName(r++);if(!s)return null;const o=e.overrides[a]();return o.setMyFactory(t),o}}const Kx={};function X0(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Kx,n),E.obj(t,e),jx(t,e)}const Px=E.newInstance(X0,"vtkViewNodeFactory");var I0={newInstance:Px,extend:X0};const Y0=Object.create(null);function Ft(t,e){Y0[t]=e}function Xx(t,e){e.classHierarchy.push("vtkOpenGLViewNodeFactory")}const Ix={};function q0(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ix,n),e.overrides=Y0,I0.extend(t,e,n),Xx(t,e)}const Yx=E.newInstance(q0,"vtkOpenGLViewNodeFactory");var qx={newInstance:Yx,extend:q0};function Qx(t,e){e.classHierarchy.push("vtkOpenGLCamera"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext())},t.opaquePass=n=>{if(n){const r=e._openGLRenderer.getTiledSizeAndOrigin();e.context.viewport(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize),e.context.scissor(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize)}},t.translucentPass=t.opaquePass,t.zBufferPass=t.opaquePass,t.opaqueZBufferPass=t.opaquePass,t.volumePass=t.opaquePass,t.getKeyMatrices=n=>{if(n!==e.lastRenderer||e._openGLRenderWindow.getMTime()>e.keyMatrixTime.getMTime()||t.getMTime()>e.keyMatrixTime.getMTime()||n.getMTime()>e.keyMatrixTime.getMTime()||e.renderable.getMTime()>e.keyMatrixTime.getMTime()){Qe(e.keyMatrices.wcvc,e.renderable.getViewMatrix()),Fc(e.keyMatrices.normalMatrix,e.keyMatrices.wcvc),Bc(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Oe(e.keyMatrices.wcvc,e.keyMatrices.wcvc);const r=e._openGLRenderer.getAspectRatio();Qe(e.keyMatrices.vcpc,e.renderable.getProjectionMatrix(r,-1,1)),Oe(e.keyMatrices.vcpc,e.keyMatrices.vcpc),Ne(e.keyMatrices.wcpc,e.keyMatrices.vcpc,e.keyMatrices.wcvc),e.keyMatrixTime.modified(),e.lastRenderer=n}return e.keyMatrices}}const Zx={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function Jx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Zx,n),Be.extend(t,e,n),e.keyMatrixTime={},qe(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(9),vcpc:new Float64Array(16),wcvc:new Float64Array(16),wcpc:new Float64Array(16)},He(t,e,["context","keyMatrixTime"]),Qx(t,e)}const eS=Ce(Jx);Ft("vtkCamera",eS);const{vtkDebugMacro:tS}=nn;function nS(t,e){e.classHierarchy.push("vtkOpenGLRenderer"),t.buildPass=n=>{if(n){if(!e.renderable)return;t.updateLights(),t.prepareNodes(),t.addMissingNode(e.renderable.getActiveCamera()),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps(),!0),t.removeUnusedNodes()}},t.updateLights=()=>{let n=0;const r=e.renderable.getLightsByReference();for(let a=0;a<r.length;++a)r[a].getSwitch()>0&&n++;return n||(tS("No lights are on, creating one."),e.renderable.createLight()),n},t.zBufferPass=n=>{if(n){let r=0;const a=e.context;e.renderable.getTransparent()||(e.context.clearColor(1,0,0,1),r|=a.COLOR_BUFFER_BIT),e.renderable.getPreserveDepthBuffer()||(a.clearDepth(1),r|=a.DEPTH_BUFFER_BIT,e.context.depthMask(!0));const s=t.getTiledSizeAndOrigin();a.enable(a.SCISSOR_TEST),a.scissor(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize),a.viewport(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize),a.colorMask(!0,!0,!0,!0),r&&a.clear(r),a.enable(a.DEPTH_TEST)}},t.opaqueZBufferPass=n=>t.zBufferPass(n),t.cameraPass=n=>{n&&t.clear()},t.getAspectRatio=()=>{const n=e._parent.getSizeByReference(),r=e.renderable.getViewportByReference();return n[0]*(r[2]-r[0])/((r[3]-r[1])*n[1])},t.getTiledSizeAndOrigin=()=>{const n=e.renderable.getViewportByReference(),r=[0,0,1,1],a=n[0]-r[0],s=n[1]-r[1],i=e._parent.normalizedDisplayToDisplay(a,s),o=Math.round(i[0]),c=Math.round(i[1]),u=n[2]-r[0],g=n[3]-r[1],f=e._parent.normalizedDisplayToDisplay(u,g);let l=Math.round(f[0])-o,h=Math.round(f[1])-c;return l<0&&(l=0),h<0&&(h=0),{usize:l,vsize:h,lowerLeftU:o,lowerLeftV:c}},t.clear=()=>{let n=0;const r=e.context;if(!e.renderable.getTransparent()){const s=e.renderable.getBackgroundByReference();r.clearColor(s[0],s[1],s[2],s[3]),n|=r.COLOR_BUFFER_BIT}e.renderable.getPreserveDepthBuffer()||(r.clearDepth(1),n|=r.DEPTH_BUFFER_BIT,r.depthMask(!0)),r.colorMask(!0,!0,!0,!0);const a=t.getTiledSizeAndOrigin();r.enable(r.SCISSOR_TEST),r.scissor(a.lowerLeftU,a.lowerLeftV,a.usize,a.vsize),r.viewport(a.lowerLeftU,a.lowerLeftV,a.usize,a.vsize),n&&r.clear(n),r.enable(r.DEPTH_TEST)},t.releaseGraphicsResources=()=>{e.selector!==null&&e.selector.releaseGraphicsResources(),e.renderable&&e.renderable.getViewProps().forEach(n=>{n.modified()})},t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))}}const rS={context:null,_openGLRenderWindow:null,selector:null};function aS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rS,n),Be.extend(t,e,n),ht(t,e,["shaderCache"]),He(t,e,["selector"]),ja(t,e,["openGLRenderWindow"]),nS(t,e)}const sS=Ce(aS,"vtkOpenGLRenderer");Ft("vtkRenderer",sS);function iS(t,e){e.classHierarchy.push("vtkOpenGLActor"),t.buildPass=n=>{if(n){e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(let r=0;r<e.children.length;r++){const a=e.children[r];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.traverseZBufferPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseOpaqueZBufferPass=n=>t.traverseOpaquePass(n),t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.activateTextures=()=>{if(e.ogltextures){e.activeTextures=[];for(let n=0;n<e.ogltextures.length;n++){const r=e.ogltextures[n];r.render(),r.getHandle()&&e.activeTextures.push(r)}}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.zBufferPass=(n,r)=>t.opaquePass(n,r),t.opaqueZBufferPass=(n,r)=>t.opaquePass(n,r),t.opaquePass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=(n,r)=>{if(n)e.context.depthMask(e._openGLRenderer.getSelector()&&e.renderable.getNestedPickable()),t.activateTextures();else if(e.activeTextures)for(let a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.getKeyMatrices=()=>(e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),Qe(e.keyMatrices.mcwc,e.renderable.getMatrix()),Oe(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.renderable.getIsIdentity()?jn(e.keyMatrices.normalMatrix):(Fc(e.keyMatrices.normalMatrix,e.keyMatrices.mcwc),Bc(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Jl(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),e.keyMatrixTime.modified()),e.keyMatrices)}const oS={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function cS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oS,n),Be.extend(t,e,n),e.keyMatrixTime={},qe(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:jn(new Float64Array(9)),mcwc:ue(new Float64Array(16))},He(t,e,["context"]),ht(t,e,["activeTextures"]),iS(t,e)}const fS=Ce(cS);Ft("vtkActor",fS);function uS(t,e){e.classHierarchy.push("vtkOpenGLActor2D"),t.buildPass=n=>{if(n){if(!e.renderable)return;e._openGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(let r=0;r<e.children.length;r++){const a=e.children[r];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementOverlayActorCount()}},t.traverseOpaquePass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.traverseOverlayPass=n=>{!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable||(t.apply(n,!0),e.oglmapper.traverse(n),t.apply(n,!1))},t.activateTextures=()=>{if(e.ogltextures){e.activeTextures=[];for(let n=0;n<e.ogltextures.length;n++){const r=e.ogltextures[n];r.render(),r.getHandle()&&e.activeTextures.push(r)}}},t.opaquePass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=(n,r)=>{if(n)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(let a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.overlayPass=(n,r)=>{if(n)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(let a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()}}const gS={context:null,activeTextures:null};function lS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gS,n),Be.extend(t,e,n),He(t,e,["context"]),ht(t,e,["activeTextures"]),uS(t,e)}const hS=Ce(lS);Ft("vtkActor2D",hS);function Vs(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function pS(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Q0(t){let e,n,r;t.length!==2?(e=Vs,n=(o,c)=>Vs(t(o),c),r=(o,c)=>t(o)-c):(e=t===Vs||t===pS?t:dS,n=t,r=t);function a(o,c,u=0,g=o.length){if(u<g){if(e(c,c)!==0)return g;do{const f=u+g>>>1;n(o[f],c)<0?u=f+1:g=f}while(u<g)}return u}function s(o,c,u=0,g=o.length){if(u<g){if(e(c,c)!==0)return g;do{const f=u+g>>>1;n(o[f],c)<=0?u=f+1:g=f}while(u<g)}return u}function i(o,c,u=0,g=o.length){const f=a(o,c,u,g-1);return f>u&&r(o[f-1],c)>-r(o[f],c)?f-1:f}return{left:a,center:i,right:s}}function dS(){return 0}function vS(t){return t===null?NaN:+t}const yS=Q0(Vs),TS=yS.right;Q0(vS).center;const xS=Math.sqrt(50),SS=Math.sqrt(10),CS=Math.sqrt(2);function Qs(t,e,n){const r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),s=r/Math.pow(10,a),i=s>=xS?10:s>=SS?5:s>=CS?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/i,o=Math.round(t*u),c=Math.round(e*u),o/u<t&&++o,c/u>e&&--c,u=-u):(u=Math.pow(10,a)*i,o=Math.round(t/u),c=Math.round(e/u),o*u<t&&++o,c*u>e&&--c),c<o&&.5<=n&&n<2?Qs(t,e,n*2):[o,c,u]}function wS(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[a,s,i]=r?Qs(e,t,n):Qs(t,e,n);if(!(s>=a))return[];const o=s-a+1,c=new Array(o);if(r)if(i<0)for(let u=0;u<o;++u)c[u]=(s-u)/-i;else for(let u=0;u<o;++u)c[u]=(s-u)*i;else if(i<0)for(let u=0;u<o;++u)c[u]=(a+u)/-i;else for(let u=0;u<o;++u)c[u]=(a+u)*i;return c}function zo(t,e,n){return e=+e,t=+t,n=+n,Qs(t,e,n)[2]}function ES(t,e,n){e=+e,t=+t,n=+n;const r=e<t,a=r?zo(e,t,n):zo(t,e,n);return(r?-1:1)*(a<0?1/-a:a)}function RS(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Kc(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Z0(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ka(){}var Na=.7,Zs=1/Na,kr="\\s*([+-]?\\d+)\\s*",ka="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Jt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",MS=/^#([0-9a-f]{3,8})$/,OS=new RegExp(`^rgb\\(${kr},${kr},${kr}\\)$`),DS=new RegExp(`^rgb\\(${Jt},${Jt},${Jt}\\)$`),LS=new RegExp(`^rgba\\(${kr},${kr},${kr},${ka}\\)$`),VS=new RegExp(`^rgba\\(${Jt},${Jt},${Jt},${ka}\\)$`),mS=new RegExp(`^hsl\\(${ka},${Jt},${Jt}\\)$`),FS=new RegExp(`^hsla\\(${ka},${Jt},${Jt},${ka}\\)$`),Du={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kc(Ka,Ga,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Lu,formatHex:Lu,formatHex8:BS,formatHsl:_S,formatRgb:Vu,toString:Vu});function Lu(){return this.rgb().formatHex()}function BS(){return this.rgb().formatHex8()}function _S(){return J0(this).formatHsl()}function Vu(){return this.rgb().formatRgb()}function Ga(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=MS.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?mu(e):n===3?new xt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ns(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ns(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=OS.exec(t))?new xt(e[1],e[2],e[3],1):(e=DS.exec(t))?new xt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=LS.exec(t))?ns(e[1],e[2],e[3],e[4]):(e=VS.exec(t))?ns(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=mS.exec(t))?_u(e[1],e[2]/100,e[3]/100,1):(e=FS.exec(t))?_u(e[1],e[2]/100,e[3]/100,e[4]):Du.hasOwnProperty(t)?mu(Du[t]):t==="transparent"?new xt(NaN,NaN,NaN,0):null}function mu(t){return new xt(t>>16&255,t>>8&255,t&255,1)}function ns(t,e,n,r){return r<=0&&(t=e=n=NaN),new xt(t,e,n,r)}function US(t){return t instanceof Ka||(t=Ga(t)),t?(t=t.rgb(),new xt(t.r,t.g,t.b,t.opacity)):new xt}function Ho(t,e,n,r){return arguments.length===1?US(t):new xt(t,e,n,r??1)}function xt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Kc(xt,Ho,Z0(Ka,{brighter(t){return t=t==null?Zs:Math.pow(Zs,t),new xt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Na:Math.pow(Na,t),new xt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new xt(ur(this.r),ur(this.g),ur(this.b),Js(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Fu,formatHex:Fu,formatHex8:NS,formatRgb:Bu,toString:Bu}));function Fu(){return`#${cr(this.r)}${cr(this.g)}${cr(this.b)}`}function NS(){return`#${cr(this.r)}${cr(this.g)}${cr(this.b)}${cr((isNaN(this.opacity)?1:this.opacity)*255)}`}function Bu(){const t=Js(this.opacity);return`${t===1?"rgb(":"rgba("}${ur(this.r)}, ${ur(this.g)}, ${ur(this.b)}${t===1?")":`, ${t})`}`}function Js(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ur(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function cr(t){return t=ur(t),(t<16?"0":"")+t.toString(16)}function _u(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Nt(t,e,n,r)}function J0(t){if(t instanceof Nt)return new Nt(t.h,t.s,t.l,t.opacity);if(t instanceof Ka||(t=Ga(t)),!t)return new Nt;if(t instanceof Nt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),i=NaN,o=s-a,c=(s+a)/2;return o?(e===s?i=(n-r)/o+(n<r)*6:n===s?i=(r-e)/o+2:i=(e-n)/o+4,o/=c<.5?s+a:2-s-a,i*=60):o=c>0&&c<1?0:i,new Nt(i,o,c,t.opacity)}function kS(t,e,n,r){return arguments.length===1?J0(t):new Nt(t,e,n,r??1)}function Nt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Kc(Nt,kS,Z0(Ka,{brighter(t){return t=t==null?Zs:Math.pow(Zs,t),new Nt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Na:Math.pow(Na,t),new Nt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new xt(no(t>=240?t-240:t+120,a,r),no(t,a,r),no(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new Nt(Uu(this.h),rs(this.s),rs(this.l),Js(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Js(this.opacity);return`${t===1?"hsl(":"hsla("}${Uu(this.h)}, ${rs(this.s)*100}%, ${rs(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Uu(t){return t=(t||0)%360,t<0?t+360:t}function rs(t){return Math.max(0,Math.min(1,t||0))}function no(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Pc=t=>()=>t;function GS(t,e){return function(n){return t+n*e}}function bS(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function $S(t){return(t=+t)==1?eh:function(e,n){return n-e?bS(e,n,t):Pc(isNaN(e)?n:e)}}function eh(t,e){var n=e-t;return n?GS(t,n):Pc(isNaN(t)?e:t)}const Nu=(function t(e){var n=$S(e);function r(a,s){var i=n((a=Ho(a)).r,(s=Ho(s)).r),o=n(a.g,s.g),c=n(a.b,s.b),u=eh(a.opacity,s.opacity);return function(g){return a.r=i(g),a.g=o(g),a.b=c(g),a.opacity=u(g),a+""}}return r.gamma=t,r})(1);function WS(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),a;return function(s){for(a=0;a<n;++a)r[a]=t[a]*(1-s)+e[a]*s;return r}}function zS(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function HS(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,a=new Array(r),s=new Array(n),i;for(i=0;i<r;++i)a[i]=Xc(t[i],e[i]);for(;i<n;++i)s[i]=e[i];return function(o){for(i=0;i<r;++i)s[i]=a[i](o);return s}}function AS(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function ei(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function jS(t,e){var n={},r={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?n[a]=Xc(t[a],e[a]):r[a]=e[a];return function(s){for(a in n)r[a]=n[a](s);return r}}var Ao=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ro=new RegExp(Ao.source,"g");function KS(t){return function(){return t}}function PS(t){return function(e){return t(e)+""}}function XS(t,e){var n=Ao.lastIndex=ro.lastIndex=0,r,a,s,i=-1,o=[],c=[];for(t=t+"",e=e+"";(r=Ao.exec(t))&&(a=ro.exec(e));)(s=a.index)>n&&(s=e.slice(n,s),o[i]?o[i]+=s:o[++i]=s),(r=r[0])===(a=a[0])?o[i]?o[i]+=a:o[++i]=a:(o[++i]=null,c.push({i,x:ei(r,a)})),n=ro.lastIndex;return n<e.length&&(s=e.slice(n),o[i]?o[i]+=s:o[++i]=s),o.length<2?c[0]?PS(c[0].x):KS(e):(e=c.length,function(u){for(var g=0,f;g<e;++g)o[(f=c[g]).i]=f.x(u);return o.join("")})}function Xc(t,e){var n=typeof e,r;return e==null||n==="boolean"?Pc(e):(n==="number"?ei:n==="string"?(r=Ga(e))?(e=r,Nu):XS:e instanceof Ga?Nu:e instanceof Date?AS:zS(e)?WS:Array.isArray(e)?HS:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?jS:ei)(t,e)}function IS(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function YS(t){return function(){return t}}function qS(t){return+t}var ku=[0,1];function Vr(t){return t}function jo(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:YS(isNaN(e)?NaN:.5)}function QS(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function ZS(t,e,n){var r=t[0],a=t[1],s=e[0],i=e[1];return a<r?(r=jo(a,r),s=n(i,s)):(r=jo(r,a),s=n(s,i)),function(o){return s(r(o))}}function JS(t,e,n){var r=Math.min(t.length,e.length)-1,a=new Array(r),s=new Array(r),i=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++i<r;)a[i]=jo(t[i],t[i+1]),s[i]=n(e[i],e[i+1]);return function(o){var c=TS(t,o,1,r)-1;return s[c](a[c](o))}}function e2(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function t2(){var t=ku,e=ku,n=Xc,r,a,s,i=Vr,o,c,u;function g(){var l=Math.min(t.length,e.length);return i!==Vr&&(i=QS(t[0],t[l-1])),o=l>2?JS:ZS,c=u=null,f}function f(l){return l==null||isNaN(l=+l)?s:(c||(c=o(t.map(r),e,n)))(r(i(l)))}return f.invert=function(l){return i(a((u||(u=o(e,t.map(r),ei)))(l)))},f.domain=function(l){return arguments.length?(t=Array.from(l,qS),g()):t.slice()},f.range=function(l){return arguments.length?(e=Array.from(l),g()):e.slice()},f.rangeRound=function(l){return e=Array.from(l),n=IS,g()},f.clamp=function(l){return arguments.length?(i=l?!0:Vr,g()):i!==Vr},f.interpolate=function(l){return arguments.length?(n=l,g()):n},f.unknown=function(l){return arguments.length?(s=l,f):s},function(l,h){return r=l,a=h,g()}}function n2(){return t2()(Vr,Vr)}function r2(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ti(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Wr(t){return t=ti(Math.abs(t)),t?t[1]:NaN}function a2(t,e){return function(n,r){for(var a=n.length,s=[],i=0,o=t[0],c=0;a>0&&o>0&&(c+o+1>r&&(o=Math.max(1,r-c)),s.push(n.substring(a-=o,a+o)),!((c+=o+1)>r));)o=t[i=(i+1)%t.length];return s.reverse().join(e)}}function s2(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var i2=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ni(t){if(!(e=i2.exec(t)))throw new Error("invalid format: "+t);var e;return new Ic({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ni.prototype=Ic.prototype;function Ic(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ic.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function o2(t){e:for(var e=t.length,n=1,r=-1,a;n<e;++n)switch(t[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(a+1):t}var th;function c2(t,e){var n=ti(t,e);if(!n)return t+"";var r=n[0],a=n[1],s=a-(th=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=r.length;return s===i?r:s>i?r+new Array(s-i+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+ti(t,Math.max(0,e+s-1))[0]}function Gu(t,e){var n=ti(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const bu={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:r2,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Gu(t*100,e),r:Gu,s:c2,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function $u(t){return t}var Wu=Array.prototype.map,zu=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function f2(t){var e=t.grouping===void 0||t.thousands===void 0?$u:a2(Wu.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?$u:s2(Wu.call(t.numerals,String)),i=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f){f=ni(f);var l=f.fill,h=f.align,v=f.sign,p=f.symbol,d=f.zero,y=f.width,S=f.comma,x=f.precision,T=f.trim,w=f.type;w==="n"?(S=!0,w="g"):bu[w]||(x===void 0&&(x=12),T=!0,w="g"),(d||l==="0"&&h==="=")&&(d=!0,l="0",h="=");var C=p==="$"?n:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",R=p==="$"?r:/[%p]/.test(w)?i:"",M=bu[w],m=/[defgprs%]/.test(w);x=x===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function L(V){var F=C,B=R,_,P,z;if(w==="c")B=M(V)+B,V="";else{V=+V;var A=V<0||1/V<0;if(V=isNaN(V)?c:M(Math.abs(V),x),T&&(V=o2(V)),A&&+V==0&&v!=="+"&&(A=!1),F=(A?v==="("?v:o:v==="-"||v==="("?"":v)+F,B=(w==="s"?zu[8+th/3]:"")+B+(A&&v==="("?")":""),m){for(_=-1,P=V.length;++_<P;)if(z=V.charCodeAt(_),48>z||z>57){B=(z===46?a+V.slice(_+1):V.slice(_))+B,V=V.slice(0,_);break}}}S&&!d&&(V=e(V,1/0));var I=F.length+V.length+B.length,k=I<y?new Array(y-I+1).join(l):"";switch(S&&d&&(V=e(k+V,k.length?y-B.length:1/0),k=""),h){case"<":V=F+V+B+k;break;case"=":V=F+k+V+B;break;case"^":V=k.slice(0,I=k.length>>1)+F+V+B+k.slice(I);break;default:V=k+F+V+B;break}return s(V)}return L.toString=function(){return f+""},L}function g(f,l){var h=u((f=ni(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(Wr(l)/3)))*3,p=Math.pow(10,-v),d=zu[8+v/3];return function(y){return h(p*y)+d}}return{format:u,formatPrefix:g}}var as,nh,rh;u2({thousands:",",grouping:[3],currency:["$",""]});function u2(t){return as=f2(t),nh=as.format,rh=as.formatPrefix,as}function g2(t){return Math.max(0,-Wr(Math.abs(t)))}function l2(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Wr(e)/3)))*3-Wr(Math.abs(t)))}function h2(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Wr(e)-Wr(t))+1}function p2(t,e,n,r){var a=ES(t,e,n),s;switch(r=ni(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=l2(a,i))&&(r.precision=s),rh(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=h2(a,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=g2(a))&&(r.precision=s-(r.type==="%")*2);break}}return nh(r)}function d2(t){var e=t.domain;return t.ticks=function(n){var r=e();return wS(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var a=e();return p2(a[0],a[a.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),a=0,s=r.length-1,i=r[a],o=r[s],c,u,g=10;for(o<i&&(u=i,i=o,o=u,u=a,a=s,s=u);g-- >0;){if(u=zo(i,o,n),u===c)return r[a]=i,r[s]=o,e(r);if(u>0)i=Math.floor(i/u)*u,o=Math.ceil(o/u)*u;else if(u<0)i=Math.ceil(i*u)/u,o=Math.floor(o*u)/u;else break;c=u}return t},t}function Yc(){var t=n2();return t.copy=function(){return e2(t,Yc())},RS.apply(t,arguments),d2(t)}var ms={exports:{}},v2=ms.exports,Hu;function y2(){return Hu||(Hu=1,(function(t){(function(e,n,r){function a(c){var u=this,g=o();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=g(" "),u.s1=g(" "),u.s2=g(" "),u.s0-=g(c),u.s0<0&&(u.s0+=1),u.s1-=g(c),u.s1<0&&(u.s1+=1),u.s2-=g(c),u.s2<0&&(u.s2+=1),g=null}function s(c,u){return u.c=c.c,u.s0=c.s0,u.s1=c.s1,u.s2=c.s2,u}function i(c,u){var g=new a(c),f=u&&u.state,l=g.next;return l.int32=function(){return g.next()*4294967296|0},l.double=function(){return l()+(l()*2097152|0)*11102230246251565e-32},l.quick=l,f&&(typeof f=="object"&&s(f,g),l.state=function(){return s(g,{})}),l}function o(){var c=4022871197,u=function(g){g=String(g);for(var f=0;f<g.length;f++){c+=g.charCodeAt(f);var l=.02519603282416938*c;c=l>>>0,l-=c,l*=c,c=l>>>0,l-=c,c+=l*4294967296}return(c>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(v2,t)})(ms)),ms.exports}var Fs={exports:{}},T2=Fs.exports,Au;function x2(){return Au||(Au=1,(function(t){(function(e,n,r){function a(o){var c=this,u="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var f=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^f^f>>>8},o===(o|0)?c.x=o:u+=o;for(var g=0;g<u.length+64;g++)c.x^=u.charCodeAt(g)|0,c.next()}function s(o,c){return c.x=o.x,c.y=o.y,c.z=o.z,c.w=o.w,c}function i(o,c){var u=new a(o),g=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,v=(l+h)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,g&&(typeof g=="object"&&s(g,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=i:this.xor128=i})(T2,t)})(Fs)),Fs.exports}var Bs={exports:{}},S2=Bs.exports,ju;function C2(){return ju||(ju=1,(function(t){(function(e,n,r){function a(o){var c=this,u="";c.next=function(){var f=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(f^f<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,o===(o|0)?c.x=o:u+=o;for(var g=0;g<u.length+64;g++)c.x^=u.charCodeAt(g)|0,g==u.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function s(o,c){return c.x=o.x,c.y=o.y,c.z=o.z,c.w=o.w,c.v=o.v,c.d=o.d,c}function i(o,c){var u=new a(o),g=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,v=(l+h)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,g&&(typeof g=="object"&&s(g,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=i:this.xorwow=i})(S2,t)})(Bs)),Bs.exports}var _s={exports:{}},w2=_s.exports,Ku;function E2(){return Ku||(Ku=1,(function(t){(function(e,n,r){function a(o){var c=this;c.next=function(){var g=c.x,f=c.i,l,h;return l=g[f],l^=l>>>7,h=l^l<<24,l=g[f+1&7],h^=l^l>>>10,l=g[f+3&7],h^=l^l>>>3,l=g[f+4&7],h^=l^l<<7,l=g[f+7&7],l=l^l<<13,h^=l^l<<9,g[f]=h,c.i=f+1&7,h};function u(g,f){var l,h=[];if(f===(f|0))h[0]=f;else for(f=""+f,l=0;l<f.length;++l)h[l&7]=h[l&7]<<15^f.charCodeAt(l)+h[l+1&7]<<13;for(;h.length<8;)h.push(0);for(l=0;l<8&&h[l]===0;++l);for(l==8?h[7]=-1:h[l],g.x=h,g.i=0,l=256;l>0;--l)g.next()}u(c,o)}function s(o,c){return c.x=o.x.slice(),c.i=o.i,c}function i(o,c){o==null&&(o=+new Date);var u=new a(o),g=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,v=(l+h)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,g&&(g.x&&s(g,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=i:this.xorshift7=i})(w2,t)})(_s)),_s.exports}var Us={exports:{}},R2=Us.exports,Pu;function M2(){return Pu||(Pu=1,(function(t){(function(e,n,r){function a(o){var c=this;c.next=function(){var g=c.w,f=c.X,l=c.i,h,v;return c.w=g=g+1640531527|0,v=f[l+34&127],h=f[l=l+1&127],v^=v<<13,h^=h<<17,v^=v>>>15,h^=h>>>12,v=f[l]=v^h,c.i=l,v+(g^g>>>16)|0};function u(g,f){var l,h,v,p,d,y=[],S=128;for(f===(f|0)?(h=f,f=null):(f=f+"\0",h=0,S=Math.max(S,f.length)),v=0,p=-32;p<S;++p)f&&(h^=f.charCodeAt((p+32)%f.length)),p===0&&(d=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,p>=0&&(d=d+1640531527|0,l=y[p&127]^=h+d,v=l==0?v+1:0);for(v>=128&&(y[(f&&f.length||0)&127]=-1),v=127,p=512;p>0;--p)h=y[v+34&127],l=y[v=v+1&127],h^=h<<13,l^=l<<17,h^=h>>>15,l^=l>>>12,y[v]=h^l;g.w=d,g.X=y,g.i=v}u(c,o)}function s(o,c){return c.i=o.i,c.w=o.w,c.X=o.X.slice(),c}function i(o,c){o==null&&(o=+new Date);var u=new a(o),g=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,v=(l+h)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,g&&(g.X&&s(g,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=i:this.xor4096=i})(R2,t)})(Us)),Us.exports}var Ns={exports:{}},O2=Ns.exports,Xu;function D2(){return Xu||(Xu=1,(function(t){(function(e,n,r){function a(o){var c=this,u="";c.next=function(){var f=c.b,l=c.c,h=c.d,v=c.a;return f=f<<25^f>>>7^l,l=l-h|0,h=h<<24^h>>>8^v,v=v-f|0,c.b=f=f<<20^f>>>12^l,c.c=l=l-h|0,c.d=h<<16^l>>>16^v,c.a=v-f|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,o===Math.floor(o)?(c.a=o/4294967296|0,c.b=o|0):u+=o;for(var g=0;g<u.length+20;g++)c.b^=u.charCodeAt(g)|0,c.next()}function s(o,c){return c.a=o.a,c.b=o.b,c.c=o.c,c.d=o.d,c}function i(o,c){var u=new a(o),g=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,v=(l+h)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,g&&(typeof g=="object"&&s(g,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=i:this.tychei=i})(O2,t)})(Ns)),Ns.exports}var ks={exports:{}};const L2={},V2=Object.freeze(Object.defineProperty({__proto__:null,default:L2},Symbol.toStringTag,{value:"Module"})),m2=vx(V2);var F2=ks.exports,Iu;function B2(){return Iu||(Iu=1,(function(t){(function(e,n,r){var a=256,s=6,i=52,o="random",c=r.pow(a,s),u=r.pow(2,i),g=u*2,f=a-1,l;function h(T,w,C){var R=[];w=w==!0?{entropy:!0}:w||{};var M=y(d(w.entropy?[T,x(n)]:T??S(),3),R),m=new v(R),L=function(){for(var V=m.g(s),F=c,B=0;V<u;)V=(V+B)*a,F*=a,B=m.g(1);for(;V>=g;)V/=2,F/=2,B>>>=1;return(V+B)/F};return L.int32=function(){return m.g(4)|0},L.quick=function(){return m.g(4)/4294967296},L.double=L,y(x(m.S),n),(w.pass||C||function(V,F,B,_){return _&&(_.S&&p(_,m),V.state=function(){return p(m,{})}),B?(r[o]=V,F):V})(L,M,"global"in w?w.global:this==r,w.state)}function v(T){var w,C=T.length,R=this,M=0,m=R.i=R.j=0,L=R.S=[];for(C||(T=[C++]);M<a;)L[M]=M++;for(M=0;M<a;M++)L[M]=L[m=f&m+T[M%C]+(w=L[M])],L[m]=w;(R.g=function(V){for(var F,B=0,_=R.i,P=R.j,z=R.S;V--;)F=z[_=f&_+1],B=B*a+z[f&(z[_]=z[P=f&P+F])+(z[P]=F)];return R.i=_,R.j=P,B})(a)}function p(T,w){return w.i=T.i,w.j=T.j,w.S=T.S.slice(),w}function d(T,w){var C=[],R=typeof T,M;if(w&&R=="object")for(M in T)try{C.push(d(T[M],w-1))}catch{}return C.length?C:R=="string"?T:T+"\0"}function y(T,w){for(var C=T+"",R,M=0;M<C.length;)w[f&M]=f&(R^=w[f&M]*19)+C.charCodeAt(M++);return x(w)}function S(){try{var T;return l&&(T=l.randomBytes)?T=T(a):(T=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(T)),x(T)}catch{var w=e.navigator,C=w&&w.plugins;return[+new Date,e,C,e.screen,x(n)]}}function x(T){return String.fromCharCode.apply(0,T)}if(y(r.random(),n),t.exports){t.exports=h;try{l=m2}catch{}}else r["seed"+o]=h})(typeof self<"u"?self:F2,[],Math)})(ks)),ks.exports}var ao,Yu;function _2(){if(Yu)return ao;Yu=1;var t=y2(),e=x2(),n=C2(),r=E2(),a=M2(),s=D2(),i=B2();return i.alea=t,i.xor128=e,i.xorwow=n,i.xorshift7=r,i.xor4096=a,i.tychei=s,ao=i,ao}var U2=_2();const N2=Si(U2),ah=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k2=[1,0,0,0,1,0,0,0,1],qc=1e-6,Qc=1e-12,{vtkErrorMacro:sh,vtkWarningMacro:pr}=E;let ih=0;const qu=20;function Pa(t){return()=>sh(`vtkMath::${t} - NOT IMPLEMENTED`)}function Ma(t,e,n,r){let a;for(let s=0;s<e;s++)a=t[n*e+s],t[n*e+s]=t[r*e+s],t[r*e+s]=a}function fa(t,e,n,r){let a;for(let s=0;s<e;s++)a=t[s*e+n],t[s*e+n]=t[s*e+r],t[s*e+r]=a}function Me(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3;const e=Array(t);for(let n=0;n<t;++n)e[n]=0;return e}const G2=()=>Math.PI;function b2(t,e){return e>1023?t*2**1023*2**(e-1023):e<-1074?t*2**-1074*2**(e+1074):t*2**e}function me(t){return t/180*Math.PI}function zr(t){return t*180/Math.PI}const{round:ua,floor:$2,ceil:W2,min:z2,max:H2}=Math;function A2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=1/0;for(let a=e,s=t.length;a<s;a+=n)t[a]<r&&(r=t[a]);return r}function j2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=-1/0;for(let a=e,s=t.length;a<s;a+=n)r<t[a]&&(r=t[a]);return r}function K2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=1/0,a=-1/0;for(let s=e,i=t.length;s<i;s+=n)t[s]<r&&(r=t[s]),a<t[s]&&(a=t[s]);return[r,a]}const P2=Pa("ceilLog2"),X2=Pa("factorial");function Vt(t){let e=1;for(;e<t;)e*=2;return e}function ga(t){return t===Vt(t)}function I2(t,e){let n=1;for(let r=1;r<=e;++r)n*=(t-r+1)/r;return Math.floor(n)}function Y2(t,e){if(t<e)return 0;const n=Me(e);for(let r=0;r<e;++r)n[r]=r;return n}function q2(t,e,n){let r=0;for(let a=e-1;a>=0;--a)if(n[a]<t-e+a){let s=n[a]+1;for(;a<e;)n[a++]=s++;r=1;break}return r}function Q2(t){N2(`${t}`,{global:!0}),ih=t}function Z2(){return ih}function J2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:1)-t;return t+n*Math.random()}const eC=Pa("gaussian");function Hr(t,e,n){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n}function ze(t,e,n){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n}function oh(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t}function ch(t,e){return t[0]*=e,t[1]*=e,t}function Ko(t,e,n,r){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r}function tC(t,e,n,r){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r}function ee(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function nC(t,e,n){n[0]=t[0]*e[0],n[1]=t[0]*e[1],n[2]=t[0]*e[2],n[3]=t[1]*e[0],n[4]=t[1]*e[1],n[5]=t[1]*e[2],n[6]=t[2]*e[0],n[7]=t[2]*e[1],n[8]=t[2]*e[2]}function gt(t,e,n){const r=t[1]*e[2]-t[2]*e[1],a=t[2]*e[0]-t[0]*e[2],s=t[0]*e[1]-t[1]*e[0];return n[0]=r,n[1]=a,n[2]=s,n}function Et(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(e){case 1:return Math.abs(t);case 2:return Math.sqrt(t[0]*t[0]+t[1]*t[1]);case 3:return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);default:{let n=0;for(let r=0;r<e;r++)n+=t[r]*t[r];return Math.sqrt(n)}}}function Rt(t){const e=Et(t);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e),e}function rC(t){const e=Et(t,3);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e,t[3]/=e),e}function aC(t,e,n,r){const a=t[0]*t[0],s=t[1]*t[1],i=t[2]*t[2],o=Math.sqrt(a+s+i);let c,u,g;a>s&&a>i?(c=0,u=1,g=2):s>i?(c=1,u=2,g=0):(c=2,u=0,g=1);const f=t[c]/o,l=t[u]/o,h=t[g]/o,v=Math.sqrt(f*f+h*h);if(r!==0){const p=Math.sin(r),d=Math.cos(r);e&&(e[c]=(h*d-f*l*p)/v,e[u]=p*v,e[g]=(-(f*d)-l*h*p)/v),n&&(n[c]=(-(h*p)-f*l*d)/v,n[u]=d*v,n[g]=(f*p-l*h*d)/v)}else e&&(e[c]=h/v,e[u]=0,e[g]=-f/v),n&&(n[c]=-f*l/v,n[u]=v,n[g]=-l*h/v)}function sC(t,e,n){const r=ee(e,e);if(r===0)return n[0]=0,n[1]=0,n[2]=0,!1;const a=ee(t,e)/r;for(let s=0;s<3;s++)n[s]=e[s];return oh(n,a),!0}function Po(t,e){return t[0]*e[0]+t[1]*e[1]}function iC(t,e,n){const r=Po(e,e);if(r===0)return n[0]=0,n[1]=0,!1;const a=Po(t,e)/r;for(let s=0;s<2;s++)n[s]=e[s];return ch(n,a),!0}function Tt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])+(t[2]-e[2])*(t[2]-e[2])}function oC(t,e){const n=[0,0,0];return gt(t,e,n),Math.atan2(Et(n),ee(t,e))}function cC(t,e,n){const r=Math.abs(t-n);return 1/Math.sqrt(2*Math.PI*e)*Math.exp(-(r**2)/(2*e))}function fC(t,e,n){const r=Math.abs(t-n);return Math.exp(-(r**2)/(2*e))}function uC(t,e,n){n[0]=t[0]*e[0],n[1]=t[0]*e[1],n[2]=t[1]*e[0],n[3]=t[1]*e[1]}function fh(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function uh(t){const e=fh(t);return e!==0&&(t[0]/=e,t[1]/=e),e}function Ve(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===2?e[0][0]*e[1][1]-e[1][0]*e[0][1]:e.length===4?e[0]*e[3]-e[1]*e[2]:Number.NaN}function gC(t,e){let n,r,a;const s=[0,0,0];for(let i=0;i<3;i++)a=Math.abs(t[i*3]),(r=Math.abs(t[i*3+1]))>a&&(a=r),(r=Math.abs(t[i*3+2]))>a&&(a=r),s[i]=1/a;a=s[0]*Math.abs(t[0]),n=0,(r=s[1]*Math.abs(t[3]))>=a&&(a=r,n=1),(r=s[2]*Math.abs(t[6]))>=a&&(n=2),n!==0&&(Ma(t,3,n,0),s[n]=s[0]),e[0]=n,t[3]/=t[0],t[6]/=t[0],t[4]-=t[3]*t[1],t[7]-=t[6]*t[1],a=s[1]*Math.abs(t[4]),n=1,(r=s[2]*Math.abs(t[7]))>=a&&(n=2,Ma(t,3,1,2),s[2]=s[1]),e[1]=n,t[7]/=t[4],t[5]-=t[3]*t[2],t[8]-=t[6]*t[2]+t[7]*t[5],e[2]=2}function lC(t,e,n){let r=n[e[0]];n[e[0]]=n[0],n[0]=r,r=n[e[1]],n[e[1]]=n[1],n[1]=r-t[3]*n[0],r=n[e[2]],n[e[2]]=n[2],n[2]=r-t[6]*n[0]-t[7]*n[1],n[2]/=t[8],n[1]=(n[1]-t[5]*n[2])/t[4],n[0]=(n[0]-t[1]*n[1]-t[2]*n[2])/t[0]}function hC(t,e,n){const r=t[0],a=t[1],s=t[2],i=t[3],o=t[4],c=t[5],u=t[6],g=t[7],f=t[8],l=+Ve(o,g,c,f),h=-Ve(i,u,c,f),v=+Ve(i,u,o,g),p=-Ve(a,g,s,f),d=+Ve(r,u,s,f),y=-Ve(r,u,a,g),S=+Ve(a,o,s,c),x=-Ve(r,i,s,c),T=+Ve(r,i,a,o),w=r*l+a*h+s*v,C=l*e[0]+p*e[1]+S*e[2],R=h*e[0]+d*e[1]+x*e[2],M=v*e[0]+y*e[1]+T*e[2];n[0]=C/w,n[1]=R/w,n[2]=M/w}function pC(t,e,n){const r=t[0]*e[0]+t[1]*e[1]+t[2]*e[2],a=t[3]*e[0]+t[4]*e[1]+t[5]*e[2],s=t[6]*e[0]+t[7]*e[1]+t[8]*e[2];n[0]=r,n[1]=a,n[2]=s}function Xo(t,e,n){const r=[...t],a=[...e];for(let s=0;s<3;s++)n[s]=r[0]*a[s]+r[1]*a[s+3]+r[2]*a[s+6],n[s+3]=r[3]*a[s]+r[4]*a[s+3]+r[5]*a[s+6],n[s+6]=r[6]*a[s]+r[7]*a[s+3]+r[8]*a[s+6]}function dC(t,e,n,r,a,s,i){r!==a&&sh("Number of columns of A must match number of rows of B.");const o=[...t],c=[...e];for(let u=0;u<n;u++)for(let g=0;g<s;g++){i[u*s+g]=0;for(let f=0;f<r;f++)i[u*s+g]+=o[u*r+f]*c[g+s*f]}}function Gr(t,e){let n;n=t[3],e[3]=t[1],e[1]=n,n=t[6],e[6]=t[2],e[2]=n,n=t[7],e[7]=t[5],e[5]=n,e[0]=t[0],e[4]=t[4],e[8]=t[8]}function vC(t,e){const n=t[0],r=t[1],a=t[2],s=t[3],i=t[4],o=t[5],c=t[6],u=t[7],g=t[8],f=+Ve(i,u,o,g),l=-Ve(s,c,o,g),h=+Ve(s,c,i,u),v=-Ve(r,u,a,g),p=+Ve(n,c,a,g),d=-Ve(n,c,r,u),y=+Ve(r,i,a,o),S=-Ve(n,s,a,o),x=+Ve(n,s,r,i),T=n*f+r*l+a*h;T===0&&pr("Matrix has 0 determinant"),e[0]=f/T,e[3]=l/T,e[6]=h/T,e[1]=v/T,e[4]=p/T,e[7]=d/T,e[2]=y/T,e[5]=S/T,e[8]=x/T}function Ei(t){return t[0]*t[4]*t[8]+t[3]*t[7]*t[2]+t[6]*t[1]*t[5]-t[0]*t[7]*t[5]-t[3]*t[1]*t[8]-t[6]*t[4]*t[2]}function gh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:qc;if(t.length!==e.length)return!1;function r(a,s){return Math.abs(a-e[s])<=n}return t.every(r)}const Ar=gh;function lh(t){for(let e=0;e<3;e++)t[e*3]=t[e*3+1]=t[e*3+2]=0,t[e*3+e]=1}function hh(t,e){for(let n=0;n<t;n++){for(let r=0;r<t;r++)e[n*t+r]=0;e[n*t+n]=1}return e}function yC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qc;return Ar(t,ah,e)}function TC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qc;return Ar(t,k2,e)}function ph(t,e){const n=t[0]*t[0],r=t[0]*t[1],a=t[0]*t[2],s=t[0]*t[3],i=t[1]*t[1],o=t[2]*t[2],c=t[3]*t[3],u=t[1]*t[2],g=t[1]*t[3],f=t[2]*t[3],l=i+o+c;let h=1/(n+l);const v=(n-l)*h;h*=2,e[0]=i*h+v,e[3]=(u+s)*h,e[6]=(g-a)*h,e[1]=(u-s)*h,e[4]=o*h+v,e[7]=(f+r)*h,e[2]=(g+a)*h,e[5]=(f-r)*h,e[8]=c*h+v}function Gs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!`${t}`.includes("e"))return+`${Math.round(`${t}e+${e}`)}e-${e}`;const n=`${t}`.split("e");let r="";return+n[1]+e>0&&(r="+"),+`${Math.round(`${+n[0]}e${r}${+n[1]+e}`)}e-${e}`}function Io(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e[0]=Gs(t[0],n),e[1]=Gs(t[1],n),e[2]=Gs(t[2],n),e}function Xa(t,e,n,r){let a,s,i,o,c,u,g,f,l,h,v,p,d,y,S,x;const T=Me(e),w=Me(e),C=(M,m,L)=>{y=M[m],d=M[L],M[m]=y-p*(d+y*h),M[L]=d+p*(y-d*h)};for(hh(e,r),c=0;c<e;c++)T[c]=n[c]=t[c+c*e],w[c]=0;for(a=0;a<qu;a++){for(v=0,c=0;c<e-1;c++)for(o=c+1;o<e;o++)v+=Math.abs(t[c*e+o]);if(v===0)break;for(a<3?g=.2*v/(e*e):g=0,c=0;c<e-1;c++)for(o=c+1;o<e;o++)if(y=100*Math.abs(t[c*e+o]),a>3&&Math.abs(n[c])+y===Math.abs(n[c])&&Math.abs(n[o])+y===Math.abs(n[o]))t[c*e+o]=0;else if(Math.abs(t[c*e+o])>g){for(d=n[o]-n[c],Math.abs(d)+y===Math.abs(d)?l=t[c*e+o]/d:(f=.5*d/t[c*e+o],l=1/(Math.abs(f)+Math.sqrt(1+f*f)),f<0&&(l=-l)),S=1/Math.sqrt(1+l*l),p=l*S,h=p/(1+S),d=l*t[c*e+o],w[c]-=d,w[o]+=d,n[c]-=d,n[o]+=d,t[c*e+o]=0,s=0;s<=c-1;s++)C(t,s*e+c,s*e+o);for(s=c+1;s<=o-1;s++)C(t,c*e+s,s*e+o);for(s=o+1;s<e;s++)C(t,c*e+s,o*e+s);for(s=0;s<e;s++)C(r,s*e+c,s*e+o)}for(c=0;c<e;c++)T[c]+=w[c],n[c]=T[c],w[c]=0}if(a>=qu)return pr("vtkMath::Jacobi: Error extracting eigenfunctions"),0;for(s=0;s<e-1;s++){for(i=s,x=n[i],a=s+1;a<e;a++)(n[a]>=x||Math.abs(n[a]-x)<Qc)&&(i=a,x=n[i]);i!==s&&(n[i]=n[s],n[s]=x,fa(r,e,s,i))}const R=(e>>1)+(e&1);for(u=0,a=0;a<e*e;a++)r[a]>=0&&u++;if(u<R)for(a=0;a<e;a++)r[a*e+s]*=-1;return 1}function dh(t,e){const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];n[0]=t[0]+t[4]+t[8],n[5]=t[0]-t[4]-t[8],n[10]=-t[0]+t[4]-t[8],n[15]=-t[0]-t[4]+t[8],n[1]=n[4]=t[7]-t[5],n[2]=n[8]=t[2]-t[6],n[3]=n[12]=t[3]-t[1],n[6]=n[9]=t[3]+t[1],n[7]=n[13]=t[2]+t[6],n[11]=n[14]=t[7]+t[5];const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=[0,0,0,0],s=[...n];Xa(s,4,a,r),e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12]}function xC(t,e,n){const r=t[0]*e[0],a=t[0]*e[1],s=t[0]*e[2],i=t[0]*e[3],o=t[1]*e[0],c=t[1]*e[1],u=t[1]*e[2],g=t[1]*e[3],f=t[2]*e[0],l=t[2]*e[1],h=t[2]*e[2],v=t[2]*e[3],p=t[3]*e[0],d=t[3]*e[1],y=t[3]*e[2],S=t[3]*e[3];n[0]=r-c-h-S,n[1]=a+o+v-y,n[2]=s-g+f+d,n[3]=i+u-l+p}function vh(t,e){for(let l=0;l<9;l++)e[l]=t[l];const n=Me(3),r=Me(3);let a;for(let l=0;l<3;l++){const h=Math.abs(e[l*3]),v=Math.abs(e[l*3+1]),p=Math.abs(e[l*3+2]);a=v>h?v:h,a=p>a?p:a,n[l]=1,a!==0&&(n[l]/=a)}const s=Math.abs(e[0])*n[0],i=Math.abs(e[3])*n[1],o=Math.abs(e[6])*n[2];r[0]=0,a=s,i>=a&&(a=i,r[0]=1),o>=a&&(r[0]=2),r[0]!==0&&(fa(e,3,r[0],0),n[r[0]]=n[0]);const c=Math.abs(e[4])*n[1],u=Math.abs(e[7])*n[2];r[1]=1,a=c,u>=a&&(r[1]=2,fa(e,3,1,2)),r[2]=2;let g=0;if(Ei(e)<0){g=1;for(let l=0;l<9;l++)e[l]=-e[l]}const f=Me(4);if(dh(e,f),ph(f,e),g)for(let l=0;l<9;l++)e[l]=-e[l];r[1]!==1&&fa(e,3,r[1],1),r[0]!==0&&fa(e,3,r[0],0)}function yh(t,e,n){let r,a,s,i,o,c;const u=[...t];if(Xa(u,3,e,n),e[0]===e[1]&&e[0]===e[2]){lh(n);return}for(Gr(n,n),r=0;r<3;r++)if(e[(r+1)%3]===e[(r+2)%3]){for(c=Math.abs(n[r*3]),i=0,a=1;a<3;a++)c<(o=Math.abs(n[r*3+a]))&&(c=o,i=a);i!==r&&(o=e[i],e[i]=e[r],e[r]=o,Ma(n,3,r,i)),n[i*3+i]<0&&(n[i*3]=-n[i*3],n[i*3+1]=-n[i*3+1],n[i*3+2]=-n[i*3+2]),a=(i+1)%3,s=(i+2)%3,n[a*3]=0,n[a*3+1]=0,n[a*3+2]=0,n[a*3+a]=1;const g=gt([n[i*3],n[i*3+1],n[i*3+2]],[n[a*3],n[a*3+1],n[a*3+2]],[]);Rt(g);const f=gt(g,[n[i*3],n[i*3+1],n[i*3+2]],[]);for(let l=0;l<3;l++)n[s*3+l]=g[l],n[a*3+l]=f[l];Gr(n,n);return}for(c=Math.abs(n[0]),i=0,r=1;r<3;r++)c<(o=Math.abs(n[r*3]))&&(c=o,i=r);if(i!==0){const g=e[i];e[i]=e[0],e[0]=g,Ma(n,3,i,0)}if(Math.abs(n[4])<Math.abs(n[7])){const g=e[2];e[2]=e[1],e[1]=g,Ma(n,3,1,2)}for(r=0;r<2;r++)n[r*3+r]<0&&(n[r*3]=-n[r*3],n[r*3+1]=-n[r*3+1],n[r*3+2]=-n[r*3+2]);Ei(n)<0&&(n[6]=-n[6],n[7]=-n[7],n[8]=-n[8]),Gr(n,n)}function SC(t,e,n,r){let a;const s=[...t],i=Ei(s);if(i<0)for(a=0;a<9;a++)s[a]=-s[a];vh(s,e),Gr(s,s),Xo(s,e,r),yh(r,n,r),Xo(e,r,e),Gr(r,r),i<0&&(n[0]=-n[0],n[1]=-n[1],n[2]=-n[2])}function Zc(t,e,n){let r,a,s,i,o=0,c,u,g;const f=Me(n);for(r=0;r<n;r++){for(i=0,a=0;a<n;a++)(g=Math.abs(t[r*n+a]))>i&&(i=g);if(i===0)return pr("Unable to factor linear system"),0;f[r]=1/i}for(a=0;a<n;a++){for(r=0;r<a;r++){for(c=t[r*n+a],s=0;s<r;s++)c-=t[r*n+s]*t[s*n+a];t[r*n+a]=c}for(i=0,r=a;r<n;r++){for(c=t[r*n+a],s=0;s<a;s++)c-=t[r*n+s]*t[s*n+a];t[r*n+a]=c,(u=f[r]*Math.abs(c))>=i&&(i=u,o=r)}if(a!==o){for(s=0;s<n;s++)u=t[o*n+s],t[o*n+s]=t[a*n+s],t[a*n+s]=u;f[o]=f[a]}if(e[a]=o,Math.abs(t[a*n+a])<=Qc)return pr("Unable to factor linear system"),0;if(a!==n-1)for(u=1/t[a*n+a],r=a+1;r<n;r++)t[r*n+a]*=u}return 1}function Jc(t,e,n,r){let a,s,i,o,c;for(i=-1,a=0;a<r;a++){if(o=e[a],c=n[o],n[o]=n[a],i>=0)for(s=i;s<=a-1;s++)c-=t[a*r+s]*n[s];else c!==0&&(i=a);n[a]=c}for(a=r-1;a>=0;a--){for(c=n[a],s=a+1;s<r;s++)c-=t[a*r+s]*n[s];n[a]=c/t[a*r+a]}}function Th(t,e,n){if(n===2){const a=Me(2),s=Ve(t[0],t[1],t[2],t[3]);return s===0?0:(a[0]=(t[3]*e[0]-t[1]*e[1])/s,a[1]=(-(t[2]*e[0])+t[0]*e[1])/s,e[0]=a[0],e[1]=a[1],1)}if(n===1)return t[0]===0?0:(e[0]/=t[0],1);const r=Me(n);return Zc(t,r,n)===0?0:(Jc(t,r,e,n),1)}function ef(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;const s=r||Me(n),i=a||Me(n);if(Zc(t,s,n)===0)return null;for(let o=0;o<n;o++){for(let c=0;c<n;c++)i[c]=0;i[o]=1,Jc(t,s,i,n);for(let c=0;c<n;c++)e[c*n+o]=i[c]}return e}function CC(t,e){let n=+Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let a=0;a<e;a++)for(let s=a;s<e;s++)Math.abs(t[a*e+s])>r&&(r=Math.abs(t[a*e+s]));for(let a=0;a<e;a++)Math.abs(t[a*e+a])<n&&(n=Math.abs(t[a*e+a]));return n===0?Number.MAX_VALUE:r/n}function wC(t,e,n){return Xa(t,3,e,n)}function Yo(t,e,n,r){if(t<n)return pr("Insufficient number of samples. Underdetermined."),0;let a,s,i;const o=Me(n*n),c=Me(n),u=Me(n*n);for(i=0;i<t;i++)for(a=0;a<n;a++)for(s=a;s<n;s++)o[a*n+s]+=e[i*n+a]*e[i*n+s];for(a=0;a<n;a++)for(s=0;s<a;s++)o[a*n+s]=o[s*n+a];for(Xa(o,n,c,u),a=0;a<n;a++)r[a]=u[a*n+n-1];return 1}function EC(t,e,n,r,a,s){let i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!0;if(t<n||t<a)return pr("Insufficient number of samples. Underdetermined."),0;const o=Me(a);let c=1,u,g=0,f,l,h,v=0;if(i){for(l=0;l<a;l++)o[l]=1;for(f=0;f<t;f++)for(l=0;l<a;l++)Math.abs(r[f*a+l])>Qc&&(c=0,o[l]=0);if(c&&a===1)return pr("Detected homogeneous system (Y=0), calling SolveHomogeneousLeastSquares()"),Yo(t,e,n,s);if(c)v=1;else for(l=0;l<a;l++)o[l]&&(v=1)}v&&(u=Me(n),g=Yo(t,e,n,u));const p=Me(n*n),d=Me(n*n),y=Me(n*a);for(h=0;h<t;h++)for(f=0;f<n;f++){for(l=f;l<n;l++)p[f*n+l]+=e[h*n+f]*e[h*n+l];for(l=0;l<a;l++)y[f*a+l]+=e[h*n+f]*r[h*a+l]}for(f=0;f<n;f++)for(l=0;l<f;l++)p[f*n+l]=p[l*n+f];const S=ef(p,d,n);if(S)for(f=0;f<n;f++)for(l=0;l<a;l++)for(s[f*a+l]=0,h=0;h<n;h++)s[f*a+l]+=d[f*n+h]*y[h*a+l];if(v){for(l=0;l<a;l++)if(o[l])for(f=0;f<n;f++)s[f*a+l]=u[f*a]}return v?g&&S:S}function RC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,.5,1];switch(t.length){case 3:return e[0]=parseInt(t[0],16)*17/255,e[1]=parseInt(t[1],16)*17/255,e[2]=parseInt(t[2],16)*17/255,e;case 4:return e[0]=parseInt(t[1],16)*17/255,e[1]=parseInt(t[2],16)*17/255,e[2]=parseInt(t[3],16)*17/255,e;case 6:return e[0]=parseInt(t.substr(0,2),16)/255,e[1]=parseInt(t.substr(2,2),16)/255,e[2]=parseInt(t.substr(4,2),16)/255,e;case 7:return e[0]=parseInt(t.substr(1,2),16)/255,e[1]=parseInt(t.substr(3,2),16)/255,e[2]=parseInt(t.substr(5,2),16)/255,e;case 9:return e[0]=parseInt(t.substr(1,2),16)/255,e[1]=parseInt(t.substr(3,2),16)/255,e[2]=parseInt(t.substr(5,2),16)/255,e[3]=parseInt(t.substr(7,2),16)/255,e;default:return e}}function MC(t,e){let n,r;const[a,s,i]=t,o=1/3,c=1/6,u=2/3;let g=a,f=a;s>g?g=s:s<f&&(f=s),i>g?g=i:i<f&&(f=i);const l=g;l>0?r=(g-f)/g:r=0,r>0?(a===g?n=c*(s-i)/(g-f):s===g?n=o+c*(i-a)/(g-f):n=u+c*(a-s)/(g-f),n<0&&(n+=1)):n=0,e[0]=n,e[1]=r,e[2]=l}function xh(t,e){const[n,r,a]=t,s=1/3,i=1/6,o=2/3,c=5/6;let u,g,f;n>i&&n<=s?(g=1,u=(s-n)/i,f=0):n>s&&n<=.5?(g=1,f=(n-s)/i,u=0):n>.5&&n<=o?(f=1,g=(o-n)/i,u=0):n>o&&n<=c?(f=1,u=(n-o)/i,g=0):n>c&&n<=1?(u=1,f=(1-n)/i,g=0):(u=1,g=n/i,f=0),u=r*u+(1-r),g=r*g+(1-r),f=r*f+(1-r),u*=a,g*=a,f*=a,e[0]=u,e[1]=g,e[2]=f}function Sh(t,e){const[n,r,a]=t;let s=(n+16)/116,i=r/500+s,o=s-a/200;s**3>.008856?s**=3:s=(s-16/116)/7.787,i**3>.008856?i**=3:i=(i-16/116)/7.787,o**3>.008856?o**=3:o=(o-16/116)/7.787;const c=.9505,u=1,g=1.089;e[0]=c*i,e[1]=u*s,e[2]=g*o}function Ch(t,e){const[n,r,a]=t,s=.9505,i=1,o=1.089;let c=n/s,u=r/i,g=a/o;c>.008856?c**=1/3:c=7.787*c+16/116,u>.008856?u**=1/3:u=7.787*u+16/116,g>.008856?g**=1/3:g=7.787*g+16/116,e[0]=116*u-16,e[1]=500*(c-u),e[2]=200*(u-g)}function wh(t,e){const[n,r,a]=t;let s=n*3.2406+r*-1.5372+a*-.4986,i=n*-.9689+r*1.8758+a*.0415,o=n*.0557+r*-.204+a*1.057;s>.0031308?s=1.055*s**(1/2.4)-.055:s*=12.92,i>.0031308?i=1.055*i**(1/2.4)-.055:i*=12.92,o>.0031308?o=1.055*o**(1/2.4)-.055:o*=12.92;let c=s;c<i&&(c=i),c<o&&(c=o),c>1&&(s/=c,i/=c,o/=c),s<0&&(s=0),i<0&&(i=0),o<0&&(o=0),e[0]=s,e[1]=i,e[2]=o}function Eh(t,e){let[n,r,a]=t;n>.04045?n=((n+.055)/1.055)**2.4:n/=12.92,r>.04045?r=((r+.055)/1.055)**2.4:r/=12.92,a>.04045?a=((a+.055)/1.055)**2.4:a/=12.92,e[0]=n*.4124+r*.3576+a*.1805,e[1]=n*.2126+r*.7152+a*.0722,e[2]=n*.0193+r*.1192+a*.9505}function OC(t,e){const n=[0,0,0];Eh(t,n),Ch(n,e)}function DC(t,e){const n=[0,0,0];Sh(t,n),wh(n,e)}function tf(t){return t[0]=1,t[1]=-1,t[2]=1,t[3]=-1,t[4]=1,t[5]=-1,t}function bs(t){return!(t[1]-t[0]<0)}function LC(t,e,n){return n[0]=Math.min(t[0],e[0]),n[1]=Math.max(t[0],e[0]),n[2]=Math.min(t[1],e[1]),n[3]=Math.max(t[1],e[1]),n[4]=Math.min(t[2],e[2]),n[5]=Math.max(t[2],e[2]),n}function $s(t,e,n){return t<e?e:t>n?n:t}function qo(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return r[0]=$s(t[0],e[0],n[0]),r[1]=$s(t[1],e[1],n[1]),r[2]=$s(t[2],e[2],n[2]),r}function VC(t,e){let n=0;return e[0]!==e[1]&&(t<e[0]?n=e[0]:t>e[1]?n=e[1]:n=t,n=(n-e[0])/(e[1]-e[0])),n}const mC=Pa("GetScalarTypeFittingRange"),FC=Pa("GetAdjustedScalarRange");function BC(t,e){if(!t||!e)return 0;for(let n=0;n<6;n+=2)if(t[n]<e[n]||t[n]>e[n+1]||t[n+1]<e[n]||t[n+1]>e[n+1])return 0;return 1}function _C(t,e,n){if(!t||!e)return 0;for(let r=0;r<6;r+=2)if(t[r]+n[r/2]<e[r]||t[r]-n[r/2]>e[r+1]||t[r+1]+n[r/2]<e[r]||t[r+1]-n[r/2]>e[r+1])return 0;return 1}function UC(t,e,n){if(!t||!e||!n)return 0;for(let r=0;r<3;r++)if(t[r]+n[r]<e[2*r]||t[r]-n[r]>e[2*r+1])return 0;return 1}function NC(t,e,n,r){const a=Me(3),s=Me(3),i=Me(3),o=Me(3),c=Me(3),u=Me(3);for(let T=0;T<3;++T)a[T]=t[T]-e[T],s[T]=e[T]-n[T],i[T]=n[T]-t[T],o[T]=-a[T],c[T]=-s[T],u[T]=-i[T];const g=Et(o),f=Et(c),l=Et(i),h=Me(3);gt(a,s,h);const v=Et(h),p=g*f*l/(2*v),d=2*v*v,y=f*f*ee(a,u)/d,S=l*l*ee(o,s)/d,x=g*g*ee(i,c)/d;for(let T=0;T<3;++T)r[T]=y*t[T]+S*e[T]+x*n[T];return p}const kC=1/0,GC=-1/0,bC=t=>!Number.isFinite(t),{isFinite:$C,isNaN:Qo}=Number,Rh=Qo;function Ri(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}function WC(t){let e=-1,n=-1;for(let r=0;r<t.length;r++){const a=Math.abs(t[r]);a>e&&(n=r,e=a)}return n}function zC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;const n=new Array(e),r=new Array(e);for(let s=0;s<e;++s)n[s]=s,r[s]=s;for(let s=e-1;s>0;s--){let i=-1/0,o=0,c=0;for(let u=0;u<=s;++u){const g=n[u];for(let f=0;f<=s;++f){const l=r[f],h=Math.abs(t[g+e*l]);h>i&&(i=h,o=u,c=f)}}[n[s],n[o]]=[n[o],n[s]],[r[s],r[c]]=[r[c],r[s]]}const a=new Array(e*e).fill(0);for(let s=0;s<e;++s){const i=n[s]+e*r[s];a[i]=t[i]<0?-1:1}return a}function Mh(t){const e=Math.floor(t*255);return e>15?e.toString(16):`0${e.toString(16)}`}function HC(t){return`${arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#"}${t.map(Mh).join("")}`}function ss(t){return Math.round(t*255)}function AC(t){return t.length===3?`rgb(${t.map(ss).join(", ")})`:`rgba(${ss(t[0]||0)}, ${ss(t[1]||0)}, ${ss(t[2]||0)}, ${t[3]||0})`}var Qu={Pi:G2,ldexp:b2,radiansFromDegrees:me,degreesFromRadians:zr,round:ua,floor:$2,ceil:W2,ceilLog2:P2,min:z2,max:H2,arrayMin:A2,arrayMax:j2,arrayRange:K2,isPowerOfTwo:ga,nearestPowerOfTwo:Vt,factorial:X2,binomial:I2,beginCombination:Y2,nextCombination:q2,randomSeed:Q2,getSeed:Z2,random:J2,gaussian:eC,add:Hr,subtract:ze,multiplyScalar:oh,multiplyScalar2D:ch,multiplyAccumulate:Ko,multiplyAccumulate2D:tC,dot:ee,outer:nC,cross:gt,norm:Et,normalize:Rt,perpendiculars:aC,projectVector:sC,projectVector2D:iC,distance2BetweenPoints:Tt,angleBetweenVectors:oC,gaussianAmplitude:cC,gaussianWeight:fC,dot2D:Po,outer2D:uC,norm2D:fh,normalize2D:uh,determinant2x2:Ve,LUFactor3x3:gC,LUSolve3x3:lC,linearSolve3x3:hC,multiply3x3_vect3:pC,multiply3x3_mat3:Xo,multiplyMatrix:dC,transpose3x3:Gr,invert3x3:vC,identity3x3:lh,identity:hh,isIdentity:yC,isIdentity3x3:TC,determinant3x3:Ei,quaternionToMatrix3x3:ph,areEquals:gh,areMatricesEqual:Ar,roundNumber:Gs,roundVector:Io,matrix3x3ToQuaternion:dh,multiplyQuaternion:xC,orthogonalize3x3:vh,diagonalize3x3:yh,singularValueDecomposition3x3:SC,solveLinearSystem:Th,invertMatrix:ef,luFactorLinearSystem:Zc,luSolveLinearSystem:Jc,estimateMatrixCondition:CC,jacobi:wC,jacobiN:Xa,solveHomogeneousLeastSquares:Yo,solveLeastSquares:EC,hex2float:RC,rgb2hsv:MC,hsv2rgb:xh,lab2xyz:Sh,xyz2lab:Ch,xyz2rgb:wh,rgb2xyz:Eh,rgb2lab:OC,lab2rgb:DC,uninitializeBounds:tf,areBoundsInitialized:bs,computeBoundsFromPoints:LC,clampValue:$s,clampVector:qo,clampAndNormalizeValue:VC,getScalarTypeFittingRange:mC,getAdjustedScalarRange:FC,extentIsWithinOtherExtent:BC,boundsIsWithinOtherBounds:_C,pointIsWithinBounds:UC,solve3PointCircle:NC,inf:kC,negInf:GC,isInf:bC,isNan:Qo,isNaN:Qo,isFinite:$C,createUninitializedBounds:Ri,getMajorAxisIndex:WC,getSparseOrthogonalMatrix:zC,floatToHex2:Mh,floatRGB2HexCode:HC,float2CssRGBA:AC};function jC(t,e){e.classHierarchy.push("vtkImplicitFunction"),t.functionValue=n=>{if(!e.transform)return t.evaluateFunction(n);const r=[];return e.transform.transformPoint(n,r),t.evaluateFunction(r)},t.evaluateFunction=n=>{E.vtkErrorMacro("not implemented")}}const KC={};function Oh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KC,n),E.obj(t,e),E.setGet(t,e,["transform"]),jC(t,e)}const PC=E.newInstance(Oh,"vtkImplicitFunction");var XC={newInstance:PC,extend:Oh};const Zo=1e-6,Dh="coincide",Lh="disjoint";function IC(t,e,n){return t[0]*(n[0]-e[0])+t[1]*(n[1]-e[1])+t[2]*(n[2]-e[2])}function Vh(t,e,n){const r=n[0]*(t[0]-e[0])+n[1]*(t[1]-e[1])+n[2]*(t[2]-e[2]);return Math.abs(r)}function mh(t,e,n,r){const a=[];ze(t,e,a);const s=ee(n,a);r[0]=t[0]-s*n[0],r[1]=t[1]-s*n[1],r[2]=t[2]-s*n[2]}function Fh(t,e,n){const r=ee(t,e);let a=ee(e,e);return a===0&&(a=1),n[0]=t[0]-r*e[0]/a,n[1]=t[1]-r*e[1]/a,n[2]=t[2]-r*e[2]/a,n}function Bh(t,e,n,r){const a=[];ze(t,e,a);const s=ee(n,a),i=ee(n,n);i!==0?(r[0]=t[0]-s*n[0]/i,r[1]=t[1]-s*n[1]/i,r[2]=t[2]-s*n[2]/i):(r[0]=t[0],r[1]=t[1],r[2]=t[2])}function _h(t,e,n,r){const a={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},s=[],i=[];ze(e,t,s),ze(n,t,i);const o=ee(r,i),c=ee(r,s);let u,g;return c<0?u=-c:u=c,o<0?g=-o*Zo:g=o*Zo,u<=g||(a.t=o/c,a.x[0]=t[0]+a.t*s[0],a.x[1]=t[1]+a.t*s[1],a.x[2]=t[2]+a.t*s[2],a.intersection=!0,a.betweenPoints=a.t>=0&&a.t<=1),a}function Uh(t,e,n,r){const a={intersection:!1,l0:[],l1:[],error:null},s=[];gt(e,r,s);const i=s.map(f=>Math.abs(f));if(i[0]+i[1]+i[2]<Zo){const f=[];return ze(t,n,f),ee(e,f)===0?a.error=Dh:a.error=Lh,a}let o;i[0]>i[1]&&i[0]>i[2]?o="x":i[1]>i[2]?o="y":o="z";const c=[],u=-ee(e,t),g=-ee(r,n);switch(o){case"x":c[0]=0,c[1]=(g*e[2]-u*r[2])/s[0],c[2]=(u*r[1]-g*e[1])/s[0];break;case"y":c[0]=(u*r[2]-g*e[2])/s[1],c[1]=0,c[2]=(g*e[0]-u*r[0])/s[1];break;case"z":c[0]=(g*e[1]-u*r[1])/s[2],c[1]=(u*r[0]-g*e[0])/s[2],c[2]=0;break}return a.l0=c,Hr(c,s,a.l1),a.intersection=!0,a}const YC={evaluate:IC,distanceToPlane:Vh,projectPoint:mh,projectVector:Fh,generalizedProjectPoint:Bh,intersectWithLine:_h,intersectWithPlane:Uh,DISJOINT:Lh,COINCIDE:Dh};function qC(t,e){e.classHierarchy.push("vtkPlane"),t.distanceToPlane=n=>Vh(n,e.origin,e.normal),t.projectPoint=(n,r)=>{mh(n,e.origin,e.normal,r)},t.projectVector=(n,r)=>Fh(n,e.normal,r),t.push=n=>{if(n!==0)for(let r=0;r<3;r++)e.origin[r]+=n*e.normal[r]},t.generalizedProjectPoint=(n,r)=>{Bh(n,e.origin,e.normal,r)},t.evaluateFunction=(n,r,a)=>Array.isArray(n)?e.normal[0]*(n[0]-e.origin[0])+e.normal[1]*(n[1]-e.origin[1])+e.normal[2]*(n[2]-e.origin[2]):e.normal[0]*(n-e.origin[0])+e.normal[1]*(r-e.origin[1])+e.normal[2]*(a-e.origin[2]),t.evaluateGradient=n=>[e.normal[0],e.normal[1],e.normal[2]],t.intersectWithLine=(n,r)=>_h(n,r,e.origin,e.normal),t.intersectWithPlane=(n,r)=>Uh(n,r,e.origin,e.normal)}const QC={normal:[0,0,1],origin:[0,0,0]};function Nh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,QC,n),XC.extend(t,e,n),E.setGetArray(t,e,["normal","origin"],3),qC(t,e)}const ZC=E.newInstance(Nh,"vtkPlane");var An={newInstance:ZC,extend:Nh,...YC};const Mi=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function kh(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function Tn(t){return t?.length>=6&&t[0]<=t[1]&&t[2]<=t[3]&&t[4]<=t[5]}function nf(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function rf(t){return nf(t,Mi)}function ri(t,e,n,r){const[a,s,i,o,c,u]=t;return t[0]=a<e?a:e,t[1]=s>e?s:e,t[2]=i<n?i:n,t[3]=o>n?o:n,t[4]=c<r?c:r,t[5]=u>r?u:r,t}function af(t,e){if(e.length===0)return t;if(Array.isArray(e[0]))for(let n=0;n<e.length;++n)ri(t,...e[n]);else for(let n=0;n<e.length;n+=3)ri(t,...e.slice(n,n+3));return t}function Gh(t,e,n,r,a,s,i){const[o,c,u,g,f,l]=t;return i===void 0?(t[0]=Math.min(e[0],o),t[1]=Math.max(e[1],c),t[2]=Math.min(e[2],u),t[3]=Math.max(e[3],g),t[4]=Math.min(e[4],f),t[5]=Math.max(e[5],l)):(t[0]=Math.min(e,o),t[1]=Math.max(n,c),t[2]=Math.min(r,u),t[3]=Math.max(a,g),t[4]=Math.min(s,f),t[5]=Math.max(i,l)),t}function bh(t,e,n,r){const[a,s,i,o,c,u]=t;return t[0]=e,t[1]=e>s?e:s,t[2]=n,t[3]=n>o?n:o,t[4]=r,t[5]=r>u?r:u,a!==e||i!==n||c!==r}function $h(t,e,n,r){const[a,s,i,o,c,u]=t;return t[0]=e<a?e:a,t[1]=e,t[2]=n<i?n:i,t[3]=n,t[4]=r<c?r:c,t[5]=r,s!==e||o!==n||u!==r}function sf(t,e){return e==null?JC(t):(t[0]-=e,t[1]+=e,t[2]-=e,t[3]+=e,t[4]-=e,t[5]+=e,t)}function JC(t){const e=[0,0,0];let n=-1,r=0,a=0;for(let s=0;s<3;++s)a=t[s*2+1]-t[s*2],a>r&&(r=a,n=s),e[s]=a>0?1:0;if(n<0)return sf(t,.5);for(let s=0;s<3;++s)if(!e[s]){const i=.005*r;t[s*2]-=i,t[s*2+1]+=i}return t}function of(t,e,n,r){return Tn(t)?(e>=0?(t[0]*=e,t[1]*=e):(t[0]=e*t[1],t[1]=e*t[0]),n>=0?(t[2]*=n,t[3]*=n):(t[2]=n*t[3],t[3]=n*t[2]),r>=0?(t[4]*=r,t[5]*=r):(t[4]=r*t[5],t[5]=r*t[4]),!0):!1}function cf(t){return[.5*(t[0]+t[1]),.5*(t[2]+t[3]),.5*(t[4]+t[5])]}function ew(t,e,n,r){if(!Tn(t))return!1;const a=cf(t);return t[0]-=a[0],t[1]-=a[0],t[2]-=a[1],t[3]-=a[1],t[4]-=a[2],t[5]-=a[2],of(t,e,n,r),t[0]+=a[0],t[1]+=a[0],t[2]+=a[1],t[3]+=a[1],t[4]+=a[2],t[5]+=a[2],!0}function Oa(t,e){return t[e*2+1]-t[e*2]}function Ia(t){return[Oa(t,0),Oa(t,1),Oa(t,2)]}function Wh(t){return t.slice(0,2)}function zh(t){return t.slice(2,4)}function Hh(t){return t.slice(4,6)}function Ah(t){const e=Ia(t);return e[0]>e[1]?e[0]>e[2]?e[0]:e[2]:e[1]>e[2]?e[1]:e[2]}function ff(t){if(Tn(t)){const e=Ia(t);return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]}return null}function jh(t){const e=ff(t);return e!==null?Math.sqrt(e):null}function Oi(t){return[t[0],t[2],t[4]]}function Di(t){return[t[1],t[3],t[5]]}function is(t,e){return t<=0&&e>=0||t>=0&&e<=0}function uf(t,e){return e[0]=[t[0],t[2],t[4]],e[1]=[t[0],t[2],t[5]],e[2]=[t[0],t[3],t[4]],e[3]=[t[0],t[3],t[5]],e[4]=[t[1],t[2],t[4]],e[5]=[t[1],t[2],t[5]],e[6]=[t[1],t[3],t[4]],e[7]=[t[1],t[3],t[5]],e}function Kh(t,e,n){return e[0]=t[0],e[1]=t[2],e[2]=t[4],n[0]=t[1],n[1]=t[3],n[2]=t[5],e}function Ph(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const r=uf(t,[]);for(let a=0;a<r.length;++a)Te(r[a],r[a],e);return rf(n),af(n,r)}function Xh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=.5*(t[1]-t[0]),e[1]=.5*(t[3]-t[2]),e[2]=.5*(t[5]-t[4]),e}function Ih(t,e,n,r){const a=[].concat(Mi),s=t.getData();for(let i=0;i<s.length;i+=3){const o=[s[i],s[i+1],s[i+2]],c=ee(o,e);a[0]=Math.min(c,a[0]),a[1]=Math.max(c,a[1]);const u=ee(o,n);a[2]=Math.min(u,a[2]),a[3]=Math.max(u,a[3]);const g=ee(o,r);a[4]=Math.min(g,a[4]),a[5]=Math.max(g,a[5])}return a}function Yh(t,e,n,r,a){let s=!0;const i=[];let o=0;const c=[],u=[0,0,0],g=0,f=1,l=2;for(let h=0;h<3;h++)e[h]<t[2*h]?(i[h]=f,u[h]=t[2*h],s=!1):e[h]>t[2*h+1]?(i[h]=g,u[h]=t[2*h+1],s=!1):i[h]=l;if(s)return r[0]=e[0],r[1]=e[1],r[2]=e[2],a[0]=0,1;for(let h=0;h<3;h++)i[h]!==l&&n[h]!==0?c[h]=(u[h]-e[h])/n[h]:c[h]=-1;for(let h=0;h<3;h++)c[o]<c[h]&&(o=h);if(c[o]>1||c[o]<0)return 0;a[0]=c[o];for(let h=0;h<3;h++)if(o!==h){if(r[h]=e[h]+c[o]*n[h],r[h]<t[2*h]||r[h]>t[2*h+1])return 0}else r[h]=u[h];return 1}function qh(t,e,n){const r=[];let a=0,s=1,i=1;for(let o=4;o<=5;++o){r[2]=t[o];for(let c=2;c<=3;++c){r[1]=t[c];for(let u=0;u<=1;++u)if(r[0]=t[u],a=An.evaluate(n,e,r),i&&(s=a>=0?1:-1,i=0),a===0||s>0&&a<0||s<0&&a>0)return 1}}return 0}function Qh(t,e){if(!(Tn(t)&&Tn(e)))return!1;const n=[0,0,0,0,0,0];let r;for(let a=0;a<3;a++)if(r=!1,e[a*2]>=t[a*2]&&e[a*2]<=t[a*2+1]?(r=!0,n[a*2]=e[a*2]):t[a*2]>=e[a*2]&&t[a*2]<=e[a*2+1]&&(r=!0,n[a*2]=t[a*2]),e[a*2+1]>=t[a*2]&&e[a*2+1]<=t[a*2+1]?(r=!0,n[a*2+1]=e[2*a+1]):t[a*2+1]>=e[a*2]&&t[a*2+1]<=e[a*2+1]&&(r=!0,n[a*2+1]=t[a*2+1]),!r)return!1;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],!0}function ai(t,e){if(!(Tn(t)&&Tn(e)))return!1;for(let n=0;n<3;n++)if(!(e[n*2]>=t[n*2]&&e[n*2]<=t[n*2+1])&&!(t[n*2]>=e[n*2]&&t[n*2]<=e[n*2+1])&&!(e[n*2+1]>=t[n*2]&&e[n*2+1]<=t[n*2+1])&&!(t[n*2+1]>=e[n*2]&&t[n*2+1]<=e[n*2+1]))return!1;return!0}function si(t,e,n,r){return!(e<t[0]||e>t[1]||n<t[2]||n>t[3]||r<t[4]||r>t[5])}function tw(t,e){return!(!ai(t,e)||!si(t,...Oi(e))||!si(t,...Di(e)))}function Zh(t,e,n){const r=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],a=[0,0,0,0,0,0,0,0];let s=0;for(let f=0;f<2;f++)for(let l=2;l<4;l++)for(let h=4;h<6;h++){const v=[t[f],t[l],t[h]];a[s++]=An.evaluate(n,e,v)}let i=2;for(;i--&&!(is(a[r[i][0]],a[r[i][4]])&&is(a[r[i][1]],a[r[i][5]])&&is(a[r[i][2]],a[r[i][6]])&&is(a[r[i][3]],a[r[i][7]])););if(i<0)return!1;const o=Math.sign(n[i]),c=Math.abs((t[i*2+1]-t[i*2])*n[i]);let u=o>0?1:0;for(let f=0;f<4;f++){if(c===0)continue;const l=Math.abs(a[r[i][f]])/c;o>0&&l<u&&(u=l),o<0&&l>u&&(u=l)}const g=(1-u)*t[i*2]+u*t[i*2+1];return o>0?t[i*2]=g:t[i*2+1]=g,!0}function Jh(t,e){for(let r=0;r<3;++r)e[r]=e[r]<1?1:e[r];let n=e[0]*e[1]*e[2];for(;n>t;){for(let r=0;r<3;++r)e[r]=e[r]>1?e[r]-1:1;n=e[0]*e[1]*e[2]}}function ep(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];e=e<=0?1:e;let a=0;const s=[0,0,0];let i=-1,o=0;const c=Ia(t),u=c[0]+c[1]+c[2],g=u*(.001/3);for(let p=0;p<3;++p)c[p]>o&&(i=p,o=c[p]),c[p]>g?(s[p]=1,a++):s[p]=0;const f=Oi(t),l=Di(t);if(a<1)return n[0]=1,n[1]=1,n[2]=1,r[0]=f[0]-.5,r[1]=l[0]+.5,r[2]=f[1]-.5,r[3]=l[1]+.5,r[4]=f[2]-.5,r[5]=l[2]+.5,1;let h=e;h/=s[0]?c[0]/u:1,h/=s[1]?c[1]/u:1,h/=s[2]?c[2]/u:1,h**=1/a;for(let p=0;p<3;++p)n[p]=s[p]?Math.floor(h*c[p]/u):1,n[p]=n[p]<1?1:n[p];Jh(e,n);const v=.5*c[i]/n[i];for(let p=0;p<3;++p)s[p]?(r[2*p]=f[p],r[2*p+1]=l[p]):(r[2*p]=f[p]-v,r[2*p+1]=l[p]+v);return n[0]*n[1]*n[2]}function tp(t,e){if(t[0]>=e[0]&&t[0]<=e[1]&&t[1]>=e[2]&&t[1]<=e[3]&&t[2]>=e[4]&&t[2]<=e[5])return 0;const n=[0,0,0];return t[0]<e[0]?n[0]=e[0]-t[0]:t[0]>e[1]&&(n[0]=t[0]-e[1]),t[1]<e[2]?n[1]=e[2]-t[1]:t[1]>e[3]&&(n[1]=t[1]-e[3]),t[2]<e[4]?n[2]=e[4]-t[2]:t[2]>e[5]&&(n[2]=t[2]-e[5]),ee(n,n)}class nw{constructor(e){this.bounds=e,this.bounds||(this.bounds=new Float64Array(Mi))}getBounds(){return this.bounds}equals(e){return kh(this.bounds,e)}isValid(){return Tn(this.bounds)}setBounds(e){return nf(this.bounds,e)}reset(){return rf(this.bounds)}addPoint(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return ri(this.bounds,...n)}addPoints(e){return af(this.bounds,e)}addBounds(e,n,r,a,s,i){return Gh(this.bounds,e,n,r,a,s,i)}setMinPoint(e,n,r){return bh(this.bounds,e,n,r)}setMaxPoint(e,n,r){return $h(this.bounds,e,n,r)}inflate(e){return sf(this.bounds,e)}scale(e,n,r){return of(this.bounds,e,n,r)}getCenter(){return cf(this.bounds)}getLength(e){return Oa(this.bounds,e)}getLengths(){return Ia(this.bounds)}getMaxLength(){return Ah(this.bounds)}getDiagonalLength(){return jh(this.bounds)}getDiagonalLength2(){return ff(this.bounds)}getMinPoint(){return Oi(this.bounds)}getMaxPoint(){return Di(this.bounds)}getXRange(){return Wh(this.bounds)}getYRange(){return zh(this.bounds)}getZRange(){return Hh(this.bounds)}getCorners(e){return uf(this.bounds,e)}computeCornerPoints(e,n){return Kh(this.bounds,e,n)}computeLocalBounds(e,n,r){return Ih(this.bounds,e,n,r)}transformBounds(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Ph(this.bounds,e,n)}computeScale3(e){return Xh(this.bounds,e)}cutWithPlane(e,n){return Zh(this.bounds,e,n)}intersectBox(e,n,r,a){return Yh(this.bounds,e,n,r,a)}intersectPlane(e,n){return qh(this.bounds,e,n)}intersect(e){return Qh(this.bounds,e)}intersects(e){return ai(this.bounds,e)}containsPoint(e,n,r){return si(this.bounds,e,n,r)}contains(e){return ai(this.bounds,e)}computeDivisions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return ep(this.bounds,e,n,r)}distance2ToBounds(e){return tp(e,this.bounds)}}function rw(t){const e=t&&t.bounds;return new nw(e)}const aw={equals:kh,isValid:Tn,setBounds:nf,reset:rf,addPoint:ri,addPoints:af,addBounds:Gh,setMinPoint:bh,setMaxPoint:$h,inflate:sf,scale:of,scaleAboutCenter:ew,getCenter:cf,getLength:Oa,getLengths:Ia,getMaxLength:Ah,getDiagonalLength:jh,getDiagonalLength2:ff,getMinPoint:Oi,getMaxPoint:Di,getXRange:Wh,getYRange:zh,getZRange:Hh,getCorners:uf,computeCornerPoints:Kh,computeLocalBounds:Ih,transformBounds:Ph,computeScale3:Xh,cutWithPlane:Zh,intersectBox:Yh,intersectPlane:qh,intersect:Qh,intersects:ai,containsPoint:si,contains:tw,computeDivisions:ep,clampDivisions:Jh,distance2ToBounds:tp,INIT_BOUNDS:Mi};var he={newInstance:rw,...aw};const sw={DISPLAY:0,WORLD:1};var np={CoordinateSystem:sw};const{CoordinateSystem:Jo}=np;function Zu(t){return()=>E.vtkErrorMacro(`vtkProp::${t} - NOT IMPLEMENTED`)}function iw(t,e){e.classHierarchy.push("vtkProp"),t.getMTime=()=>{let n=e.mtime;for(let r=0;r<e.textures.length;++r){const a=e.textures[r].getMTime();a>n&&(n=a)}return n},t.processSelectorPixelBuffers=(n,r)=>{},t.getNestedProps=()=>null,t.getActors=()=>[],t.getActors2D=()=>[],t.getVolumes=()=>[],t.pick=Zu("pick"),t.hasKey=Zu("hasKey"),t.getNestedVisibility=()=>e.visibility&&(!e._parentProp||e._parentProp.getNestedVisibility()),t.getNestedPickable=()=>e.pickable&&(!e._parentProp||e._parentProp.getNestedPickable()),t.getNestedDragable=()=>e.dragable&&(!e._parentProp||e._parentProp.getNestedDragable()),t.getRedrawMTime=()=>e.mtime,t.setEstimatedRenderTime=n=>{e.estimatedRenderTime=n,e.savedEstimatedRenderTime=n},t.restoreEstimatedRenderTime=()=>{e.estimatedRenderTime=e.savedEstimatedRenderTime},t.addEstimatedRenderTime=n=>{e.estimatedRenderTime+=n},t.setAllocatedRenderTime=n=>{e.allocatedRenderTime=n,e.savedEstimatedRenderTime=e.estimatedRenderTime,e.estimatedRenderTime=0},t.getSupportsSelection=()=>!1,t.getTextures=()=>e.textures,t.hasTexture=n=>e.textures.indexOf(n)!==-1,t.addTexture=n=>{n&&!t.hasTexture(n)&&(e.textures=e.textures.concat(n),t.modified())},t.removeTexture=n=>{const r=e.textures.filter(a=>a!==n);e.textures.length!==r.length&&(e.textures=r,t.modified())},t.removeAllTextures=()=>{e.textures=[],t.modified()},t.setCoordinateSystemToWorld=()=>t.setCoordinateSystem(Jo.WORLD),t.setCoordinateSystemToDisplay=()=>t.setCoordinateSystem(Jo.DISPLAY)}const ow={allocatedRenderTime:10,coordinateSystem:Jo.WORLD,dragable:!0,estimatedRenderTime:0,paths:null,pickable:!0,renderTimeMultiplier:1,savedEstimatedRenderTime:0,textures:[],useBounds:!0,visibility:!0};function rp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ow,n),E.obj(t,e),E.get(t,e,["estimatedRenderTime","allocatedRenderTime"]),E.setGet(t,e,["_parentProp","coordinateSystem","dragable","pickable","renderTimeMultiplier","useBounds","visibility"]),E.moveToProtected(t,e,["parentProp"]),iw(t,e)}const cw=E.newInstance(rp,"vtkProp");var Ya={newInstance:cw,extend:rp,...np};const fw=1e-6;function uw(t,e){e.classHierarchy.push("vtkProp3D"),t.addPosition=r=>{e.position=e.position.map((a,s)=>a+r[s]),t.modified()},t.getOrientationWXYZ=()=>{const r=hr();No(r,e.rotation);const a=new Float64Array(3),s=hx(a,r);return[zr(s),a[0],a[1],a[2]]},t.getOrientationQuaternion=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return No(r,e.rotation)},t.rotateX=r=>{r!==0&&(_c(e.rotation,e.rotation,me(r)),t.modified())},t.rotateY=r=>{r!==0&&(Uc(e.rotation,e.rotation,me(r)),t.modified())},t.rotateZ=r=>{r!==0&&(Nc(e.rotation,e.rotation,me(r)),t.modified())},t.rotateWXYZ=(r,a,s,i)=>{if(r===0||a===0&&s===0&&i===0)return;const o=me(r),c=hr();Gc(c,[a,s,i],o);const u=new Float64Array(16);Ra(u,c),Ne(e.rotation,e.rotation,u),t.modified()},t.rotateQuaternion=r=>{if(Math.abs(r[3])>=1-fw)return;const a=Ra(new Float64Array(16),r);Ne(e.rotation,e.rotation,a),t.modified()},t.setOrientation=(r,a,s)=>r===e.orientation[0]&&a===e.orientation[1]&&s===e.orientation[2]?!1:(e.orientation=[r,a,s],ue(e.rotation),t.rotateZ(s),t.rotateX(r),t.rotateY(a),t.modified(),!0),t.setOrientationFromQuaternion=r=>{const a=xi();return Ra(a,r),Ar(a,e.rotation)?!1:(e.rotation=a,t.modified(),!0)},t.setUserMatrix=r=>Ar(e.userMatrix,r)?!1:(Qe(e.userMatrix,r),t.modified(),!0),t.getMatrix=()=>(t.computeMatrix(),e.matrix),t.computeMatrix=()=>{if(t.getMTime()>e.matrixMTime.getMTime()){ue(e.matrix),e.userMatrix&&Ne(e.matrix,e.matrix,e.userMatrix),Ue(e.matrix,e.matrix,e.origin),Ue(e.matrix,e.matrix,e.position),Ne(e.matrix,e.matrix,e.rotation),lr(e.matrix,e.matrix,e.scale),Ue(e.matrix,e.matrix,[-e.origin[0],-e.origin[1],-e.origin[2]]),Oe(e.matrix,e.matrix),e.isIdentity=!0;for(let r=0;r<4;++r)for(let a=0;a<4;++a)(r===a?1:0)!==e.matrix[r+a*4]&&(e.isIdentity=!1);e.matrixMTime.modified()}},t.getBoundsByReference=()=>{if(e.mapper===null)return e.bounds;const r=e.mapper.getBounds();if(!r||r.length!==6)return r;if(r[0]>r[1])return e.mapperBounds=r,e.bounds=[...he.INIT_BOUNDS],e.boundsMTime.modified(),r;if(!e.mapperBounds||!r.every((a,s)=>r[s]===e.mapperBounds[s])||t.getMTime()>e.boundsMTime.getMTime()){E.vtkDebugMacro("Recomputing bounds..."),e.mapperBounds=r,t.computeMatrix();const a=new Float64Array(16);Oe(a,e.matrix),he.transformBounds(r,a,e.bounds),e.boundsMTime.modified()}return e.bounds},t.getBounds=()=>{const r=t.getBoundsByReference();try{return[...r]}catch{return r}},t.getCenter=()=>he.getCenter(e.bounds),t.getLength=()=>he.getLength(e.bounds),t.getXRange=()=>he.getXRange(e.bounds),t.getYRange=()=>he.getYRange(e.bounds),t.getZRange=()=>he.getZRange(e.bounds),t.getUserMatrix=()=>e.userMatrix;function n(){t.computeMatrix()}t.onModified(n),t.getProperty=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.properties[r]==null&&(e.properties[r]=t.makeProperty?.()),e.properties[r]},t.getProperties=()=>(e.properties.length===0&&(e.properties[0]=t.makeProperty?.()),e.properties),t.setProperty=(r,a)=>{const s=Number.isInteger(r),[i,o]=s?[r,a]:[0,r];return e.properties[i]===o?!1:(e.properties[i]=o,!0)},t.getMTime=()=>{let r=e.mtime;return e.properties.forEach(a=>{if(a!==null){const s=a.getMTime();r=s>r?s:r}}),r}}const gw={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[...he.INIT_BOUNDS],properties:[],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function ap(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gw,n),Ya.extend(t,e,n),e.matrixMTime={},E.obj(e.matrixMTime),E.get(t,e,["isIdentity"]),E.getArray(t,e,["orientation"]),E.setGetArray(t,e,["origin","position","scale"],3),E.setGet(t,e,["properties"]),e.matrix=ue(new Float64Array(16)),e.rotation=ue(new Float64Array(16)),e.userMatrix=ue(new Float64Array(16)),e.transform=null,uw(t,e)}const lw=E.newInstance(ap,"vtkProp3D");var hw={newInstance:lw,extend:ap};const sp={FLAT:0,GOURAUD:1,PHONG:2},mt={POINTS:0,WIREFRAME:1,SURFACE:2},pw=sp;var ip={Shading:sp,Representation:mt,Interpolation:pw};const{Representation:la,Interpolation:ha}=ip;function Ju(t){return()=>E.vtkErrorMacro(`vtkProperty::${t} - NOT IMPLEMENTED`)}function dw(t,e){e.classHierarchy.push("vtkProperty"),t.setColor=(n,r,a)=>{Array.isArray(n)?(e.color[0]!==n[0]||e.color[1]!==n[1]||e.color[2]!==n[2])&&(e.color[0]=n[0],e.color[1]=n[1],e.color[2]=n[2],t.modified()):(e.color[0]!==n||e.color[1]!==r||e.color[2]!==a)&&(e.color[0]=n,e.color[1]=r,e.color[2]=a,t.modified()),t.setDiffuseColor(e.color),t.setAmbientColor(e.color),t.setSpecularColor(e.color)},t.computeCompositeColor=Ju("ComputeCompositeColor"),t.getColor=()=>{let n=0;e.ambient+e.diffuse+e.specular>0&&(n=1/(e.ambient+e.diffuse+e.specular));for(let r=0;r<3;r++)e.color[r]=n*(e.ambient*e.ambientColor[r]+e.diffuse*e.diffuseColor[r]+e.specular*e.specularColor[r]);return[].concat(e.color)},t.setSpecularPower=n=>{const r=1/Math.max(1,n);(e.roughness!==r||e.specularPower!==n)&&(e.specularPower=n,e.roughness=r,t.modified())},t.addShaderVariable=Ju("AddShaderVariable"),t.setInterpolationToFlat=()=>t.setInterpolation(ha.FLAT),t.setInterpolationToGouraud=()=>t.setInterpolation(ha.GOURAUD),t.setInterpolationToPhong=()=>t.setInterpolation(ha.PHONG),t.getInterpolationAsString=()=>E.enumToString(ha,e.interpolation),t.setRepresentationToWireframe=()=>t.setRepresentation(la.WIREFRAME),t.setRepresentationToSurface=()=>t.setRepresentation(la.SURFACE),t.setRepresentationToPoints=()=>t.setRepresentation(la.POINTS),t.getRepresentationAsString=()=>E.enumToString(la,e.representation)}const vw={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,metallic:0,roughness:.6,normalStrength:1,emission:1,baseIOR:1.45,specular:0,specularPower:1,opacity:1,interpolation:ha.GOURAUD,representation:la.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null,ORMTexture:null,RMTexture:null};function yw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vw,n),E.obj(t,e),E.setGet(t,e,["lighting","interpolation","ambient","diffuse","metallic","roughness","normalStrength","emission","baseIOR","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation","diffuseTexture","metallicTexture","roughnessTexture","normalTexture","ambientOcclusionTexture","emissionTexture","ORMTexture","RMTexture"]),E.setGetArray(t,e,["ambientColor","specularColor","diffuseColor","edgeColor"],3),dw(t,e)}const Tw=E.newInstance(yw,"vtkProperty");var Yr={newInstance:Tw,...ip};function xw(t,e){e.classHierarchy.push("vtkActor");const n={...t};t.getActors=()=>[t],t.getIsOpaque=()=>{if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.properties[0]||t.getProperty();let r=e.properties[0].getOpacity()>=1;return r=r&&(!e.texture||!e.texture.isTranslucent()),r=r&&(!e.mapper||e.mapper.getIsOpaque()),r},t.hasTranslucentPolygonalGeometry=()=>e.mapper===null?!1:(e.properties[0]||t.getProperty(),!t.getIsOpaque()),t.makeProperty=Yr.newInstance,t.getMTime=()=>{let r=n.getMTime();if(e.backfaceProperty!==null){const a=e.backfaceProperty.getMTime();r=a>r?a:r}return r},t.getRedrawMTime=()=>{let r=e.mtime;if(e.mapper!==null){let a=e.mapper.getMTime();r=a>r?a:r,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),a=e.mapper.getInput().getMTime(),r=a>r?a:r)}return r},t.getSupportsSelection=()=>e.mapper?e.mapper.getSupportsSelection():!1,t.processSelectorPixelBuffers=(r,a)=>{e.mapper&&e.mapper.processSelectorPixelBuffers&&e.mapper.processSelectorPixelBuffers(r,a)}}const Sw={mapper:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1};function op(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Sw,n),hw.extend(t,e,n),e.boundsMTime={},E.obj(e.boundsMTime),E.setGet(t,e,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),xw(t,e)}const Cw=E.newInstance(op,"vtkActor");var dr={newInstance:Cw,extend:op};const ww={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Pe={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",UNSIGNED_CHAR_CLAMPED:"Uint8ClampedArray",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},Ew=Pe.FLOAT;var cp={DefaultDataType:Ew,DataTypeByteSize:ww,VtkDataTypes:Pe};const{vtkErrorMacro:Rw}=nn,{DefaultDataType:Mw}=cp,Ow=1e-6;function ec(t,e,n){const r=t.length;let a=Number.MAX_VALUE,s=-Number.MAX_VALUE,i,o;for(o=e;o<r;o+=n)if(!Number.isNaN(t[o])){a=t[o],s=a;break}for(;o<r;o+=n)i=t[o],i<a?a=i:i>s&&(s=i);return{min:a,max:s}}function Dw(){let t=Number.MAX_VALUE,e=-Number.MAX_VALUE,n=0,r=0;return{add(a){t>a&&(t=a),e<a&&(e=a),n++,r+=a},get(){return{min:t,max:e,count:n,sum:r,mean:r/n}},getRange(){return{min:t,max:e}}}}function fp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(e<0&&n>1){const a=t.length/n,s=new Float64Array(a);for(let i=0,o=0;i<a;++i){for(let c=o+n;o<c;++o)s[i]+=t[o]*t[o];s[i]**=.5}return ec(s,0,1)}return ec(t,e<0?0:e,n)}function eg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=t||[];for(;n.length<=e;)n.push(null);return n}function gf(t){return Object.prototype.toString.call(t).slice(8,-1)}function Lw(t){const e=t.getNumberOfComponents();let n=0;const r=new Array(e);for(let a=0;a<t.getNumberOfTuples();++a){t.getTuple(a,r);const s=Et(r,e);s>n&&(n=s)}return n}const Vw={computeRange:fp,createRangeHelper:Dw,fastComputeRange:ec,getDataType:gf,getMaxNorm:Lw};function mw(t,e){e.classHierarchy.push("vtkDataArray");function n(r){if(r<0)return!1;const a=t.getNumberOfComponents(),s=e.values.length/(a>0?a:1);if(r===s)return!0;if(r>s){const i=e.values;return e.values=Xr(e.dataType,(r+s)*a),e.values.set(i),!0}return e.size>r*a&&(e.size=r*a,t.dataChange()),!0}t.dataChange=()=>{e.ranges=null,t.modified()},t.allocate=r=>{n(t.getNumberOfTuples()+r)},t.resize=r=>{n(r);const a=r*t.getNumberOfComponents();return e.size!==a?(e.size=a,t.dataChange(),!0):!1},t.initialize=()=>(t.resize(0),t),t.getElementComponentSize=()=>e.values.BYTES_PER_ELEMENT,t.getComponent=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[r*e.numberOfComponents+a]},t.setComponent=(r,a,s)=>{s!==e.values[r*e.numberOfComponents+a]&&(e.values[r*e.numberOfComponents+a]=s,t.dataChange())},t.getValue=r=>{const a=r/e.numberOfComponents,s=r%e.numberOfComponents;return t.getComponent(a,s)},t.setValue=(r,a)=>{const s=r/e.numberOfComponents,i=r%e.numberOfComponents;t.setComponent(s,i,a)},t.getData=()=>e.size===e.values.length?e.values:e.values.subarray(0,e.size),t.getRange=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,a=r;a<0&&(a=e.numberOfComponents===1?0:e.numberOfComponents);let s=null;return e.ranges||(e.ranges=eg(e.ranges,e.numberOfComponents)),s=e.ranges[a],s?(e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple):(s=fp(t.getData(),r,e.numberOfComponents),e.ranges[a]=s,e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple)},t.setRange=(r,a)=>{e.ranges||(e.ranges=eg(e.ranges,e.numberOfComponents));const s={min:r.min,max:r.max};return e.ranges[a]=s,e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple},t.getRanges=function(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0))return structuredClone(e.ranges);const a=[];for(let s=0;s<e.numberOfComponents;s++){const[i,o]=t.getRange(s),c={min:i,max:o};a.push(c)}if(e.numberOfComponents>1){const[s,i]=t.getRange(-1),o={min:s,max:i};a.push(o)}return a},t.setTuple=(r,a)=>{const s=r*e.numberOfComponents;for(let i=0;i<e.numberOfComponents;i++)e.values[s+i]=a[i]},t.setTuples=(r,a)=>{let s=r*e.numberOfComponents;const i=Math.min(a.length,e.size-s);for(let o=0;o<i;)e.values[s++]=a[o++]},t.insertTuple=(r,a)=>(e.size<=r*e.numberOfComponents&&(e.size=(r+1)*e.numberOfComponents,n(r+1)),t.setTuple(r,a),r),t.insertTuples=(r,a)=>{const s=r+a.length/e.numberOfComponents;return e.size<s*e.numberOfComponents&&(e.size=s*e.numberOfComponents,n(s)),t.setTuples(r,a),s},t.insertNextTuple=r=>{const a=e.size/e.numberOfComponents;return t.insertTuple(a,r)},t.insertNextTuples=r=>{const a=e.size/e.numberOfComponents;return t.insertTuples(a,r)},t.findTuple=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ow;for(let s=0;s<e.size;s+=e.numberOfComponents)if(Math.abs(r[0]-e.values[s])<=a){let i=!0;for(let o=1;o<e.numberOfComponents;++o)if(Math.abs(r[o]-e.values[s+o])>a){i=!1;break}if(i)return s/e.numberOfComponents}return-1},t.getTuple=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const s=e.numberOfComponents||1,i=r*s;switch(s){case 4:a[3]=e.values[i+3];case 3:a[2]=e.values[i+2];case 2:a[1]=e.values[i+1];case 1:a[0]=e.values[i];break;default:for(let o=s-1;o>=0;--o)a[o]=e.values[i+o]}return a},t.getTuples=(r,a)=>{const s=(r??0)*e.numberOfComponents,i=(a??t.getNumberOfTuples())*e.numberOfComponents,o=t.getData().subarray(s,i);return o.length>0?o:null},t.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*e.numberOfComponents},t.getNumberOfComponents=()=>e.numberOfComponents,t.getNumberOfValues=()=>e.size,t.getNumberOfTuples=()=>e.size/e.numberOfComponents,t.getDataType=()=>e.dataType,t.newClone=()=>gp({empty:!0,name:e.name,dataType:e.dataType,numberOfComponents:e.numberOfComponents}),t.getName=()=>(e.name||(t.modified(),e.name=`vtkDataArray${t.getMTime()}`),e.name),t.setData=(r,a)=>{e.values=r,e.size=r.length,e.dataType=gf(r),a&&(e.numberOfComponents=a),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),t.dataChange()},t.getState=()=>{if(e.deleted)return null;const r={...e,vtkClass:t.getClassName()};r.values=Array.from(r.values),delete r.buffer,Object.keys(r).forEach(s=>{r[s]||delete r[s]});const a={};return Object.keys(r).sort().forEach(s=>{a[s]=r[s]}),a.mtime&&delete a.mtime,a},t.deepCopy=r=>{const a=t.getDataType(),s=e.values;t.shallowCopy(r),e.ranges=structuredClone(r.getRanges()),s?.length>=r.getNumberOfValues()&&a===r.getDataType()?(s.set(r.getData()),e.values=s,t.dataChange()):t.setData(r.getData().slice())},t.interpolateTuple=(r,a,s,i,o,c)=>{const u=e.numberOfComponents||1;(u!==a.getNumberOfComponents()||u!==i.getNumberOfComponents())&&Rw("numberOfComponents must match");const g=a.getTuple(s),f=i.getTuple(o),l=[];switch(l.length=u,u){case 4:l[3]=g[3]+(f[3]-g[3])*c;case 3:l[2]=g[2]+(f[2]-g[2])*c;case 2:l[1]=g[1]+(f[1]-g[1])*c;case 1:l[0]=g[0]+(f[0]-g[0])*c;break;default:for(let h=0;h<u;h++)l[h]=g[h]+(f[h]-g[h])*c}return t.insertTuple(r,l)}}const Fw={name:"",numberOfComponents:1,dataType:Mw,rangeTuple:[0,0]};function up(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,Fw,n),Array.isArray(n.values)&&n.dataType===void 0&&console.warn("vtkDataArray.newInstance: no dataType provided, converting to Float32Array"),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(e.values?Array.isArray(e.values)&&(e.values=bc(e.dataType,e.values)):e.values=Xr(e.dataType,e.size),e.values&&(e.size=e.size??e.values.length,e.dataType=gf(e.values)),qe(t,e),Aa(t,e,["name","numberOfComponents"]),e.size%e.numberOfComponents!==0)throw new RangeError("model.size is not a multiple of model.numberOfComponents");mw(t,e)}const gp=Ce(up,"vtkDataArray");var De={newInstance:gp,extend:up,...Vw,...cp};function Bw(t,e){e.classHierarchy.push("vtkAbstractMapper"),t.update=()=>{t.getInputData()},t.addClippingPlane=n=>n.isA("vtkPlane")?e.clippingPlanes.includes(n)?!1:(e.clippingPlanes.push(n),t.modified(),!0):!1,t.getNumberOfClippingPlanes=()=>e.clippingPlanes.length,t.removeAllClippingPlanes=()=>e.clippingPlanes.length===0?!1:(e.clippingPlanes.length=0,t.modified(),!0),t.removeClippingPlane=n=>{const r=e.clippingPlanes.indexOf(n);return r===-1?!1:(e.clippingPlanes.splice(r,1),t.modified(),!0)},t.getClippingPlanes=()=>e.clippingPlanes,t.setClippingPlanes=n=>{if(n)if(!Array.isArray(n))t.addClippingPlane(n);else{const r=n.length;for(let a=0;a<r&&a<6;a++)t.addClippingPlane(n[a])}},t.getClippingPlaneInDataCoords=(n,r,a)=>{const s=e.clippingPlanes,i=n;if(s){const o=s.length;if(r>=0&&r<o){const c=s[r],u=c.getNormal(),g=c.getOrigin(),f=u[0],l=u[1],h=u[2],v=-(f*g[0]+l*g[1]+h*g[2]);a[0]=f*i[0]+l*i[4]+h*i[8]+v*i[12],a[1]=f*i[1]+l*i[5]+h*i[9]+v*i[13],a[2]=f*i[2]+l*i[6]+h*i[10]+v*i[14],a[3]=f*i[3]+l*i[7]+h*i[11]+v*i[15];return}}E.vtkErrorMacro(`Clipping plane index ${r} is out of range.`)}}const _w={clippingPlanes:[]};function Uw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_w,n),E.obj(t,e),E.algo(t,e,1,0),e.clippingPlanes||(e.clippingPlanes=[]),Bw(t,e)}var Nw={extend:Uw};function kw(t,e){t.getBounds=()=>(E.vtkErrorMacro("vtkAbstractMapper3D.getBounds - NOT IMPLEMENTED"),Ri()),t.getCenter=()=>{const n=t.getBounds();return e.center=he.isValid(n)?he.getCenter(n):null,e.center?.slice()},t.getLength=()=>{const n=t.getBounds();return he.getDiagonalLength(n)}}const Gw=t=>({bounds:[...he.INIT_BOUNDS],center:[0,0,0],viewSpecificProperties:{},...t});function bw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Gw(n)),Nw.extend(t,e,n),E.setGet(t,e,["viewSpecificProperties"]),kw(t,e)}var $w={extend:bw};const{vtkErrorMacro:tg,vtkWarningMacro:Ww}=E;function zw(t,e){e.classHierarchy.push("vtkFieldData");const n=t.getState;e.arrays&&(e.arrays=e.arrays.map(r=>({data:Gt(r.data)}))),t.initialize=()=>{t.initializeFields(),t.copyAllOn(),t.clearFieldFlags()},t.initializeFields=()=>{e.arrays=[],e.copyFieldFlags={},t.modified()},t.copyStructure=r=>{t.initializeFields(),e.copyFieldFlags=r.getCopyFieldFlags().map(a=>a),e.arrays=r.getArrays().map(a=>({data:a}))},t.getNumberOfArrays=()=>e.arrays.length,t.getNumberOfActiveArrays=()=>e.arrays.length,t.addArray=r=>{const a=r.getName(),{array:s,index:i}=t.getArrayWithIndex(a);return s!=null?(e.arrays[i]={data:r},i):(e.arrays=[].concat(e.arrays,{data:r}),e.arrays.length-1)},t.removeAllArrays=()=>{e.arrays=[]},t.removeArray=r=>{const a=e.arrays.findIndex(s=>s.data.getName()===r);return t.removeArrayByIndex(a)},t.removeArrayByIndex=r=>r!==-1&&r<e.arrays.length?(e.arrays.splice(r,1),!0):!1,t.getArrays=()=>e.arrays.map(r=>r.data),t.getArray=r=>typeof r=="number"?t.getArrayByIndex(r):t.getArrayByName(r),t.getArrayByName=r=>e.arrays.reduce((a,s,i)=>s.data.getName()===r?s.data:a,null),t.getArrayWithIndex=r=>{const a=e.arrays.findIndex(s=>s.data.getName()===r);return{array:a!==-1?e.arrays[a].data:null,index:a}},t.getArrayByIndex=r=>r>=0&&r<e.arrays.length?e.arrays[r].data:null,t.hasArray=r=>t.getArrayWithIndex(r).index>=0,t.getArrayName=r=>{const a=e.arrays[r];return a?a.data.getName():""},t.getCopyFieldFlags=()=>e.copyFieldFlags,t.getFlag=r=>e.copyFieldFlags[r],t.passData=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;r.getArrays().forEach(i=>{const o=t.getFlag(i.getName());if(o!==!1&&!(e.doCopyAllOff&&o!==!0)&&i){let c=t.getArrayByName(i.getName());if(c)if(i.getNumberOfComponents()===c.getNumberOfComponents())if(a>-1&&a<i.getNumberOfTuples()){const u=s>-1?s:a;c.insertTuple(u,i.getTuple(a))}else c.insertTuples(0,i.getTuples());else tg("Unhandled case in passData");else if(a<0||a>i.getNumberOfTuples())t.addArray(i),r.getAttributes(i).forEach(u=>{t.setAttribute(i,u)});else{const u=i.getNumberOfComponents();let g=i.getNumberOfValues();const f=s>-1?s:a;g<=f*u&&(g=(f+1)*u),c=De.newInstance({name:i.getName(),dataType:i.getDataType(),numberOfComponents:u,values:E.newTypedArray(i.getDataType(),g),size:0}),c.insertTuple(f,i.getTuple(a)),t.addArray(c),r.getAttributes(i).forEach(l=>{t.setAttribute(c,l)})}}})},t.interpolateData=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;r.getArrays().forEach(c=>{const u=t.getFlag(c.getName());if(u!==!1&&!(e.doCopyAllOff&&u!==!0)&&c){let g=t.getArrayByName(c.getName());if(g)if(c.getNumberOfComponents()===g.getNumberOfComponents())if(a>-1&&a<c.getNumberOfTuples()){const f=i>-1?i:a;g.interpolateTuple(f,c,a,c,s,o),Ww("Unexpected case in interpolateData")}else g.insertTuples(c.getTuples());else tg("Unhandled case in interpolateData");else if(a<0||s<0||a>c.getNumberOfTuples())t.addArray(c),r.getAttributes(c).forEach(f=>{t.setAttribute(c,f)});else{const f=c.getNumberOfComponents();let l=c.getNumberOfValues();const h=i>-1?i:a;l<=h*f&&(l=(h+1)*f),g=De.newInstance({name:c.getName(),dataType:c.getDataType(),numberOfComponents:f,values:E.newTypedArray(c.getDataType(),l),size:0}),g.interpolateTuple(h,c,a,c,s,o),t.addArray(g),r.getAttributes(c).forEach(v=>{t.setAttribute(g,v)})}}})},t.copyFieldOn=r=>{e.copyFieldFlags[r]=!0},t.copyFieldOff=r=>{e.copyFieldFlags[r]=!1},t.copyAllOn=()=>{(!e.doCopyAllOn||e.doCopyAllOff)&&(e.doCopyAllOn=!0,e.doCopyAllOff=!1,t.modified())},t.copyAllOff=()=>{(e.doCopyAllOn||!e.doCopyAllOff)&&(e.doCopyAllOn=!1,e.doCopyAllOff=!0,t.modified())},t.clearFieldFlags=()=>{e.copyFieldFlags={}},t.deepCopy=r=>{e.arrays=r.getArrays().map(a=>{const s=a.newClone();return s.deepCopy(a),{data:s}})},t.copyFlags=r=>r.getCopyFieldFlags().map(a=>a),t.reset=()=>e.arrays.forEach(r=>r.data.reset()),t.getMTime=()=>e.arrays.reduce((r,a)=>a.data.getMTime()>r?a.data.getMTime():r,e.mtime),t.getNumberOfComponents=()=>e.arrays.reduce((r,a)=>r+a.data.getNumberOfComponents(),0),t.getNumberOfTuples=()=>e.arrays.length>0?e.arrays[0].getNumberOfTuples():0,t.getState=()=>{const r=n();return r&&(r.arrays=e.arrays.map(a=>({data:a.data.getState()}))),r}}const Hw={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function lp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Hw,n),E.obj(t,e),zw(t,e)}const Aw=E.newInstance(lp,"vtkFieldData");var jw={newInstance:Aw,extend:lp};const Kw={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},Pw={MAX:0,EXACT:1,NOLIMIT:2},Xw={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},Iw={DUPLICATEPOINT:1,HIDDENPOINT:2},Yw={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},qw="vtkGhostType",Qw={DEFAULT:0,SINGLE:1,DOUBLE:2};var hp={AttributeCopyOperations:Yw,AttributeLimitTypes:Pw,AttributeTypes:Kw,CellGhostTypes:Xw,DesiredOutputPrecision:Qw,PointGhostTypes:Iw,ghostArrayName:qw};const{AttributeTypes:wn,AttributeCopyOperations:In}=hp,{vtkWarningMacro:os}=E;function Zw(t,e){const n=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function r(i){let o=n.find(c=>wn[c.toUpperCase()]===i||typeof i!="number"&&c.toLowerCase()===i.toLowerCase());return typeof o>"u"&&(o=null),o}e.classHierarchy.push("vtkDataSetAttributes");const a={...t};t.checkNumberOfComponents=i=>!0,t.setAttribute=(i,o)=>{const c=r(o);if(i&&c.toUpperCase()==="PEDIGREEIDS"&&!i.isA("vtkDataArray"))return os(`Cannot set attribute ${c}. The attribute must be a vtkDataArray.`),-1;if(i&&!t.checkNumberOfComponents(i,c))return os(`Cannot set attribute ${c}. Incorrect number of components.`),-1;let u=e[`active${c}`];if(u>=0&&u<e.arrays.length){if(e.arrays[u]===i)return u;t.removeArrayByIndex(u)}return i?(u=t.addArray(i),e[`active${c}`]=u):e[`active${c}`]=-1,t.modified(),e[`active${c}`]},t.getAttributes=i=>n.filter(o=>t[`get${o}`]()===i),t.setActiveAttributeByName=(i,o)=>t.setActiveAttributeByIndex(t.getArrayWithIndex(i).index,o),t.setActiveAttributeByIndex=(i,o)=>{const c=r(o);if(i>=0&&i<e.arrays.length){if(c.toUpperCase()!=="PEDIGREEIDS"){const u=t.getArrayByIndex(i);if(!u.isA("vtkDataArray"))return os(`Cannot set attribute ${c}. Only vtkDataArray subclasses can be set as active attributes.`),-1;if(!t.checkNumberOfComponents(u,c))return os(`Cannot set attribute ${c}. Incorrect number of components.`),-1}return e[`active${c}`]=i,t.modified(),i}return i===-1&&(e[`active${c}`]=i,t.modified()),-1},t.getActiveAttribute=i=>{const o=r(i);return t[`get${o}`]()},t.removeAllArrays=()=>{n.forEach(i=>{e[`active${i}`]=-1}),a.removeAllArrays()},t.removeArrayByIndex=i=>(i!==-1&&n.forEach(o=>{i===e[`active${o}`]?e[`active${o}`]=-1:i<e[`active${o}`]&&(e[`active${o}`]-=1)}),a.removeArrayByIndex(i)),n.forEach(i=>{const o=`active${i}`;t[`get${i}`]=()=>t.getArrayByIndex(e[o]),t[`set${i}`]=c=>t.setAttribute(c,i),t[`setActive${i}`]=c=>t.setActiveAttributeByIndex(t.getArrayWithIndex(c).index,i),t[`copy${i}Off`]=()=>{const c=i.toUpperCase();e.copyAttributeFlags[In.PASSDATA][wn[c]]=!1},t[`copy${i}On`]=()=>{const c=i.toUpperCase();e.copyAttributeFlags[In.PASSDATA][wn[c]]=!0}}),t.initializeAttributeCopyFlags=()=>{e.copyAttributeFlags=[],Object.keys(In).filter(i=>i!=="ALLCOPY").forEach(i=>{e.copyAttributeFlags[In[i]]=Object.keys(wn).filter(o=>o!=="NUM_ATTRIBUTES").reduce((o,c)=>(o[wn[c]]=!0,o),[])}),e.copyAttributeFlags[In.COPYTUPLE][wn.GLOBALIDS]=!1,e.copyAttributeFlags[In.INTERPOLATE][wn.GLOBALIDS]=!1,e.copyAttributeFlags[In.COPYTUPLE][wn.PEDIGREEIDS]=!1},t.initialize=E.chain(t.initialize,t.initializeAttributeCopyFlags),e.dataArrays&&Object.keys(e.dataArrays).length&&Object.keys(e.dataArrays).forEach(i=>{!e.dataArrays[i].ref&&e.dataArrays[i].type==="vtkDataArray"&&t.addArray(De.newInstance(e.dataArrays[i]))});const s=t.shallowCopy;t.shallowCopy=(i,o)=>{s(i,o),e.arrays=i.getArrays().map(c=>{const u=c.newClone();return u.shallowCopy(c,o),{data:u}})},t.initializeAttributeCopyFlags()}const Jw={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function pp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Jw,n),jw.extend(t,e,n),E.setGet(t,e,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),e.arrays||(e.arrays={}),Zw(t,e)}const eE=E.newInstance(pp,"vtkDataSetAttributes");var ng={newInstance:eE,extend:pp,...hp};const tE={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},nE={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7};var rE={FieldDataTypes:tE,FieldAssociations:nE};const pa=["pointData","cellData","fieldData"];function aE(t,e){e.classHierarchy.push("vtkDataSet"),pa.forEach(a=>{e[a]?e[a]=Gt(e[a]):e[a]=ng.newInstance()}),t.computeBounds=()=>{if(e.modifiedTime&&e.computeTime&&e.modifiedTime>e.computeTime||!e.computeTime){const a=t.getPoints();a?.getNumberOfPoints()?he.setBounds(e.bounds,a.getBoundsByReference()):e.bounds=Qu.createUninitializedBounds(),e.computeTime=E.getCurrentGlobalMTime()}},t.getLength2=()=>{const a=t.getBoundsByReference();return!a||a.length!==6?0:he.getDiagonalLength2(a)},t.getLength=()=>Math.sqrt(t.getLength2()),t.getCenter=()=>{const a=t.getBoundsByReference();return!a||a.length!==6?[0,0,0]:he.getCenter(a)},t.getCellBounds=a=>{const s=t.getCell(a);return s?s.getBounds():Qu.createUninitializedBounds()},t.getBounds=E.chain(()=>t.computeBounds,t.getBounds),t.getBoundsByReference=E.chain(()=>t.computeBounds,t.getBoundsByReference);const n=t.shallowCopy;t.shallowCopy=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(a,s),pa.forEach(i=>{e[i]=ng.newInstance(),e[i].shallowCopy(a.getReferenceByName(i))})};const r=t.getMTime;t.getMTime=()=>pa.reduce((a,s)=>Math.max(a,e[s]?.getMTime()??a),r()),t.initialize=()=>(pa.forEach(a=>e[a]?.initialize()),t)}const sE={};function dp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sE,n),E.obj(t,e),E.setGet(t,e,pa),E.getArray(t,e,["bounds"],6),aE(t,e)}const iE=E.newInstance(dp,"vtkDataSet");var Sr={newInstance:iE,extend:dp,...rE};const Lt={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9};var vp={StructuredType:Lt};const{StructuredType:sn}=vp;function oE(t){let e=0;for(let n=0;n<3;++n)t[n*2]<t[n*2+1]&&e++;return t[0]>t[1]||t[2]>t[3]||t[4]>t[5]?sn.EMPTY:e===3?sn.XYZ_GRID:e===2?t[0]===t[1]?sn.YZ_PLANE:t[2]===t[3]?sn.XZ_PLANE:sn.XY_PLANE:e===1?t[0]<t[1]?sn.X_LINE:t[2]<t[3]?sn.Y_LINE:sn.Z_LINE:sn.SINGLE_POINT}var cE={getDataDescriptionFromExtent:oE,...vp};const{vtkErrorMacro:Yn}=E;function fE(t,e){e.classHierarchy.push("vtkImageData"),t.setExtent=function(){if(e.deleted)return Yn("instance deleted - cannot call any method"),!1;for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const i=a.length===1?a[0]:a;if(i.length!==6)return!1;const o=e.extent.some((c,u)=>c!==i[u]);return o&&(e.extent=i.slice(),e.dataDescription=cE.getDataDescriptionFromExtent(e.extent),t.modified()),o},t.setDimensions=function(){let r,a,s;if(e.deleted){Yn("instance deleted - cannot call any method");return}if(arguments.length===1){const i=arguments.length<=0?void 0:arguments[0];r=i[0],a=i[1],s=i[2]}else if(arguments.length===3)r=arguments.length<=0?void 0:arguments[0],a=arguments.length<=1?void 0:arguments[1],s=arguments.length<=2?void 0:arguments[2];else{Yn("Bad dimension specification");return}t.setExtent(0,r-1,0,a-1,0,s-1)},t.getDimensions=()=>[e.extent[1]-e.extent[0]+1,e.extent[3]-e.extent[2]+1,e.extent[5]-e.extent[4]+1],t.getNumberOfCells=()=>{const r=t.getDimensions();let a=1;for(let s=0;s<3;s++){if(r[s]===0)return 0;r[s]>1&&(a*=r[s]-1)}return a},t.getNumberOfPoints=()=>{const r=t.getDimensions();return r[0]*r[1]*r[2]},t.getPoint=r=>{const a=t.getDimensions();if(a[0]===0||a[1]===0||a[2]===0)return Yn("Requesting a point from an empty image."),null;const s=new Float64Array(3);switch(e.dataDescription){case Lt.EMPTY:return null;case Lt.SINGLE_POINT:break;case Lt.X_LINE:s[0]=r;break;case Lt.Y_LINE:s[1]=r;break;case Lt.Z_LINE:s[2]=r;break;case Lt.XY_PLANE:s[0]=r%a[0],s[1]=r/a[0];break;case Lt.YZ_PLANE:s[1]=r%a[1],s[2]=r/a[1];break;case Lt.XZ_PLANE:s[0]=r%a[0],s[2]=r/a[0];break;case Lt.XYZ_GRID:s[0]=r%a[0],s[1]=r/a[0]%a[1],s[2]=r/(a[0]*a[1]);break;default:Yn("Invalid dataDescription");break}const i=[0,0,0];return t.indexToWorld(s,i),i},t.getBounds=()=>t.extentToBounds(t.getSpatialExtent()),t.extentToBounds=r=>he.transformBounds(r,e.indexToWorld),t.getSpatialExtent=()=>he.inflate([...e.extent],.5),t.computeTransforms=()=>{n0(e.indexToWorld,e.origin),e.indexToWorld[0]=e.direction[0],e.indexToWorld[1]=e.direction[1],e.indexToWorld[2]=e.direction[2],e.indexToWorld[4]=e.direction[3],e.indexToWorld[5]=e.direction[4],e.indexToWorld[6]=e.direction[5],e.indexToWorld[8]=e.direction[6],e.indexToWorld[9]=e.direction[7],e.indexToWorld[10]=e.direction[8],lr(e.indexToWorld,e.indexToWorld,e.spacing),ut(e.worldToIndex,e.indexToWorld)},t.indexToWorld=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Te(a,r,e.indexToWorld),a},t.indexToWorldVec3=t.indexToWorld,t.worldToIndex=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Te(a,r,e.worldToIndex),a},t.worldToIndexVec3=t.worldToIndex,t.indexToWorldBounds=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return he.transformBounds(r,e.indexToWorld,a)},t.worldToIndexBounds=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return he.transformBounds(r,e.worldToIndex,a)},e._onOriginChanged=t.computeTransforms,e._onDirectionChanged=t.computeTransforms,e._onSpacingChanged=t.computeTransforms,t.computeTransforms(),t.getCenter=()=>he.getCenter(t.getBounds()),t.computeHistogram=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const s=[0,0,0,0,0,0];t.worldToIndexBounds(r,s);const i=[0,0,0],o=[0,0,0];he.computeCornerPoints(s,i,o),Io(i,i),Io(o,o);const c=t.getDimensions();qo(i,[0,0,0],[c[0]-1,c[1]-1,c[2]-1],i),qo(o,[0,0,0],[c[0]-1,c[1]-1,c[2]-1],o);const u=c[0],g=c[0]*c[1],f=t.getPointData().getScalars().getData();let l=-1/0,h=1/0,v=0,p=0,d=0;for(let T=i[2];T<=o[2];T++)for(let w=i[1];w<=o[1];w++){let C=i[0]+w*u+T*g;for(let R=i[0];R<=o[0];R++){if(!a||a([R,w,T],s)){const M=f[C];M>l&&(l=M),M<h&&(h=M),v+=M*M,p+=M,d+=1}++C}}const y=d>0?p/d:0,S=d?Math.abs(v/d-y*y):0,x=Math.sqrt(S);return{minimum:h,maximum:l,average:y,variance:S,sigma:x,count:d}},t.computeIncrements=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const s=[];let i=a;for(let o=0;o<3;++o)s[o]=i,i*=r[o*2+1]-r[o*2]+1;return s},t.computeOffsetIndex=r=>{let[a,s,i]=r;const o=t.getExtent(),c=t.getPointData().getScalars().getNumberOfComponents(),u=t.computeIncrements(o,c);return Math.floor((Math.round(a)-o[0])*u[0]+(Math.round(s)-o[2])*u[1]+(Math.round(i)-o[4])*u[2])},t.getOffsetIndexFromWorld=r=>{const a=t.getExtent(),s=t.worldToIndex(r);for(let i=0;i<3;++i)if(s[i]<a[i*2]||s[i]>a[i*2+1])return Yn(`GetScalarPointer: Pixel ${s} is not in memory. Current extent = ${a}`),NaN;return t.computeOffsetIndex(s)},t.getScalarValueFromWorld=function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=t.getPointData().getScalars().getNumberOfComponents();if(a<0||a>=s)return Yn(`GetScalarPointer: Scalar Component ${a} is not within bounds. Current Scalar numberOfComponents: ${s}`),NaN;const i=t.getOffsetIndexFromWorld(r);return Number.isNaN(i)?i:t.getPointData().getScalars().getComponent(i,a)};const n=t.initialize;t.initialize=()=>(t.set({direction:jn(e.direction),spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:Lt.EMPTY}),n())}const uE={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:Lt.EMPTY};function yp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uE,n),Sr.extend(t,e,n),e.direction?Array.isArray(e.direction)&&(e.direction=new Float64Array(e.direction.slice(0,9))):e.direction=jn(new Float64Array(9)),e.indexToWorld=new Float64Array(16),e.worldToIndex=new Float64Array(16),E.get(t,e,["indexToWorld","worldToIndex"]),E.setGetArray(t,e,["origin","spacing"],3),E.setGetArray(t,e,["direction"],9),E.getArray(t,e,["extent"],6),fE(t,e)}const gE=E.newInstance(yp,"vtkImageData");var lE={newInstance:gE,extend:yp};const hE={MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},tc={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4},pE={LINEAR:0,LOG10:1};var lf={VectorMode:hE,ScalarMappingTarget:tc,Scale:pE};const dE={DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},vE={DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5},yE={BY_ID:0,BY_NAME:1};var hf={ColorMode:dE,GetArray:yE,ScalarMode:vE};const{ScalarMappingTarget:rg,Scale:TE,VectorMode:Pt}=lf,{VtkDataTypes:En}=De,{ColorMode:cs}=hf,{vtkErrorMacro:ag}=E;function xE(t){return t}function sg(t){return Math.floor(t*255+.5)}function SE(t,e){e.classHierarchy.push("vtkScalarsToColors"),t.setVectorModeToMagnitude=()=>t.setVectorMode(Pt.MAGNITUDE),t.setVectorModeToComponent=()=>t.setVectorMode(Pt.COMPONENT),t.setVectorModeToRGBColors=()=>t.setVectorMode(Pt.RGBCOLORS),t.build=()=>{},t.isOpaque=()=>!0,t.setAnnotations=(n,r)=>{if(!(n&&!r||!n&&r)){if(n&&r&&n.length!==r.length){ag("Values and annotations do not have the same number of tuples so ignoring");return}if(e.annotationArray=[],r&&n){const a=r.length;for(let s=0;s<a;s++)e.annotationArray.push({value:n[s],annotation:String(r[s])})}t.updateAnnotatedValueMap(),t.modified()}},t.setAnnotation=(n,r)=>{let a=t.checkForAnnotatedValue(n),s=!1;return a>=0?e.annotationArray[a].annotation!==r&&(e.annotationArray[a].annotation=r,s=!0):(e.annotationArray.push({value:n,annotation:r}),a=e.annotationArray.length-1,s=!0),s&&(t.updateAnnotatedValueMap(),t.modified()),a},t.getNumberOfAnnotatedValues=()=>e.annotationArray.length,t.getAnnotatedValue=n=>n<0||n>=e.annotationArray.length?null:e.annotationArray[n].value,t.getAnnotation=n=>e.annotationArray[n]===void 0?null:e.annotationArray[n].annotation,t.getAnnotatedValueIndex=n=>e.annotationArray.length?t.checkForAnnotatedValue(n):-1,t.removeAnnotation=n=>{const r=t.checkForAnnotatedValue(n),a=r>=0;return a&&(e.annotationArray.splice(r,1),t.updateAnnotatedValueMap(),t.modified()),a},t.resetAnnotations=()=>{e.annotationArray=[],e.annotatedValueMap=[],t.modified()},t.getAnnotationColor=(n,r)=>{if(e.indexedLookup){const a=t.getAnnotatedValueIndex(n);t.getIndexedColor(a,r)}else t.getColor(parseFloat(n),r),r[3]=1},t.checkForAnnotatedValue=n=>t.getAnnotatedValueIndexInternal(n),t.getAnnotatedValueIndexInternal=n=>{if(e.annotatedValueMap[n]!==void 0){const r=e.annotationArray.length;return e.annotatedValueMap[n]%r}return-1},t.getIndexedColor=(n,r)=>{r[0]=0,r[1]=0,r[2]=0,r[3]=0},t.updateAnnotatedValueMap=()=>{e.annotatedValueMap=[];const n=e.annotationArray.length;for(let r=0;r<n;r++)e.annotatedValueMap[e.annotationArray[r].value]=r},t.mapScalars=(n,r,a)=>{const s=n.getNumberOfComponents();let i=null;if(r===cs.DEFAULT&&(n.getDataType()===En.UNSIGNED_CHAR||n.getDataType()===En.UNSIGNED_CHAR_CLAMPED)||r===cs.DIRECT_SCALARS&&n)i=t.convertToRGBA(n,s,n.getNumberOfTuples());else{const o={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:En.UNSIGNED_CHAR},c=E.newTypedArray(o.dataType,4*n.getNumberOfTuples());o.values=c,o.size=c.length,i=De.newInstance(o);let u=a;u<0&&s>1?t.mapVectorsThroughTable(n,i,rg.RGBA,-1,-1):(u<0&&(u=0),u>=s&&(u=s-1),t.mapScalarsThroughTable(n,i,rg.RGBA,u))}return i},t.mapVectorsToMagnitude=(n,r,a)=>{const s=n.getNumberOfTuples(),i=n.getNumberOfComponents(),o=r.getData(),c=n.getData();for(let u=0;u<s;u++){let g=0;for(let f=0;f<a;f++)g+=c[u*i+f]*c[u*i+f];o[u]=Math.sqrt(g)}},t.mapVectorsThroughTable=(n,r,a,s,i)=>{let o=t.getVectorMode(),c=i,u=s;const g=n.getNumberOfComponents();o===Pt.COMPONENT?(u===-1&&(u=t.getVectorComponent()),u<0&&(u=0),u>=g&&(u=g-1)):(c===-1&&(c=t.getVectorSize()),c<=0?(u=0,c=g):(u<0&&(u=0),u>=g&&(u=g-1),u+c>g&&(c=g-u)),o===Pt.MAGNITUDE&&(g===1||c===1)&&(o=Pt.COMPONENT));let f=0;switch(u>0&&(f=u),o){case Pt.COMPONENT:{t.mapScalarsThroughTable(n,r,a,f);break}case Pt.RGBCOLORS:break;case Pt.MAGNITUDE:default:{const l=De.newInstance({numberOfComponents:1,values:new Float32Array(n.getNumberOfTuples())});t.mapVectorsToMagnitude(n,l,c),t.mapScalarsThroughTable(l,r,a,0);break}}},t.luminanceToRGBA=(n,r,a,s)=>{const i=s(a),o=r.getData(),c=n.getData(),u=o.length,g=0,f=1;let l=0;for(let h=g;h<u;h+=f){const v=s(o[h]);c[l*4]=v,c[l*4+1]=v,c[l*4+2]=v,c[l*4+3]=i,l++}},t.luminanceAlphaToRGBA=(n,r,a,s)=>{const i=r.getData(),o=n.getData(),c=i.length,u=0,g=2;let f=0;for(let l=u;l<c;l+=g){const h=s(i[l]);o[f]=h,o[f+1]=h,o[f+2]=h,o[f+3]=s(i[l+1])*a,f+=4}},t.rGBToRGBA=(n,r,a,s)=>{const i=sg(a),o=r.getData(),c=n.getData(),u=o.length,g=0,f=3;let l=0;for(let h=g;h<u;h+=f)c[l*4]=s(o[h]),c[l*4+1]=s(o[h+1]),c[l*4+2]=s(o[h+2]),c[l*4+3]=i,l++},t.rGBAToRGBA=(n,r,a,s)=>{const i=r.getData(),o=n.getData(),c=i.length,u=0,g=4;let f=0;for(let l=u;l<c;l+=g)o[f*4]=s(i[l]),o[f*4+1]=s(i[l+1]),o[f*4+2]=s(i[l+2]),o[f*4+3]=s(i[l+3])*a,f++},t.convertToRGBA=(n,r,a)=>{let{alpha:s}=e;if(r===4&&s>=1&&n.getDataType()===En.UNSIGNED_CHAR)return n;const i=De.newInstance({numberOfComponents:4,empty:!0,size:4*a,dataType:En.UNSIGNED_CHAR});if(a<=0)return i;s=s>0?s:0,s=s<1?s:1;let o=xE;switch((n.getDataType()===En.FLOAT||n.getDataType()===En.DOUBLE)&&(o=sg),r){case 1:t.luminanceToRGBA(i,n,s,o);break;case 2:t.luminanceAlphaToRGBA(i,n,o);break;case 3:t.rGBToRGBA(i,n,s,o);break;case 4:t.rGBAToRGBA(i,n,s,o);break;default:return ag("Cannot convert colors"),null}return i},t.usingLogScale=()=>!1,t.getNumberOfAvailableColors=()=>256*256*256,t.setRange=(n,r)=>t.setMappingRange(n,r),t.getRange=()=>t.getMappingRange(),t.areScalarsOpaque=(n,r,a)=>{if(!n)return t.isOpaque();const s=n.getNumberOfComponents();return r===cs.DEFAULT&&n.getDataType()===En.UNSIGNED_CHAR||r===cs.DIRECT_SCALARS?s===3||s===1?e.alpha>=1:n.getRange(s-1)[0]===255:!0}}const CE={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:Pt.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1,scale:TE.LINEAR};function Tp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CE,n),E.obj(t,e),e.mappingRange=[0,255],e.annotationArray=[],e.annotatedValueMap=[],E.setGet(t,e,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),E.setArray(t,e,["mappingRange"],2),E.getArray(t,e,["mappingRange"]),SE(t,e)}const wE=E.newInstance(Tp,"vtkScalarsToColors");var xp={newInstance:wE,extend:Tp,...lf};const{vtkErrorMacro:ig}=E,og=0,cg=1,so=2;function EE(t,e){e.classHierarchy.push("vtkLookupTable"),t.isOpaque=()=>{if(e.opaqueFlagBuildTime.getMTime()<t.getMTime()){let n=!0;e.nanColor[3]<1&&(n=0),e.useBelowRangeColor&&e.belowRangeColor[3]<1&&(n=0),e.useAboveRangeColor&&e.aboveRangeColor[3]<1&&(n=0);for(let r=3;r<e.table.length&&n;r+=4)e.table[r]<255&&(n=!1);e.opaqueFlag=n,e.opaqueFlagBuildTime.modified()}return e.opaqueFlag},t.usingLogScale=()=>!1,t.getNumberOfAvailableColors=()=>e.table.length/4-3,t.linearIndexLookup=(n,r)=>{let a=0;const s=Number(n);return s<r.range[0]?a=r.maxIndex+og+1.5:s>r.range[1]?a=r.maxIndex+cg+1.5:(a=(s+r.shift)*r.scale,a=a<r.maxIndex?a:r.maxIndex),Math.floor(a)},t.linearLookup=(n,r,a)=>{let s=0;Rh(n)?s=Math.floor(a.maxIndex+1.5+so):s=t.linearIndexLookup(n,a);const i=4*s;return r.slice(i,i+4)},t.indexedLookupFunction=(n,r,a)=>{let s=t.getAnnotatedValueIndexInternal(n);s===-1&&(s=e.numberOfColors+so);const i=4*s;return[r[i],r[i+1],r[i+2],r[i+3]]},t.lookupShiftAndScale=(n,r)=>{r.shift=-n[0],r.scale=Number.MAX_VALUE,n[1]>n[0]&&(r.scale=(r.maxIndex+1)/(n[1]-n[0]))},t.mapScalarsThroughTable=(n,r,a,s)=>{let i=t.linearLookup;e.indexedLookup&&(i=t.indexedLookupFunction);const o=t.getMappingRange(),c={maxIndex:t.getNumberOfColors()-1,range:o,shift:0,scale:0};t.lookupShiftAndScale(o,c);const u=t.getAlpha(),g=n.getNumberOfTuples(),f=n.getNumberOfComponents(),l=r.getData(),h=n.getData();if(u>=1){if(a===tc.RGBA)for(let v=0;v<g;v++){const p=i(h[v*f+s],e.table,c);l[v*4]=p[0],l[v*4+1]=p[1],l[v*4+2]=p[2],l[v*4+3]=p[3]}}else if(a===tc.RGBA)for(let v=0;v<g;v++){const p=i(h[v*f+s],e.table,c);l[v*4]=p[0],l[v*4+1]=p[1],l[v*4+2]=p[2],l[v*4+3]=Math.floor(p[3]*u+.5)}},t.forceBuild=()=>{let n=0,r=0,a=0,s=0;const i=e.numberOfColors-1;i&&(n=(e.hueRange[1]-e.hueRange[0])/i,r=(e.saturationRange[1]-e.saturationRange[0])/i,a=(e.valueRange[1]-e.valueRange[0])/i,s=(e.alphaRange[1]-e.alphaRange[0])/i),e.table.length=4*i+16;const o=[],c=[];for(let u=0;u<=i;u++)o[0]=e.hueRange[0]+u*n,o[1]=e.saturationRange[0]+u*r,o[2]=e.valueRange[0]+u*a,xh(o,c),c[3]=e.alphaRange[0]+u*s,e.table[u*4]=c[0]*255+.5,e.table[u*4+1]=c[1]*255+.5,e.table[u*4+2]=c[2]*255+.5,e.table[u*4+3]=c[3]*255+.5;t.buildSpecialColors(),e.buildTime.modified()},t.setTable=n=>{if(Array.isArray(n)){const a=n[0].length;e.numberOfColors=n.length;const s=4-a;let i=0;for(let o=0;o<e.numberOfColors;o++)e.table[o*4]=255,e.table[o*4+1]=255,e.table[o*4+2]=255,e.table[o*4+3]=255;for(let o=0;o<n.length;o++){const c=n[o];for(let u=0;u<a;u++)e.table[i++]=c[u];i+=s}return t.buildSpecialColors(),e.insertTime.modified(),t.modified(),!0}if(n.getNumberOfComponents()!==4)return ig("Expected 4 components for RGBA colors"),!1;if(n.getDataType()!==Pe.UNSIGNED_CHAR)return ig("Expected unsigned char values for RGBA colors"),!1;e.numberOfColors=n.getNumberOfTuples();const r=n.getData();e.table.length=r.length;for(let a=0;a<r.length;a++)e.table[a]=r[a];return t.buildSpecialColors(),e.insertTime.modified(),t.modified(),!0},t.buildSpecialColors=()=>{const{numberOfColors:n}=e,r=e.table;let a=(n+og)*4;e.useBelowRangeColor||n===0?(r[a]=e.belowRangeColor[0]*255+.5,r[a+1]=e.belowRangeColor[1]*255+.5,r[a+2]=e.belowRangeColor[2]*255+.5,r[a+3]=e.belowRangeColor[3]*255+.5):(r[a]=r[0],r[a+1]=r[1],r[a+2]=r[2],r[a+3]=r[3]),a=(n+cg)*4,e.useAboveRangeColor||n===0?(r[a]=e.aboveRangeColor[0]*255+.5,r[a+1]=e.aboveRangeColor[1]*255+.5,r[a+2]=e.aboveRangeColor[2]*255+.5,r[a+3]=e.aboveRangeColor[3]*255+.5):(r[a]=r[4*(n-1)+0],r[a+1]=r[4*(n-1)+1],r[a+2]=r[4*(n-1)+2],r[a+3]=r[4*(n-1)+3]),a=(n+so)*4,r[a]=e.nanColor[0]*255+.5,r[a+1]=e.nanColor[1]*255+.5,r[a+2]=e.nanColor[2]*255+.5,r[a+3]=e.nanColor[3]*255+.5},t.build=()=>{(e.table.length<1||t.getMTime()>e.buildTime.getMTime()&&e.insertTime.getMTime()<=e.buildTime.getMTime())&&t.forceBuild()},e.table.length>0&&(t.buildSpecialColors(),e.insertTime.modified())}const RE={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function Sp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RE,n),xp.extend(t,e,n),e.table||(e.table=[]),e.buildTime={},E.obj(e.buildTime),e.opaqueFlagBuildTime={},E.obj(e.opaqueFlagBuildTime,{mtime:0}),e.insertTime={},E.obj(e.insertTime,{mtime:0}),E.get(t,e,["buildTime"]),E.setGet(t,e,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),E.setArray(t,e,["alphaRange","hueRange","saturationRange","valueRange"],2),E.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),E.getArray(t,e,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),EE(t,e)}const ME=E.newInstance(Sp,"vtkLookupTable");var OE={newInstance:ME,extend:Sp};const Kn={Off:0,PolygonOffset:1};let nc=Kn.PolygonOffset,ii=Kn.Off;const DE=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function LE(){return nc}function VE(t){const e=nc===t;return nc=t,e}function mE(){return ii}function Li(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const e=ii===t;return ii=t,e}function FE(){return Li(Kn.Off)}function BE(){return Li(Kn.Off)}function _E(){return Li(Kn.PolygonOffset)}function UE(){return DE[ii]}var rc={Resolve:Kn,getResolveCoincidentTopologyAsString:UE,getResolveCoincidentTopologyPolygonOffsetFaces:LE,getResolveCoincidentTopology:mE,setResolveCoincidentTopology:Li,setResolveCoincidentTopologyPolygonOffsetFaces:VE,setResolveCoincidentTopologyToDefault:FE,setResolveCoincidentTopologyToOff:BE,setResolveCoincidentTopologyToPolygonOffset:_E};function Cp(t,e,n){n.forEach(r=>{t[`get${r.method}`]=()=>e[r.key],t[`set${r.method}`]=E.objectSetterMap.object(t,e,{name:r.key,params:["factor","offset"]})})}const pf=["Polygon","Line","Point"],NE={Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},kE=()=>{},ir={modified:kE};Cp(ir,NE,pf.map(t=>({key:t,method:`ResolveCoincidentTopology${t}OffsetParameters`})));function GE(t,e){e.resolveCoincidentTopology===void 0&&(e.resolveCoincidentTopology=!1),E.setGet(t,e,["resolveCoincidentTopology"]),e.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys(rc).forEach(n=>{t[n]=rc[n]}),Object.keys(ir).filter(n=>n!=="modified").forEach(n=>{t[n]=ir[n]}),Cp(t,e.topologyOffset,pf.map(n=>({key:n,method:`RelativeCoincidentTopology${n}OffsetParameters`}))),t.getCoincidentTopologyPolygonOffsetParameters=()=>{const n=ir.getResolveCoincidentTopologyPolygonOffsetParameters(),r=t.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}},t.getCoincidentTopologyLineOffsetParameters=()=>{const n=ir.getResolveCoincidentTopologyLineOffsetParameters(),r=t.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}},t.getCoincidentTopologyPointOffsetParameter=()=>{const n=ir.getResolveCoincidentTopologyPointOffsetParameters(),r=t.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:n.factor+r.factor,offset:n.offset+r.offset}}}var wp={implementCoincidentTopologyMethods:GE,staticOffsetAPI:ir,otherStaticMethods:rc,CATEGORIES:pf,Resolve:Kn};const ct={MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,ID_HIGH24:3,MAX_KNOWN_PASS:3};var Ep={PassTypes:ct};const{FieldAssociations:fg}=Sr,{staticOffsetAPI:bE,otherStaticMethods:$E}=wp,{ColorMode:fs,ScalarMode:qn,GetArray:io}=hf,{VectorMode:WE}=lf,{VtkDataTypes:zE}=De;function ra(t){return()=>E.vtkErrorMacro(`vtkMapper::${t} - NOT IMPLEMENTED`)}function HE(t,e){const n=t[1]%2===0?1:-1;if(t[0]+=n,t[0]>=e[0]||t[0]<0){const r=t[2]%2===0?1:-1;t[0]-=n,t[1]+=r,(t[1]>=e[1]||t[1]<0)&&(t[1]-=r,t[2]++)}}function AE(t,e){return t[0]+e[0]*(t[1]+e[1]*t[2])}function ug(t,e,n){const r=Math.floor(e),a=r%(2*n[0]);let s,i;a<n[0]?(t[0]=a,s=1,i=t[0]===n[0]-1):(t[0]=2*n[0]-1-a,s=-1,i=t[0]===0);const o=Math.floor(r/n[0]),c=o%(2*n[1]);let u,g;c<n[1]?(t[1]=c,u=1,g=t[1]===n[1]-1):(t[1]=2*n[1]-1-c,u=-1,g=t[1]===0),t[2]=Math.floor(o/n[1]);const f=e-r;i?g?t[2]+=f:t[1]+=u*f:t[0]+=s*f,t[0]=(t[0]+.5)/n[0],t[1]=(t[1]+.5)/n[1],t[2]=(t[2]+.5)/n[2]}const gg=new WeakMap;function jE(t,e,n,r,a,s,i){const o=new Array(arguments.length);for(let F=0;F<arguments.length;++F){const B=arguments[F];o[F]=B.getMTime?.()??B}const c=o.join("/"),u=gg.get(t);if(u&&u.stringHash===c)return u.textureCoordinates;const g=(n[1]-n[0])/(a-1),[f,l]=[n[0]-g,n[1]+g],h=f-.5*g,v=1/(l-f+g),p=f,d=(a+1)/(l-f),y=t.getData(),S=t.getNumberOfTuples(),x=t.getNumberOfComponents(),T=e<0||e>=x,w=s[2]<=1?2:3,C=De.newInstance({numberOfComponents:w,values:new Float32Array(S*w)}),R=C.getData(),M=[0,0,0];ug(M,a+2,s);let m=0,L=0;const V=[.5,.5,.5];for(let F=0;F<S;++F){let B;if(T){let _=0;for(let P=0;P<x;++P){const z=Number(y[m+P]);_+=z*z}B=Math.sqrt(_)}else B=Number(y[m+e]);if(r&&(B=Math.log10(B)),m+=x,Rh(B))V[0]=M[0],V[1]=M[1],V[2]=M[2];else if(i){let _=(B-p)*d;_<1?_=0:_>a&&(_=a+1),ug(V,_,s)}else{V[1]=.49;const _=(B-h)*v;_>1e3?V[0]=1e3:_<-1e3?V[0]=-1e3:V[0]=_}for(let _=0;_<w;++_)R[L++]=V[_]}return gg.set(t,{stringHash:c,textureCoordinates:C}),C}function KE(t,e){e.classHierarchy.push("vtkMapper"),t.getBounds=()=>{const n=t.getInputData();return n?(e.static||t.update(),e.bounds=n.getBounds()):e.bounds=Ri(),e.bounds},t.setForceCompileOnly=n=>{e.forceCompileOnly=n},t.setSelectionWebGLIdsToVTKIds=n=>{e.selectionWebGLIdsToVTKIds=n},t.createDefaultLookupTable=()=>{e.lookupTable=OE.newInstance()},t.getColorModeAsString=()=>E.enumToString(fs,e.colorMode),t.setColorModeToDefault=()=>t.setColorMode(0),t.setColorModeToMapScalars=()=>t.setColorMode(1),t.setColorModeToDirectScalars=()=>t.setColorMode(2),t.getScalarModeAsString=()=>E.enumToString(qn,e.scalarMode),t.setScalarModeToDefault=()=>t.setScalarMode(0),t.setScalarModeToUsePointData=()=>t.setScalarMode(1),t.setScalarModeToUseCellData=()=>t.setScalarMode(2),t.setScalarModeToUsePointFieldData=()=>t.setScalarMode(3),t.setScalarModeToUseCellFieldData=()=>t.setScalarMode(4),t.setScalarModeToUseFieldData=()=>t.setScalarMode(5),t.getAbstractScalars=(n,r,a,s,i)=>{if(!n||!e.scalarVisibility)return{scalars:null,cellFlag:!1};let o=null,c=!1;if(r===qn.DEFAULT)o=n.getPointData().getScalars(),o||(o=n.getCellData().getScalars(),c=!0);else if(r===qn.USE_POINT_DATA)o=n.getPointData().getScalars();else if(r===qn.USE_CELL_DATA)o=n.getCellData().getScalars(),c=!0;else if(r===qn.USE_POINT_FIELD_DATA){const u=n.getPointData();a===io.BY_ID?o=u.getArrayByIndex(s):o=u.getArrayByName(i)}else if(r===qn.USE_CELL_FIELD_DATA){const u=n.getCellData();c=!0,a===io.BY_ID?o=u.getArrayByIndex(s):o=u.getArrayByName(i)}else if(r===qn.USE_FIELD_DATA){const u=n.getFieldData();a===io.BY_ID?o=u.getArrayByIndex(s):o=u.getArrayByName(i)}return{scalars:o,cellFlag:c}},t.mapScalars=(n,r)=>{const{scalars:a,cellFlag:s}=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName);if(e.areScalarsMappedFromCells=s,!a){e.colorCoordinates=null,e.colorTextureMap=null,e.colorMapColors=null;return}const i=`${t.getMTime()}${a.getMTime()}${r}`;if(e.colorBuildString!==i){if(e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]),t.canUseTextureMapForColoring(a,s))e.mapScalarsToTexture(a,s,r);else{e.colorCoordinates=null,e.colorTextureMap=null;const o=t.getLookupTable();o&&(o.build(),e.colorMapColors=o.mapScalars(a,e.colorMode,e.fieldDataTupleId))}e.colorBuildString=`${t.getMTime()}${a.getMTime()}${r}`}},e.mapScalarsToTexture=(n,r,a)=>{const s=e.lookupTable.getRange(),i=e.lookupTable.usingLogScale(),o=e.lookupTable.getAlpha(),c=i?[Math.log10(s[0]),Math.log10(s[1])]:s;if(e.colorMapColors=null,e.colorTextureMap==null||t.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getAlpha()!==a){e.lookupTable.setAlpha(a),e.colorTextureMap=null,e.lookupTable.build();const g=e.lookupTable.getNumberOfAvailableColors(),f=2048,l=f**3-3,v=4096-2,p=2,d=r?l:v;e.numberOfColorsInRange=Math.min(Math.max(g,p),d);const y=e.numberOfColorsInRange+3,S=e.numberOfColorsInRange+2,x=r?[Math.min(Math.ceil(y/f**0),f),Math.min(Math.ceil(y/f**1),f),Math.min(Math.ceil(y/f**2),f)]:[S,2,1],T=x[0]*x[1]*x[2],w=new Float64Array(T);w.fill(NaN);const C=e.numberOfColorsInRange,R=C+2,M=[0,0,0],m=c[0],L=c[1]-c[0];for(let B=0;B<R;++B){const _=AE(M,x),P=m+L*(B-1)/(C-1),z=i?10**P:P;w[_]=z,HE(M,x)}const V=De.newInstance({numberOfComponents:1,values:w}),F=e.lookupTable.mapScalars(V,e.colorMode,0);e.colorTextureMap=lE.newInstance(),e.colorTextureMap.setDimensions(x),e.colorTextureMap.getPointData().setScalars(F),e.lookupTable.setAlpha(o)}const u=e.lookupTable.getVectorMode()===WE.MAGNITUDE&&n.getNumberOfComponents()>1?-1:e.lookupTable.getVectorComponent();e.colorCoordinates=jE(n,u,c,i,e.numberOfColorsInRange,e.colorTextureMap.getDimensions(),r)},t.getIsOpaque=()=>{const n=t.getInputData(),a=t.getAbstractScalars(n,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!e.scalarVisibility||a==null)return!0;const s=t.getLookupTable();return s?(s.build(),s.areScalarsOpaque(a,e.colorMode,-1)):!0},t.canUseTextureMapForColoring=(n,r)=>r&&e.colorMode!==fs.DIRECT_SCALARS?!0:!(!e.interpolateScalarsBeforeMapping||e.lookupTable&&e.lookupTable.getIndexedLookup()||!n||e.colorMode===fs.DEFAULT&&n.getDataType()===zE.UNSIGNED_CHAR||e.colorMode===fs.DIRECT_SCALARS),t.clearColorArrays=()=>{e.colorMapColors=null,e.colorCoordinates=null,e.colorTextureMap=null},t.getLookupTable=()=>(e.lookupTable||t.createDefaultLookupTable(),e.lookupTable),t.getMTime=()=>{let n=e.mtime;if(e.lookupTable!==null){const r=e.lookupTable.getMTime();n=r>n?r:n}return n},t.getPrimitiveCount=()=>{const n=t.getInputData();return{points:n.getPoints().getNumberOfValues()/3,verts:n.getVerts().getNumberOfValues()-n.getVerts().getNumberOfCells(),lines:n.getLines().getNumberOfValues()-2*n.getLines().getNumberOfCells(),triangles:n.getPolys().getNumberOfValues()-3*n.getPolys().getNumberOfCells()}},t.acquireInvertibleLookupTable=ra("AcquireInvertibleLookupTable"),t.valueToColor=ra("ValueToColor"),t.colorToValue=ra("ColorToValue"),t.useInvertibleColorFor=ra("UseInvertibleColorFor"),t.clearInvertibleColor=ra("ClearInvertibleColor"),t.processSelectorPixelBuffers=(n,r)=>{if(!n||!e.selectionWebGLIdsToVTKIds||!e.populateSelectionSettings)return;const a=n.getRawPixelBuffer(ct.ID_LOW24),s=n.getRawPixelBuffer(ct.ID_HIGH24),i=n.getCurrentPass(),o=n.getFieldAssociation();let c=null;o===fg.FIELD_ASSOCIATION_POINTS?c=e.selectionWebGLIdsToVTKIds.points:o===fg.FIELD_ASSOCIATION_CELLS&&(c=e.selectionWebGLIdsToVTKIds.cells),c&&r.forEach(u=>{if(i===ct.ID_LOW24){let g=0;s&&(g+=s[u],g*=256),g+=a[u+2],g*=256,g+=a[u+1],g*=256,g+=a[u];const f=c[g],l=n.getPixelBuffer(ct.ID_LOW24);l[u]=f&255,l[u+1]=(f&65280)>>8,l[u+2]=(f&16711680)>>16}else if(i===ct.ID_HIGH24&&s){let g=0;g+=s[u],g*=256,g+=a[u+2],g*=256,g+=a[u+1],g*=256,g+=a[u];const f=c[g],l=n.getPixelBuffer(ct.ID_HIGH24);l[u]=(f&4278190080)>>24}})}}const PE={colorMapColors:null,areScalarsMappedFromCells:!1,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,populateSelectionSettings:!0,selectionWebGLIdsToVTKIds:null,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,numberOfColorsInRange:0,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,customShaderAttributes:[]};function Rp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,PE,n),$w.extend(t,e,n),E.get(t,e,["areScalarsMappedFromCells","colorCoordinates","colorMapColors","colorTextureMap","numberOfColorsInRange","selectionWebGLIdsToVTKIds"]),E.setGet(t,e,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","populateSelectionSettings","renderTime","scalarMode","scalarVisibility","static","useLookupTableScalarRange","customShaderAttributes"]),E.setGetArray(t,e,["scalarRange"],2),wp.implementCoincidentTopologyMethods(t,e),KE(t,e)}const XE=E.newInstance(Rp,"vtkMapper");var vr={newInstance:XE,extend:Rp,...bE,...$E,...hf};const{isVtkObject:IE}=E;function Mp(t){let e=0;return t.filter((n,r)=>r===e?(e+=n+1,!0):!1)}function Op(t){let e=0;for(let n=0;n<t.length;)n+=t[n]+1,e++;return e}const YE={extractCellSizes:Mp,getNumberOfCells:Op};function qE(t,e){e.classHierarchy.push("vtkCellArray");const n={...t};t.getNumberOfCells=r=>(e.numberOfCells!==void 0&&!r||(e.cellSizes?e.numberOfCells=e.cellSizes.length:e.numberOfCells=Op(t.getData())),e.numberOfCells),t.getCellSizes=r=>(e.cellSizes!==void 0&&!r||(e.cellSizes=Mp(t.getData())),e.cellSizes),t.resize=r=>{const a=t.getNumberOfTuples();n.resize(r);const s=t.getNumberOfTuples();s<a&&(s===0?(e.numberOfCells=0,e.cellSizes=[]):(e.numberOfCells=void 0,e.cellSizes=void 0))},t.setData=r=>{n.setData(r,1),e.numberOfCells=void 0,e.cellSizes=void 0},t.getCell=r=>{let a=r;const s=e.values[a++];return e.values.subarray(a,a+s)},t.insertNextCell=r=>{let a;IE(r)?a=r.getPointsIds():a=r;const s=t.getNumberOfCells();return t.insertNextTuples([a.length,...a]),++e.numberOfCells,e.cellSizes!=null&&e.cellSizes.push(a.length),s},t.getMaxCellSize=()=>t.getCellSizes().reduce((r,a)=>Math.max(r,a),0)}function QE(t){return{empty:!0,numberOfComponents:1,dataType:Pe.UNSIGNED_INT,...t}}function Dp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};De.extend(t,e,QE(n)),qE(t,e)}const ZE=E.newInstance(Dp,"vtkCellArray");var lg={newInstance:ZE,extend:Dp,...YE};const{vtkErrorMacro:JE}=E;function eR(t,e){let n=0;e.classHierarchy.push("vtkPoints"),t.getNumberOfPoints=t.getNumberOfTuples,t.setNumberOfPoints=function(s){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;t.getNumberOfPoints()!==s&&(e.size=s*i,e.values=E.newTypedArray(e.dataType,e.size),t.setNumberOfComponents(i),t.modified())},t.setPoint=function(s){for(var i=arguments.length,o=new Array(i>1?i-1:0),c=1;c<i;c++)o[c-1]=arguments[c];t.setTuple(s,o)},t.getPoint=t.getTuple,t.findPoint=t.findTuple,t.insertNextPoint=(s,i,o)=>t.insertNextTuple([s,i,o]),t.insertPoint=(s,i)=>t.insertTuple(s,i);const r=t.getBounds;t.getBounds=()=>(n<e.mtime&&t.computeBounds(),r());const a=t.getBoundsByReference;t.getBoundsByReference=()=>(n<e.mtime&&t.computeBounds(),a()),t.computeBounds=()=>{if(t.getNumberOfComponents()===3){const s=t.getRange(0);e.bounds[0]=s[0],e.bounds[1]=s[1];const i=t.getRange(1);e.bounds[2]=i[0],e.bounds[3]=i[1];const o=t.getRange(2);e.bounds[4]=o[0],e.bounds[5]=o[1]}else if(t.getNumberOfComponents()===2){const s=t.getRange(0);e.bounds[0]=s[0],e.bounds[1]=s[1];const i=t.getRange(1);e.bounds[2]=i[0],e.bounds[3]=i[1],e.bounds[4]=0,e.bounds[5]=0}else JE(`getBounds called on an array with components of ${t.getNumberOfComponents()}`),tf(e.bounds);n=E.getCurrentGlobalMTime()},t.setNumberOfComponents(e.numberOfComponents<2?3:e.numberOfComponents)}const tR={empty:!0,numberOfComponents:3,dataType:Pe.FLOAT,bounds:[1,-1,1,-1,1,-1]};function Lp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tR,n),De.extend(t,e,n),E.getArray(t,e,["bounds"],6),eR(t,e)}const nR=E.newInstance(Lp,"vtkPoints");var ba={newInstance:nR,extend:Lp};function rR(t,e){e.classHierarchy.push("vtkCell"),t.initialize=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(r){e.pointsIds=r;let a=e.points.getData();a.length!==3*e.pointsIds.length&&(a=E.newTypedArray(n.getDataType(),3*e.pointsIds.length));const s=n.getData();e.pointsIds.forEach((i,o)=>{let c=3*i,u=3*o;a[u]=s[c],a[++u]=s[++c],a[++u]=s[++c]}),e.points.setData(a)}else{e.points=n,e.pointsIds=new Array(n.getNumberOfPoints());for(let a=n.getNumberOfPoints()-1;a>=0;--a)e.pointsIds[a]=a}},t.getBounds=()=>e.points.getBounds(),t.getLength2=()=>{const n=he.getLengths(t.getBounds());return n[0]*n[0]+n[1]*n[1]+n[2]*n[2]},t.getParametricDistance=n=>{let r,a=0;for(let s=0;s<3;s++)n[s]<0?r=-n[s]:n[s]>1?r=n[s]-1:r=0,r>a&&(a=r);return a},t.getNumberOfPoints=()=>e.points.getNumberOfPoints(),t.deepCopy=n=>{n.initialize(e.points,e.pointsIds)},t.getCellDimension=()=>{},t.intersectWithLine=(n,r,a,s,i,o,c)=>{},t.evaluatePosition=(n,r,a,s,i,o)=>{E.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}const aR={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function Vp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aR,n),E.obj(t,e),e.points||(e.points=ba.newInstance()),E.get(t,e,["points","pointsIds"]),rR(t,e)}const sR=E.newInstance(Vp,"vtkCell");var yr={newInstance:sR,extend:Vp};function iR(t,e){let n=e;for(e>=t.array.length&&(n+=t.array.length);n>t.array.length;)t.array.push({ncells:0,cells:null});t.array.length=n}function oR(t,e){e.classHierarchy.push("vtkCellLinks"),t.buildLinks=n=>{const r=n.getPoints().getNumberOfPoints(),a=n.getNumberOfCells(),s=new Uint32Array(r);if(n.isA("vtkPolyData")){for(let i=0;i<a;++i){const{cellPointIds:o}=n.getCellPoints(i);o.forEach(c=>{t.incrementLinkCount(c)})}t.allocateLinks(r),e.maxId=r-1;for(let i=0;i<a;++i){const{cellPointIds:o}=n.getCellPoints(i);o.forEach(c=>{t.insertCellReference(c,s[c]++,i)})}}else{for(let i=0;i<a;i++)yr.newInstance().getPointsIds().forEach(c=>{t.incrementLinkCount(c)});t.allocateLinks(r),e.maxId=r-1;for(let i=0;i<a;++i)yr.newInstance().getPointsIds().forEach(c=>{t.insertCellReference(c,s[c]++,i)})}},t.allocate=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.array=Array(n).fill().map(()=>({ncells:0,cells:null})),e.extend=r,e.maxId=-1},t.initialize=()=>{e.array=null},t.getLink=n=>e.array[n],t.getNcells=n=>e.array[n].ncells,t.getCells=n=>e.array[n].cells,t.insertNextPoint=n=>{e.array.push({ncells:n,cells:Array(n)}),++e.maxId},t.insertNextCellReference=(n,r)=>{e.array[n].cells[e.array[n].ncells++]=r},t.deletePoint=n=>{e.array[n].ncells=0,e.array[n].cells=null},t.removeCellReference=(n,r)=>{e.array[r].cells=e.array[r].cells.filter(a=>a!==n),e.array[r].ncells=e.array[r].cells.length},t.addCellReference=(n,r)=>{e.array[r].cells[e.array[r].ncells++]=n},t.resizeCellList=(n,r)=>{e.array[n].cells.length=r},t.squeeze=()=>{iR(e,e.maxId+1)},t.reset=()=>{e.maxId=-1},t.deepCopy=n=>{e.array=[...n.array],e.extend=n.extend,e.maxId=n.maxId},t.incrementLinkCount=n=>{++e.array[n].ncells},t.allocateLinks=n=>{for(let r=0;r<n;++r)e.array[r].cells=new Array(e.array[r].ncells)},t.insertCellReference=(n,r,a)=>{e.array[n].cells[r]=a}}const cR={array:null,maxId:0,extend:0};function mp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cR,n),E.obj(t,e),oR(t,e)}const fR=E.newInstance(mp,"vtkCellLinks");var uR={newInstance:fR,extend:mp};const pe={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_QUAD:9,VTK_QUADRATIC_EDGE:21,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42},ac=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function gR(t){return t<ac.length?ac[t]:"UnknownClass"}function lR(t){return ac.findIndex(t)}function hR(t){return t<pe.VTK_QUADRATIC_EDGE||t===pe.VTK_CONVEX_POINT_SET||t===pe.VTK_POLYHEDRON}function pR(t){return t===pe.VTK_TRIANGLE_STRIP||t===pe.VTK_POLY_LINE||t===pe.VTK_POLY_VERTEX}const dR={getClassNameFromTypeId:gR,getTypeIdFromClassName:lR,isLinear:hR,hasSubCells:pR};function vR(t,e){e.classHierarchy.push("vtkCellTypes"),t.allocate=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.size=n>0?n:1,e.extend=r>0?r:1,e.maxId=-1,e.typeArray=new Uint8Array(n),e.locationArray=new Uint32Array(n)},t.insertCell=(n,r,a)=>{e.typeArray[n]=r,e.locationArray[n]=a,n>e.maxId&&(e.maxId=n)},t.insertNextCell=(n,r)=>(t.insertCell(++e.maxId,n,r),e.maxId),t.setCellTypes=(n,r,a)=>{e.size=n,e.typeArray=r,e.locationArray=a,e.maxId=n-1},t.getCellLocation=n=>e.locationArray[n],t.deleteCell=n=>{e.typeArray[n]=pe.VTK_EMPTY_CELL},t.getNumberOfTypes=()=>e.maxId+1,t.isType=n=>{const r=t.getNumberOfTypes();for(let a=0;a<r;++a)if(n===t.getCellType(a))return!0;return!1},t.insertNextType=n=>t.insertNextCell(n,-1),t.getCellType=n=>e.typeArray[n],t.reset=()=>{e.maxId=-1},t.deepCopy=n=>{t.allocate(n.getSize(),n.getExtend()),e.typeArray.set(n.getTypeArray()),e.locationArray.set(n.getLocationArray()),e.maxId=n.getMaxId()}}const yR={size:0,maxId:-1,extend:1e3};function Fp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,yR,n),E.obj(t,e),E.get(t,e,["size","maxId","extend"]),E.getArray(t,e,["typeArray","locationArray"]),vR(t,e)}const TR=E.newInstance(Fp,"vtkCellTypes");var xR={newInstance:TR,extend:Fp,...dR};const Bp={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2};var _p={IntersectionState:Bp};const{IntersectionState:Ws}=_p;function mr(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;const a={t:Number.MIN_VALUE,distance:0},s=[];let i;s[0]=n[0]-e[0],s[1]=n[1]-e[1],s[2]=n[2]-e[2];const o=s[0]*(t[0]-e[0])+s[1]*(t[1]-e[1])+s[2]*(t[2]-e[2]),c=ee(s,s);let u=1e-5*o;return c!==0&&(a.t=o/c),u<0&&(u=-u),-u<c&&c<u||c<=0||a.t<0?i=e:a.t>1?i=n:(i=s,s[0]=e[0]+a.t*s[0],s[1]=e[1]+a.t*s[1],s[2]=e[2]+a.t*s[2]),r&&(r[0]=i[0],r[1]=i[1],r[2]=i[2]),a.distance=Tt(i,t),a}function Up(t,e,n,r,a,s){const i=[],o=[],c=[];a[0]=0,s[0]=0,ze(e,t,i),ze(r,n,o),ze(n,t,c);const u=[ee(i,i),-ee(i,o),-ee(i,o),ee(o,o)],g=[];if(g[0]=ee(i,c),g[1]=-ee(o,c),Th(u,g,2)===0){let f=Number.MAX_VALUE;const l=[t,e,n,r],h=[n,n,t,t],v=[r,r,e,e];s[0],s[0],a[0],a[0],a[0],a[0],s[0],s[0];let p;for(let d=0;d<4;d++)p=mr(l[d],h[d],v[d]),p.distance<f&&(f=p.distance,p.t);return Ws.ON_LINE}return a[0]=g[0],s[0]=g[1],a[0]>=0&&a[0]<=1&&s[0]>=0&&s[0]<=1?Ws.YES_INTERSECTION:Ws.NO_INTERSECTION}const SR={distanceToLine:mr,intersection:Up};function CR(t,e){e.classHierarchy.push("vtkLine");function n(r){return r>=0&&r<=1}t.getCellDimension=()=>1,t.intersectWithLine=(r,a,s,i,o)=>{const c={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};o[1]=0,o[2]=0;const u=[],g=[],f=[];e.points.getPoint(0,g),e.points.getPoint(1,f);const l=[],h=[],v=Up(r,a,g,f,l,h);if(c.t=l[0],c.betweenPoints=n(c.t),o[0]=h[0],v===Ws.YES_INTERSECTION){for(let p=0;p<3;p++)i[p]=g[p]+o[0]*(f[p]-g[p]),u[p]=r[p]+c.t*(a[p]-r[p]);if(Tt(i,u)<=s*s)return c.intersect=1,c}else{let p;if(c.t<0)return p=mr(r,g,f,i),p.distance<=s*s&&(c.t=0,c.intersect=1,c.betweenPoints=!0),c;if(c.t>1)return p=mr(a,g,f,i),p.distance<=s*s&&(c.t=1,c.intersect=1,c.betweenPoints=!0),c;if(o[0]<0)return o[0]=0,p=mr(g,r,a,i),c.t=p.t,p.distance<=s*s&&(c.intersect=1),c;if(o[0]>1)return o[0]=1,p=mr(f,r,a,i),c.t=p.t,p.distance<=s*s&&(c.intersect=1),c}return c},t.evaluateLocation=(r,a,s)=>{const i=[],o=[];e.points.getPoint(0,i),e.points.getPoint(1,o);for(let c=0;c<3;c++)a[c]=i[c]+r[0]*(o[c]-i[c]);s[0]=1-r[0],s[1]=r[0]},t.evaluateOrientation=(r,a,s)=>e.orientations?(Ls(a,e.orientations[0],e.orientations[1],r[0]),s[0]=1-r[0],s[1]=r[0],!0):!1}const wR={orientations:null};function Np(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wR,n),yr.extend(t,e,n),E.setGet(t,e,["orientations"]),CR(t,e)}const ER=E.newInstance(Np,"vtkLine");var et={newInstance:ER,extend:Np,...SR,..._p};function RR(t,e){e.classHierarchy.push("vtkPointSet"),e.points?e.points=Gt(e.points):e.points=ba.newInstance(),t.getNumberOfPoints=()=>e.points.getNumberOfPoints(),t.getBounds=()=>e.points.getBounds(),t.computeBounds=()=>{t.getBounds()};const n=t.shallowCopy;t.shallowCopy=function(s){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(s,i),e.points=ba.newInstance(),e.points.shallowCopy(s.getPoints())};const r=t.getMTime;t.getMTime=()=>{const s=r();return Math.max(s,e.points?.getMTime()??s)};const a=t.initialize;t.initialize=()=>(e.points?.initialize(),a())}const MR={};function kp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MR,n),Sr.extend(t,e,n),E.setGet(t,e,["points"]),RR(t,e)}const OR=E.newInstance(kp,"vtkPointSet");var DR={newInstance:OR,extend:kp};function LR(t,e){e.classHierarchy.push("vtkPolyLine");const n=et.newInstance();n.getPoints().setNumberOfPoints(2),t.getCellDimension=()=>1,t.intersectWithLine=(r,a,s,i,o,c,u)=>{const g={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null},f=t.getNumberOfPoints()-1;let l=Number.MAX_VALUE;for(let h=0;h<f;h++){const v=[0,0,0];n.getPoints().getData().set(e.points.getData().subarray(3*h,3*(h+2)));const p=n.intersectWithLine(s,i,o,c,u);if(p.intersect===1&&p.t<=g.t+o&&p.t>=r&&p.t<=a){g.intersect=1;const d=n.getParametricDistance(v);if(d<l||d===l&&p.t<g.t){g.subId=h,g.t=p.t,l=d;for(let y=0;y<3;y++)c[y],v[y]}}}return g},t.evaluateLocation=(r,a,s,i)=>(n.getPoints().getData().set(e.points.getData().subarray(3*r,3*(r+2))),n.evaluateLocation(a,s,i)),t.evaluateOrientation=(r,a,s,i)=>(e.orientations?n.setOrientations([e.orientations[r],e.orientations[r+1]]):n.setOrientations(null),n.evaluateOrientation(a,s,i)),t.getDistancesToFirstPoint=()=>{const r=e.distancesTime.getMTime();if(r<e.points.getMTime()||r<t.getMTime()){const a=t.getNumberOfPoints();if(e.distances?e.distances.length=a:e.distances=new Array(a),a>0){const s=new Array(3),i=new Array(3);let o=0;e.distances[0]=o,e.points.getPoint(0,s);for(let c=1;c<a;++c)e.points.getPoint(c,i),o+=e.distanceFunction(s,i),e.distances[c]=o,ix(s,i)}e.distancesTime.modified()}return e.distances},t.findPointIdAtDistanceFromFirstPoint=r=>{const a=t.getDistancesToFirstPoint();if(a.length<2)return-1;let s=0,i=a.length-1;if(r<a[s]||r>a[i]||a[i]===0)return-1;for(;i-s>1;){const o=Math.floor((s+i)/2);a[o]<=r?s=o:i=o}return s}}const VR={orientations:null,distanceFunction:fx};function Gp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,VR,n),yr.extend(t,e,n),E.setGet(t,e,["orientations","distanceFunction"]),e.distancesTime={},E.obj(e.distancesTime,{mtime:0}),LR(t,e)}const mR=E.newInstance(Gp,"vtkPolyLine");var FR={newInstance:mR,extend:Gp};function BR(t,e){e.classHierarchy.push("vtkPriorityQueue"),t.push=(n,r)=>{const a=e.elements.findIndex(s=>s.priority>n);e.elements.splice(a,0,{priority:n,element:r})},t.pop=()=>e.elements.length>0?e.elements.shift().element:null,t.deleteById=n=>{e.elements=e.elements.filter(r=>{let{element:a}=r;return a.id!==n})},t.length=()=>e.elements.length}const _R={elements:[]};function bp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_R,n),E.obj(t,e),BR(t,e)}const UR=E.newInstance(bp,"vtkPriorityQueue");var NR={newInstance:UR,extend:bp};const us=1e-6,hg=11920929e-14,kR=1e-8,rr={FAILURE:-1,OUTSIDE:0,INSIDE:1,INTERSECTION:2,ON_LINE:3};function pg(t,e,n,r,a){return(r[t]-n[t])*(a[e]-n[e])-(a[t]-n[t])*(r[e]-n[e])}function GR(t,e,n,r){if(t[0]<n[0]||t[0]>n[1]||t[1]<n[2]||t[1]>n[3]||t[2]<n[4]||t[2]>n[5])return rr.OUTSIDE;if(Rt(r)<=hg)return rr.FAILURE;let a=kR*((n[1]-n[0])*(n[1]-n[0])+(n[3]-n[2])*(n[3]-n[2])+(n[5]-n[4])*(n[5]-n[4]));a*=a,a=a===0?hg:a;const s=[],i=[];for(let g=0;g<e.length;){if(s[0]=e[g++],s[1]=e[g++],s[2]=e[g++],Tt(t,s)<=a)return rr.INSIDE;const{distance:f,t:l}=et.distanceToLine(t,s,i);if(f<=a&&l>0&&l<1)return rr.INSIDE}let o,c;Math.abs(r[0])>Math.abs(r[1])?Math.abs(r[0])>Math.abs(r[2])?(o=1,c=2):(o=0,c=1):Math.abs(r[1])>Math.abs(r[2])?(o=0,c=2):(o=0,c=1);let u=0;for(let g=0;g<e.length;)s[0]=e[g++],s[1]=e[g++],s[2]=e[g++],g<e.length?(i[0]=e[g],i[1]=e[g+1],i[2]=e[g+2]):(i[0]=e[0],i[1]=e[1],i[2]=e[2]),s[c]<=t[c]?i[c]>t[c]&&pg(o,c,s,i,t)>0&&++u:i[c]<=t[c]&&pg(o,c,s,i,t)<0&&--u;return u===0?rr.OUTSIDE:rr.INSIDE}function bR(t,e,n){const r=t.length,a=[];e.getPoint(t[0],a),n[0]=a[0],n[1]=a[0],n[2]=a[1],n[3]=a[1],n[4]=a[2],n[5]=a[2];for(let i=1;i<r;i++)e.getPoint(t[i],a),he.addPoint(n,...a);const s=he.getLengths(n);return ee(s,s)}function $R(t,e,n){n.length=3,n[0]=0,n[1]=0,n[2]=0;const r=[];let a=[],s=[];const i=[],o=[];e.getPoint(t[0],r),e.getPoint(t[1],a);for(let c=2;c<t.length;c++){e.getPoint(t[c],s),ze(s,a,i),ze(r,a,o);const u=[0,0,0];gt(i,o,u),Hr(n,u,n),[a,s]=[s,a]}return Rt(n)}function WR(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,0];n[0]=0,n[1]=0,n[2]=0;const r=t.length,a=[];for(let s=0;s<r;s++)e.getPoint(t[s],a),n[0]+=a[0],n[1]+=a[1],n[2]+=a[2];return n[0]/=r,n[1]/=r,n[2]/=r,n}const zR={PolygonWithPointIntersectionState:rr,pointInPolygon:GR,getBounds:bR,getNormal:$R,computeCentroid:WR};function HR(t,e){e.classHierarchy.push("vtkPolygon");function n(){const o=[0,0,0],c=[0,0,0];e.normal=[0,0,0];const u=[...e.firstPoint.point];let g=e.firstPoint;for(let f=0;f<e.pointCount;f++){ze(g.point,u,o),ze(g.next.point,u,c);const l=[0,0,0];gt(o,c,l),Hr(e.normal,l,e.normal),g=g.next}return Rt(e.normal)}function r(o){const c=[0,0,0],u=[0,0,0],g=[0,0,0],f=[0,0,0];ze(o.point,o.previous.point,c),ze(o.next.point,o.point,u),ze(o.previous.point,o.next.point,g),gt(c,u,f);const l=ee(f,e.normal);if(l<=0)return-1;const h=Et(c)+Et(u)+Et(g);return h*h/l}function a(o){if(e.pointCount<=3)return!0;const c=o.previous,u=o.next,g=[0,0,0];ze(u.point,c.point,g);const f=[0,0,0];if(gt(g,e.normal,f),Rt(f),Et(f)===0)return!1;let l=An.evaluate(f,c.point,u.next.point),h=l>us?1:l<-us?-1:0,v=h<0?1:0;for(let p=u.next.next;p.id!==c.id;p=p.next){const d=p.previous;l=An.evaluate(f,c.point,p.point);const y=l>us?1:l<-us?-1:0;if(y!==h){if(v||(v=y<=0?1:0),et.intersection(c.point,u.point,p.point,d.point,[0],[0])===Bp.YES_INTERSECTION)return!1;h=y}}return v===1}function s(o,c){e.pointCount-=1;const u=o.previous,g=o.next;e.tris=e.tris.concat(o.point),e.tris=e.tris.concat(g.point),e.tris=e.tris.concat(u.point),u.next=g,g.previous=u,c.deleteById(u.id),c.deleteById(g.id);const f=r(u);f>0&&c.push(f,u);const l=r(g);l>0&&c.push(l,g),o.id===e.firstPoint.id&&(e.firstPoint=g)}function i(){n();const o=NR.newInstance();let c=e.firstPoint;for(let u=0;u<e.pointCount;u++){const g=r(c);g>0&&o.push(g,c),c=c.next}for(;e.pointCount>2&&o.length()>0;)if(e.pointCount===o.length()){const u=o.pop();s(u,o)}else{const u=o.pop();a(u)&&s(u,o)}return e.pointCount<=2}t.triangulate=()=>e.firstPoint?i():null,t.setPoints=o=>{e.pointCount=o.length,e.firstPoint={id:0,point:o[0],next:null,previous:null};let c=e.firstPoint;for(let u=1;u<e.pointCount;u++)c.next={id:u,point:o[u],next:null,previous:c},c=c.next;e.firstPoint.previous=c,c.next=e.firstPoint},t.getPointArray=()=>e.tris}const AR={firstPoint:null,pointCount:0,tris:[]};function $p(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AR,n),E.obj(t,e),HR(t,e)}const jR=E.newInstance($p,"vtkPolygon");var KR={newInstance:jR,extend:$p,...zR};function df(t,e,n,r){const a=n[0]-e[0],s=n[1]-e[1],i=n[2]-e[2],o=t[0]-e[0],c=t[1]-e[1],u=t[2]-e[2];r[0]=s*u-i*c,r[1]=i*o-a*u,r[2]=a*c-s*o}function $a(t,e,n,r){df(t,e,n,r);const a=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);a!==0&&(r[0]/=a,r[1]/=a,r[2]/=a)}function Wp(t){t[0]=-1,t[1]=1,t[2]=0,t[3]=-1,t[4]=0,t[5]=1}function PR(t,e,n,r,a,s){let i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,o=!1;const c=[],u=[],g=[],f=[],l=[];$a(t,e,n,f),$a(r,a,s,l);const h=-ee(f,t),v=-ee(l,r),p=[ee(l,t)+v,ee(l,e)+v,ee(l,n)+v];if(p[0]*p[1]>i&&p[0]*p[2]>i)return{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g};const d=[ee(f,r)+h,ee(f,a)+h,ee(f,s)+h];if(d[0]*d[1]>i&&d[0]*d[2]>i)return{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g};if(Math.abs(f[0]-l[0])<1e-9&&Math.abs(f[1]-l[1])<1e-9&&Math.abs(f[2]-l[2])<1e-9&&Math.abs(h-v)<1e-9)return o=!0,{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g};const y=[t,e,n],S=[r,a,s],x=ee(f,l),T=(h-v*x)/(x*x-1),w=(v-h*x)/(x*x-1),C=[T*f[0]+w*l[0],T*f[1]+w*l[1],T*f[2]+w*l[2]],R=gt(f,l,[]);Rt(R);let M=0,m=0;const L=[],V=[];let F=50,B=50;for(let z=0;z<3;z++){const A=z,I=(z+1)%3,k=An.intersectWithLine(y[A],y[I],r,l);k.intersection&&k.t>0-i&&k.t<1+i&&(k.t<1+i&&k.t>1-i&&(F=M),L[M++]=ee(k.x,R)-ee(C,R));const Y=An.intersectWithLine(S[A],S[I],t,f);Y.intersection&&Y.t>0-i&&Y.t<1+i&&(Y.t<1+i&&Y.t>1-i&&(B=m),V[m++]=ee(Y.x,R)-ee(C,R))}if(M>2){M--;const z=L[2];L[2]=L[F],L[F]=z}if(m>2){m--;const z=V[2];V[2]=V[B],V[B]=z}if(M!==2||m!==2)return{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g};if(Number.isNaN(L[0])||Number.isNaN(L[1])||Number.isNaN(V[0])||Number.isNaN(V[1]))return{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g};if(L[0]>L[1]){const z=L[1];L[1]=L[0],L[0]=z}if(V[0]>V[1]){const z=V[1];V[1]=V[0],V[0]=z}let _,P;return L[1]<V[0]||V[1]<L[0]?{intersect:!1,coplanar:o,pt1:c,pt2:u,surfaceId:g}:(L[0]<V[0]?L[1]<V[1]?(g[0]=2,g[1]=1,_=V[0],P=L[1]):(g[0]=2,g[1]=2,_=V[0],P=V[1]):L[1]<V[1]?(g[0]=1,g[1]=1,_=L[0],P=L[1]):(g[0]=1,g[1]=2,_=L[0],P=V[1]),Ko(C,R,_,c),Ko(C,R,P,u),{intersect:!0,coplanar:o,pt1:c,pt2:u,surfaceId:g})}const XR={computeNormalDirection:df,computeNormal:$a,interpolationDerivs:Wp,intersectWithTriangle:PR};function IR(t,e){e.classHierarchy.push("vtkTriangle"),t.getCellDimension=()=>2,t.intersectWithLine=(n,r,a,s,i)=>{const o={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};i[2]=0;const c=[],u=a*a,g=[],f=[],l=[];e.points.getPoint(0,g),e.points.getPoint(1,f),e.points.getPoint(2,l);const h=[],v=[];if($a(g,f,l,h),h[0]!==0||h[1]!==0||h[2]!==0){const x=An.intersectWithLine(n,r,g,h);if(o.betweenPoints=x.betweenPoints,o.t=x.t,s[0]=x.x[0],s[1]=x.x[1],s[2]=x.x[2],!x.intersection)return i[0]=0,i[1]=0,o.intersect=0,o;const T=t.evaluatePosition(s,c,i,v);if(T.evaluation>=0)return T.dist2<=u?(o.intersect=1,o):(o.intersect=T.evaluation,o)}const p=Tt(g,f),d=Tt(f,l),y=Tt(l,g);e.line||(e.line=et.newInstance()),p>d&&p>y?(e.line.getPoints().setPoint(0,g),e.line.getPoints().setPoint(1,f)):d>y&&d>p?(e.line.getPoints().setPoint(0,f),e.line.getPoints().setPoint(1,l)):(e.line.getPoints().setPoint(0,l),e.line.getPoints().setPoint(1,g));const S=e.line.intersectWithLine(n,r,a,s,i);if(o.betweenPoints=S.betweenPoints,o.t=S.t,S.intersect){const x=[],T=[],w=[];for(let C=0;C<3;C++)x[C]=g[C]-l[C],T[C]=f[C]-l[C],w[C]=s[C]-l[C];return i[0]=ee(w,x)/y,i[1]=ee(w,T)/d,o.intersect=1,o}return i[0]=0,i[1]=0,o.intersect=0,o},t.evaluatePosition=(n,r,a,s)=>{const i={subId:0,dist2:0,evaluation:-1};let o,c;const u=[],g=[],f=[],l=[];let h;const v=[],p=[],d=[];let y=0,S=0;const x=[];let T,w,C,R=[];const M=[],m=[],L=[];i.subId=0,a[2]=0,e.points.getPoint(1,u),e.points.getPoint(2,g),e.points.getPoint(0,f),df(u,g,f,l),An.generalizedProjectPoint(n,u,l,L);let V=0;for(o=0;o<3;o++)l[o]<0?h=-l[o]:h=l[o],h>V&&(V=h,S=o);for(c=0,o=0;o<3;o++)o!==S&&(x[c++]=o);for(o=0;o<2;o++)v[o]=L[x[o]]-f[x[o]],p[o]=u[x[o]]-f[x[o]],d[o]=g[x[o]]-f[x[o]];if(y=Ve(p,d),y===0)return a[0]=0,a[1]=0,i.evaluation=-1,i;if(a[0]=Ve(v,d)/y,a[1]=Ve(p,v)/y,s[0]=1-(a[0]+a[1]),s[1]=a[0],s[2]=a[1],s[0]>=0&&s[0]<=1&&s[1]>=0&&s[1]<=1&&s[2]>=0&&s[2]<=1)r&&(i.dist2=Tt(L,n),r[0]=L[0],r[1]=L[1],r[2]=L[2]),i.evaluation=1;else{let F;if(r){if(s[1]<0&&s[2]<0)for(T=Tt(n,f),w=et.distanceToLine(n,u,f,F,M),C=et.distanceToLine(n,f,g,F,m),T<w?(i.dist2=T,R=f):(i.dist2=w,R=M),C<i.dist2&&(i.dist2=C,R=m),o=0;o<3;o++)r[o]=R[o];else if(s[2]<0&&s[0]<0)for(T=Tt(n,u),w=et.distanceToLine(n,u,f,F,M),C=et.distanceToLine(n,u,g,F,m),T<w?(i.dist2=T,R=u):(i.dist2=w,R=M),C<i.dist2&&(i.dist2=C,R=m),o=0;o<3;o++)r[o]=R[o];else if(s[1]<0&&s[0]<0)for(T=Tt(n,g),w=et.distanceToLine(n,g,f,F,M),C=et.distanceToLine(n,u,g,F,m),T<w?(i.dist2=T,R=g):(i.dist2=w,R=M),C<i.dist2&&(i.dist2=C,R=m),o=0;o<3;o++)r[o]=R[o];else if(s[0]<0){const B=et.distanceToLine(n,u,g,r);i.dist2=B.distance}else if(s[1]<0){const B=et.distanceToLine(n,g,f,r);i.dist2=B.distance}else if(s[2]<0){const B=et.distanceToLine(n,u,f,r);i.dist2=B.distance}}i.evaluation=0}return i},t.evaluateLocation=(n,r,a)=>{const s=[],i=[],o=[];e.points.getPoint(0,s),e.points.getPoint(1,i),e.points.getPoint(2,o);const c=1-n[0]-n[1];for(let u=0;u<3;u++)r[u]=s[u]*c+i[u]*n[0]+o[u]*n[1];a[0]=c,a[1]=n[0],a[2]=n[1]},t.getParametricDistance=n=>{let r,a=0;const s=[];s[0]=n[0],s[1]=n[1],s[2]=1-n[0]-n[1];for(let i=0;i<3;i++)s[i]<0?r=-s[i]:s[i]>1?r=s[i]-1:r=0,r>a&&(a=r);return a},t.derivatives=(n,r,a,s,i)=>{const o=e.points.getPoint(0),c=e.points.getPoint(1),u=e.points.getPoint(2),g=[],f=[],l=[],h=[];$a(o,c,u,g),ze(c,o,f),ze(u,o,h),gt(g,f,l);const v=Rt(f);if(v<=0||Rt(l)<=0){for(let w=0;w<s;w++)for(let C=0;C<3;C++)i[w*s+C]=0;return}const p=[0,0],d=[v,0],y=[ee(h,f),ee(h,l)],S=new Array(6);Wp(S);const x=[d[0]-p[0],d[1]-p[1],y[0]-p[0],y[1]-p[1]],T=E.newTypedArray(Ze.Float64Array,4);ef(x,T,2);for(let w=0;w<s;w++){let C=0,R=0;for(let L=0;L<3;L++)C+=S[L]*a[s*L+w],R+=S[3+L]*a[s*L+w];const M=C*T[0]+R*T[1],m=C*T[2]+R*T[3];i[3*w]=M*f[0]+m*l[0],i[3*w+1]=M*f[1]+m*l[1],i[3*w+2]=M*f[2]+m*l[2]}},t.cellBoundary=(n,r,a)=>{const s=r[0]-r[1],i=.5*(1-r[0])-r[1],o=2*r[0]+r[1]-1;return s>=0&&i>=0?(a[0]=e.pointsIds[0],a[1]=e.pointsIds[1]):i<0&&o>=0?(a[0]=e.pointsIds[1],a[1]=e.pointsIds[2]):(a[0]=e.pointsIds[2],a[1]=e.pointsIds[0]),!(r[0]<0||r[1]<0||r[0]>1||r[1]>1||1-r[0]-r[1]<0)}}const YR={};function zp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,YR,n),yr.extend(t,e,n),IR(t,e)}const qR=E.newInstance(zp,"vtkTriangle");var vf={newInstance:qR,extend:zp,...XR};function dg(){return{intersected:!1,subId:-1,x:[0,0,0],pCoords:[0,0,0],t:-1}}function QR(t,e){e.classHierarchy.push("vtkQuad"),t.getCellDimension=()=>2,t.getCellType=()=>pe.VTK_QUAD,t.getNumberOfEdges=()=>4,t.getNumberOfFaces=()=>0,t.intersectWithLine=(n,r,a,s,i)=>{let o={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1},c;const u=e.points.getPoint(0,[]),g=e.points.getPoint(1,[]),f=e.points.getPoint(2,[]),l=e.points.getPoint(3,[]),h=Tt(u,f),v=Tt(g,l);if(h===v){let C,R=0,M=0;for(let m=0;m<4;m++)C=e.pointsIds[m],C>R&&(R=C,M=m);M===0||M===2?c=0:c=1}else h<v?c=0:c=1;let p=null;e.triangle?p=e.triangle.getPoints():(e.triangle=vf.newInstance(),p=ba.newInstance(),p.setNumberOfPoints(3),e.triangle.initialize(p));let d;const y=dg();let S;const x=dg();let T,w;switch(c){case 0:p.setPoint(0,...u),p.setPoint(1,...g),p.setPoint(2,...f),d=e.triangle.intersectWithLine(n,r,a,y.x,y.pCoords),p.setPoint(0,...f),p.setPoint(1,...l),p.setPoint(2,...u),S=e.triangle.intersectWithLine(n,r,a,x.x,x.pCoords),T=d.intersect&&S.intersect?d.t<=S.t:d.intersect,w=d.intersect&&S.intersect?S.t<d.t:S.intersect,T?(o=d,s[0]=y.x[0],s[1]=y.x[1],s[2]=y.x[2],i[0]=y.pCoords[0]+y.pCoords[1],i[1]=y.pCoords[1],i[2]=y.pCoords[2]):w&&(o=S,s[0]=x.x[0],s[1]=x.x[1],s[2]=x.x[2],i[0]=1-(x.pCoords[0]+x.pCoords[1]),i[1]=1-x.pCoords[1],i[2]=x.pCoords[2]);break;case 1:p.setPoint(0,...u),p.setPoint(1,...g),p.setPoint(2,...l),d=e.triangle.intersectWithLine(n,r,a,y.x,y.pCoords),p.setPoint(0,...f),p.setPoint(1,...l),p.setPoint(2,...g),S=e.triangle.intersectWithLine(n,r,a,x.x,x.pCoords),T=d.intersect&&S.intersect?d.t<=S.t:d.intersect,w=d.intersect&&S.intersect?S.t<d.t:S.intersect,T?(o=d,s[0]=y.x[0],s[1]=y.x[1],s[2]=y.x[2],i[0]=y.pCoords[0],i[1]=y.pCoords[1],i[2]=y.pCoords[2]):w&&(o=S,s[0]=x.x[0],s[1]=x.x[1],s[2]=x.x[2],i[0]=1-x.pCoords[0],i[1]=1-x.pCoords[1],i[2]=x.pCoords[2]);break}return o},t.interpolationFunctions=(n,r)=>{const a=1-n[0],s=1-n[1];r[0]=a*s,r[1]=n[0]*s,r[2]=n[0]*n[1],r[3]=a*n[1]},t.evaluateLocation=(n,r,a)=>{const s=[];t.interpolationFunctions(n,a),r[0]=0,r[1]=0,r[2]=0;for(let i=0;i<4;i++){e.points.getPoint(i,s);for(let o=0;o<3;o++)r[o]+=s[o]*a[i]}}}const ZR={};function Hp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZR,n),yr.extend(t,e,n),QR(t,e)}const JR=E.newInstance(Hp,"vtkQuad");var eM={newInstance:JR,extend:Hp};const{vtkErrorMacro:Ap}=E;function vg(t){return()=>Ap(`vtkTriangleStrip.${t} - NOT IMPLEMENTED`)}function tM(t,e){if(!Array.isArray(t)||t.length<3){Ap("decomposeStrip - Invalid points array");return}let n=t[0],r=t[1];for(let a=0;a<t.length-2;a++){const s=t[a+2];a%2?e.insertNextCell([r,n,s]):e.insertNextCell([n,r,s]),n=r,r=s}}const nM={decomposeStrip:tM};function rM(t,e){e.classHierarchy.push("vtkTriangleStrip");const n=t.initialize;t.initialize=(r,a)=>{e.triangle.initialize(r,a),n(r,a)},t.getCellType=()=>pe.VTK_TRIANGLE_STRIP,t.getCellDimension=()=>2,t.getNumberOfEdges=()=>e.pointsIds.length,t.getNumberOfFaces=()=>0,t.evaluatePosition=(r,a,s,i,o)=>{const c=[0,0,0];let u=Number.MAX_VALUE,g=0;const f=[],l=[],h=[];s[2]=0,l[0]=0,l[1]=0,l[2]=0;const v=e.triangle.getPoints();v.setNumberOfPoints(3);const d=e.triangle.getPointsIds().length;for(let y=0;y<d;y++)o[y]=0;for(let y=0;y<d-2;y++){const S=[];v.getPoint(y,S);const x=[];v.getPoint(y+1,x);const T=[];v.getPoint(y+2,T),v.setData(Float32Array.from([...S,...x,...T]),3);const w=e.triangle.evaluatePosition(r,h,c,f),C=w.dist2;w.evaluation>=0&&(C<u||C===u&&g===0)&&(g=w,a&&(a[0]=h[0],a[1]=h[1],a[2]=h[2]),s[0]=c[0],s[1]=c[1],u=C,l[0]=f[0],l[1]=f[1],l[2]=f[2])}return i[0]=u,o[0]=l[0],o[1]=l[1],o[2]=l[2],g},t.evaluateLocation=(r,a,s,i)=>{const o=[[0,1,2],[1,0,2]],c=r%2,u=e.pointsIds.length;for(let v=0;v<u;v++)i[v]=0;const g=1-a[0]-a[1];i[r]=g,i[r+1]=a[0],i[r+2]=a[1];const f=[];e.points.getPoint(r+o[c][0],f);const l=[];e.points.getPoint(r+o[c][1],l);const h=[];e.points.getPoint(r+o[c][2],h);for(let v=0;v<3;v++)s[v]=f[v]*i[r]+l[v]*i[r+1]+h[v]*i[r+2]},t.cellBoundary=(r,a,s)=>{const i=[[0,1,2],[1,0,2]],o=r%2,c=e.triangle.getPointsIds();return c[0]=e.pointsIds[i[o][0]],c[1]=e.pointsIds[i[o][1]],c[2]=e.pointsIds[i[o][2]],e.triangle.cellBoundary(0,a,s)},t.getEdge=r=>{let a,s;const i=e.pointsIds.length;return r===0?(a=0,s=1):r===i-1?(a=r-1,s=r):(a=r-1,s=r+1),e.line.getPointsIds()[0]=e.pointsIds[a],e.line.getPointsIds()[1]=e.pointsIds[s],e.line.getPoints().setPoint(0,e.points.getPoint(a)),e.line.getPoints().setPoint(1,e.points.getPoint(s)),e.line},t.intersectWithLine=(r,a,s,i,o)=>{const c=e.pointsIds.length-2,u=e.triangle.getPoints();u.setNumberOfPoints(3);for(let g=0;g<c;g++){const f=[];e.points.getPoint(e.pointsIds[g],f);const l=[];e.points.getPoint(e.pointsIds[g+1],l);const h=[];e.points.getPoint(e.pointsIds[g+2],h),u.setData(Float32Array.from([...f,...l,...h]),3);const v=e.triangle.intersectWithLine(r,a,s,i,o);if(v.intersect)return v}return!1},t.triangulate=()=>{const r=e.points.getNumberOfPoints()-2;e.tris=new Array(3*r);const a=[[0,1,2],[1,0,2]];for(let s=0;s<r;s++){const i=s%2;for(let o=0;o<3;o++)e.tris[s*3+o]=s+a[i][o]}return!0},t.getPointArray=()=>e.tris,t.derivatives=(r,a,s,i,o)=>{const c=[];e.points.getPoint(r,c);const u=[];e.points.getPoint(r+1,u);const g=[];e.points.getPoint(r+2,g);const f=e.triangle.getPoints();f.setPoint(0,...c),f.setPoint(1,...u),f.setPoint(2,...g),e.triangle.derivatives(0,a,s,i,o)},t.getParametricCenter=r=>(r[0]=.333333,r[1]=.333333,r[2]=0,Math.floor((e.pointsIds.length-2)/2)),t.contour=(r,a,s,i,o,c,u,g,f,l,h)=>vg("contour")(),t.clip=(r,a,s,i,o,c,u,g,f,l)=>vg("clip")()}const aM={line:null,triangle:null,tris:null};function jp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aM,n),yr.extend(t,e,n),e.line||(e.line=et.newInstance()),e.triangle||(e.triangle=vf.newInstance()),rM(t,e)}const sM=E.newInstance(jp,"vtkTriangleStrip");var iM={newInstance:sM,extend:jp,...nM};const Er=["verts","lines","polys","strips"],{vtkWarningMacro:yg}=E,oM={[pe.VTK_LINE]:et,[pe.VTK_QUAD]:eM,[pe.VTK_POLY_LINE]:et,[pe.VTK_TRIANGLE]:vf,[pe.VTK_TRIANGLE_STRIP]:iM,[pe.VTK_POLY_LINE]:FR,[pe.VTK_POLYGON]:KR};function cM(t,e){e.classHierarchy.push("vtkPolyData");function n(o){return o.replace(/(?:^\w|[A-Z]|\b\w)/g,c=>c.toUpperCase()).replace(/\s+/g,"")}function r(){e.cells=void 0,e.links=void 0}Er.forEach(o=>{t[`getNumberOf${n(o)}`]=()=>e[o].getNumberOfCells(),e[o]?e[o]=Gt(e[o]):e[o]=lg.newInstance(),e[`_on${n(o)}Changed`]=r}),t.getNumberOfCells=()=>Er.reduce((o,c)=>o+e[c].getNumberOfCells(),0);const a=t.shallowCopy;t.shallowCopy=function(o){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;a(o,c),Er.forEach(u=>{e[u]=lg.newInstance(),e[u].shallowCopy(o.getReferenceByName(u))})};const s=t.getMTime;t.getMTime=()=>Er.reduce((o,c)=>Math.max(o,e[c]?.getMTime()??o),s());const i=t.initialize;t.initialize=()=>(Er.forEach(o=>e[o]?.initialize()),r(),i()),t.buildCells=()=>{const o=t.getNumberOfVerts(),c=t.getNumberOfLines(),u=t.getNumberOfPolys(),g=t.getNumberOfStrips(),f=o+c+u+g,l=new Uint8Array(f);let h=l;const v=new Uint32Array(f);let p=v;if(o){let d=0;e.verts.getCellSizes().forEach((y,S)=>{p[S]=d,h[S]=y>1?pe.VTK_POLY_VERTEX:pe.VTK_VERTEX,d+=y+1}),p=p.subarray(o),h=h.subarray(o)}if(c){let d=0;e.lines.getCellSizes().forEach((y,S)=>{p[S]=d,h[S]=y>2?pe.VTK_POLY_LINE:pe.VTK_LINE,y===1&&yg("Building VTK_LINE ",S," with only one point, but VTK_LINE needs at least two points. Check the input."),d+=y+1}),p=p.subarray(c),h=h.subarray(c)}if(u){let d=0;e.polys.getCellSizes().forEach((y,S)=>{switch(p[S]=d,y){case 3:h[S]=pe.VTK_TRIANGLE;break;case 4:h[S]=pe.VTK_QUAD;break;default:h[S]=pe.VTK_POLYGON;break}y<3&&yg("Building VTK_TRIANGLE ",S," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),d+=y+1}),p+=p.subarray(u),h+=h.subarray(u)}if(g){let d=0;h.fill(pe.VTK_TRIANGLE_STRIP,0,g),e.strips.getCellSizes().forEach((y,S)=>{p[S]=d,d+=y+1})}e.cells=xR.newInstance(),e.cells.setCellTypes(f,l,v)},t.buildLinks=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;e.cells==null&&t.buildCells(),e.links=uR.newInstance(),o>0?e.links.allocate(o):e.links.allocate(t.getPoints().getNumberOfPoints()),e.links.buildLinks(t)},t.getCellType=o=>e.cells.getCellType(o),t.getCellPoints=o=>{const c=t.getCellType(o);let u=null;switch(c){case pe.VTK_VERTEX:case pe.VTK_POLY_VERTEX:u=e.verts;break;case pe.VTK_LINE:case pe.VTK_POLY_LINE:u=e.lines;break;case pe.VTK_TRIANGLE:case pe.VTK_QUAD:case pe.VTK_POLYGON:u=e.polys;break;case pe.VTK_TRIANGLE_STRIP:u=e.strips;break;default:return u=null,{type:0,cellPointIds:null}}const g=e.cells.getCellLocation(o),f=u.getCell(g);return{cellType:c,cellPointIds:f}},t.getPointCells=o=>e.links.getCells(o),t.getCellEdgeNeighbors=(o,c,u)=>{const g=e.links.getLink(c),f=e.links.getLink(u);return g.cells.filter(l=>l!==o&&f.cells.indexOf(l)!==-1)},t.getCell=function(o){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const u=t.getCellPoints(o),g=c||oM[u.cellType].newInstance();return g.initialize(t.getPoints(),u.cellPointIds),g},t.getMaxCellSize=()=>Er.reduce((o,c)=>Math.max(o,e[c]?.getMaxCellSize?.()??0),0)}const fM={};function Kp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fM,n),DR.extend(t,e,n),E.get(t,e,["cells","links"]),E.setGet(t,e,["verts","lines","polys","strips"]),cM(t,e)}const uM=E.newInstance(Kp,"vtkPolyData");var Tr={newInstance:uM,extend:Kp};function gM(t,e){e.classHierarchy.push("vtkTexture"),t.imageLoaded=()=>{e.image.removeEventListener("load",t.imageLoaded),e.imageLoaded=!0,t.modified()},t.setJsImageData=n=>{e.jsImageData!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null,e.imageBitmap=null),e.jsImageData=n,e.imageLoaded=!0,t.modified())},t.setImageBitmap=n=>{e.imageBitmap!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null,e.jsImageData=null),e.imageBitmap=n,e.imageLoaded=!0,t.modified())},t.setCanvas=n=>{e.canvas!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.imageBitmap=null,e.jsImageData=null),e.canvas=n,t.modified())},t.setImage=n=>{e.image!==n&&(n!==null&&(t.setInputData(null),t.setInputConnection(null),e.canvas=null,e.jsImageData=null,e.imageBitmap=null),e.image=n,e.imageLoaded=!1,n.complete?t.imageLoaded():n.addEventListener("load",t.imageLoaded),t.modified())},t.getDimensionality=()=>{let n=0,r=0,a=1;if(t.getInputData()){const i=t.getInputData();n=i.getDimensions()[0],r=i.getDimensions()[1],a=i.getDimensions()[2]}return e.jsImageData&&(n=e.jsImageData.width,r=e.jsImageData.height),e.canvas&&(n=e.canvas.width,r=e.canvas.height),e.image&&(n=e.image.width,r=e.image.height),e.imageBitmap&&(n=e.imageBitmap.width,r=e.imageBitmap.height),(n>1)+(r>1)+(a>1)},t.getInputAsJsImageData=()=>{if(!e.imageLoaded||t.getInputData())return null;if(e.jsImageData)return e.jsImageData;if(e.imageBitmap)return e.imageBitmap;if(e.canvas)return e.canvas.getContext("2d").getImageData(0,0,e.canvas.width,e.canvas.height);if(e.image){const n=e.image.width,r=e.image.height,s=new OffscreenCanvas(n,r).getContext("2d");return s.translate(0,r),s.scale(1,-1),s.drawImage(e.image,0,0,n,r),s.getImageData(0,0,n,r)}return null}}const lM=(t,e,n)=>{const a=t.createShaderModule({code:`
    @group(0) @binding(0) var inputTexture: texture_2d<f32>;
    @group(0) @binding(1) var outputTexture: texture_storage_2d<rgba8unorm, write>;

    @compute @workgroup_size(8, 8)
    fn main(@builtin(global_invocation_id) global_id: vec3<u32>) {
      let texelCoord = vec2<i32>(global_id.xy);
      let outputSize = textureDimensions(outputTexture);

      if (texelCoord.x >= i32(outputSize.x) || texelCoord.y >= i32(outputSize.y)) {
        return;
      }

      let inputSize = textureDimensions(inputTexture);
      let scale = vec2<f32>(inputSize) / vec2<f32>(outputSize);

      // Compute the floating-point source coordinate
      let srcCoord = (vec2<f32>(texelCoord) + 0.5) * scale - 0.5;

      // Get integer coordinates for the four surrounding texels
      let x0 = i32(floor(srcCoord.x));
      let x1 = min(x0 + 1, i32(inputSize.x) - 1);
      let y0 = i32(floor(srcCoord.y));
      let y1 = min(y0 + 1, i32(inputSize.y) - 1);

      // Compute the weights
      let wx = srcCoord.x - f32(x0);
      let wy = srcCoord.y - f32(y0);

      // Fetch the four texels
      let c00 = textureLoad(inputTexture, vec2<i32>(x0, y0), 0);
      let c10 = textureLoad(inputTexture, vec2<i32>(x1, y0), 0);
      let c01 = textureLoad(inputTexture, vec2<i32>(x0, y1), 0);
      let c11 = textureLoad(inputTexture, vec2<i32>(x1, y1), 0);

      // Bilinear interpolation
      let color = mix(
        mix(c00, c10, wx),
        mix(c01, c11, wx),
        wy
      );

      textureStore(outputTexture, texelCoord, color);
    }
  `}),s=t.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,texture:{sampleType:"float"}},{binding:1,visibility:GPUShaderStage.COMPUTE,storageTexture:{format:"rgba8unorm",access:"write-only"}},{binding:2,visibility:GPUShaderStage.COMPUTE,sampler:{type:"filtering"}}]}),i=t.createPipelineLayout({bindGroupLayouts:[s]}),o=t.createComputePipeline({label:"ComputeMipmapPipeline",layout:i,compute:{module:a,entryPoint:"main"}}),c=t.createSampler({magFilter:"linear",minFilter:"linear"});for(let u=1;u<n;u++){const g=e.createView({baseMipLevel:u-1,mipLevelCount:1}),f=e.createView({baseMipLevel:u,mipLevelCount:1}),l=t.createBindGroup({layout:o.getBindGroupLayout(0),entries:[{binding:0,resource:g},{binding:1,resource:f},{binding:2,resource:c}]}),h=t.createCommandEncoder({label:"MipmapGenerateCommandEncoder"}),v=h.beginComputePass();v.setPipeline(o),v.setBindGroup(0,l);const p=Math.max(1,e.width>>u),d=Math.max(1,e.height>>u),y=Math.ceil(p/8),S=Math.ceil(d/8);v.dispatchWorkgroups(y,S),v.end(),t.queue.submit([h.finish()])}},hM={image:null,canvas:null,jsImageData:null,imageBitmap:null,imageLoaded:!1,repeat:!1,interpolate:!1,edgeClamp:!1,mipLevel:0,resizable:!1};function Pp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hM,n),E.obj(t,e),E.algo(t,e,6,0),E.get(t,e,["canvas","image","jsImageData","imageBitmap","imageLoaded","resizable"]),E.setGet(t,e,["repeat","edgeClamp","interpolate","mipLevel"]),gM(t,e)}const pM=E.newInstance(Pp,"vtkTexture"),dM={generateMipmaps:lM};var Wa={newInstance:pM,extend:Pp,...dM};const vM=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],Tg=[[8,7,11,3],[9,1,10,5],[4,9,0,8],[2,11,6,10],[0,3,2,1],[4,5,6,7]],gs=[[0,1],[1,3],[2,3],[0,2],[4,5],[5,7],[6,7],[4,6],[0,4],[1,5],[3,7],[2,6]],xg=[0,1,0,1,0,1,0,1,2,2,2,2],Le=[[1,2],[1,2],[0,2],[0,2],[0,1],[0,1]],re=new Float64Array(3),ls=new Float64Array(3),de=new Float64Array(3),or=new Float64Array(3),Qn=new Float64Array(3),hs=new Float64Array(3),oo=new Float64Array(16);function co(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font=`${e.fontStyle} ${e.fontSize}px ${e.fontFamily}`}function Xp(t){const e=[],n=[];for(let r=0;r<3;r++){const a=Yc().domain([t[r*2],t[r*2+1]]);e[r]=a.ticks(5);const s=a.tickFormat(5);n[r]=e[r].map(s)}return{ticks:e,tickStrings:n}}function yM(t,e){e.classHierarchy.push("vtkCubeAxesActorHelper"),t.setRenderable=n=>{e.renderable!==n&&(e.renderable=n,e.tmActor.addTexture(e.renderable.getTmTexture()),e.tmActor.setProperty(n.getProperty()),e.tmActor.setParentProp(n),t.modified())},t.createPolyDataForOneLabel=(n,r,a,s,i,o,c)=>{const u=e.renderable.get_tmAtlas().get(n);if(!u)return;const g=e.renderable.getTextPolyData().getPoints().getData(),f=e.lastSize;re[0]=g[r*3],re[1]=g[r*3+1],re[2]=g[r*3+2],Te(de,re,a),de[0]+=.1,Te(ls,de,s),kn(Qn,ls,re),de[0]-=.1,de[1]+=.1,Te(ls,de,s),kn(hs,ls,re);for(let v=0;v<3;v++)Qn[v]/=.5*.1*f[0],hs[v]/=.5*.1*f[1];let l=c.ptIdx,h=c.cellIdx;re[0]=g[r*3],re[1]=g[r*3+1],re[2]=g[r*3+2],i[0]<-.5?Dn(de,Qn,i[0]*o-u.width):i[0]>.5?Dn(de,Qn,i[0]*o):Dn(de,Qn,i[0]*o-u.width/2),ca(re,re,de),Dn(de,hs,i[1]*o-u.height/2),ca(re,re,de),c.points[l*3]=re[0],c.points[l*3+1]=re[1],c.points[l*3+2]=re[2],c.tcoords[l*2]=u.tcoords[0],c.tcoords[l*2+1]=u.tcoords[1],l++,Dn(de,Qn,u.width),ca(re,re,de),c.points[l*3]=re[0],c.points[l*3+1]=re[1],c.points[l*3+2]=re[2],c.tcoords[l*2]=u.tcoords[2],c.tcoords[l*2+1]=u.tcoords[3],l++,Dn(de,hs,u.height),ca(re,re,de),c.points[l*3]=re[0],c.points[l*3+1]=re[1],c.points[l*3+2]=re[2],c.tcoords[l*2]=u.tcoords[4],c.tcoords[l*2+1]=u.tcoords[5],l++,Dn(de,Qn,u.width),kn(re,re,de),c.points[l*3]=re[0],c.points[l*3+1]=re[1],c.points[l*3+2]=re[2],c.tcoords[l*2]=u.tcoords[6],c.tcoords[l*2+1]=u.tcoords[7],l++,c.polys[h*4]=3,c.polys[h*4+1]=l-4,c.polys[h*4+2]=l-3,c.polys[h*4+3]=l-2,h++,c.polys[h*4]=3,c.polys[h*4+1]=l-4,c.polys[h*4+2]=l-2,c.polys[h*4+3]=l-1,c.ptIdx+=4,c.cellIdx+=2},t.updateTexturePolyData=()=>{const n=e.camera.getCompositeProjectionMatrix(e.lastAspectRatio,-1,1);Oe(n,n);const r=e.renderable.getTextValues().length,a=r*4,s=r*2,i=new Float64Array(a*3),o=new Uint16Array(s*4),c=new Float32Array(a*2);ut(oo,n);const u={ptIdx:0,cellIdx:0,polys:o,points:i,tcoords:c};let g=0,f=0,l=0;const h=e.renderable.getTextPolyData().getPoints().getData(),v=e.renderable.getTextValues();for(;g<h.length/3;){re[0]=h[g*3],re[1]=h[g*3+1],re[2]=h[g*3+2],Te(de,re,n),re[0]=h[g*3+3],re[1]=h[g*3+4],re[2]=h[g*3+5],Te(or,re,n),kn(de,de,or);const d=[de[0],de[1]];uh(d),t.createPolyDataForOneLabel(v[f],g,n,oo,d,e.renderable.getAxisTitlePixelOffset(),u),g+=2,f++;for(let y=0;y<e.renderable.getTickCounts()[l];y++)t.createPolyDataForOneLabel(v[f],g,n,oo,d,e.renderable.getTickLabelPixelOffset(),u),g++,f++;l++}const p=De.newInstance({numberOfComponents:2,values:c,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(p),e.tmPolyData.getPoints().setData(i,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(o,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updateAPISpecificData=(n,r,a)=>{(e.lastSize[0]!==n[0]||e.lastSize[1]!==n[1])&&(e.lastSize[0]=n[0],e.lastSize[1]=n[1],e.lastAspectRatio=n[0]/n[1],e.forceUpdate=!0),e.camera=r,t.updateTexturePolyData()}}const TM=E.newInstance(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},n),E.obj(t,e),e.tmPolyData=Tr.newInstance(),e.tmMapper=vr.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmActor=dr.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),E.setGet(t,e,["renderable"]),E.get(t,e,["lastSize","lastAspectRatio","axisTextStyle","tickTextStyle","tmActor","ticks"]),e.forceUpdate=!1,e.lastRedrawTime={},E.obj(e.lastRedrawTime,{mtime:0}),e.lastRebuildTime={},E.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.lastTickBounds=[],yM(t,e)},"vtkCubeAxesActorHelper");function xM(t,e){e.classHierarchy.push("vtkCubeAxesActor"),t.setCamera=r=>{e.camera!==r&&(e.cameraModifiedSub&&(e.cameraModifiedSub.unsubscribe(),e.cameraModifiedSub=null),e.camera=r,r&&(e.cameraModifiedSub=r.onModified(t.update)),t.update(),t.modified())},t.computeFacesToDraw=()=>{const r=e.camera.getViewMatrix();Oe(r,r);let a=!1;const s=he.getDiagonalLength(e.dataBounds),i=Math.sin(e.faceVisibilityAngle*Math.PI/180);for(let o=0;o<6;o++){let c=!1;const u=Math.floor(o/2),g=(u+1)%3,f=(u+2)%3;e.dataBounds[g*2]!==e.dataBounds[g*2+1]&&e.dataBounds[f*2]!==e.dataBounds[f*2+1]&&(re[u]=e.dataBounds[o]-.1*s*vM[o][u],re[g]=.5*(e.dataBounds[g*2]+e.dataBounds[g*2+1]),re[f]=.5*(e.dataBounds[f*2]+e.dataBounds[f*2+1]),Te(de,re,r),re[u]=e.dataBounds[o],Te(or,re,r),kn(de,or,de),$n(de,de),c=de[2]>i,e.camera.getParallelProjection()||($n(or,or),c=kc(or,de)>i)),c!==e.lastFacesToDraw[o]&&(e.lastFacesToDraw[o]=c,a=!0)}return a},t.updatePolyData=(r,a,s)=>{let i=0,o=0;i+=8;let c=0;for(let h=0;h<12;h++)a[h]>0&&c++;if(o+=c,e.gridLines)for(let h=0;h<6;h++)r[h]&&(i+=s[Le[h][0]].length*2+s[Le[h][1]].length*2,o+=s[Le[h][0]].length+s[Le[h][1]].length);const u=new Float64Array(i*3),g=new Uint32Array(o*3);let f=0,l=0;for(let h=0;h<2;h++)for(let v=0;v<2;v++)for(let p=0;p<2;p++)u[f*3]=e.dataBounds[p],u[f*3+1]=e.dataBounds[2+v],u[f*3+2]=e.dataBounds[4+h],f++;for(let h=0;h<12;h++)a[h]>0&&(g[l*3]=2,g[l*3+1]=gs[h][0],g[l*3+2]=gs[h][1],l++);if(e.gridLines){for(let h=0;h<6;h++)if(r[h]){const v=Math.floor(h/2);let p=s[Le[h][0]];for(let d=0;d<p.length;d++)u[f*3+v]=e.dataBounds[h],u[f*3+Le[h][0]]=p[d],u[f*3+Le[h][1]]=e.dataBounds[Le[h][1]*2],f++,u[f*3+v]=e.dataBounds[h],u[f*3+Le[h][0]]=p[d],u[f*3+Le[h][1]]=e.dataBounds[Le[h][1]*2+1],f++,g[l*3]=2,g[l*3+1]=f-2,g[l*3+2]=f-1,l++;p=s[Le[h][1]];for(let d=0;d<p.length;d++)u[f*3+v]=e.dataBounds[h],u[f*3+Le[h][1]]=p[d],u[f*3+Le[h][0]]=e.dataBounds[Le[h][0]*2],f++,u[f*3+v]=e.dataBounds[h],u[f*3+Le[h][1]]=p[d],u[f*3+Le[h][0]]=e.dataBounds[Le[h][0]*2+1],f++,g[l*3]=2,g[l*3+1]=f-2,g[l*3+2]=f-1,l++}}e.polyData.getPoints().setData(u,3),e.polyData.getPoints().modified(),e.polyData.getLines().setData(g,1),e.polyData.getLines().modified(),e.polyData.modified()},t.updateTextData=(r,a,s,i)=>{let o=0;for(let h=0;h<12;h++)a[h]===1&&(o+=2,o+=s[xg[h]].length);const c=e.polyData.getPoints().getData(),u=new Float64Array(o*3);let g=0,f=0,l=0;for(let h=0;h<6;h++)if(r[h])for(let v=0;v<4;v++){const p=Tg[h][v];if(a[p]===1){const d=xg[p],y=gs[p][0]*3,S=gs[p][1]*3;u[g*3]=.5*(c[y]+c[S]),u[g*3+1]=.5*(c[y+1]+c[S+1]),u[g*3+2]=.5*(c[y+2]+c[S+2]),g++;const x=Math.floor(h/2);u[g*3+x]=e.dataBounds[h],u[g*3+Le[h][0]]=.5*(e.dataBounds[Le[h][0]*2]+e.dataBounds[Le[h][0]*2+1]),u[g*3+Le[h][1]]=.5*(e.dataBounds[Le[h][1]*2]+e.dataBounds[Le[h][1]*2+1]),g++,e.textValues[f]=e.axisLabels[d],f++;const T=(d+1)%3,w=(d+2)%3,C=s[d],R=i[d];e.tickCounts[l]=C.length;for(let M=0;M<C.length;M++)u[g*3+d]=C[M],u[g*3+T]=c[y+T],u[g*3+w]=c[y+w],g++,e.textValues[f]=R[M],f++;l++}}e.textPolyData.getPoints().setData(u,3),e.textPolyData.modified()},t.update=()=>{if(!e.camera)return;const r=t.computeFacesToDraw(),a=e.lastFacesToDraw;let s=!1;for(let i=0;i<6;i++)e.dataBounds[i]!==e.lastTickBounds[i]&&(s=!0,e.lastTickBounds[i]=e.dataBounds[i]);if(r||s||e.forceUpdate){const i=new Array(12).fill(0);for(let c=0;c<6;c++)if(a[c])for(let u=0;u<4;u++)i[Tg[c][u]]++;const o=e.generateTicks(e.dataBounds);t.updatePolyData(a,i,o.ticks),t.updateTextData(a,i,o.ticks,o.tickStrings),(s||e.forceUpdate)&&t.updateTextureAtlas(o.tickStrings)}e.forceUpdate=!1},t.updateTextureAtlas=r=>{e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e._tmAtlas.clear();let a=0,s=1;for(let i=0;i<3;i++){if(!e._tmAtlas.has(e.axisLabels[i])){co(e.tmContext,e.axisTextStyle);const o=e.tmContext.measureText(e.axisLabels[i]),c={height:o.actualBoundingBoxAscent+2,startingHeight:s,width:o.width+2,textStyle:e.axisTextStyle};e._tmAtlas.set(e.axisLabels[i],c),s+=c.height,a<c.width&&(a=c.width)}co(e.tmContext,e.tickTextStyle);for(let o=0;o<r[i].length;o++)if(!e._tmAtlas.has(r[i][o])){const c=e.tmContext.measureText(r[i][o]),u={height:c.actualBoundingBoxAscent+2,startingHeight:s,width:c.width+2,textStyle:e.tickTextStyle};e._tmAtlas.set(r[i][o],u),s+=u.height,a<u.width&&(a=u.width)}}a=Vt(a),s=Vt(s),e._tmAtlas.forEach(i=>{i.tcoords=[0,(s-i.startingHeight-i.height)/s,i.width/a,(s-i.startingHeight-i.height)/s,i.width/a,(s-i.startingHeight)/s,0,(s-i.startingHeight)/s]}),e.tmCanvas.width=a,e.tmCanvas.height=s,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,a,s),e._tmAtlas.forEach((i,o)=>{co(e.tmContext,i.textStyle),e.tmContext.fillText(o,1,i.startingHeight+i.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified()},t.onModified(()=>{e.forceUpdate=!0,t.update()}),t.setTickTextStyle=r=>{e.tickTextStyle={...e.tickTextStyle,...r},t.modified()},t.setAxisTextStyle=r=>{e.axisTextStyle={...e.axisTextStyle,...r},t.modified()},t.get_tmAtlas=()=>e._tmAtlas,t.getBounds=()=>(t.update(),he.setBounds(e.bounds,e.gridActor.getBounds()),he.scaleAboutCenter(e.bounds,e.boundsScaleFactor,e.boundsScaleFactor,e.boundsScaleFactor),e.bounds);const n=E.chain(t.setProperty,e.gridActor.setProperty);t.setProperty=r=>n(r)[0]}function SM(t,e,n){return{boundsScaleFactor:1.3,camera:null,dataBounds:[...he.INIT_BOUNDS],faceVisibilityAngle:8,gridLines:!0,axisLabels:null,axisTitlePixelOffset:35,tickLabelPixelOffset:12,generateTicks:Xp,...n,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif",...n?.axisTextStyle},tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif",...n?.tickTextStyle}}}function Ip(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};dr.extend(t,e,SM(t,e,n)),e.lastFacesToDraw=[!1,!1,!1,!1,!1,!1],e.axisLabels=["X-Axis","Y-Axis","Z-Axis"],e.tickCounts=[],e.textValues=[],e.lastTickBounds=[],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.tmTexture=Wa.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),e.gridMapper=vr.newInstance(),e.polyData=Tr.newInstance(),e.gridMapper.setInputData(e.polyData),e.gridActor=dr.newInstance(),e.gridActor.setMapper(e.gridMapper),e.gridActor.setProperty(t.getProperty()),e.gridActor.setParentProp(t),e.textPolyData=Tr.newInstance(),E.setGet(t,e,["axisTitlePixelOffset","boundsScaleFactor","faceVisibilityAngle","gridLines","tickLabelPixelOffset","generateTicks"]),E.setGetArray(t,e,["dataBounds"],6),E.setGetArray(t,e,["axisLabels"],3),E.get(t,e,["axisTextStyle","tickTextStyle","camera","tmTexture","textValues","textPolyData","tickCounts","gridActor"]),xM(t,e)}const CM=E.newInstance(Ip,"vtkCubeAxesActor");var Yp={newInstance:CM,extend:Ip,newCubeAxesActorHelper:TM,defaultGenerateTicks:Xp};function wM(t,e){e.classHierarchy.push("vtkOpenGLCubeAxesActor"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,s=e._openGLRenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([s.usize,s.vsize],a,e._openGLRenderWindow.getRenderable())}}}const EM={};function RM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,EM,n),Be.extend(t,e,n),e.CubeAxesActorHelper=Yp.newCubeAxesActorHelper(),wM(t,e)}const MM=Ce(RM,"vtkOpenGLCubeAxesActor");Ft("vtkCubeAxesActor",MM);const Da={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2};var qp={ObjectType:Da};const{ObjectType:zs}=qp,OM={};function DM(t,e){e.classHierarchy.push("vtkOpenGLBufferObject");function n(o){switch(o){case zs.ELEMENT_ARRAY_BUFFER:return e.context.ELEMENT_ARRAY_BUFFER;case zs.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in e.context)return e.context.TEXTURE_BUFFER;case zs.ARRAY_BUFFER:default:return e.context.ARRAY_BUFFER}}let r=null,a=null,s=!0,i="";t.getType=()=>r,t.setType=o=>{r=o},t.getHandle=()=>a,t.isReady=()=>s===!1,t.generateBuffer=o=>{const c=n(o);return a===null&&(a=e.context.createBuffer(),r=o),n(r)===c},t.upload=(o,c)=>t.generateBuffer(c)?(e.context.bindBuffer(n(r),a),e.context.bufferData(n(r),o,e.context.STATIC_DRAW),e.allocatedGPUMemoryInBytes=o.length*o.BYTES_PER_ELEMENT,s=!1,!0):(i="Trying to upload array buffer to incompatible buffer.",!1),t.bind=()=>a?(e.context.bindBuffer(n(r),a),!0):!1,t.release=()=>a?(e.context.bindBuffer(n(r),null),!0):!1,t.releaseGraphicsResources=()=>{a!==null&&(e.context.bindBuffer(n(r),null),e.context.deleteBuffer(a),a=null,e.allocatedGPUMemoryInBytes=0)},t.setOpenGLRenderWindow=o=>{e._openGLRenderWindow!==o&&(t.releaseGraphicsResources(),e._openGLRenderWindow=o,e.context=null,o&&(e.context=e._openGLRenderWindow.getContext()))},t.getError=()=>i}const LM={objectType:zs.ARRAY_BUFFER,context:null,allocatedGPUMemoryInBytes:0};function Qp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LM,n),E.obj(t,e),E.get(t,e,["_openGLRenderWindow","allocatedGPUMemoryInBytes"]),E.moveToProtected(t,e,["openGLRenderWindow"]),DM(t,e)}const VM=E.newInstance(Qp);var Zp={newInstance:VM,extend:Qp,...OM,...qp};function mM(t){let e=0,n=0;for(let a=0;a<3;++a){const s=t.getRange(a),i=s[1]-s[0];e+=i*i;const o=.5*(s[1]+s[0]);n+=o*o}const r=e>0&&(Math.abs(n)/e>1e6||Math.abs(Math.log10(e))>3||e===0&&n>1e6);if(r){const a=new Float64Array(3),s=new Float64Array(3);for(let i=0;i<3;++i){const o=t.getRange(i),c=o[1]-o[0];a[i]=.5*(o[1]+o[0]),s[i]=c>0?1/c:1}return{useShiftAndScale:r,coordShift:a,coordScale:s}}return{useShiftAndScale:r,coordShift:new Float32Array([0,0,0]),coordScale:new Float32Array([1,1,1])}}const{vtkErrorMacro:Sg}=E;function FM(t,e){const n=new Float64Array(3);cx(n,e);const r=new Float64Array(16);return o0(r,hr(),t,n),r}function BM(t,e){return t===null||e===null?!1:!(nu(t,[0,0,0])&&nu(e,[1,1,1]))}function _M(t,e){e.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),t.setType(Da.ARRAY_BUFFER),t.createVBO=function(n,r,a,s){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!n.getData()||!n.getData().length)return e.elementCount=0,0;e.blockSize=3,e.vertexOffset=0,e.normalOffset=0,e.tCoordOffset=0,e.tCoordComponents=0,e.colorComponents=0,e.colorOffset=0,e.customData=[];const o=s.points.getData();let c=null,u=null,g=null;const f=s.colors?s.colors.getNumberOfComponents():0,l=s.tcoords?s.tcoords.getNumberOfComponents():0;s.normals&&(e.normalOffset=4*e.blockSize,e.blockSize+=3,c=s.normals.getData()),s.customAttributes&&s.customAttributes.forEach(k=>{k&&(e.customData.push({data:k.getData(),offset:4*e.blockSize,components:k.getNumberOfComponents(),name:k.getName()}),e.blockSize+=k.getNumberOfComponents())}),s.tcoords&&(e.tCoordOffset=4*e.blockSize,e.tCoordComponents=l,e.blockSize+=l,u=s.tcoords.getData()),s.colors?(e.colorComponents=s.colors.getNumberOfComponents(),e.colorOffset=0,g=s.colors.getData(),e.colorBO||(e.colorBO=Zp.newInstance()),e.colorBO.setOpenGLRenderWindow(e._openGLRenderWindow)):e.colorBO=null,e.stride=4*e.blockSize;let h=0,v=0,p=0,d=0,y=0,S=0,x;const T={anythingToPoints(k,Y,te,J){for(let q=0;q<k;++q)x(Y[te+q],J)},linesToWireframe(k,Y,te,J){for(let q=0;q<k-1;++q)x(Y[te+q],J),x(Y[te+q+1],J)},polysToWireframe(k,Y,te,J){if(k>2)for(let q=0;q<k;++q)x(Y[te+q],J),x(Y[te+(q+1)%k],J)},stripsToWireframe(k,Y,te,J){if(k>2){for(let q=0;q<k-1;++q)x(Y[te+q],J),x(Y[te+q+1],J);for(let q=0;q<k-2;q++)x(Y[te+q],J),x(Y[te+q+2],J)}},polysToSurface(k,Y,te,J){for(let q=0;q<k-2;q++)x(Y[te+0],J),x(Y[te+q+1],J),x(Y[te+q+2],J)},stripsToSurface(k,Y,te,J){for(let q=0;q<k-2;q++)x(Y[te+q],J),x(Y[te+q+1+q%2],J),x(Y[te+q+1+(q+1)%2],J)}},w={anythingToPoints(k,Y){return k},linesToWireframe(k,Y){return k>1?(k-1)*2:0},polysToWireframe(k,Y){return k>2?k*2:0},stripsToWireframe(k,Y){return k>2?k*4-6:0},polysToSurface(k,Y){return k>2?(k-2)*3:0},stripsToSurface(k,Y,te){return k>2?(k-2)*3:0}};let C=null,R=null;a===mt.POINTS||r==="verts"?(C=T.anythingToPoints,R=w.anythingToPoints):a===mt.WIREFRAME||r==="lines"?(C=T[`${r}ToWireframe`],R=w[`${r}ToWireframe`]):(C=T[`${r}ToSurface`],R=w[`${r}ToSurface`]);const M=n.getData(),m=M.length;let L=0;for(let k=0;k<m;)L+=R(M[k],M),k+=M[k]+1;let V=null;const F=new Float32Array(L*e.blockSize);g&&(V=new Uint8Array(L*4));let B=0,_=0;const{useShiftAndScale:P,coordShift:z,coordScale:A}=mM(s.points);if(P?t.setCoordShiftAndScale(z,A):e.coordShiftAndScaleEnabled===!0&&t.setCoordShiftAndScale(null,null),i)if(!i.points&&!i.cells)i.points=new Int32Array(L),i.cells=new Int32Array(L);else{const k=new Int32Array(L+i.points.length);k.set(i.points),i.points=k;const Y=new Int32Array(L+i.cells.length);Y.set(i.cells),i.cells=Y}let I=s.vertexOffset;x=function(Y,te){if(i&&(i.points[I]=Y,i.cells[I]=S+s.cellOffset),++I,h=Y*3,e.coordShiftAndScaleEnabled?(F[B++]=(o[h++]-e.coordShift[0])*e.coordScale[0],F[B++]=(o[h++]-e.coordShift[1])*e.coordScale[1],F[B++]=(o[h++]-e.coordShift[2])*e.coordScale[2]):(F[B++]=o[h++],F[B++]=o[h++],F[B++]=o[h++]),c!==null&&(s.haveCellNormals?v=(S+s.cellOffset)*3:v=Y*3,F[B++]=c[v++],F[B++]=c[v++],F[B++]=c[v++]),e.customData.forEach(J=>{y=Y*J.components;for(let q=0;q<J.components;++q)F[B++]=J.data[y++]}),u!==null){s.useTCoordsPerCell?p=te*l:p=Y*l;for(let J=0;J<l;++J)F[B++]=u[p++]}g!==null&&(s.haveCellScalars?d=(S+s.cellOffset)*f:d=Y*f,V[_++]=g[d++],V[_++]=g[d++],V[_++]=g[d++],V[_++]=f===4?g[d++]:255)};for(let k=0;k<m;k+=M[k]+1,S++)C(M[k],M,k+1,S+s.cellOffset);return e.elementCount=L,t.upload(F,Da.ARRAY_BUFFER),e.colorBO&&(e.colorBOStride=4,e.colorBO.upload(V,Da.ARRAY_BUFFER)),S},t.setCoordShiftAndScale=(n,r)=>{if(n!==null&&(n.constructor!==Float64Array||n.length!==3)){Sg("Wrong type for coordShift, expected vec3 or null");return}if(r!==null&&(r.constructor!==Float64Array||r.length!==3)){Sg("Wrong type for coordScale, expected vec3 or null");return}(e.coordShift===null||n===null||!ru(n,e.coordShift))&&(e.coordShift=n),(e.coordScale===null||r===null||!ru(r,e.coordScale))&&(e.coordScale=r),e.coordShiftAndScaleEnabled=BM(e.coordShift,e.coordScale),e.coordShiftAndScaleEnabled?e.inverseShiftAndScaleMatrix=FM(e.coordShift,e.coordScale):e.inverseShiftAndScaleMatrix=null}}const UM={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function Jp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UM,n),Zp.extend(t,e,n),E.setGet(t,e,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),E.get(t,e,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),_M(t,e)}const NM=E.newInstance(Jp);var kM={newInstance:NM,extend:Jp};const{vtkErrorMacro:GM}=E;function bM(t,e){e.classHierarchy.push("vtkShader"),t.compile=()=>{let n=e.context.VERTEX_SHADER;if(!e.source||!e.source.length||e.shaderType==="Unknown")return!1;switch(e.handle!==0&&(e.context.deleteShader(e.handle),e.handle=0),e.shaderType){case"Fragment":n=e.context.FRAGMENT_SHADER;break;case"Vertex":default:n=e.context.VERTEX_SHADER;break}if(e.handle=e.context.createShader(n),e.context.shaderSource(e.handle,e.source),e.context.compileShader(e.handle),!e.context.getShaderParameter(e.handle,e.context.COMPILE_STATUS)){const a=e.context.getShaderInfoLog(e.handle);return GM(`Error compiling shader '${e.source}': ${a}`),e.context.deleteShader(e.handle),e.handle=0,!1}return!0},t.cleanup=()=>{e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0,e.dirty=!0)}}const $M={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function e1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$M,n),E.obj(t,e),E.setGet(t,e,["shaderType","source","error","handle","context"]),bM(t,e)}const WM=E.newInstance(e1,"vtkShader");var fo={newInstance:WM,extend:e1};const{vtkErrorMacro:jt}=E;function zM(t,e,n,r){const a=typeof n=="string"?n:n.join(`
`),s=r===!1?e:new RegExp(e,"g"),i=t.replace(s,a);return{replace:i!==a,result:i}}function HM(t,e){e.classHierarchy.push("vtkShaderProgram"),t.compileShader=()=>e.vertexShader.compile()?e.fragmentShader.compile()?!t.attachShader(e.vertexShader)||!t.attachShader(e.fragmentShader)?(jt(e.error),0):t.link()?(t.setCompiled(!0),1):(jt(`Links failed: ${e.error}`),0):(jt(e.fragmentShader.getSource().split(`
`).map((n,r)=>`${r}: ${n}`).join(`
`)),jt(e.fragmentShader.getError()),0):(jt(e.vertexShader.getSource().split(`
`).map((n,r)=>`${r}: ${n}`).join(`
`)),jt(e.vertexShader.getError()),0),t.cleanup=()=>{e.shaderType==="Unknown"||e.handle===0||(t.release(),e.vertexShaderHandle!==0&&(e.context.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=0),e.fragmentShaderHandle!==0&&(e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=0),e.context.deleteProgram(e.handle),e.handle=0,t.setCompiled(!1))},t.bind=()=>!e.linked&&!t.link()?!1:(e.context.useProgram(e.handle),t.setBound(!0),!0),t.isBound=()=>!!e.bound,t.release=()=>{e.context.useProgram(null),t.setBound(!1)},t.setContext=n=>{e.vertexShader.setContext(n),e.fragmentShader.setContext(n),e.geometryShader.setContext(n)},t.link=()=>{if(e.linked)return!0;if(e.handle===0)return e.error="Program has not been initialized, and/or does not have shaders.",!1;if(e.uniformLocs={},e.context.linkProgram(e.handle),!e.context.getProgramParameter(e.handle,e.context.LINK_STATUS)){const r=e.context.getProgramInfoLog(e.handle);return jt(`Error linking shader ${r}`),e.handle=0,!1}return t.setLinked(!0),e.attributeLocs={},!0},t.setUniformMatrix=(n,r)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;const s=new Float32Array(r);return e.context.uniformMatrix4fv(a,!1,s),!0},t.setUniformMatrix3x3=(n,r)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;const s=new Float32Array(r);return e.context.uniformMatrix3fv(a,!1,s),!0},t.setUniformf=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1f(a,r),!0)},t.setUniformfv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1fv(a,r),!0)},t.setUniformi=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1i(a,r),!0)},t.setUniformiv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform1iv(a,r),!0)},t.setUniform2f=(n,r,a)=>{const s=t.findUniform(n);if(s===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2f(s,r,a),!0},t.setUniform2fv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform2fv(a,r),!0)},t.setUniform2i=(n,r,a)=>{const s=t.findUniform(n);if(s===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2i(s,r,a),!0},t.setUniform2iv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform2iv(a,r),!0)},t.setUniform3f=(n,r,a,s)=>{const i=t.findUniform(n);if(i===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(s===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(i,r,a,s),!0},t.setUniform3fArray=(n,r)=>{const a=t.findUniform(n);if(a===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;if(!Array.isArray(r)||r.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(a,r[0],r[1],r[2]),!0},t.setUniform3fv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform3fv(a,r),!0)},t.setUniform3i=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];let o=s;if(o.length===1&&Array.isArray(o[0])&&(o=o[0]),o.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3i(r,o[0],o[1],o[2]),!0},t.setUniform3iv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform3iv(a,r),!0)},t.setUniform4f=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];let o=s;if(o.length===1&&Array.isArray(o[0])&&(o=o[0]),o.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4f(r,o[0],o[1],o[2],o[3]),!0},t.setUniform4fv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform4fv(a,r),!0)},t.setUniform4i=function(n){const r=t.findUniform(n);if(r===-1)return e.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];let o=s;if(o.length===1&&Array.isArray(o[0])&&(o=o[0]),o.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4i(r,o[0],o[1],o[2],o[3]),!0},t.setUniform4iv=(n,r)=>{const a=t.findUniform(n);return a===-1?(e.error=`Could not set uniform ${n} . No such uniform.`,!1):(e.context.uniform4iv(a,r),!0)},t.findUniform=n=>{if(!n||!e.linked)return-1;let r=e.uniformLocs[n];return r!==void 0?r:(r=e.context.getUniformLocation(e.handle,n),r===null?(e.error=`Uniform ${n} not found in current shader program.`,e.uniformLocs[n]=-1,-1):(e.uniformLocs[n]=r,r))},t.isUniformUsed=n=>{if(!n)return!1;let r=e.uniformLocs[n];return r!==void 0?r!==null:e.linked?(r=e.context.getUniformLocation(e.handle,n),e.uniformLocs[n]=r,r!==null):(jt("attempt to find uniform when the shader program is not linked"),!1)},t.isAttributeUsed=n=>{if(!n)return!1;if(n in e.attributeLocs)return!0;if(!e.linked)return jt("attempt to find uniform when the shader program is not linked"),!1;const r=e.context.getAttribLocation(e.handle,n);return r===-1?!1:(e.attributeLocs[n]=r,!0)},t.attachShader=n=>{if(n.getHandle()===0)return e.error="Shader object was not initialized, cannot attach it.",!1;if(n.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;if(e.handle===0){const r=e.context.createProgram();if(r===0)return e.error="Could not create shader program.",!1;e.handle=r,e.linked=!1}return n.getShaderType()==="Vertex"&&(e.vertexShaderHandle!==0&&e.context.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=n.getHandle()),n.getShaderType()==="Fragment"&&(e.fragmentShaderHandle!==0&&e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=n.getHandle()),e.context.attachShader(e.handle,n.getHandle()),t.setLinked(!1),!0},t.detachShader=n=>{if(n.getHandle()===0)return e.error="shader object was not initialized, cannot attach it.",!1;if(n.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;switch(e.handle===0&&(e.error="This shader program has not been initialized yet."),n.getShaderType()){case"Vertex":return e.vertexShaderHandle!==n.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,n.getHandle()),e.vertexShaderHandle=0,e.linked=!1,!0);case"Fragment":return e.fragmentShaderHandle!==n.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,n.getHandle()),e.fragmentShaderHandle=0,e.linked=!1,!0);default:return!1}},t.setContext=n=>{e.context=n,e.vertexShader.setContext(n),e.fragmentShader.setContext(n),e.geometryShader.setContext(n)},t.setLastCameraMTime=n=>{e.lastCameraMTime=n}}const AM={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function t1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AM,n),e.attributesLocs={},e.uniformLocs={},e.vertexShader=fo.newInstance(),e.vertexShader.setShaderType("Vertex"),e.fragmentShader=fo.newInstance(),e.fragmentShader.setShaderType("Fragment"),e.geometryShader=fo.newInstance(),e.geometryShader.setShaderType("Geometry"),E.obj(t,e),E.get(t,e,["lastCameraMTime"]),E.setGet(t,e,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),HM(t,e)}const jM=E.newInstance(t1,"vtkShaderProgram");var N={newInstance:jM,extend:t1,substitute:zM};function KM(t,e){e.classHierarchy.push("vtkOpenGLVertexArrayObject"),t.exposedMethod=()=>{},t.initialize=()=>{e.instancingExtension=null,e._openGLRenderWindow.getWebgl2()||(e.instancingExtension=e.context.getExtension("ANGLE_instanced_arrays")),!e.forceEmulation&&e._openGLRenderWindow&&e._openGLRenderWindow.getWebgl2()?(e.extension=null,e.supported=!0,e.handleVAO=e.context.createVertexArray()):(e.extension=e.context.getExtension("OES_vertex_array_object"),!e.forceEmulation&&e.extension?(e.supported=!0,e.handleVAO=e.extension.createVertexArrayOES()):e.supported=!1)},t.isReady=()=>e.handleVAO!==0||e.supported===!1,t.bind=()=>{if(t.isReady()||t.initialize(),t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(e.handleVAO):e.context.bindVertexArray(e.handleVAO);else if(t.isReady()){const n=e.context;for(let r=0;r<e.buffers.length;++r){const a=e.buffers[r];e.context.bindBuffer(n.ARRAY_BUFFER,a.buffer);for(let s=0;s<a.attributes.length;++s){const i=a.attributes[s],o=i.isMatrix?i.size:1;for(let c=0;c<o;++c)n.enableVertexAttribArray(i.index+c),n.vertexAttribPointer(i.index+c,i.size,i.type,i.normalize,i.stride,i.offset+i.stride*c/i.size),i.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(i.index+c,1):n.vertexAttribDivisor(i.index+c,1))}}}},t.release=()=>{if(t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(null):e.context.bindVertexArray(null);else if(t.isReady()){const n=e.context;for(let r=0;r<e.buffers.length;++r){const a=e.buffers[r];e.context.bindBuffer(n.ARRAY_BUFFER,a.buffer);for(let s=0;s<a.attributes.length;++s){const i=a.attributes[s],o=i.isMatrix?i.size:1;for(let c=0;c<o;++c)n.enableVertexAttribArray(i.index+c),n.vertexAttribPointer(i.index+c,i.size,i.type,i.normalize,i.stride,i.offset+i.stride*c/i.size),i.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(i.index+c,0):n.vertexAttribDivisor(i.index+c,0)),n.disableVertexAttribArray(i.index+c)}}}},t.shaderProgramChanged=()=>{t.release(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.handleProgram=0},t.releaseGraphicsResources=()=>{t.shaderProgramChanged(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.supported=!0,e.handleProgram=0},t.addAttributeArray=(n,r,a,s,i,o,c,u)=>t.addAttributeArrayWithDivisor(n,r,a,s,i,o,c,u,0,!1),t.addAttributeArrayWithDivisor=(n,r,a,s,i,o,c,u,g,f)=>{if(!n||!n.isBound()||r.getHandle()===0||r.getType()!==Da.ARRAY_BUFFER||(e.handleProgram===0&&(e.handleProgram=n.getHandle()),t.isReady()||t.initialize(),!t.isReady()||e.handleProgram!==n.getHandle()))return!1;const l=e.context,h={};if(h.name=a,h.index=l.getAttribLocation(e.handleProgram,a),h.offset=s,h.stride=i,h.type=o,h.size=c,h.normalize=u,h.isMatrix=f,h.divisor=g,h.Index===-1)return!1;if(r.bind(),l.enableVertexAttribArray(h.index),l.vertexAttribPointer(h.index,h.size,h.type,h.normalize,h.stride,h.offset),g>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(h.index,1):l.vertexAttribDivisor(h.index,1)),h.buffer=r.getHandle(),!e.supported){let v=!1;for(let p=0;p<e.buffers.length;++p){const d=e.buffers[p];if(d.buffer===h.buffer){v=!0;let y=!1;for(let S=0;S<d.attributes.length;++S)d.attributes[S].name===a&&(y=!0,d.attributes[S]=h);y||d.attributes.push(h)}}v||e.buffers.push({buffer:h.buffer,attributes:[h]})}return!0},t.addAttributeMatrixWithDivisor=(n,r,a,s,i,o,c,u,g)=>{const f=t.addAttributeArrayWithDivisor(n,r,a,s,i,o,c,u,g,!0);if(!f)return f;const l=e.context,h=l.getAttribLocation(e.handleProgram,a);for(let v=1;v<c;v++)l.enableVertexAttribArray(h+v),l.vertexAttribPointer(h+v,c,o,u,i,s+i*v/c),g>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(h+v,1):l.vertexAttribDivisor(h+v,1));return!0},t.removeAttributeArray=n=>{if(!t.isReady()||e.handleProgram===0)return!1;if(!e.supported)for(let r=0;r<e.buffers.length;++r){const a=e.buffers[r];for(let s=0;s<a.attributes.length;++s)if(a.attributes[s].name===n)return a.attributes.splice(s,1),a.attributes.length||e.buffers.splice(r,1),!0}return!0},t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))}}const PM={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null};function n1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,PM,n),e.buffers=[],E.obj(t,e),E.get(t,e,["supported"]),E.setGet(t,e,["forceEmulation"]),KM(t,e)}const XM=E.newInstance(n1,"vtkOpenGLVertexArrayObject");var r1={newInstance:XM,extend:n1};const Ln={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6};function IM(t,e){e.classHierarchy.push("vtkOpenGLHelper"),t.setOpenGLRenderWindow=n=>{e.context=n.getContext(),e.program.setContext(e.context),e.VAO.setOpenGLRenderWindow(n),e.CABO.setOpenGLRenderWindow(n)},t.releaseGraphicsResources=n=>{e.VAO.releaseGraphicsResources(),e.CABO.releaseGraphicsResources(),e.CABO.setElementCount(0)},t.drawArrays=(n,r,a,s)=>{if(e.CABO.getElementCount()){const i=t.getOpenGLMode(a),o=t.haveWideLines(n,r),c=e.context,u=c.getParameter(c.DEPTH_WRITEMASK);e.pointPicking&&c.depthMask(!1),i===c.LINES&&o?(t.updateShaders(n,r,s),c.drawArraysInstanced(i,0,e.CABO.getElementCount(),2*Math.ceil(r.getProperty().getLineWidth()))):(c.lineWidth(r.getProperty().getLineWidth()),t.updateShaders(n,r,s),c.drawArrays(i,0,e.CABO.getElementCount()),c.lineWidth(1));const f=(i===c.POINTS?1:0)||(i===c.LINES?2:3);return e.pointPicking&&c.depthMask(u),e.CABO.getElementCount()/f}return 0},t.getOpenGLMode=n=>{if(e.pointPicking)return e.context.POINTS;const r=e.primitiveType;return n===mt.POINTS||r===Ln.Points?e.context.POINTS:n===mt.WIREFRAME||r===Ln.Lines||r===Ln.TrisEdges||r===Ln.TriStripsEdges?e.context.LINES:e.context.TRIANGLES},t.haveWideLines=(n,r)=>r.getProperty().getLineWidth()>1?!(e.CABO.getOpenGLRenderWindow()&&e.CABO.getOpenGLRenderWindow().getHardwareMaximumLineWidth()>=r.getProperty().getLineWidth()):!1,t.getNeedToRebuildShaders=(n,r,a)=>!!(a.getNeedToRebuildShaders(t,n,r)||t.getProgram()===0||t.getShaderSourceTime().getMTime()<a.getMTime()||t.getShaderSourceTime().getMTime()<r.getMTime()),t.updateShaders=(n,r,a)=>{if(t.getNeedToRebuildShaders(n,r,a)){const s={Vertex:null,Fragment:null,Geometry:null};a.buildShaders(s,n,r);const i=e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgramArray(s.Vertex,s.Fragment,s.Geometry);i!==t.getProgram()&&(t.setProgram(i),t.getVAO().releaseGraphicsResources()),t.getShaderSourceTime().modified()}else e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgram(t.getProgram());t.getVAO().bind(),a.setMapperShaderParameters(t,n,r),a.setPropertyShaderParameters(t,n,r),a.setCameraShaderParameters(t,n,r),a.setLightingShaderParameters(t,n,r),a.invokeShaderCallbacks(t,n,r)},t.setMapperShaderParameters=(n,r,a)=>{if(t.haveWideLines(n,r)){t.getProgram().setUniform2f("viewportSize",a.usize,a.vsize);const s=parseFloat(r.getProperty().getLineWidth()),i=s/2;t.getProgram().setUniformf("lineWidthStepSize",s/Math.ceil(s)),t.getProgram().setUniformf("halfLineWidth",i)}e.primitiveType===Ln.Points||r.getProperty().getRepresentation()===mt.POINTS?t.getProgram().setUniformf("pointSize",r.getProperty().getPointSize()):e.pointPicking&&t.getProgram().setUniformf("pointSize",t.getPointPickingPrimitiveSize())},t.replaceShaderPositionVC=(n,r,a)=>{let s=n.Vertex;s=N.substitute(s,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform float pointSize;"]).result,s=N.substitute(s,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl","  gl_PointSize = pointSize;"],!1).result,t.getOpenGLMode(a.getProperty().getRepresentation())===e.context.LINES&&t.haveWideLines(r,a)&&(s=N.substitute(s,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform vec2 viewportSize;","uniform float lineWidthStepSize;","uniform float halfLineWidth;"]).result,s=N.substitute(s,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl"," if (halfLineWidth > 0.0)","   {","   float offset = float(gl_InstanceID / 2) * lineWidthStepSize - halfLineWidth;","   vec4 tmpPos = gl_Position;","   vec3 tmpPos2 = tmpPos.xyz / tmpPos.w;","   tmpPos2.x = tmpPos2.x + 2.0 * mod(float(gl_InstanceID), 2.0) * offset / viewportSize[0];","   tmpPos2.y = tmpPos2.y + 2.0 * mod(float(gl_InstanceID + 1), 2.0) * offset / viewportSize[1];","   gl_Position = vec4(tmpPos2.xyz * tmpPos.w, tmpPos.w);","   }"]).result),n.Vertex=s},t.getPointPickingPrimitiveSize=()=>e.primitiveType===Ln.Points?2:e.primitiveType===Ln.Lines?4:6,t.getAllocatedGPUMemoryInBytes=()=>t.getCABO().getAllocatedGPUMemoryInBytes()}const YM={context:null,program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0,pointPicking:!1};function a1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,YM,n),E.obj(t,e),e.shaderSourceTime={},E.obj(e.shaderSourceTime),e.attributeUpdateTime={},E.obj(e.attributeUpdateTime),E.setGet(t,e,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType","pointPicking"]),e.program=N.newInstance(),e.VAO=r1.newInstance(),e.CABO=kM.newInstance(),IM(t,e)}const qM=E.newInstance(a1);var qr={newInstance:qM,extend:a1,primTypes:Ln};const QM={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},sc={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5};var s1={Wrap:QM,Filter:sc};const i1=new Float32Array(1),ZM=new Int32Array(i1.buffer);function JM(t){i1[0]=t;const e=ZM[0];let n=e>>16&32768,r=e>>12&2047;const a=e>>23&255;return a<103?n:a>142?(n|=31744,n|=(a===255?0:1)&&e&8388607,n):a<113?(r|=2048,n|=(r>>114-a)+(r>>113-a&1),n):(n|=a-112<<10|r>>1,n+=r&1,n)}function eO(t){const e=(t&32768)>>15,n=(t&31744)>>10,r=t&1023;return n===0?(e?-1:1)*2**-14*(r/2**10):n===31?r?NaN:(e?-1:1)*(1/0):(e?-1:1)*2**(n-15)*(1+r/2**10)}var kt={fromHalf:eO,toHalf:JM};function tO(){try{const r=new Int16Array([0,32767]),a=[1,1],s=document.createElement("canvas");s.width=4,s.height=4;const i=s.getContext("webgl2");if(!i)return!1;const o=i.getExtension("EXT_texture_norm16");if(!o)return!1;const c=`#version 300 es
    void main() {
      gl_PointSize = ${4 .toFixed(1)};
      gl_Position = vec4(0, 0, 0, 1);
    }
  `,u=`#version 300 es
    precision highp float;
    precision highp int;
    precision highp sampler2D;

    uniform sampler2D u_image;

    out vec4 color;

    void main() {
        vec4 intColor = texture(u_image, gl_PointCoord.xy);
        color = vec4(vec3(intColor.rrr), 1);
    }
    `,g=i.createShader(i.VERTEX_SHADER);if(i.shaderSource(g,c),i.compileShader(g),!i.getShaderParameter(g,i.COMPILE_STATUS))return!1;const f=i.createShader(i.FRAGMENT_SHADER);if(i.shaderSource(f,u),i.compileShader(f),!i.getShaderParameter(f,i.COMPILE_STATUS))return!1;const l=i.createProgram();if(i.attachShader(l,g),i.attachShader(l,f),i.linkProgram(l),!i.getProgramParameter(l,i.LINK_STATUS))return!1;const h=i.createTexture();i.bindTexture(i.TEXTURE_2D,h),i.texImage2D(i.TEXTURE_2D,0,o.R16_SNORM_EXT,2,1,0,i.RED,i.SHORT,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.useProgram(l),i.drawArrays(i.POINTS,0,1);const v=new Uint8Array(4);i.readPixels(a[0],a[1],1,1,i.RGBA,i.UNSIGNED_BYTE,v);const[p,d,y]=v,S=i.getExtension("WEBGL_lose_context");return S&&S.loseContext(),p===d&&d===y&&p!==0}catch{return!1}}let uo;function nO(){return uo===void 0&&(uo=tO()),uo}const{Wrap:un,Filter:be}=s1,{VtkDataTypes:se}=De,{vtkDebugMacro:go,vtkErrorMacro:Zn,vtkWarningMacro:Cg,requiredParam:fe}=nn,{toHalf:rO}=kt;function aO(t,e){e.classHierarchy.push("vtkOpenGLTexture");function n(){return{internalFormat:e.internalFormat,format:e.format,openGLDataType:e.openGLDataType,width:e.width,height:e.height}}t.render=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(v?e._openGLRenderWindow=v:(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow")),e.context=e._openGLRenderWindow.getContext(),e.renderable.getInterpolate()?(e.generateMipmap?t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR):t.setMinificationFilter(be.LINEAR),t.setMagnificationFilter(be.LINEAR)):(t.setMinificationFilter(be.NEAREST),t.setMagnificationFilter(be.NEAREST)),e.renderable.getRepeat()&&(t.setWrapR(un.REPEAT),t.setWrapS(un.REPEAT),t.setWrapT(un.REPEAT)),e.renderable.getInputData()&&e.renderable.setImage(null),!e.handle||e.renderable.getMTime()>e.textureBuildTime.getMTime()){if(e.renderable.getImageBitmap()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR)),e.renderable.getImageBitmap()&&e.renderable.getImageLoaded()&&(t.create2DFromImageBitmap(e.renderable.getImageBitmap()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getImage()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR)),e.renderable.getImage()&&e.renderable.getImageLoaded()&&(t.create2DFromImage(e.renderable.getImage()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getCanvas()!==null){e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR));const d=e.renderable.getCanvas();t.create2DFromRaw({width:d.width,height:d.height,numComps:4,dataType:se.UNSIGNED_CHAR,data:d,flip:!0}),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}if(e.renderable.getJsImageData()!==null){const d=e.renderable.getJsImageData();e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR)),t.create2DFromRaw({width:d.width,height:d.height,numComps:4,dataType:se.UNSIGNED_CHAR,data:d.data,flip:!0}),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}const p=e.renderable.getInputData(0);if(p&&p.getPointData().getScalars()){const d=p.getExtent(),y=p.getPointData().getScalars(),S=[];for(let x=0;x<e.renderable.getNumberOfInputPorts();++x){const T=e.renderable.getInputData(x),w=T?T.getPointData().getScalars().getData():null;w&&S.push(w)}e.renderable.getInterpolate()&&y.getNumberOfComponents()===4&&(e.generateMipmap=!0,t.setMinificationFilter(be.LINEAR_MIPMAP_LINEAR)),S.length%6===0?t.createCubeFromRaw({width:d[1]-d[0]+1,height:d[3]-d[2]+1,numComps:y.getNumberOfComponents(),dataType:y.getDataType(),data:S}):t.create2DFromRaw({width:d[1]-d[0]+1,height:d[3]-d[2]+1,numComps:y.getNumberOfComponents(),dataType:y.getDataType(),data:y.getData()}),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}}e.handle&&t.activate()};const r=()=>{if(!((e.minificationFilter===be.LINEAR||e.magnificationFilter===be.LINEAR)&&!nO()))return e.oglNorm16Ext};t.destroyTexture=()=>{t.deactivate(),e.context&&e.handle&&e.context.deleteTexture(e.handle),e._prevTexParams=null,e.handle=0,e.numberOfDimensions=0,e.target=0,e.components=0,e.width=0,e.height=0,e.depth=0,t.resetFormatAndType()},t.createTexture=()=>{e.handle||(e.handle=e.context.createTexture(),e.target&&(e.context.bindTexture(e.target,e.handle),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.bindTexture(e.target,null)))},t.getTextureUnit=()=>e._openGLRenderWindow?e._openGLRenderWindow.getTextureUnitForTexture(t):-1,t.activate=()=>{e._openGLRenderWindow.activateTexture(t),t.bind()},t.deactivate=()=>{e._openGLRenderWindow&&e._openGLRenderWindow.deactivateTexture(t)},t.releaseGraphicsResources=v=>{v&&e.handle&&(v.activateTexture(t),v.deactivateTexture(t),e.context.deleteTexture(e.handle),e._prevTexParams=null,e.handle=0,e.numberOfDimensions=0,e.target=0,e.internalFormat=0,e.format=0,e.openGLDataType=0,e.components=0,e.width=0,e.height=0,e.depth=0,e.allocatedGPUMemoryInBytes=0),e.shaderProgram&&(e.shaderProgram.releaseGraphicsResources(v),e.shaderProgram=null)},t.bind=()=>{e.context.bindTexture(e.target,e.handle),e.autoParameters&&t.getMTime()>e.sendParametersTime.getMTime()&&t.sendParameters()},t.isBound=()=>{let v=!1;if(e.context&&e.handle){let p=0;switch(e.target){case e.context.TEXTURE_2D:p=e.context.TEXTURE_BINDING_2D;break;default:Cg("impossible case");break}v=e.context.getIntegerv(p)===e.handle}return v},t.sendParameters=()=>{e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e._openGLRenderWindow.getWebgl2()&&(e.context.texParameteri(e.target,e.context.TEXTURE_BASE_LEVEL,e.baseLevel),e.context.texParameteri(e.target,e.context.TEXTURE_MAX_LEVEL,e.maxLevel)),e.sendParametersTime.modified()},t.getInternalFormat=(v,p)=>(e._forceInternalFormat||(e.internalFormat=t.getDefaultInternalFormat(v,p)),e.internalFormat||go(`Unable to find suitable internal format for T=${v} NC= ${p}`),[e.context.R32F,e.context.RG32F,e.context.RGB32F,e.context.RGBA32F].includes(e.internalFormat)&&!e.context.getExtension("OES_texture_float_linear")&&Cg("Failed to load OES_texture_float_linear. Texture filtering is not available for *32F internal formats."),e.internalFormat),t.getDefaultInternalFormat=(v,p)=>{let d=0;return d=e._openGLRenderWindow.getDefaultTextureInternalFormat(v,p,r(),t.useHalfFloat()),d||(d||(go("Unsupported internal texture type!"),go(`Unable to find suitable internal format for T=${v} NC= ${p}`)),d)},t.useHalfFloat=()=>e.enableUseHalfFloat&&e.canUseHalfFloat,t.setInternalFormat=v=>{e._forceInternalFormat=!0,v!==e.internalFormat&&(e.internalFormat=v,t.modified())},t.getFormat=(v,p)=>(e.format=t.getDefaultFormat(v,p),e.format),t.getDefaultFormat=(v,p)=>{if(e._openGLRenderWindow.getWebgl2())switch(p){case 1:return e.context.RED;case 2:return e.context.RG;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}else switch(p){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}},t.resetFormatAndType=()=>{e._prevTexParams=null,e.format=0,e.internalFormat=0,e._forceInternalFormat=!1,e.openGLDataType=0},t.getDefaultDataType=v=>{const p=t.useHalfFloat();if(e._openGLRenderWindow.getWebgl2())switch(v){case se.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case(r()&&!p&&se.SHORT):return e.context.SHORT;case(r()&&!p&&se.UNSIGNED_SHORT):return e.context.UNSIGNED_SHORT;case(p&&se.SHORT):return e.context.HALF_FLOAT;case(p&&se.UNSIGNED_SHORT):return e.context.HALF_FLOAT;case se.FLOAT:case se.VOID:default:return e.context.FLOAT}switch(v){case se.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case se.FLOAT:case se.VOID:default:if(e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))return e.context.FLOAT;{const d=e.context.getExtension("OES_texture_half_float");if(d&&e.context.getExtension("OES_texture_half_float_linear"))return d.HALF_FLOAT_OES}return e.context.UNSIGNED_BYTE}},t.getOpenGLDataType=function(v){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(!e.openGLDataType||p)&&(e.openGLDataType=t.getDefaultDataType(v)),e.openGLDataType},t.getShiftAndScale=()=>{let v=0,p=1;switch(e.openGLDataType){case e.context.BYTE:p=127.5,v=p-128;break;case e.context.UNSIGNED_BYTE:p=255,v=0;break;case e.context.SHORT:p=32767.5,v=p-32768;break;case e.context.UNSIGNED_SHORT:p=65536,v=0;break;case e.context.INT:p=21474836475e-1,v=p-2147483648;break;case e.context.UNSIGNED_INT:p=4294967295,v=0;break;case e.context.FLOAT:}return{shift:v,scale:p}},t.getOpenGLFilterMode=v=>{switch(v){case be.NEAREST:return e.context.NEAREST;case be.LINEAR:return e.context.LINEAR;case be.NEAREST_MIPMAP_NEAREST:return e.context.NEAREST_MIPMAP_NEAREST;case be.NEAREST_MIPMAP_LINEAR:return e.context.NEAREST_MIPMAP_LINEAR;case be.LINEAR_MIPMAP_NEAREST:return e.context.LINEAR_MIPMAP_NEAREST;case be.LINEAR_MIPMAP_LINEAR:return e.context.LINEAR_MIPMAP_LINEAR;default:return e.context.NEAREST}},t.getOpenGLWrapMode=v=>{switch(v){case un.CLAMP_TO_EDGE:return e.context.CLAMP_TO_EDGE;case un.REPEAT:return e.context.REPEAT;case un.MIRRORED_REPEAT:return e.context.MIRRORED_REPEAT;default:return e.context.CLAMP_TO_EDGE}};function a(v){const[p,d,y,S,x,T]=v;return[d-p+1,S-y+1,T-x+1]}function s(v){const[p,d,y]=a(v);return p*d*y}function i(v,p,d,y,S){const[x,T,w,C,R,M]=d,[m,L]=p,V=m*L;let F=S;for(let B=R;B<=M;B++){const _=B*V;for(let P=w;P<=C;P++){const z=_+P*m;for(let A=z+x,I=z+T;A<=I;A++,F++)y[F]=v[A]}}}function o(v,p){const y=(arguments.length>2&&arguments[2]!==void 0?arguments[2]:null)||v.constructor,S=p.reduce((C,R)=>C+s(R),0),x=new y(S),T=[e.width,e.height,e.depth];let w=0;return p.forEach(C=>{i(v,T,C,x,w),w+=s(C)}),x}t.updateArrayDataTypeForGL=function(v,p){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];const S=[];let x=e.width*e.height*e.components;d&&(x*=e.depth);const T=!!y.length;if(v!==se.FLOAT&&e.openGLDataType===e.context.FLOAT)for(let C=0;C<p.length;C++)if(p[C])if(T)S.push(o(p[C],y,Float32Array));else{const R=p[C].length>x?p[C].subarray(0,x):p[C];S.push(new Float32Array(R))}else S.push(null);if(v!==se.UNSIGNED_CHAR&&e.openGLDataType===e.context.UNSIGNED_BYTE)for(let C=0;C<p.length;C++)if(p[C])if(T)S.push(o(p[C],y,Uint8Array));else{const R=p[C].length>x?p[C].subarray(0,x):p[C];S.push(new Uint8Array(R))}else S.push(null);let w=!1;if(e._openGLRenderWindow.getWebgl2())w=e.openGLDataType===e.context.HALF_FLOAT;else{const C=e.context.getExtension("OES_texture_half_float");w=C&&e.openGLDataType===C.HALF_FLOAT_OES}if(w)for(let C=0;C<p.length;C++)if(p[C]){const R=T?o(p[C],y):p[C],M=new Uint16Array(T?R.length:x),m=M.length;for(let L=0;L<m;L++)M[L]=rO(R[L]);S.push(M)}else S.push(null);if(S.length===0)for(let C=0;C<p.length;C++)S.push(T&&p[C]?o(p[C],y):p[C]);return S};function c(v){if(e._openGLRenderWindow.getWebgl2())return v;const p=[],d=e.width,y=e.height,S=e.components;if(v&&(!ga(d)||!ga(y))){const x=e.context.getExtension("OES_texture_half_float"),T=Vt(d),w=Vt(y),C=T*w*e.components;for(let R=0;R<v.length;R++)if(v[R]!==null){let M=null;const m=y/w,L=d/T;let V=!1;e.openGLDataType===e.context.FLOAT?M=new Float32Array(C):x&&e.openGLDataType===x.HALF_FLOAT_OES?(M=new Uint16Array(C),V=!0):M=new Uint8Array(C);for(let F=0;F<w;F++){const B=F*T*S,_=F*m;let P=Math.floor(_),z=Math.ceil(_);z>=y&&(z=y-1);const A=_-P,I=1-A;P=P*d*S,z=z*d*S;for(let k=0;k<T;k++){const Y=k*S,te=k*L;let J=Math.floor(te),q=Math.ceil(te);q>=d&&(q=d-1);const pt=te-J;J*=S,q*=S;for(let Ae=0;Ae<S;Ae++)V?M[B+Y+Ae]=kt.toHalf(kt.fromHalf(v[R][P+J+Ae])*I*(1-pt)+kt.fromHalf(v[R][P+q+Ae])*I*pt+kt.fromHalf(v[R][z+J+Ae])*A*(1-pt)+kt.fromHalf(v[R][z+q+Ae])*A*pt):M[B+Y+Ae]=v[R][P+J+Ae]*I*(1-pt)+v[R][P+q+Ae]*I*pt+v[R][z+J+Ae]*A*(1-pt)+v[R][z+q+Ae]*A*pt}}p.push(M),e.width=T,e.height=w}else p.push(null)}if(p.length===0)for(let x=0;x<v.length;x++)p.push(v[x]);return p}function u(v){return e._openGLRenderWindow?e.resizable||e.renderable?.getResizable()?!1:e._openGLRenderWindow.getWebgl2()?!(e._openGLRenderWindow.getGLInformations().RENDERER.value.match(/WebKit/gi)&&navigator.platform.match(/Mac/gi)&&r()&&(v===se.UNSIGNED_SHORT||v===se.SHORT)):!1:!1}t.create2DFromRaw=function(){let{width:v=fe("width"),height:p=fe("height"),numComps:d=fe("numComps"),dataType:y=fe("dataType"),data:S=fe("data"),flip:x=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(t.getOpenGLDataType(y,!0),t.getInternalFormat(y,d),t.getFormat(y,d),!e.internalFormat||!e.format||!e.openGLDataType)return Zn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=d,e.width=v,e.height=p,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const T=[S],w=t.updateArrayDataTypeForGL(y,T),C=c(w);return e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,x),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),u(y)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),C[0]!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,C[0])):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,C[0]),e.generateMipmap&&e.context.generateMipmap(e.target),x&&e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,!1),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*d*e._openGLRenderWindow.getDefaultTextureByteSize(y,r(),t.useHalfFloat()),t.deactivate(),!0},t.createCubeFromRaw=function(){let{width:v=fe("width"),height:p=fe("height"),numComps:d=fe("numComps"),dataType:y=fe("dataType"),data:S=fe("data")}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(t.getOpenGLDataType(y),t.getInternalFormat(y,d),t.getFormat(y,d),!e.internalFormat||!e.format||!e.openGLDataType)return Zn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_CUBE_MAP,e.components=d,e.width=v,e.height=p,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),e.maxLevel=S.length/6-1,t.createTexture(),t.bind();const x=t.updateArrayDataTypeForGL(y,S),T=c(x),w=[];let C=e.width,R=e.height;for(let M=0;M<T.length;M++){M%6===0&&M!==0&&(C/=2,R/=2),w[M]=Xr(y,R*C*e.components);for(let m=0;m<R;++m){const L=m*C*e.components,V=(R-m-1)*C*e.components;w[M].set(T[M].slice(V,V+C*e.components),L)}}e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),u(y)&&e.context.texStorage2D(e.target,6,e.internalFormat,e.width,e.height);for(let M=0;M<6;M++){let m=0,L=e.width,V=e.height;for(;L>=1&&V>=1;){let F=null;m<=e.maxLevel&&(F=w[6*m+M]),u(y)?F!=null&&e.context.texSubImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+M,m,0,0,L,V,e.format,e.openGLDataType,F):e.context.texImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+M,m,e.internalFormat,L,V,0,e.format,e.openGLDataType,F),m++,L/=2,V/=2}}return e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*d*e._openGLRenderWindow.getDefaultTextureByteSize(y,r(),t.useHalfFloat()),t.deactivate(),!0},t.createDepthFromRaw=function(){let{width:v=fe("width"),height:p=fe("height"),dataType:d=fe("dataType"),data:y=fe("data")}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.getOpenGLDataType(d),e.format=e.context.DEPTH_COMPONENT,e._openGLRenderWindow.getWebgl2()?d===se.FLOAT?e.internalFormat=e.context.DEPTH_COMPONENT32F:e.internalFormat=e.context.DEPTH_COMPONENT16:e.internalFormat=e.context.DEPTH_COMPONENT,!e.internalFormat||!e.format||!e.openGLDataType?(Zn("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=1,e.width=v,e.height=p,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),u(d)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),y!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,y)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,y),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(d,r(),t.useHalfFloat()),t.deactivate(),!0)},t.create2DFromImage=v=>{if(t.getOpenGLDataType(se.UNSIGNED_CHAR),t.getInternalFormat(se.UNSIGNED_CHAR,4),t.getFormat(se.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType)return Zn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=4,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const p=!e._openGLRenderWindow.getWebgl2()&&(!ga(v.width)||!ga(v.height));let d=v,y=v.width,S=v.height,x=!0;const T=window.chrome;if(p||T){const w=new OffscreenCanvas(Vt(v.width),Vt(v.height));y=w.width,S=w.height;const C=w.getContext("2d");C.translate(0,w.height),C.scale(1,-1),C.drawImage(v,0,0,v.width,v.height,0,0,w.width,w.height),d=w,x=!1}return e.width=y,e.height=S,e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,x),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),u(se.UNSIGNED_CHAR)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,d)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,d),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(se.UNSIGNED_CHAR,r(),t.useHalfFloat()),t.deactivate(),!0},t.create2DFromImageBitmap=v=>(t.getOpenGLDataType(se.UNSIGNED_CHAR),t.getInternalFormat(se.UNSIGNED_CHAR,4),t.getFormat(se.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType?(Zn("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=4,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),e.width=v.width,e.height=v.height,u(se.UNSIGNED_CHAR)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,v)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,v),e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(se.UNSIGNED_CHAR,r(),t.useHalfFloat()),t.deactivate(),!0));function g(v,p,d){const y=new Array(d),S=new Array(d);for(let x=0;x<d;++x)y[x]=v[x],S[x]=p[x]-v[x]||1;return{scale:S,offset:y}}function f(v,p){for(let d=0;d<v.length;d++){const y=v[d],S=p[d]+y;if(y<-2048||y>2048||S<-2048||S>2048)return!1}return!0}function l(v,p,d,y){t.getOpenGLDataType(v);const S=f(p,d)||y;let x=!1;if(e._openGLRenderWindow.getWebgl2())x=e.openGLDataType===e.context.FLOAT&&e.context.getExtension("OES_texture_float_linear")===null&&S||e.openGLDataType===e.context.HALF_FLOAT;else{const T=e.context.getExtension("OES_texture_half_float");x=T&&e.openGLDataType===T.HALF_FLOAT_OES}e.canUseHalfFloat=x&&S}function h(v,p){const d=v.getNumberOfComponents(),y=v.getDataType(),S=v.getData(),x=new Array(d),T=new Array(d);for(let C=0;C<d;++C){const[R,M]=v.getRange(C);x[C]=R,T[C]=M}const w=g(x,T,d);return l(y,w.offset,w.scale,p),t.useHalfFloat()||t.getOpenGLDataType(y,!0),{numComps:d,dataType:y,data:S,scaleOffsets:w}}t.create2DFilterableFromRaw=function(){let{width:v=fe("width"),height:p=fe("height"),numComps:d=fe("numComps"),dataType:y=fe("dataType"),data:S=fe("data"),preferSizeOverAccuracy:x=!1,ranges:T=void 0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.create2DFilterableFromDataArray({width:v,height:p,dataArray:De.newInstance({numberOfComponents:d,dataType:y,values:S,ranges:T}),preferSizeOverAccuracy:x})},t.create2DFilterableFromDataArray=function(){let{width:v=fe("width"),height:p=fe("height"),dataArray:d=fe("dataArray"),preferSizeOverAccuracy:y=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{numComps:S,dataType:x,data:T}=h(d,y);t.create2DFromRaw({width:v,height:p,numComps:S,dataType:x,data:T})},t.updateVolumeInfoForGL=(v,p)=>{let d=!1;const y=t.useHalfFloat();(!e.volumeInfo?.scale||!e.volumeInfo?.offset)&&(e.volumeInfo={scale:new Array(p),offset:new Array(p)});for(let S=0;S<p;++S)e.volumeInfo.scale[S]=1,e.volumeInfo.offset[S]=0;if(r()&&!y&&v===se.SHORT){for(let S=0;S<p;++S)e.volumeInfo.scale[S]=32767;d=!0}if(r()&&!y&&v===se.UNSIGNED_SHORT){for(let S=0;S<p;++S)e.volumeInfo.scale[S]=65535;d=!0}if(v===se.UNSIGNED_CHAR){for(let S=0;S<p;++S)e.volumeInfo.scale[S]=255;d=!0}return(v===se.FLOAT||y&&(v===se.SHORT||v===se.UNSIGNED_SHORT))&&(d=!0),d},t.create3DFromRaw=function(){let{width:v=fe("width"),height:p=fe("height"),depth:d=fe("depth"),numComps:y=fe("numComps"),dataType:S=fe("dataType"),data:x=fe("data"),updatedExtents:T=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},w=S,C=x;if(!t.updateVolumeInfoForGL(w,y)&&C){const B=v*p*d,_=structuredClone(e.volumeInfo),P=new Float32Array(B*y);e.volumeInfo.offset=_.offset,e.volumeInfo.scale=_.scale;let z=0;const A=_.scale.map(I=>1/I);for(let I=0;I<B;I++)for(let k=0;k<y;k++)P[z]=(C[z]-_.offset[k])*A[k],z++;w=se.FLOAT,C=P}if(t.getOpenGLDataType(w),t.getInternalFormat(w,y),t.getFormat(w,y),!e.internalFormat||!e.format||!e.openGLDataType)return Zn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_3D,e.components=y,e.width=v,e.height=p,e.depth=d,e.numberOfDimensions=3,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();const R=T.length>0,M=!R||!v0(e._prevTexParams,n()),m=[C],V=t.updateArrayDataTypeForGL(w,m,!0,M?[]:T),F=c(V);if(e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),M)u(w)?(e.context.texStorage3D(e.target,1,e.internalFormat,e.width,e.height,e.depth),F[0]!=null&&e.context.texSubImage3D(e.target,0,0,0,0,e.width,e.height,e.depth,e.format,e.openGLDataType,F[0])):e.context.texImage3D(e.target,0,e.internalFormat,e.width,e.height,e.depth,0,e.format,e.openGLDataType,F[0]),e._prevTexParams=n();else if(R){const B=F[0];let _=0;for(let P=0;P<T.length;P++){const z=T[P],A=a(z),I=s(z),k=new B.constructor(B.buffer,_,I);_+=k.byteLength,e.context.texSubImage3D(e.target,0,z[0],z[2],z[4],A[0],A[1],A[2],e.format,e.openGLDataType,k)}}return e.generateMipmap&&e.context.generateMipmap(e.target),e.allocatedGPUMemoryInBytes=e.width*e.height*e.depth*e.components*e._openGLRenderWindow.getDefaultTextureByteSize(w,r(),t.useHalfFloat()),t.deactivate(),!0},t.create3DFilterableFromRaw=function(){let{width:v=fe("width"),height:p=fe("height"),depth:d=fe("depth"),numComps:y=fe("numComps"),dataType:S=fe("dataType"),data:x=fe("data"),preferSizeOverAccuracy:T=!1,ranges:w=void 0,updatedExtents:C=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.create3DFilterableFromDataArray({width:v,height:p,depth:d,dataArray:De.newInstance({numberOfComponents:y,dataType:S,values:x,ranges:w}),preferSizeOverAccuracy:T,updatedExtents:C})},t.create3DFilterableFromDataArray=function(){let{width:v=fe("width"),height:p=fe("height"),depth:d=fe("depth"),dataArray:y=fe("dataArray"),preferSizeOverAccuracy:S=!1,updatedExtents:x=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{numComps:T,dataType:w,data:C,scaleOffsets:R}=h(y,S),M=[],m=[];for(let Se=0;Se<T;++Se)M[Se]=0,m[Se]=1;if(e.volumeInfo={scale:m,offset:M,dataComputedScale:R.scale,dataComputedOffset:R.offset,width:v,height:p,depth:d},e._openGLRenderWindow.getWebgl2())return t.create3DFromRaw({width:v,height:p,depth:d,numComps:T,dataType:w,data:C,updatedExtents:x});const L=v*p*d,V=structuredClone(R);let F=(Se,$e,Mt,Je,je)=>{Se[$e]=Mt},B=se.UNSIGNED_CHAR;if(w===se.UNSIGNED_CHAR)for(let Se=0;Se<T;++Se)V.offset[Se]=0,V.scale[Se]=255;else e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear")?(B=se.FLOAT,F=(Se,$e,Mt,Je,je)=>{Se[$e]=(Mt-Je)/je}):(B=se.UNSIGNED_CHAR,F=(Se,$e,Mt,Je,je)=>{Se[$e]=255*(Mt-Je)/je});if(t.getOpenGLDataType(B),t.getInternalFormat(B,T),t.getFormat(B,T),!e.internalFormat||!e.format||!e.openGLDataType)return Zn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=T,e.depth=1,e.numberOfDimensions=2;let _=e.context.getParameter(e.context.MAX_TEXTURE_SIZE);_>4096&&(B===se.FLOAT||T>=3)&&(_=4096);let P=1,z=1;L>_*_&&(P=Math.ceil(Math.sqrt(L/(_*_))),z=P);let A=Math.sqrt(L)/P;A=Vt(A);const I=Math.floor(A*P/v),k=Math.ceil(d/I),Y=Vt(p*k/z);e.width=A,e.height=Y,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.volumeInfo.xreps=I,e.volumeInfo.yreps=k,e.volumeInfo.xstride=P,e.volumeInfo.ystride=z,e.volumeInfo.offset=V.offset,e.volumeInfo.scale=V.scale;let te;const J=A*Y*T;B===se.FLOAT?te=new Float32Array(J):te=new Uint8Array(J);let q=0;const pt=Math.floor(v/P),Ae=Math.floor(p/z);for(let Se=0;Se<k;Se++){const $e=Math.min(I,d-Se*I),Mt=T*(e.width-$e*Math.floor(v/P));for(let Je=0;Je<Ae;Je++){for(let je=0;je<$e;je++){const Cn=T*((Se*I+je)*v*p+z*Je*v);for(let O=0;O<pt;O++)for(let D=0;D<T;D++)F(te,q,C[Cn+P*O*T+D],V.offset[D],V.scale[D]),q++}q+=Mt}}return e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),u(B)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),te!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,te)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,te),t.deactivate(),!0},t.setOpenGLRenderWindow=v=>{e._openGLRenderWindow!==v&&(t.releaseGraphicsResources(),e._openGLRenderWindow=v,e.context=null,v&&(e.context=e._openGLRenderWindow.getContext()))},t.getMaximumTextureSize=v=>v&&v.isCurrent()?v.getIntegerv(v.MAX_TEXTURE_SIZE):-1,t.enableUseHalfFloat=v=>{e.enableUseHalfFloat=v}}const sO={_openGLRenderWindow:null,_forceInternalFormat:!1,_prevTexParams:null,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:un.CLAMP_TO_EDGE,wrapT:un.CLAMP_TO_EDGE,wrapR:un.CLAMP_TO_EDGE,minificationFilter:be.NEAREST,magnificationFilter:be.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1,oglNorm16Ext:null,allocatedGPUMemoryInBytes:0,enableUseHalfFloat:!0,canUseHalfFloat:!1};function o1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sO,n),Be.extend(t,e,n),e.sendParametersTime={},qe(e.sendParametersTime,{mtime:0}),e.textureBuildTime={},qe(e.textureBuildTime,{mtime:0}),Aa(t,e,["format","openGLDataType"]),He(t,e,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap","oglNorm16Ext"]),ht(t,e,["width","height","volumeInfo","components","handle","target","allocatedGPUMemoryInBytes"]),ja(t,e,["openGLRenderWindow"]),aO(t,e)}const c1=Ce(o1,"vtkOpenGLTexture");var pn={newInstance:c1,extend:o1,...s1};Ft("vtkTexture",c1);var iO=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexMC;

// frag position in VC
//VTK::PositionVC::Dec

// optional normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

// Apple Bug
//VTK::PrimID::Dec

// picking support
//VTK::Picking::Dec

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  //VTK::PrimID::Impl

  //VTK::PositionVC::Impl

  //VTK::Light::Impl

  //VTK::Picking::Impl
}
`,oO=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the polydata mappers fragment shader

uniform int PrimitiveIDOffset;

// VC position of this fragment
//VTK::PositionVC::Dec

// optional color passed in from the vertex shader, vertexColor
//VTK::Color::Dec

// optional surface normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// define vtkImageLabelOutlineOn
//VTK::ImageLabelOutlineOn

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// Depth Peeling Support
//VTK::DepthPeeling::Dec

// clipping plane vars
//VTK::Clip::Dec

// label outline 
//VTK::LabelOutline::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

//VTK::LabelOutlineHelperFunction

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Clip::Impl

  //VTK::Color::Impl

  // Generate the normal if we are not passed in one
  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Light::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;function cO(t,e){t.replaceShaderCoincidentOffset=(n,r,a)=>{const s=t.getCoincidentParameters(r,a);if(s&&(s.factor!==0||s.offset!==0)){let i=n.Fragment;i=N.substitute(i,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,e.context.getExtension("EXT_frag_depth")&&(s.factor!==0?(i=N.substitute(i,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,i=N.substitute(i,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):i=N.substitute(i,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),e._openGLRenderWindow.getWebgl2()&&(s.factor!==0?(i=N.substitute(i,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,i=N.substitute(i,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):i=N.substitute(i,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),n.Fragment=i}}}function fO(t,e){t.applyShaderReplacements=(n,r,a)=>{let s=null;if(r&&(s=r.ShaderReplacements),s)for(let i=0;i<s.length;i++){const o=s[i];if(a&&o.replaceFirst||!a&&!o.replaceFirst){const c=o.shaderType,u=n[c],g=N.substitute(u,o.originalValue,o.replacementValue,o.replaceAll);n[c]=g.result}}},t.buildShaders=(n,r,a)=>{t.getReplacedShaderTemplate(n,r,a),e.lastRenderPassShaderReplacement=e.currentRenderPass?e.currentRenderPass.getShaderReplacement():null,e.lastRenderPassShaderReplacement&&e.lastRenderPassShaderReplacement(n);const s=e.renderable.getViewSpecificProperties().OpenGL;t.applyShaderReplacements(n,s,!0),t.replaceShaderValues(n,r,a),t.applyShaderReplacements(n,s)},t.getReplacedShaderTemplate=(n,r,a)=>{const s=e.renderable.getViewSpecificProperties().OpenGL;t.getShaderTemplate(n,r,a);let i=n.Vertex;if(s){const u=s.VertexShaderCode;u!==void 0&&u!==""&&(i=u)}n.Vertex=i;let o=n.Fragment;if(s){const u=s.FragmentShaderCode;u!==void 0&&u!==""&&(o=u)}n.Fragment=o;let c=n.Geometry;if(s){const u=s.GeometryShaderCode;u!==void 0&&(c=u)}n.Geometry=c}}var oi={implementReplaceShaderCoincidentOffset:cO,implementBuildShadersWithReplacements:fO};const{FieldAssociations:lo}=Sr,{primTypes:We}=qr,{Representation:Rr,Shading:wg}=Yr,{ScalarMode:ps}=vr,{Filter:Eg,Wrap:Rg}=pn,{vtkErrorMacro:Jn}=nn,uO={type:"StartEvent"},gO={type:"EndEvent"},{CoordinateSystem:lO}=Ya;function hO(t){const e=t.getSelector();return e?e.getCurrentPass():ct.MIN_KNOWN_PASS-1}function pO(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper"),t.buildPass=r=>{r&&(e.currentRenderPass=null,e.openGLActor=t.getFirstAncestorOfType("vtkOpenGLActor"),e._openGLRenderer=e.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera(),e.openGLCamera))},t.translucentPass=(r,a)=>{r&&(e.currentRenderPass=a,t.render())},t.zBufferPass=r=>{r&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=r=>t.zBufferPass(r),t.opaquePass=r=>{r&&t.render()},t.render=()=>{const r=e._openGLRenderWindow.getContext();if(e.context!==r){e.context=r;for(let i=We.Start;i<We.End;i++)e.primitives[i].setOpenGLRenderWindow(e._openGLRenderWindow)}const a=e.openGLActor.getRenderable(),s=e._openGLRenderer.getRenderable();t.renderPiece(s,a)},t.getShaderTemplate=(r,a,s)=>{r.Vertex=iO,r.Fragment=oO,r.Geometry=""},t.replaceShaderColor=(r,a,s)=>{let i=r.Vertex,o=r.Geometry,c=r.Fragment;const u=e.lastBoundBO.getReferenceByName("lastLightComplexity");let g=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];u&&(g=g.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let f=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];u&&(f=f.concat(["  vec3 specularColor;","  float specularPower;"])),f=f.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),u&&(f=f.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges&&(g=g.concat(["varying vec4 vertexColorVSOutput;"]),i=N.substitute(i,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,i=N.substitute(i,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,o=N.substitute(o,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,o=N.substitute(o,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges?c=N.substitute(c,"//VTK::Color::Impl",f.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result:(e.renderable.getAreScalarsMappedFromCells()||e.renderable.getInterpolateScalarsBeforeMapping())&&e.renderable.getColorCoordinates()&&!e.drawingEdges?c=N.substitute(c,"//VTK::Color::Impl",f.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:(s.getBackfaceProperty()&&!e.drawingEdges&&(g=g.concat(["uniform float opacityUniformBF; // the fragment opacity","uniform float ambientIntensityBF; // the material ambient","uniform float diffuseIntensityBF; // the material diffuse","uniform vec3 ambientColorUniformBF; // ambient material color","uniform vec3 diffuseColorUniformBF; // diffuse material color"]),u?(g=g.concat(["uniform float specularIntensityBF; // the material specular intensity","uniform vec3 specularColorUniformBF; // intensity weighted color","uniform float specularPowerUniformBF;"]),f=f.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  specularColor = specularIntensityBF * specularColorUniformBF;","  specularPower = specularPowerUniformBF;","  opacity = opacityUniformBF; }"])):f=f.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  opacity = opacityUniformBF; }"])),e.haveCellScalars&&!e.drawingEdges&&(g=g.concat(["uniform samplerBuffer texture1;"])),c=N.substitute(c,"//VTK::Color::Impl",f).result),c=N.substitute(c,"//VTK::Color::Dec",g).result,r.Vertex=i,r.Geometry=o,r.Fragment=c},t.replaceShaderLight=(r,a,s)=>{let i=r.Fragment;const o="",c=e.lastBoundBO.getReferenceByName("lastLightComplexity"),u=e.lastBoundBO.getReferenceByName("lastLightCount");let g=[];switch(c){case 0:i=N.substitute(i,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:i=N.substitute(i,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(let f=0;f<u;++f)g=g.concat([`uniform vec3 lightColor${f};`,`uniform vec3 lightDirectionVC${f}; // normalized`,`uniform vec3 lightHalfAngleVC${f}; // normalized`]);i=N.substitute(i,"//VTK::Light::Dec",g).result,g=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(let f=0;f<u;++f)g=g.concat([`  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC${f}));`,`  diffuseL += ((df${o}) * lightColor${f});`,`  if (dot(normalVCVSOutput, lightDirectionVC${f}) < 0.0)`,"    {",`    float sf = sign(df)*pow(max(1e-5,
                                              dot(reflect(lightDirectionVC${f},normalVCVSOutput),
                                                  normalize(-vertexVC.xyz))),
                                         specularPower);`,`    specularL += (sf${o} * lightColor${f});`,"    }"]);g=g.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),i=N.substitute(i,"//VTK::Light::Impl",g,!1).result;break;case 3:for(let f=0;f<u;++f)g=g.concat([`uniform vec3 lightColor${f};`,`uniform vec3 lightDirectionVC${f}; // normalized`,`uniform vec3 lightHalfAngleVC${f}; // normalized`,`uniform vec3 lightPositionVC${f};`,`uniform vec3 lightAttenuation${f};`,`uniform float lightConeAngle${f};`,`uniform float lightExponent${f};`,`uniform int lightPositional${f};`]);i=N.substitute(i,"//VTK::Light::Dec",g).result,g=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(let f=0;f<u;++f)g=g.concat(["  attenuation = 1.0;",`  if (lightPositional${f} == 0)`,"    {",`      vertLightDirectionVC = lightDirectionVC${f};`,"    }","  else","    {",`    vertLightDirectionVC = vertexVC.xyz - lightPositionVC${f};`,"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /",`      (lightAttenuation${f}.x`,`       + lightAttenuation${f}.y * distanceVC`,`       + lightAttenuation${f}.z * distanceVC * distanceVC);`,"    // per OpenGL standard cone angle is 90 or less for a spot light",`    if (lightConeAngle${f} <= 90.0)`,"      {",`      float coneDot = dot(vertLightDirectionVC, lightDirectionVC${f});`,"      // if inside the cone",`      if (coneDot >= cos(radians(lightConeAngle${f})))`,"        {",`        attenuation = attenuation * pow(coneDot, lightExponent${f});`,"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));",`    diffuseL += ((df${o}) * lightColor${f});`,"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {",`      float sf = sign(df)*attenuation*pow(max(1e-5,
                                                           dot(reflect(lightDirectionVC${f},
                                                                       normalVCVSOutput),
                                                               normalize(-vertexVC.xyz))),
                                                       specularPower);`,`    specularL += ((sf${o}) * lightColor${f});`,"    }"]);g=g.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),i=N.substitute(i,"//VTK::Light::Impl",g,!1).result;break;default:Jn("bad light complexity")}r.Fragment=i},t.replaceShaderNormal=(r,a,s)=>{if(e.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let o=r.Vertex,c=r.Geometry,u=r.Fragment;e.lastBoundBO.getCABO().getNormalOffset()?(o=N.substitute(o,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,o=N.substitute(o,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,c=N.substitute(c,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,c=N.substitute(c,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,u=N.substitute(u,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,u=N.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.haveCellNormals?(u=N.substitute(u,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,u=N.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.lastBoundBO.getOpenGLMode(s.getProperty().getRepresentation())===e.context.LINES?(u=N.substitute(u,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,u=N.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  if (abs(fdx.x) > 0.0)","    { fdx = normalize(fdx); normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { fdy = normalize(fdy); normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(u=N.substitute(u,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,u=N.substitute(u,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,u=N.substitute(u,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),r.Vertex=o,r.Geometry=c,r.Fragment=u}},t.replaceShaderPositionVC=(r,a,s)=>{e.lastBoundBO.replaceShaderPositionVC(r,a,s);let i=r.Vertex,o=r.Geometry,c=r.Fragment;e.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(i=N.substitute(i,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,i=N.substitute(i,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,i=N.substitute(i,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,o=N.substitute(o,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,o=N.substitute(o,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,c=N.substitute(c,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,c=N.substitute(c,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(i=N.substitute(i,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,i=N.substitute(i,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),r.Vertex=i,r.Geometry=o,r.Fragment=c},t.replaceShaderTCoord=(r,a,s)=>{if(e.lastBoundBO.getCABO().getTCoordOffset()){let i=r.Vertex,o=r.Geometry,c=r.Fragment;if(e.drawingEdges)return;i=N.substitute(i,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;const u=e.openGLActor.getActiveTextures();let g=2,f=2;if(u&&u.length>0&&(g=u[0].getComponents(),u[0].getTarget()===e.context.TEXTURE_CUBE_MAP&&(f=3)),e.renderable.getColorTextureMap()&&(g=e.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),f=2),f===2){if(i=N.substitute(i,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,o=N.substitute(o,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,o=N.substitute(o,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,c=N.substitute(c,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,u&&u.length>=1)switch(g){case 1:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}}else switch(i=N.substitute(i,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,o=N.substitute(o,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,o=N.substitute(o,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,c=N.substitute(c,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,g){case 1:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:c=N.substitute(c,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}r.Vertex=i,r.Geometry=o,r.Fragment=c}},t.replaceShaderClip=(r,a,s)=>{let i=r.Vertex,o=r.Fragment;if(e.renderable.getNumberOfClippingPlanes()){const c=e.renderable.getNumberOfClippingPlanes();i=N.substitute(i,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`uniform vec4 clipPlanes[${c}];`,`varying float clipDistancesVSOutput[${c}];`]).result,i=N.substitute(i,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${c}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,o=N.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`varying float clipDistancesVSOutput[${c}];`]).result,o=N.substitute(o,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${c}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}r.Vertex=i,r.Fragment=o},t.getCoincidentParameters=(r,a)=>{let s={factor:0,offset:0};const i=a.getProperty();if(e.renderable.getResolveCoincidentTopology()==Kn.PolygonOffset||i.getEdgeVisibility()&&i.getRepresentation()===Rr.SURFACE){const c=e.lastBoundBO.getPrimitiveType();c===We.Points||i.getRepresentation()===Rr.POINTS?s=e.renderable.getCoincidentTopologyPointOffsetParameter():c===We.Lines||i.getRepresentation()===Rr.WIREFRAME?s=e.renderable.getCoincidentTopologyLineOffsetParameters():(c===We.Tris||c===We.TriStrips)&&(s=e.renderable.getCoincidentTopologyPolygonOffsetParameters()),(c===We.TrisEdges||c===We.TriStripsEdges)&&(s=e.renderable.getCoincidentTopologyPolygonOffsetParameters(),s.factor/=2,s.offset/=2)}const o=e._openGLRenderer.getSelector();return o&&o.getFieldAssociation()===lo.FIELD_ASSOCIATION_POINTS&&(s.offset-=2),s},t.replaceShaderPicking=(r,a,s)=>{let i=r.Fragment,o=r.Vertex;if(i=N.substitute(i,"//VTK::Picking::Dec",["uniform int picking;","//VTK::Picking::Dec"]).result,!!e._openGLRenderer.getSelector()){switch((e.lastSelectionState===ct.ID_LOW24||e.lastSelectionState===ct.ID_HIGH24)&&(o=N.substitute(o,"//VTK::Picking::Dec",[`flat out int vertexIDVSOutput;
`,`uniform int VertexIDOffset;
`]).result,o=N.substitute(o,"//VTK::Picking::Impl",`  vertexIDVSOutput = gl_VertexID + VertexIDOffset;
`).result,i=N.substitute(i,"//VTK::Picking::Dec",`flat in int vertexIDVSOutput;
`).result,i=N.substitute(i,"//VTK::Picking::Impl",["  int idx = vertexIDVSOutput;","//VTK::Picking::Impl"]).result),e.lastSelectionState){case ct.ID_LOW24:i=N.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx%256)/255.0, float((idx/256)%256)/255.0, float((idx/65536)%256)/255.0, 1.0);").result;break;case ct.ID_HIGH24:i=N.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float((idx/16777216)%256)/255.0, 0.0, 0.0, 1.0);").result;break;default:i=N.substitute(i,"//VTK::Picking::Dec","uniform vec3 mapperIndex;").result,i=N.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result}r.Fragment=i,r.Vertex=o}},t.replaceShaderValues=(r,a,s)=>{if(t.replaceShaderColor(r,a,s),t.replaceShaderNormal(r,a,s),t.replaceShaderLight(r,a,s),t.replaceShaderTCoord(r,a,s),t.replaceShaderPicking(r,a,s),t.replaceShaderClip(r,a,s),t.replaceShaderCoincidentOffset(r,a,s),t.replaceShaderPositionVC(r,a,s),e.haveSeenDepthRequest){let i=r.Fragment;i=N.substitute(i,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,i=N.substitute(i,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,r.Fragment=i}},t.getNeedToRebuildShaders=(r,a,s)=>{let i=0,o=0;const c=r.getPrimitiveType(),u=e.currentInput;let g=!1;const f=u.getPointData().getNormals(),l=u.getCellData().getNormals(),h=s.getProperty().getInterpolation()===wg.FLAT,v=s.getProperty().getRepresentation(),p=r.getOpenGLMode(v,c);if((p===e.context.TRIANGLES||l&&!f||!h&&f||!h&&p===e.context.LINES)&&(g=!0),s.getProperty().getLighting()&&g){i=0;const x=a.getLightsByReference();for(let T=0;T<x.length;++T){const w=x[T];w.getSwitch()>0&&(o++,i===0&&(i=1)),i===1&&(o>1||w.getIntensity()!==1||!w.lightTypeIsHeadLight())&&(i=2),i<3&&w.getPositional()&&(i=3)}}let d=!1;const y=e.lastBoundBO.getReferenceByName("lastLightComplexity"),S=e.lastBoundBO.getReferenceByName("lastLightCount");return(y!==i||S!==o)&&(e.lastBoundBO.set({lastLightComplexity:i},!0),e.lastBoundBO.set({lastLightCount:o},!0),d=!0),(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(d=!0),e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime()||r.getShaderSourceTime().getMTime()<e.selectionStateChanged.getMTime()||d?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,!0):!1},t.invokeShaderCallbacks=(r,a,s)=>{const i=e.renderable.getViewSpecificProperties().ShadersCallbacks;i&&i.forEach(o=>{o.callback(o.userData,r,a,s)})},t.setMapperShaderParameters=(r,a,s)=>{if(r.getProgram().isUniformUsed("PrimitiveIDOffset")&&r.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),r.getProgram().isUniformUsed("VertexIDOffset")&&r.getProgram().setUniformi("VertexIDOffset",e.vertexIDOffset),r.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){const c=e.lastBoundBO.getReferenceByName("lastLightComplexity");r.getProgram().isAttributeUsed("vertexMC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexMC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||Jn("Error setting vertexMC in shader VAO.")),r.getProgram().isAttributeUsed("normalMC")&&r.getCABO().getNormalOffset()&&c>0?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"normalMC",r.getCABO().getNormalOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||Jn("Error setting normalMC in shader VAO."):r.getVAO().removeAttributeArray("normalMC"),e.renderable.getCustomShaderAttributes().forEach((u,g)=>{r.getProgram().isAttributeUsed(`${u}MC`)&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),`${u}MC`,r.getCABO().getCustomData()[g].offset,r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getCustomData()[g].components,!1)||Jn(`Error setting ${u}MC in shader VAO.`))}),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),!1)||Jn("Error setting tcoordMC in shader VAO."):r.getVAO().removeAttributeArray("tcoordMC"),r.getProgram().isAttributeUsed("scalarColor")&&r.getCABO().getColorComponents()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO().getColorBO(),"scalarColor",r.getCABO().getColorOffset(),r.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||Jn("Error setting scalarColor in shader VAO."):r.getVAO().removeAttributeArray("scalarColor"),r.getAttributeUpdateTime().modified()}if(e.renderable.getNumberOfClippingPlanes()){const c=e.renderable.getNumberOfClippingPlanes(),u=[],f=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,l=f?Qe(e.tmpMat4,s.getMatrix()):s.getMatrix();f&&(Oe(l,l),Ne(l,l,f),Oe(l,l));for(let h=0;h<c;h++){const v=[];e.renderable.getClippingPlaneInDataCoords(l,h,v);for(let p=0;p<4;p++)u.push(v[p])}r.getProgram().setUniformi("numClipPlanes",c),r.getProgram().setUniform4fv("clipPlanes",u)}e.internalColorTexture&&r.getProgram().isUniformUsed("texture1")&&r.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());const i=e.openGLActor.getActiveTextures();if(i)for(let c=0;c<i.length;++c){const g=i[c].getTextureUnit(),f=`texture${g+1}`;r.getProgram().isUniformUsed(f)&&r.getProgram().setUniformi(f,g)}if(e.haveSeenDepthRequest&&r.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),r.getProgram().isUniformUsed("coffset")){const c=t.getCoincidentParameters(a,s);r.getProgram().setUniformf("coffset",c.offset),r.getProgram().isUniformUsed("cfactor")&&r.getProgram().setUniformf("cfactor",c.factor)}r.setMapperShaderParameters(a,s,e._openGLRenderer.getTiledSizeAndOrigin());const o=e._openGLRenderer.getSelector();r.getProgram().setUniform3fArray("mapperIndex",o?o.getPropColorValue():[0,0,0]),r.getProgram().setUniformi("picking",o?o.getCurrentPass()+1:0)},t.setLightingShaderParameters=(r,a,s)=>{const i=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(i<2)return;const o=r.getProgram();let c=0;const u=a.getLightsByReference();for(let l=0;l<u.length;++l){const h=u[l];if(h.getSwitch()>0){const p=h.getColorByReference(),d=h.getIntensity();e.lightColor[0]=p[0]*d,e.lightColor[1]=p[1]*d,e.lightColor[2]=p[2]*d;const y=h.getDirection(),S=a.getActiveCamera().getViewMatrix(),x=[...y];h.lightTypeIsSceneLight()&&(x[0]=S[0]*y[0]+S[1]*y[1]+S[2]*y[2],x[1]=S[4]*y[0]+S[5]*y[1]+S[6]*y[2],x[2]=S[8]*y[0]+S[9]*y[1]+S[10]*y[2],Rt(x)),e.lightDirection[0]=x[0],e.lightDirection[1]=x[1],e.lightDirection[2]=x[2],Rt(e.lightDirection),o.setUniform3fArray(`lightColor${c}`,e.lightColor),o.setUniform3fArray(`lightDirectionVC${c}`,e.lightDirection),c++}}if(i<3)return;const f=a.getActiveCamera().getViewMatrix();Oe(f,f),c=0;for(let l=0;l<u.length;++l){const h=u[l];if(h.getSwitch()>0){const p=h.getTransformedPosition(),d=new Float64Array(3);Te(d,p,f),o.setUniform3fArray(`lightAttenuation${c}`,h.getAttenuationValuesByReference()),o.setUniformi(`lightPositional${c}`,h.getPositional()),o.setUniformf(`lightExponent${c}`,h.getExponent()),o.setUniformf(`lightConeAngle${c}`,h.getConeAngle()),o.setUniform3fArray(`lightPositionVC${c}`,[d[0],d[1],d[2]]),c++}}};function n(r,a,s){return a.identity(s),r.reduce((i,o,c)=>c===0?o?a.copy(i,o):a.identity(i):o?a.multiply(i,i,o):i,s)}t.setCameraShaderParameters=(r,a,s)=>{const i=r.getProgram(),o=e.openGLCamera.getKeyMatrices(a),c=a.getActiveCamera(),u=e.openGLCamera.getKeyMatrixTime().getMTime(),g=i.getLastCameraMTime(),l=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,h=s.getIsIdentity(),v=h?{mcwc:null,normalMatrix:null}:e.openGLActor.getKeyMatrices();if(s.getCoordinateSystem()===lO.DISPLAY){const p=e._openGLRenderer.getTiledSizeAndOrigin();ue(e.tmpMat4),e.tmpMat4[0]=2/p.usize,e.tmpMat4[12]=-1,e.tmpMat4[5]=2/p.vsize,e.tmpMat4[13]=-1,Ne(e.tmpMat4,e.tmpMat4,l),i.setUniformMatrix("MCPCMatrix",e.tmpMat4)}else i.setUniformMatrix("MCPCMatrix",n([o.wcpc,v.mcwc,l],Go,e.tmpMat4));i.isUniformUsed("MCVCMatrix")&&i.setUniformMatrix("MCVCMatrix",n([o.wcvc,v.mcwc,l],Go,e.tmpMat4)),i.isUniformUsed("normalMatrix")&&i.setUniformMatrix3x3("normalMatrix",n([o.normalMatrix,v.normalMatrix],UT,e.tmpMat3)),g!==u&&(i.isUniformUsed("cameraParallel")&&i.setUniformi("cameraParallel",c.getParallelProjection()),i.setLastCameraMTime(u)),h||i.setLastCameraMTime(0)},t.setPropertyShaderParameters=(r,a,s)=>{const i=r.getProgram();let o=s.getProperty(),c=o.getOpacity(),u=e.drawingEdges?o.getEdgeColorByReference():o.getAmbientColorByReference(),g=e.drawingEdges?o.getEdgeColorByReference():o.getDiffuseColorByReference(),f=e.drawingEdges?1:o.getAmbient(),l=e.drawingEdges?0:o.getDiffuse(),h=e.drawingEdges?0:o.getSpecular();const v=o.getSpecularPower();i.setUniformf("opacityUniform",c),i.setUniform3fArray("ambientColorUniform",u),i.setUniform3fArray("diffuseColorUniform",g),i.setUniformf("ambient",f),i.setUniformf("diffuse",l);const p=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(p<1)return;let d=o.getSpecularColorByReference();if(i.setUniform3fArray("specularColorUniform",d),i.setUniformf("specularPowerUniform",v),i.setUniformf("specular",h),i.isUniformUsed("ambientIntensityBF")){if(o=s.getBackfaceProperty(),c=o.getOpacity(),u=o.getAmbientColor(),f=o.getAmbient(),g=o.getDiffuseColor(),l=o.getDiffuse(),d=o.getSpecularColor(),h=o.getSpecular(),i.setUniformf("ambientIntensityBF",f),i.setUniformf("diffuseIntensityBF",l),i.setUniformf("opacityUniformBF",c),i.setUniform3fArray("ambientColorUniformBF",u),i.setUniform3fArray("diffuseColorUniformBF",g),p<1)return;i.setUniformf("specularIntensityBF",h),i.setUniform3fArray("specularColorUniformBF",d),i.setUniformf("specularPowerUniformBF",v)}},t.updateMaximumPointCellIds=(r,a)=>{const s=e._openGLRenderer.getSelector();if(!s)return;if(e.selectionWebGLIdsToVTKIds?.points?.length){const o=e.selectionWebGLIdsToVTKIds.points.length;s.setMaximumPointId(o-1)}if(e.selectionWebGLIdsToVTKIds?.cells?.length){const o=e.selectionWebGLIdsToVTKIds.cells.length;s.setMaximumCellId(o-1)}s.getFieldAssociation()===lo.FIELD_ASSOCIATION_POINTS&&(e.pointPicking=!0)},t.renderPieceStart=(r,a)=>{e.primitiveIDOffset=0,e.vertexIDOffset=0;const s=hO(e._openGLRenderer);e.lastSelectionState!==s&&(e.selectionStateChanged.modified(),e.lastSelectionState=s),e._openGLRenderer.getSelector()&&e._openGLRenderer.getSelector().renderProp(a),t.updateBufferObjects(r,a),e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),e.lastBoundBO=null},t.renderPieceDraw=(r,a)=>{const s=a.getProperty().getRepresentation(),i=a.getProperty().getEdgeVisibility()&&s===Rr.SURFACE,o=e._openGLRenderer.getSelector(),c=o&&o.getFieldAssociation()===lo.FIELD_ASSOCIATION_POINTS&&(e.lastSelectionState===ct.ID_LOW24||e.lastSelectionState===ct.ID_HIGH24);for(let u=We.Start;u<We.End;u++)e.primitives[u].setPointPicking(c),e.primitives[u].getCABO().getElementCount()&&(e.drawingEdges=i&&(u===We.TrisEdges||u===We.TriStripsEdges),(!e.drawingEdges||!(e.renderDepth||e.lastSelectionState>=0))&&(e.lastBoundBO=e.primitives[u],e.primitiveIDOffset+=e.primitives[u].drawArrays(r,a,s,t),e.vertexIDOffset+=e.primitives[u].getCABO().getElementCount()))},t.renderPieceFinish=(r,a)=>{e.LastBoundBO&&e.LastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.renderPiece=(r,a)=>{if(t.invokeEvent(uO),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(gO),!e.currentInput){Jn("No input!");return}if(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())return;const s=e.context,i=a.getProperty().getBackfaceCulling(),o=a.getProperty().getFrontfaceCulling();!i&&!o?e._openGLRenderWindow.disableCullFace():o?(e._openGLRenderWindow.enableCullFace(),s.cullFace(s.FRONT)):(e._openGLRenderWindow.enableCullFace(),s.cullFace(s.BACK)),t.renderPieceStart(r,a),t.renderPieceDraw(r,a),t.renderPieceFinish(r,a)},t.updateBufferObjects=(r,a)=>{t.getNeedToRebuildBufferObjects(r,a)&&t.buildBufferObjects(r,a),t.updateMaximumPointCellIds()},t.getNeedToRebuildBufferObjects=(r,a)=>{const s=e.VBOBuildTime.getMTime();return s<t.getMTime()||s<e.renderable.getMTime()||s<a.getMTime()||s<e.currentInput.getMTime()},t.buildBufferObjects=(r,a)=>{const s=e.currentInput;if(s===null)return;e.renderable.mapScalars(s,1);const i=e.renderable.getColorMapColors();e.haveCellScalars=!1;const o=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(o===ps.USE_CELL_DATA||o===ps.USE_CELL_FIELD_DATA||o===ps.USE_FIELD_DATA||!s.getPointData().getScalars())&&o!==ps.USE_POINT_FIELD_DATA&&i&&(e.haveCellScalars=!0);let c=a.getProperty().getInterpolation()!==wg.FLAT?s.getPointData().getNormals():null;c===null&&s.getCellData().getNormals()&&(e.haveCellNormals=!0,c=s.getCellData().getNormals());const u=a.getProperty().getRepresentation();let g=s.getPointData().getTCoords();e.openGLActor.getActiveTextures()||(g=null);let f=!1;if(e.renderable.getColorCoordinates()){g=e.renderable.getColorCoordinates(),f=e.renderable.getAreScalarsMappedFromCells(),e.internalColorTexture||(e.internalColorTexture=pn.newInstance({resizable:!0}));const h=e.internalColorTexture;h.setMinificationFilter(Eg.NEAREST),h.setMagnificationFilter(Eg.NEAREST),h.setWrapS(Rg.CLAMP_TO_EDGE),h.setWrapT(Rg.CLAMP_TO_EDGE),h.setOpenGLRenderWindow(e._openGLRenderWindow);const v=e.renderable.getColorTextureMap(),p=v.getExtent(),d=v.getPointData().getScalars();h.create2DFromRaw({width:p[1]-p[0]+1,height:p[3]-p[2]+1,numComps:d.getNumberOfComponents(),dataType:d.getDataType(),data:d.getData()}),h.activate(),h.sendParameters(),h.deactivate()}const l=`${s.getMTime()}A${u}B${s.getMTime()}C${c?c.getMTime():1}D${i?i.getMTime():1}E${a.getProperty().getEdgeVisibility()}F${g?g.getMTime():1}`;if(e.VBOBuildString!==l){const v={points:s.getPoints(),normals:c,tcoords:g,colors:i,cellOffset:0,vertexOffset:0,useTCoordsPerCell:f,haveCellScalars:e.haveCellScalars,haveCellNormals:e.haveCellNormals,customAttributes:e.renderable.getCustomShaderAttributes().map(y=>s.getPointData().getArrayByName(y))};e.renderable.getPopulateSelectionSettings()&&(e.selectionWebGLIdsToVTKIds={points:null,cells:null});const p=[{inRep:"verts",cells:s.getVerts()},{inRep:"lines",cells:s.getLines()},{inRep:"polys",cells:s.getPolys()},{inRep:"strips",cells:s.getStrips()},{inRep:"polys",cells:s.getPolys()},{inRep:"strips",cells:s.getStrips()}],d=a.getProperty().getEdgeVisibility()&&u===Rr.SURFACE;for(let y=We.Start;y<We.End;y++)y!==We.TrisEdges&&y!==We.TriStripsEdges?(v.cellOffset+=e.primitives[y].getCABO().createVBO(p[y].cells,p[y].inRep,u,v,e.selectionWebGLIdsToVTKIds),v.vertexOffset+=e.primitives[y].getCABO().getElementCount()):d?e.primitives[y].getCABO().createVBO(p[y].cells,p[y].inRep,Rr.WIREFRAME,{...v,tcoords:null,colors:null,haveCellScalars:!1,haveCellNormals:!1}):e.primitives[y].releaseGraphicsResources();e.renderable.getPopulateSelectionSettings()&&e.renderable.setSelectionWebGLIdsToVTKIds(e.selectionWebGLIdsToVTKIds),e.VBOBuildString=l}e.VBOBuildTime.modified()},t.getAllocatedGPUMemoryInBytes=()=>{let r=0;return e.primitives.forEach(a=>{r+=a.getAllocatedGPUMemoryInBytes()}),r}}const dO={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastSelectionState:ct.MIN_KNOWN_PASS-1,selectionStateChanged:null,selectionWebGLIdsToVTKIds:null,pointPicking:!1};function vO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dO,n),Be.extend(t,e,n),oi.implementReplaceShaderCoincidentOffset(t,e,n),oi.implementBuildShadersWithReplacements(t,e,n),e.primitives=[],e.primTypes=We,e.tmpMat3=jn(new Float64Array(9)),e.tmpMat4=ue(new Float64Array(16));for(let r=We.Start;r<We.End;r++)e.primitives[r]=qr.newInstance(),e.primitives[r].setPrimitiveType(r),e.primitives[r].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);He(t,e,["context"]),e.VBOBuildTime={},qe(e.VBOBuildTime,{mtime:0}),e.selectionStateChanged={},qe(e.selectionStateChanged,{mtime:0}),pO(t,e)}const yO=Ce(vO,"vtkOpenGLPolyDataMapper");Ft("vtkMapper",yO);var TO=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

uniform int PrimitiveIDOffset;

// Texture coordinates
//VTK::TCoord::Dec

// Scalar coloring
//VTK::Color::Dec

// Depth Peeling
//VTK::DepthPeeling::Dec

// picking support
//VTK::Picking::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Color::Impl
  //VTK::TCoord::Impl

  //VTK::DepthPeeling::Impl
  //VTK::Picking::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }
}
`,xO=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model Coordinates
// WC - WC world coordinates
// VC - View Coordinates
// DC - Display Coordinates

in vec4 vertexWC;

// frag position in VC
//VTK::PositionVC::Dec

// material property values
//VTK::Color::Dec

// Texture coordinates
//VTK::TCoord::Dec

// Apple Bug
//VTK::PrimID::Dec

uniform mat4 WCVCMatrix;  // World to view matrix

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  gl_Position = WCVCMatrix*vertexWC;

  //VTK::TCoord::Impl

  //VTK::Color::Impl

  //VTK::PositionVC::Impl
}
`;const f1={BACKGROUND:0,FOREGROUND:1};var u1={DisplayLocation:f1};const{primTypes:_t}=qr,{Filter:Mg,Wrap:Og}=pn,{vtkErrorMacro:aa}=nn,SO={type:"StartEvent"},CO={type:"EndEvent"};function wO(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper2D"),t.buildPass=r=>{r&&(e.openGLActor2D=t.getFirstAncestorOfType("vtkOpenGLActor2D"),e._openGLRenderer=e.openGLActor2D.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera(),e.openGLCamera))},t.overlayPass=r=>{r&&t.render()},t.getShaderTemplate=(r,a,s)=>{r.Vertex=xO,r.Fragment=TO,r.Geometry=""},t.render=()=>{const r=e._openGLRenderWindow.getContext();if(e.context!==r){e.context=r;for(let i=_t.Start;i<_t.End;i++)e.primitives[i].setOpenGLRenderWindow(e._openGLRenderWindow)}const a=e.openGLActor2D.getRenderable(),s=e._openGLRenderer.getRenderable();t.renderPiece(s,a)},t.renderPiece=(r,a)=>{if(t.invokeEvent(SO),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(CO),!e.currentInput){aa("No input!");return}if(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())return;const s=e.context;e._openGLRenderWindow.enableCullFace(),s.cullFace(s.BACK),t.renderPieceStart(r,a),t.renderPieceDraw(r,a),t.renderPieceFinish(r,a)},t.renderPieceStart=(r,a)=>{if(e.primitiveIDOffset=0,e._openGLRenderer.getSelector())switch(e._openGLRenderer.getSelector().getCurrentPass()){default:e._openGLRenderer.getSelector().renderProp(a)}e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),t.updateBufferObjects(r,a),e.lastBoundBO=null},t.getNeedToRebuildShaders=(r,a,s)=>r.getShaderSourceTime().getMTime()<e.renderable.getMTime()||r.getShaderSourceTime().getMTime()<e.currentInput.getMTime(),t.updateBufferObjects=(r,a)=>{t.getNeedToRebuildBufferObjects(r,a)&&t.buildBufferObjects(r,a)},t.getNeedToRebuildBufferObjects=(r,a)=>{const s=e.VBOBuildTime.getMTime();return!!(s<t.getMTime()||s<e._openGLRenderWindow.getMTime()||s<e.renderable.getMTime()||s<a.getMTime()||s<e.currentInput.getMTime()||e.renderable.getTransformCoordinate()&&s<r.getMTime())},t.buildBufferObjects=(r,a)=>{const s=e.currentInput;if(s===null)return;e.renderable.mapScalars(s,a.getProperty().getOpacity());const i=e.renderable.getColorMapColors(),o=a.getProperty().getRepresentation();let c=s.getPointData().getTCoords();e.openGLActor2D.getActiveTextures()||(c=null);let u=!1;if(e.renderable.getColorCoordinates()){c=e.renderable.getColorCoordinates(),u=e.renderable.getAreScalarsMappedFromCells(),e.internalColorTexture||(e.internalColorTexture=pn.newInstance({resizable:!0}));const v=e.internalColorTexture;v.setMinificationFilter(Mg.NEAREST),v.setMagnificationFilter(Mg.NEAREST),v.setWrapS(Og.CLAMP_TO_EDGE),v.setWrapT(Og.CLAMP_TO_EDGE),v.setOpenGLRenderWindow(e._openGLRenderWindow);const p=e.renderable.getColorTextureMap(),d=p.getExtent(),y=p.getPointData().getScalars();v.create2DFromRaw({width:d[1]-d[0]+1,height:d[3]-d[2]+1,numComps:y.getNumberOfComponents(),dataType:y.getDataType(),data:y.getData()}),v.activate(),v.sendParameters(),v.deactivate()}const g=e.renderable.getTransformCoordinate(),l=r.getRenderWindow().getViews()[0].getViewportSize(r),h=`${s.getMTime()}A${o}B${s.getMTime()}C${i?i.getMTime():1}D${c?c.getMTime():1}E${g?r.getMTime():1}F${l}`;if(e.VBOBuildString!==h){let v=s.getPoints();if(g){const d=ba.newInstance(),y=v.getNumberOfPoints();d.setNumberOfPoints(y);const S=[];for(let x=0;x<y;++x){v.getPoint(x,S),g.setValue(S);const T=g.getComputedDoubleViewportValue(r);d.setPoint(x,T[0],T[1],0)}v=d}const p={points:v,tcoords:c,colors:i,cellOffset:0,useTCoordsPerCell:u,haveCellScalars:e.renderable.getAreScalarsMappedFromCells(),customAttributes:e.renderable.getCustomShaderAttributes().map(d=>s.getPointData().getArrayByName(d))};p.cellOffset+=e.primitives[_t.Points].getCABO().createVBO(s.getVerts(),"verts",o,p),p.cellOffset+=e.primitives[_t.Lines].getCABO().createVBO(s.getLines(),"lines",o,p),p.cellOffset+=e.primitives[_t.Tris].getCABO().createVBO(s.getPolys(),"polys",o,p),p.cellOffset+=e.primitives[_t.TriStrips].getCABO().createVBO(s.getStrips(),"strips",o,p),e.VBOBuildTime.modified(),e.VBOBuildString=h}},t.renderPieceDraw=(r,a)=>{const s=a.getProperty().getRepresentation();e.context.depthMask(!0);for(let o=_t.Start;o<_t.End;o++)e.primitives[o].getCABO().getElementCount()&&(e.lastBoundBO=e.primitives[o],e.primitiveIDOffset+=e.primitives[o].drawArrays(r,a,s,t))},t.renderPieceFinish=(r,a)=>{e.lastBoundBO&&e.lastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.replaceShaderValues=(r,a,s)=>{t.replaceShaderColor(r,a,s),t.replaceShaderTCoord(r,a,s),t.replaceShaderPicking(r,a,s),t.replaceShaderPositionVC(r,a,s)},t.replaceShaderColor=(r,a,s)=>{let i=r.Vertex,o=r.Geometry,c=r.Fragment,u=["uniform vec3 diffuseColorUniform;","uniform float opacityUniform;"],g=["vec3 diffuseColor = diffuseColorUniform;","float opacity = opacityUniform;"];e.lastBoundBO.getCABO().getColorComponents()!==0?(u=u.concat(["varying vec4 vertexColorVSOutput;"]),i=N.substitute(i,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,i=N.substitute(i,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,o=N.substitute(o,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,o=N.substitute(o,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result,c=N.substitute(c,"//VTK::Color::Impl",g.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result):e.renderable.getAreScalarsMappedFromCells()&&(g=g.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  opacity = opacity*texColor.a;"])),g=g.concat(["gl_FragData[0] = vec4(diffuseColor, opacity);"]),c=N.substitute(c,"//VTK::Color::Dec",u).result,c=N.substitute(c,"//VTK::Color::Impl",g).result,r.Vertex=i,r.Geometry=o,r.Fragment=c},t.replaceShaderTCoord=(r,a,s)=>{if(e.lastBoundBO.getCABO().getTCoordOffset()){let i=r.Vertex,o=r.Geometry,c=r.Fragment;const u=e.lastBoundBO.getCABO().getTCoordComponents();u===1?(i=N.substitute(i,"//VTK::TCoord::Dec",["in float tcoordMC;","out float tcoordVCVSOutput;"]).result,i=N.substitute(i,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,o=N.substitute(o,"//VTK::TCoord::Dec",[`in float tcoordVCVSOutput[];
`,"out float tcoordVCGSOutput;"]).result,o=N.substitute(o,["//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,c=N.substitute(c,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,c=N.substitute(c,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, vec2(tcoordVCVSOutput,0));"]).result):u===2&&(i=N.substitute(i,"//VTK::TCoord::Dec",["in vec2 tcoordMC;","out vec2 tcoordVCVSOutput;"]).result,i=N.substitute(i,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,o=N.substitute(o,"//VTK::TCoord::Dec",[`in vec2 tcoordVCVSOutput[];
`,"out vec2 tcoordVCGSOutput;"]).result,o=N.substitute(o,"//VTK::TCoord::Impl",["tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,c=N.substitute(c,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,c=N.substitute(c,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, tcoordVCVSOutput.st);"]).result),e.renderable.getAreScalarsMappedFromCells()&&(o=N.substitute(o,"//VTK::PrimID::Impl",["gl_PrimitiveID = gl_PrimitiveIDIn;"]).result),r.Vertex=i,r.Geometry=o,r.Fragment=c}},t.replaceShaderPicking=(r,a,s)=>{let i=r.Fragment;i=N.substitute(i,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,i=N.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,r.Fragment=i},t.replaceShaderPositionVC=(r,a,s)=>{e.lastBoundBO.replaceShaderPositionVC(r,a,s)},t.invokeShaderCallbacks=(r,a,s)=>{const i=e.renderable.getViewSpecificProperties().ShadersCallbacks;i&&i.forEach(o=>{o.callback(o.userData,r,a,s)})},t.setMapperShaderParameters=(r,a,s)=>{if(r.getProgram().isUniformUsed("PrimitiveIDOffset")&&r.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),r.getProgram().isAttributeUsed("vertexWC")&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"vertexWC",r.getCABO().getVertexOffset(),r.getCABO().getStride(),e.context.FLOAT,3,!1)||aa("Error setting vertexWC in shader VAO.")),r.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>r.getAttributeUpdateTime().getMTime()||r.getShaderSourceTime().getMTime()>r.getAttributeUpdateTime().getMTime())){e.renderable.getCustomShaderAttributes().forEach((c,u)=>{r.getProgram().isAttributeUsed(`${c}MC`)&&(r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),`${c}MC`,r.getCABO().getCustomData()[u].offset,r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getCustomData()[u].components,!1)||aa(`Error setting ${c}MC in shader VAO.`))}),r.getProgram().isAttributeUsed("tcoordMC")&&r.getCABO().getTCoordOffset()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO(),"tcoordMC",r.getCABO().getTCoordOffset(),r.getCABO().getStride(),e.context.FLOAT,r.getCABO().getTCoordComponents(),!1)||aa("Error setting tcoordMC in shader VAO."):r.getVAO().removeAttributeArray("tcoordMC"),r.getProgram().isAttributeUsed("scalarColor")&&r.getCABO().getColorComponents()?r.getVAO().addAttributeArray(r.getProgram(),r.getCABO().getColorBO(),"scalarColor",r.getCABO().getColorOffset(),r.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||aa("Error setting scalarColor in shader VAO."):r.getVAO().removeAttributeArray("scalarColor"),e.internalColorTexture&&r.getProgram().isUniformUsed("texture1")&&e.internalColorTexture.getTextureUnit()>-1&&r.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());const i=e.openGLActor2D.getActiveTextures();if(i)for(let c=0;c<i.length;++c){const g=i[c].getTextureUnit(),f=`texture${g+1}`;r.getProgram().isUniformUsed(f)&&r.getProgram().setUniformi(f,g)}r.setMapperShaderParameters(a,s,e._openGLRenderer.getTiledSizeAndOrigin());const o=e._openGLRenderer.getSelector();r.getProgram().setUniform3fArray("mapperIndex",o?o.getPropColorValue():[0,0,0]),r.getProgram().setUniformi("picking",o?o.getCurrentPass()+1:0)}},t.setPropertyShaderParameters=(r,a,s)=>{const i=e.renderable.getColorMapColors();if(!i||i.getNumberOfComponents()===0){const o=r.getProgram(),c=s.getProperty(),u=c.getOpacity();o.setUniformf("opacityUniform",u);const g=c.getColor();o.setUniform3fArray("diffuseColorUniform",g)}},t.setLightingShaderParameters=(r,a,s)=>{};function n(r,a,s){return a.identity(s),r.reduce((i,o,c)=>c===0?o?a.copy(i,o):a.identity(i):o?a.multiply(i,i,o):i,s)}t.setCameraShaderParameters=(r,a,s)=>{const i=r.getProgram(),c=r.getCABO().getCoordShiftAndScaleEnabled()?r.getCABO().getInverseShiftAndScaleMatrix():null,g=a.getRenderWindow().getViews()[0].getViewportSize(a),f=a.getViewport(),l=s.getActualPositionCoordinate().getComputedDoubleViewportValue(a),h=[0,0,1,1],v=[0,0,1,1];if(v[0]=f[0]>=h[0]?f[0]:h[0],v[1]=f[1]>=h[1]?f[1]:h[1],v[2]=f[2]<=h[2]?f[2]:h[2],v[3]=f[3]<=h[3]?f[3]:h[3],v[0]>=v[2]||v[1]>=v[3])return;g[0]=ua(g[0]*(v[2]-v[0])/(f[2]-f[0])),g[1]=ua(g[1]*(v[3]-v[1])/(f[3]-f[1]));const p=e._openGLRenderer.getParent().getSize(),d=ua(l[0]-(v[0]-f[0])*p[0]),y=ua(l[1]-(v[1]-f[1])*p[1]),S=-d;let x=-d+g[0];const T=-y;let w=-y+g[1];S===x&&(x=S+1),T===w&&(w=T+1);const C=ue(new Float64Array(16));C[0]=2/(x-S),C[5]=2/(w-T),C[3]=-1*(x+S)/(x-S),C[7]=-1*(w+T)/(w-T),C[10]=0,C[11]=s.getProperty().getDisplayLocation()===f1.FOREGROUND?-1:1,C[15]=1,Oe(C,C),i.setUniformMatrix("WCVCMatrix",n([C,c],Go,e.tmpMat4))},t.getAllocatedGPUMemoryInBytes=()=>{let r=0;return e.primitives.forEach(a=>{r+=a.getAllocatedGPUMemoryInBytes()}),r}}const EO={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null};function RO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,EO,n),Be.extend(t,e,n),oi.implementReplaceShaderCoincidentOffset(t,e,n),oi.implementBuildShadersWithReplacements(t,e,n),e.primitives=[],e.primTypes=_t,e.tmpMat4=ue(new Float64Array(16));for(let r=_t.Start;r<_t.End;r++)e.primitives[r]=qr.newInstance(),e.primitives[r].setPrimitiveType(r),e.primitives[r].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);He(t,e,["context"]),e.VBOBuildTime={},qe(e.VBOBuildTime,{mtime:0}),wO(t,e)}const MO=Ce(RO,"vtkOpenGLPolyDataMapper2D");Ft("vtkMapper2D",MO);const OO={HORIZONTAL:"horizontal",VERTICAL:"vertical",AUTO:"auto"};var g1={Orientation:OO};const{VectorMode:DO}=xp,{Orientation:ci}=g1;function ho(t,e,n){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor;const r=e.fontSize??n;t.font=`${e.fontStyle} ${r}px ${e.fontFamily}`}function l1(t,e){return n=>{const r=n.getLastSize(),a=(r[0]/700)**.8,s=(r[1]/700)**.8,i=Math.min(a,s),o=n.getAxisTextStyle(),c=n.getTickTextStyle();Object.assign(o,e.axisTextStyle),Object.assign(c,e.tickTextStyle),o.fontSize===void 0&&(o.fontSize=Math.max(24*i,12)),c.fontSize===void 0&&(n.getLastAspectRatio()>1?c.fontSize=Math.max(20*i,10):c.fontSize=Math.max(16*i,10));const u=n.updateTextureAtlas();n.setTopTitle(!1);const g=n.getBoxSizeByReference();let f=!1;if(e.orientation===ci.VERTICAL?f=!0:e.orientation===ci.HORIZONTAL?f=!1:f=n.getLastAspectRatio()>1,f)n.setTickLabelPixelOffset(.3*c.fontSize),u.titleWidth<=u.tickWidth+n.getTickLabelPixelOffset()+.8*c.fontSize?(n.setTopTitle(!0),n.setAxisTitlePixelOffset(.2*c.fontSize),g[0]=2*(u.tickWidth+n.getTickLabelPixelOffset()+.8*c.fontSize)/r[0],n.setBoxPosition([.98-g[0],-.92])):(n.setAxisTitlePixelOffset(.2*c.fontSize),g[0]=2*(u.titleHeight+n.getAxisTitlePixelOffset()+u.tickWidth+n.getTickLabelPixelOffset()+.8*c.fontSize)/r[0],n.setBoxPosition([.99-g[0],-.92])),g[1]=Math.max(1.2,Math.min(1.84/s,1.84));else{n.setAxisTitlePixelOffset(1.2*c.fontSize),n.setTickLabelPixelOffset(.1*c.fontSize);const l=2*(.8*c.fontSize+u.titleHeight+n.getAxisTitlePixelOffset())/r[1],h=2*u.tickWidth/r[0];g[0]=Math.min(1.9,Math.max(1.4,1.4*h*(n.getTicks().length+3))),g[1]=l,n.setBoxPosition([-.5*g[0],-.97])}n.recomputeBarSegments(u)}}function h1(t,e){return n=>{const r=n.getLastTickBounds(),a=Yc().domain([r[0],r[1]]),s=a.ticks(5),i=a.tickFormat(5);n.setTicks(s),n.setTickStrings(s.map(i))}}function LO(t,e){e.classHierarchy.push("vtkScalarBarActorHelper"),t.setRenderable=a=>{e.renderable!==a&&(e.renderable=a,e.barActor.setProperty(a.getProperty()),e.barActor.setParentProp(a),e.barActor.setCoordinateSystemToDisplay(),e.tmActor.setProperty(a.getProperty()),e.tmActor.setParentProp(a),e.tmActor.setCoordinateSystemToDisplay(),e.generateTicks=a.generateTicks,e.axisTextStyle={...a.getAxisTextStyle()},e.tickTextStyle={...a.getTickTextStyle()},t.modified())},t.updateAPISpecificData=(a,s,i)=>{(e.lastSize[0]!==a[0]||e.lastSize[1]!==a[1])&&(e.lastSize[0]=a[0],e.lastSize[1]=a[1],e.lastAspectRatio=a[0]/a[1],e.forceUpdate=!0);const o=e.renderable.getScalarsToColors();if(!(!o||!e.renderable.getVisibility())&&(e.barMapper.setLookupTable(o),e.camera=s,e.renderWindow=i,e.forceUpdate||Math.max(o.getMTime(),t.getMTime(),e.renderable.getMTime())>e.lastRebuildTime.getMTime())){const c=o.getMappingRange();if(e.lastTickBounds=[...c],e.renderable.getGenerateTicks()(t),e.renderable.getAutomated())e.renderable.getAutoLayout()(t);else{e.axisTextStyle={...e.renderable.getAxisTextStyle()},e.tickTextStyle={...e.renderable.getTickTextStyle()},e.barPosition=[...e.renderable.getBarPosition()],e.barSize=[...e.renderable.getBarSize()],e.boxPosition=[...e.renderable.getBoxPosition()],e.boxSize=[...e.renderable.getBoxSize()],e.axisTitlePixelOffset=e.renderable.getAxisTitlePixelOffset(),e.tickLabelPixelOffset=e.renderable.getTickLabelPixelOffset();const u=t.updateTextureAtlas();t.recomputeBarSegments(u)}t.updatePolyDataForLabels(),t.updatePolyDataForBarSegments(),e.lastRebuildTime.modified(),e.forceUpdate=!1}},t.updateTextureAtlas=()=>{e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left";const a={},s=new Map;let i=0,o=1;ho(e.tmContext,e.axisTextStyle,18);let c=e.tmContext.measureText(e.renderable.getAxisLabel()),u={height:c.actualBoundingBoxAscent+2,startingHeight:o,width:c.width+2,textStyle:e.axisTextStyle};s.set(e.renderable.getAxisLabel(),u),o+=u.height,i=u.width,a.titleWidth=u.width,a.titleHeight=u.height,a.tickWidth=0,a.tickHeight=0,ho(e.tmContext,e.tickTextStyle,14);const g=[...t.getTickStrings(),"NaN","Below","Above"];for(let f=0;f<g.length;f++)s.has(g[f])||(c=e.tmContext.measureText(g[f]),u={height:c.actualBoundingBoxAscent+2,startingHeight:o,width:c.width+2,textStyle:e.tickTextStyle},s.set(g[f],u),o+=u.height,i<u.width&&(i=u.width),a.tickWidth<u.width&&(a.tickWidth=u.width),a.tickHeight<u.height&&(a.tickHeight=u.height));return i=Vt(i),o=Vt(o),s.forEach(f=>{f.tcoords=[0,(o-f.startingHeight-f.height)/o,f.width/i,(o-f.startingHeight-f.height)/o,f.width/i,(o-f.startingHeight)/o,0,(o-f.startingHeight)/o]}),e.tmCanvas.width=i,e.tmCanvas.height=o,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,i,o),s.forEach((f,l)=>{const h=f.textStyle===e.axisTextStyle?18:14;ho(e.tmContext,f.textStyle,h),e.tmContext.fillText(l,1,f.startingHeight+f.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified(),e._tmAtlas=s,a},t.computeBarSize=a=>{e.vertical=e.boxSize[1]>e.boxSize[0];const s=2*a.tickHeight/e.lastSize[1],i=[1,1];if(e.vertical){const o=2*(a.tickWidth+e.tickLabelPixelOffset)/e.lastSize[0];if(e.topTitle){const c=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0]-o,e.barSize[1]=e.boxSize[1]-c}else{const c=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[0];e.barSize[0]=e.boxSize[0]-c-o,e.barSize[1]=e.boxSize[1]}e.barPosition[0]=e.boxPosition[0]+o,e.barPosition[1]=e.boxPosition[1],i[1]=s}else{const o=(2*a.tickWidth-8)/e.lastSize[0],c=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0],e.barPosition[0]=e.boxPosition[0],e.barSize[1]=e.boxSize[1]-c,e.barPosition[1]=e.boxPosition[1],i[0]=o}return i},t.recomputeBarSegments=a=>{const s=t.computeBarSize(a);e.barSegments=[];const i=[0,0],o=e.vertical?1:0,c=e.vertical?.01:.02;function u(l,h){e.barSegments.push({corners:[[...i],[i[0]+s[0],i[1]],[i[0]+s[0],i[1]+s[1]],[i[0],i[1]+s[1]]],scalars:h,title:l}),i[o]+=s[o]+c}e.renderable.getDrawNanAnnotation()&&e.renderable.getScalarsToColors().getNanColor()&&u("NaN",[NaN,NaN,NaN,NaN]),e.renderable.getDrawBelowRangeSwatch()&&e.renderable.getScalarsToColors().getUseBelowRangeColor?.()&&u("Below",[-.1,-.1,-.1,-.1]);const g=e.renderable.getScalarsToColors().getUseAboveRangeColor?.();i[o]+=c;const f=s[o];s[o]=g?1-2*c-s[o]-i[o]:1-c-i[o],u("ticks",e.vertical?[0,0,.995,.995]:[0,.995,.995,0]),e.renderable.getDrawAboveRangeSwatch()&&g&&(s[o]=f,i[o]+=c,u("Above",[1.1,1.1,1.1,1.1]))};const n=new Float64Array(3);t.createPolyDataForOneLabel=(a,s,i,o,c,u)=>{const g=e._tmAtlas.get(a);if(!g)return;let f=u.ptIdx,l=u.cellIdx;n[0]=(.5*s[0]+.5)*e.lastSize[0],n[1]=(.5*s[1]+.5)*e.lastSize[1],n[2]=s[2],n[0]+=c[0],n[1]+=c[1];const h=[],v=o==="vertical"?[1,0]:[0,1];o==="vertical"?(h[0]=g.width,h[1]=-g.height,i[0]==="middle"?n[1]-=g.width/2:i[0]==="right"&&(n[1]-=g.width),i[1]==="middle"?n[0]+=g.height/2:i[1]==="top"&&(n[0]+=g.height)):(h[0]=g.width,h[1]=g.height,i[0]==="middle"?n[0]-=g.width/2:i[0]==="right"&&(n[0]-=g.width),i[1]==="middle"?n[1]-=g.height/2:i[1]==="top"&&(n[1]-=g.height)),u.points[f*3]=n[0],u.points[f*3+1]=n[1],u.points[f*3+2]=n[2],u.tcoords[f*2]=g.tcoords[0],u.tcoords[f*2+1]=g.tcoords[1],f++,n[v[0]]+=h[0],u.points[f*3]=n[0],u.points[f*3+1]=n[1],u.points[f*3+2]=n[2],u.tcoords[f*2]=g.tcoords[2],u.tcoords[f*2+1]=g.tcoords[3],f++,n[v[1]]+=h[1],u.points[f*3]=n[0],u.points[f*3+1]=n[1],u.points[f*3+2]=n[2],u.tcoords[f*2]=g.tcoords[4],u.tcoords[f*2+1]=g.tcoords[5],f++,n[v[0]]-=h[0],u.points[f*3]=n[0],u.points[f*3+1]=n[1],u.points[f*3+2]=n[2],u.tcoords[f*2]=g.tcoords[6],u.tcoords[f*2+1]=g.tcoords[7],f++,u.polys[l*4]=3,u.polys[l*4+1]=f-4,u.polys[l*4+2]=f-3,u.polys[l*4+3]=f-2,l++,u.polys[l*4]=3,u.polys[l*4+1]=f-4,u.polys[l*4+2]=f-2,u.polys[l*4+3]=f-1,u.ptIdx+=4,u.cellIdx+=2};const r=new Float64Array(3);t.updatePolyDataForLabels=()=>{const a=t.getTickStrings().length+e.barSegments.length,s=a*4,i=a*2,o=new Float64Array(s*3),c=new Uint16Array(i*4),u=new Float32Array(s*2),g={ptIdx:0,cellIdx:0,polys:c,points:o,tcoords:u},f=e.vertical?0:1,l=e.vertical?1:0;r[2]=-.99;const h=e.vertical?["right","middle"]:["middle","bottom"];let v=[0,1];const p=[0,0];e.vertical?(p[0]=-e.tickLabelPixelOffset,e.topTitle?(r[0]=e.boxPosition[0]+.5*e.boxSize[0],r[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],g)):(r[0]=e.barPosition[0]+e.barSize[0],r[1]=e.barPosition[1]+.5*e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","top"],"vertical",[e.axisTitlePixelOffset,0],g)),v=[-1,0]):(p[1]=e.tickLabelPixelOffset,r[0]=e.barPosition[0]+.5*e.barSize[0],r[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],g)),r[f]=e.barPosition[f]+(.5*v[f]+.5)*e.barSize[f],r[l]=e.barPosition[l]+e.barSize[l]*.5;let d=null;for(let R=0;R<e.barSegments.length;R++){const M=e.barSegments[R];M.title==="ticks"?d=M:(r[l]=e.barPosition[l]+.5*e.barSize[l]*(M.corners[2][l]+M.corners[0][l]),t.createPolyDataForOneLabel(M.title,r,h,"horizontal",p,g))}const y=e.barPosition[l]+e.barSize[l]*d.corners[0][l],S=e.barSize[l]*(d.corners[2][l]-d.corners[0][l]),x=t.getTicks(),T=t.getTickStrings(),w=t.getTickPositions();for(let R=0;R<x.length;R++){const M=w?w[R]:(x[R]-e.lastTickBounds[0])/(e.lastTickBounds[1]-e.lastTickBounds[0]);r[l]=y+S*M,t.createPolyDataForOneLabel(T[R],r,h,"horizontal",p,g)}const C=De.newInstance({numberOfComponents:2,values:u,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(C),e.tmPolyData.getPoints().setData(o,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(c,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updatePolyDataForBarSegments=()=>{const a=e.renderable.getScalarsToColors();let s=0;e.renderable.getDrawNanAnnotation()&&a.getNanColor()&&(s+=1),e.renderable.getDrawBelowRangeSwatch()&&a.getUseBelowRangeColor?.()&&(s+=1),e.renderable.getDrawAboveRangeSwatch()&&a.getUseAboveRangeColor?.()&&(s+=1);const i=4*(1+s),o=i;let c=1;a.getVectorMode()===DO.COMPONENT&&(c=a.getVectorComponent()+1);const u=new Float64Array(i*3),g=new Uint16Array(o*5),f=new Float32Array(i*c);let l=0,h=0;for(let p=0;p<e.barSegments.length;p++){const d=e.barSegments[p];for(let y=0;y<4;y++){r[0]=e.barPosition[0]+d.corners[y][0]*e.barSize[0],r[1]=e.barPosition[1]+d.corners[y][1]*e.barSize[1],u[l*3]=(.5*r[0]+.5)*e.lastSize[0],u[l*3+1]=(.5*r[1]+.5)*e.lastSize[1],u[l*3+2]=r[2];for(let S=0;S<c;S++)f[l*c+S]=e.lastTickBounds[0]+d.scalars[y]*(e.lastTickBounds[1]-e.lastTickBounds[0]);l++}g[h*5]=4,g[h*5+1]=l-4,g[h*5+2]=l-3,g[h*5+3]=l-2,g[h*5+4]=l-1,h++}const v=De.newInstance({numberOfComponents:c,values:f,name:"Scalars"});e.polyData.getPointData().setScalars(v),e.polyData.getPoints().setData(u,3),e.polyData.getPoints().modified(),e.polyData.getPolys().setData(g,1),e.polyData.getPolys().modified(),e.polyData.modified()}}const VO=E.newInstance(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},n),E.obj(t,e),E.setGet(t,e,["axisTitlePixelOffset","tickLabelPixelOffset","renderable","topTitle","ticks","tickStrings","tickPositions"]),E.get(t,e,["lastSize","lastAspectRatio","lastTickBounds","axisTextStyle","tickTextStyle","barActor","tmActor"]),E.getArray(t,e,["boxPosition","boxSize"]),E.setArray(t,e,["boxPosition","boxSize"],2),e.forceUpdate=!1,e.lastRebuildTime={},E.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.barMapper=vr.newInstance(),e.barMapper.setInterpolateScalarsBeforeMapping(!0),e.barMapper.setUseLookupTableScalarRange(!0),e.polyData=Tr.newInstance(),e.barMapper.setInputData(e.polyData),e.barActor=dr.newInstance(),e.barActor.setMapper(e.barMapper),e.tmPolyData=Tr.newInstance(),e.tmMapper=vr.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmTexture=Wa.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),e.tmActor=dr.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),e.tmActor.addTexture(e.tmTexture),e.barPosition=[0,0],e.barSize=[0,0],e.boxPosition=[.88,-.92],e.boxSize=[.1,1.1],e.lastTickBounds=[],LO(t,e)},"vtkScalarBarActorHelper");function mO(t,e){e.classHierarchy.push("vtkScalarBarActor"),t.setTickTextStyle=n=>{e.tickTextStyle={...e.tickTextStyle,...n},t.modified()},t.setAxisTextStyle=n=>{e.axisTextStyle={...e.axisTextStyle,...n},t.modified()},t.setOrientationToHorizontal=()=>t.setOrientation(ci.HORIZONTAL),t.setOrientationToVertical=()=>t.setOrientation(ci.VERTICAL),t.resetAutoLayoutToDefault=()=>{t.setAutoLayout(l1(t,e))},t.resetGenerateTicksToDefault=()=>{t.setGenerateTicks(h1())}}function FO(t){return{automated:!0,autoLayout:null,axisLabel:"Scalar Value",barPosition:[0,0],barSize:[0,0],boxPosition:[.88,-.92],boxSize:[.1,1.1],scalarToColors:null,axisTitlePixelOffset:36,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:void 0,fontFamily:"serif"},tickLabelPixelOffset:14,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:void 0,fontFamily:"serif"},generateTicks:null,drawNanAnnotation:!0,drawBelowRangeSwatch:!0,drawAboveRangeSwatch:!0,orientation:null,...t}}function p1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,FO(n)),e.autoLayout||(e.autoLayout=l1(t,e)),e.generateTicks||(e.generateTicks=h1()),dr.extend(t,e,n),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),E.setGet(t,e,["automated","autoLayout","axisTitlePixelOffset","axisLabel","scalarsToColors","tickLabelPixelOffset","generateTicks","drawNanAnnotation","drawBelowRangeSwatch","drawAboveRangeSwatch","orientation"]),E.get(t,e,["axisTextStyle","tickTextStyle"]),E.getArray(t,e,["barPosition","barSize","boxPosition","boxSize"]),E.setArray(t,e,["barPosition","barSize","boxPosition","boxSize"],2),mO(t,e)}const BO=E.newInstance(p1,"vtkScalarBarActor");var d1={newInstance:BO,extend:p1,newScalarBarActorHelper:VO,...g1};function _O(t,e){e.classHierarchy.push("vtkOpenGLScalarBarActor"),t.buildPass=n=>{n&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,s=e._openGLRenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([s.usize,s.vsize],a,e._openGLRenderWindow.getRenderable())}}}const UO={};function NO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UO,n),Be.extend(t,e,n),e.scalarBarActorHelper=d1.newScalarBarActorHelper(),_O(t,e)}const kO=Ce(NO,"vtkOpenGLScalarBarActor");Ft("vtkScalarBarActor",kO);const{vtkErrorMacro:Dg}=nn;function GO(t,e){e.classHierarchy.push("vtkOpenGLSkybox"),t.buildPass=n=>{if(n){e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow);const r=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(r.getActiveCamera(),e.openGLCamera)}},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;r.incrementOpaqueActorCount()}},t.opaquePass=(n,r)=>{if(n&&!e._openGLRenderer.getSelector()){t.updateBufferObjects(),e.context.depthMask(!0),e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.tris.getProgram()),e.openGLTexture.render(e._openGLRenderWindow);const a=e.openGLTexture.getTextureUnit();e.tris.getProgram().setUniformi("sbtexture",a);const s=e._openGLRenderer.getRenderable(),i=e.openGLCamera.getKeyMatrices(s),o=new Float64Array(16);if(ut(o,i.wcpc),e.tris.getProgram().setUniformMatrix("IMCPCMatrix",o),e.lastFormat==="box"){const c=s.getActiveCamera().getPosition();e.tris.getProgram().setUniform3f("camPos",c[0],c[1],c[2])}e.tris.getVAO().bind(),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate()}},t.updateBufferObjects=()=>{if(!e.tris.getCABO().getElementCount()){const r=new Float32Array(12);for(let o=0;o<4;o++)r[o*3]=o%2*2-1,r[o*3+1]=o>1?1:-1,r[o*3+2]=1;const a=De.newInstance({numberOfComponents:3,values:r});a.setName("points");const s=new Uint16Array(8);s[0]=3,s[1]=0,s[2]=1,s[3]=3,s[4]=3,s[5]=0,s[6]=3,s[7]=2;const i=De.newInstance({numberOfComponents:1,values:s});e.tris.getCABO().createVBO(i,"polys",mt.SURFACE,{points:a,cellOffset:0})}e.renderable.getFormat()!==e.lastFormat&&(e.lastFormat=e.renderable.getFormat(),e.lastFormat==="box"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec3 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = wpos.xyz/wpos.w;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec3 TexCoords;
             uniform samplerCube sbtexture;
             uniform vec3 camPos;
             void main () {
               // skybox looks from inside out
               // which means we have to adjust
               // our tcoords. Otherwise text would
               // be flipped
               vec3 tc = normalize(TexCoords - camPos);
               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))
               {
                 tc = vec3(1.0, 1.0, -1.0) * tc;
               }
               else
               {
                 tc = vec3(-1.0, 1.0, 1.0) * tc;
               }
               gl_FragData[0] = textureCube(sbtexture, tc);
             }`,"")),e.lastFormat==="background"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec2 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec2 TexCoords;
             uniform sampler2D sbtexture;
             void main () {
               gl_FragData[0] = texture2D(sbtexture, TexCoords);
             }`,"")),e.tris.getShaderSourceTime().modified(),e.tris.getVAO().bind(),e.tris.getVAO().addAttributeArray(e.tris.getProgram(),e.tris.getCABO(),"vertexMC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||Dg("Error setting vertexMC in shader VAO."));const n=e.renderable.getTextures();n.length||Dg("vtkSkybox requires a texture map"),e.openGLTexture.getRenderable()!==n[0]&&(e.openGLTexture.releaseGraphicsResources(e._openGLRenderWindow),e.openGLTexture.setRenderable(n[0]))}}const bO={context:null};function $O(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bO,n),Be.extend(t,e,n),e.openGLTexture=pn.newInstance(),e.tris=qr.newInstance(),e.keyMatrixTime={},qe(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:jn(new Float64Array(9)),mcwc:ue(new Float64Array(16))},He(t,e,["context"]),ht(t,e,["activeTextures"]),GO(t,e)}const WO=Ce($O);Ft("vtkSkybox",WO);const{vtkDebugMacro:zO}=nn;function HO(t,e){e.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),t.opaquePass=(n,r)=>{e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow");const a=e._openGLRenderer.getAspectRatio(),s=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,i=e._openGLRenderer.getTiledSizeAndOrigin();let o=null;if(e.renderable.getUseZValues()){const c=r.getZBufferTexture(),u=Math.floor(c.getWidth()),g=Math.floor(c.getHeight()),f=e._openGLRenderWindow.getContext();c.bind();const l=r.getFramebuffer();l?l.saveCurrentBindingsAndBuffers():zO("No framebuffer to save/restore");const h=f.createFramebuffer();f.bindFramebuffer(f.FRAMEBUFFER,h),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,c.getHandle(),0),f.checkFramebufferStatus(f.FRAMEBUFFER)===f.FRAMEBUFFER_COMPLETE&&(o=new Uint8Array(u*g*4),f.viewport(0,0,u,g),f.readPixels(0,0,u,g,f.RGBA,f.UNSIGNED_BYTE,o)),l&&l.restorePreviousBindingsAndBuffers(),f.deleteFramebuffer(h)}e.renderable.invokeCallback(e.renderable.getInputData(),s,a,i,o)},t.queryPass=(n,r)=>{n&&e.renderable.getUseZValues()&&r.requestDepth()}}const AO={};function jO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AO,n),Be.extend(t,e,n),HO(t,e)}const KO=Ce(jO,"vtkOpenGLPixelSpaceCallbackMapper");Ft("vtkPixelSpaceCallbackMapper",KO);const v1=Object.create(null);function rn(t,e){v1[t]=e}function PO(t,e){e.classHierarchy.push("vtkWebGPUViewNodeFactory")}const XO={};function y1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XO,n),e.overrides=v1,I0.extend(t,e,n),PO(t,e)}const IO=E.newInstance(y1,"vtkWebGPUViewNodeFactory");var YO={newInstance:IO,extend:y1};function qO(t,e){e.classHierarchy.push("vtkWebGPUCamera"),t.getProjectionMatrix=(n,r,a,s)=>{if(ue(n),e.renderable.getParallelProjection()){const i=e.renderable.getParallelScale(),o=i*r,c=i,u=(s[0]-1)*o,g=(s[0]+1)*o,f=(s[1]-1)*c,l=(s[1]+1)*c,h=1/(g-u),v=1/(l-f);n[0]=2*h,n[5]=2*v,n[10]=1/(a[1]-a[0]),n[12]=(g+u)*h,n[13]=(l+f)*v,n[14]=a[1]/(a[1]-a[0])}else{const i=Math.tan(Math.PI*e.renderable.getViewAngle()/360);let o,c;e.renderable.getUseHorizontalViewAngle()===!0?(o=a[0]*i,c=a[0]*i/r):(o=a[0]*i*r,c=a[0]*i);const u=(s[0]-1)*o,g=(s[0]+1)*o,f=(s[1]-1)*c,l=(s[1]+1)*c;n[0]=2*a[0]/(g-u),n[5]=2*a[0]/(l-f),n[12]=(u+g)/(g-u),n[13]=(f+l)/(l-f),n[10]=0,n[14]=a[0],n[11]=-1,n[15]=0}},t.convertToOpenGLDepth=n=>{if(e.renderable.getParallelProjection())return 1-n;const r=e.renderable.getClippingRangeByReference();let a=-r[0]/n;return a=(r[0]+r[1])/(r[1]-r[0])+2*r[0]*r[1]/(a*(r[1]-r[0])),.5*a+.5},t.getKeyMatrices=n=>{const r=n.getRenderable(),a=n.getParent();if(Math.max(a.getMTime(),t.getMTime(),r.getMTime(),e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatrixTime.getMTime()){const s=e.renderable.getViewMatrix();Qe(e.keyMatrices.normalMatrix,s),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,ut(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Oe(e.keyMatrices.wcvc,s);const i=n.getStabilizedCenterByReference();Ue(e.keyMatrices.scvc,e.keyMatrices.wcvc,i);const o=n.getAspectRatio(),c=e.renderable.getClippingRangeByReference();t.getProjectionMatrix(e.keyMatrices.vcpc,o,c,e.renderable.getWindowCenterByReference()),Ne(e.keyMatrices.scpc,e.keyMatrices.vcpc,e.keyMatrices.scvc),ut(e.keyMatrices.pcsc,e.keyMatrices.scpc),e.keyMatrixTime.modified()}return e.keyMatrices}}const QO={keyMatrixTime:null,keyMatrices:null};function ZO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,QO,n),Be.extend(t,e,n),e.keyMatrixTime={},E.obj(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(16),vcpc:new Float64Array(16),pcsc:new Float64Array(16),wcvc:new Float64Array(16),scpc:new Float64Array(16),scvc:new Float64Array(16)},E.setGet(t,e,["keyMatrixTime"]),qO(t,e)}const JO=E.newInstance(ZO);rn("vtkCamera",JO);function eD(t,e){e.classHierarchy.push("vtkWebGPUBindGroup"),t.setBindables=n=>{if(e.bindables.length===n.length){let r=!0;for(let a=0;a<e.bindables.length;a++)e.bindables[a]!==n[a]&&(r=!1);if(r)return}e.bindables=n,t.modified()},t.getBindGroupLayout=n=>{const r=[];for(let a=0;a<e.bindables.length;a++){const s=e.bindables[a].getBindGroupLayoutEntry();s.binding=a,r.push(s)}return n.getBindGroupLayout({entries:r})},t.getBindGroup=n=>{let r=t.getMTime();for(let s=0;s<e.bindables.length;s++){const i=e.bindables[s].getBindGroupTime().getMTime();r=i>r?i:r}if(r<e.bindGroupTime.getMTime())return e.bindGroup;const a=[];for(let s=0;s<e.bindables.length;s++){const i=e.bindables[s].getBindGroupEntry();i.binding=s,a.push(i)}return e.bindGroup=n.getHandle().createBindGroup({layout:t.getBindGroupLayout(n),entries:a,label:e.label}),e.bindGroupTime.modified(),e.bindGroup},t.getShaderCode=n=>{const r=[],a=n.getBindGroupLayoutCount(e.label);for(let s=0;s<e.bindables.length;s++)r.push(e.bindables[s].getShaderCode(s,a));return r.join(`
`)}}const tD={device:null,handle:null,label:null};function T1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tD,n),E.obj(t,e),e.bindables=[],e.bindGroupTime={},E.obj(e.bindGroupTime,{mtime:0}),E.get(t,e,["bindGroupTime","handle","sizeInBytes","usage"]),E.setGet(t,e,["label","device","arrayInformation"]),eD(t,e)}const nD=E.newInstance(T1);var x1={newInstance:nD,extend:T1};function rD(t,e){e.classHierarchy.push("vtkWebGPUShaderModule"),t.initialize=(n,r)=>{e.device=n,e.handle=e.device.getHandle().createShaderModule({code:r.getCode()})}}const aD={device:null,handle:null};function S1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aD,n),E.obj(t,e),E.get(t,e,["lastCameraMTime"]),E.setGet(t,e,["device","handle"]),rD(t,e)}const sD=E.newInstance(S1,"vtkWebGPUShaderModule");var iD={newInstance:sD,extend:S1};function oD(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;const a=Array.isArray(n)?n.join(`
`):n;let s=!1;t.search(e)!==-1&&(s=!0);let i="";r&&(i="g");const o=new RegExp(e,i),c=t.replace(o,a);return{replace:s,result:c}}function cD(t,e){e.classHierarchy.push("vtkWebGPUShaderCache"),t.getShaderModule=n=>{const r=n.getType(),a=n.getHash(),s=e._shaderModules.keys();for(let o=0;o<s.length;o++){const c=s[o];if(c.getHash()===a&&c.getType()===r)return e._shaderModules.get(c)}const i=iD.newInstance();return i.initialize(e.device,n),e._shaderModules.set(n,i),i}}const fD={shaderModules:null,device:null,window:null};function C1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fD,n),e._shaderModules=new Map,E.obj(t,e),E.setGet(t,e,["device","window"]),cD(t,e)}const uD=E.newInstance(C1,"vtkWebGPUShaderCache");var ae={newInstance:uD,extend:C1,substitute:oD};function gD(t,e){e.classHierarchy.push("vtkWebGPUPipeline"),t.getShaderDescriptions=()=>e.shaderDescriptions,t.initialize=(n,r)=>{e.pipelineDescription=e.renderEncoder.getPipelineSettings(),e.pipelineDescription.primitive.topology=e.topology,e.pipelineDescription.vertex=e.vertexState,e.pipelineDescription.label=r;const a=[];for(let s=0;s<e.layouts.length;s++)a.push(e.layouts[s].layout);e.pipelineLayout=n.getHandle().createPipelineLayout({bindGroupLayouts:a}),e.pipelineDescription.layout=e.pipelineLayout;for(let s=0;s<e.shaderDescriptions.length;s++){const i=e.shaderDescriptions[s],o=n.getShaderModule(i);i.getType()==="vertex"&&(e.pipelineDescription.vertex.module=o.getHandle(),e.pipelineDescription.vertex.entryPoint="main"),i.getType()==="fragment"&&(e.pipelineDescription.fragment.module=o.getHandle(),e.pipelineDescription.fragment.entryPoint="main")}e.handle=n.getHandle().createRenderPipeline(e.pipelineDescription)},t.getShaderDescription=n=>{for(let r=0;r<e.shaderDescriptions.length;r++)if(e.shaderDescriptions[r].getType()===n)return e.shaderDescriptions[r];return null},t.addBindGroupLayout=n=>{n&&e.layouts.push({layout:n.getBindGroupLayout(e.device),label:n.getLabel()})},t.getBindGroupLayout=n=>e.layouts[n].layout,t.getBindGroupLayoutCount=n=>{for(let r=0;r<e.layouts.length;r++)if(e.layouts[r].label===n)return r;return 0},t.bindVertexInput=(n,r)=>{r.bindBuffers(n)}}const lD={handle:null,layouts:null,renderEncoder:null,shaderDescriptions:null,vertexState:null,topology:null,pipelineDescription:null};function w1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lD,n),qe(t,e),e.layouts=[],e.shaderDescriptions=[],ht(t,e,["handle","pipelineDescription"]),He(t,e,["device","renderEncoder","topology","vertexState"]),gD(t,e)}const hD=Ce(w1,"vtkWebGPUPipeline");var pD={newInstance:hD,extend:w1};function dD(t,e){e.classHierarchy.push("vtkWebGPUShaderDescription"),t.hasOutput=n=>e.outputNames.includes(n),t.addOutput=function(n,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;e.outputTypes.push(n),e.outputNames.push(r),e.outputInterpolations.push(a)},t.addBuiltinOutput=(n,r)=>{e.builtinOutputTypes.push(n),e.builtinOutputNames.push(r)},t.addBuiltinInput=(n,r)=>{e.builtinInputTypes.push(n),e.builtinInputNames.push(r)},t.replaceShaderCode=(n,r)=>{const a=[];let s=[];if(r&&a.push(r.getShaderCode()),n||e.builtinInputNames.length){const i=[];if(i.push(`struct ${e.type}Input
{`),n){const o=n.getOutputNamesByReference(),c=n.getOutputTypesByReference(),u=n.getOutputInterpolationsByReference();for(let g=0;g<o.length;g++)u[g]!==void 0?i.push(`  @location(${g}) @interpolate(${u[g]}) ${o[g]} : ${c[g]},`):i.push(`  @location(${g}) ${o[g]} : ${c[g]},`)}for(let o=0;o<e.builtinInputNames.length;o++)i.push(`  ${e.builtinInputNames[o]} : ${e.builtinInputTypes[o]},`);i.length>1&&(i.push("};"),s=i,a[a.length-1]+=",",a.push(`input: ${e.type}Input`))}if(a.length&&(e.code=ae.substitute(e.code,"//VTK::IOStructs::Input",a).result),e.outputNames.length+e.builtinOutputNames.length){const i=[`struct ${e.type}Output
{`];for(let o=0;o<e.outputNames.length;o++)e.outputInterpolations[o]!==void 0?i.push(`  @location(${o}) @interpolate(${e.outputInterpolations[o]}) ${e.outputNames[o]} : ${e.outputTypes[o]},`):i.push(`  @location(${o}) ${e.outputNames[o]} : ${e.outputTypes[o]},`);for(let o=0;o<e.builtinOutputNames.length;o++)i.push(`  ${e.builtinOutputNames[o]} : ${e.builtinOutputTypes[o]},`);i.push("};"),s=s.concat(i),e.code=ae.substitute(e.code,"//VTK::IOStructs::Output",[`-> ${e.type}Output`]).result}e.code=ae.substitute(e.code,"//VTK::IOStructs::Dec",s).result}}const vD={type:null,hash:null,code:null,outputNames:null,outputTypes:null};function E1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vD,n),e.outputNames=[],e.outputTypes=[],e.outputInterpolations=[],e.builtinOutputNames=[],e.builtinOutputTypes=[],e.builtinInputNames=[],e.builtinInputTypes=[],E.obj(t,e),E.setGet(t,e,["type","hash","code"]),E.getArray(t,e,["outputTypes","outputNames","outputInterpolations"]),dD(t,e)}const yD=E.newInstance(E1,"vtkWebGPUShaderDescription");var Lg={newInstance:yD,extend:E1};const Vg={r8unorm:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"float"},r8snorm:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"float"},r8uint:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},r8sint:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"sint"},r16uint:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"uint"},r16sint:{numComponents:1,nativeType:Int16Array,stride:2,elementSize:2,sampleType:"sint"},r16float:{numComponents:1,nativeType:Float32Array,stride:2,elementSize:2,sampleType:"float"},rg8unorm:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"float"},rg8snorm:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"float"},rg8uint:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"uint"},rg8sint:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"sint"},r32uint:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:4,sampleType:"uint"},r32sint:{numComponents:1,nativeType:Int32Array,stride:4,elementSize:4,sampleType:"sint"},r32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"unfilterable-float"},rg16uint:{numComponents:2,nativeType:Uint16Array,stride:4,elementSize:2,sampleType:"uint"},rg16sint:{numComponents:2,nativeType:Int16Array,stride:4,elementSize:2,sampleType:"sint"},rg16float:{numComponents:2,nativeType:Float32Array,stride:4,elementSize:2,sampleType:"float"},rgba8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"rgba8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgba8snorm:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"float"},rgba8uint:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"uint"},rgba8sint:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"sint"},bgra8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"bgra8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgb9e5ufloat:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rgb10a2unorm:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rg11b10ufloat:{numComponents:4,nativeType:Float32Array,stride:4,sampleType:"float"},rg32uint:{numComponents:2,nativeType:Uint32Array,stride:8,elementSize:4,sampleType:"uint"},rg32sint:{numComponents:2,nativeType:Int32Array,stride:8,elementSize:4,sampleType:"sint"},rg32float:{numComponents:2,nativeType:Float32Array,stride:8,elementSize:4,sampleType:"unfilterable-float"},rgba16uint:{numComponents:4,nativeType:Uint16Array,stride:8,elementSize:2,sampleType:"uint"},rgba16sint:{numComponents:4,nativeType:Int16Array,stride:8,elementSize:2,sampleType:"sint"},rgba16float:{numComponents:4,nativeType:Float32Array,stride:8,elementSize:2,sampleType:"float"},rgba32uint:{numComponents:4,nativeType:Uint32Array,stride:16,elementSize:4,sampleType:"uint"},rgba32sint:{numComponents:4,nativeType:Int32Array,stride:16,elementSize:4,sampleType:"sint"},rgba32float:{numComponents:4,nativeType:Float32Array,stride:16,elementSize:4,sampleType:"unfilterable-float"},stencil8:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},depth16unorm:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"depth"},depth24plus:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:3,sampleType:"depth"},"depth24plus-stencil8":{numComponents:2,nativeType:Uint32Array,stride:4,sampleType:"mixed"},depth32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"depth"}};function TD(t){return!t||t.length<6?0:t in Vg?Vg[t]:(ie(`unknown format ${t}`),null)}function xD(t){if(!t||t.length<5)return 0;let e=1;t[t.length-2]==="x"&&(e=Number(t[t.length-1]));const n=e===1?t.length-1:t.length-3,r=Number(t[n]);if(Number.isNaN(r))return ie(`unknown format ${t}`),0;const a=5-r/2;return e*a}function SD(t){if(!t||t.length<5)return 0;let e=1;return t[t.length-2]==="x"&&(e=Number(t[t.length-1])),e}function CD(t){if(!t||t.length<5)return 0;let e;if(t[0]==="f")e="Float";else if(t[0]==="s")e="Int";else if(t[0]==="u")e="Uint";else{ie(`unknown format ${t}`);return}const n=t.split("x")[0],r=Number(n[n.length-1]);if(Number.isNaN(r)){ie(`unknown format ${t}`);return}return e+=8*(5-r/2),e+="Array",e}function wD(t){let e;if(t[0]==="f"||t[1]==="n")e="f32";else if(t[0]==="s"&&t[1]==="i")e="i32";else if(t[0]==="u"&&t[1]==="i")e="u32";else{ie(`unknown format ${t}`);return}let n=1;return t[t.length-2]==="x"&&(n=Number(t[t.length-1])),n===4?`vec4<${e}>`:n===3?`vec3<${e}>`:n===2?`vec2<${e}>`:e}function ED(t){if(!t)return 0;let e=1;return t.substring(0,3)==="vec"?e=Number(t[3]):t.substring(0,3)==="mat"&&(e=t[3]*t[5]),e*4}function RD(t){if(t){if(t.includes("f32"))return"Float32Array";if(t.includes("i32"))return"Int32Array";if(t.includes("u32"))return"Uint32Array";ie(`unknown format ${t}`)}}var Xe={getDetailsFromTextureFormat:TD,getByteStrideFromBufferFormat:xD,getNumberOfComponentsFromBufferFormat:SD,getNativeTypeFromBufferFormat:CD,getShaderTypeFromBufferFormat:wD,getByteStrideFromShaderFormat:ED,getNativeTypeFromShaderFormat:RD};function MD(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!e.includes(t[n]))return!1;return!0}function OD(t,e){e.classHierarchy.push("vtkWebGPUVertexInput"),t.addBuffer=function(n,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"vertex",s=r;Array.isArray(s)||(s=[s]);for(let i=0;i<e.inputs.length;i++)if(MD(e.inputs[i].names,s)){if(e.inputs[i].buffer===n)return;e.inputs[i].buffer=n;return}e.inputs.push({buffer:n,stepMode:a,names:s}),e.inputs=e.inputs.sort((i,o)=>i.names[0]<o.names[0]?-1:i.names[0]>o.names[0]?1:0)},t.removeBufferIfPresent=n=>{for(let r=0;r<e.inputs.length;r++)e.inputs[r].names.includes(n)&&e.inputs.splice(r,1)},t.getBuffer=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return e.inputs[r].buffer;return null},t.hasAttribute=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return!0;return!1},t.getAttributeTime=n=>{for(let r=0;r<e.inputs.length;r++)if(e.inputs[r].names.includes(n))return e.inputs[r].buffer.getSourceTime();return 0},t.getShaderCode=()=>{let n="",r=0;for(let a=0;a<e.inputs.length;a++)for(let s=0;s<e.inputs[a].names.length;s++){const i=e.inputs[a].buffer.getArrayInformation()[s],o=Xe.getShaderTypeFromBufferFormat(i.format);r>0&&(n+=`,
`),n=`${n}  @location(${r}) ${e.inputs[a].names[s]} : ${o}`,r++}return n},t.getVertexInputInformation=()=>{const n={};if(e.inputs.length){const r=[];let a=0;for(let s=0;s<e.inputs.length;s++){const i=e.inputs[s].buffer,o={arrayStride:i.getStrideInBytes(),stepMode:e.inputs[s].stepMode,attributes:[]},c=i.getArrayInformation();for(let u=0;u<e.inputs[s].names.length;u++)o.attributes.push({shaderLocation:a,offset:c[u].offset,format:c[u].format}),a++;r.push(o)}n.buffers=r}return n},t.bindBuffers=n=>{for(let r=0;r<e.inputs.length;r++)n.setVertexBuffer(r,e.inputs[r].buffer.getHandle());e.indexBuffer&&n.setIndexBuffer(e.indexBuffer.getHandle(),e.indexBuffer.getArrayInformation()[0].format)},t.getReady=()=>{},t.releaseGraphicsResources=()=>{e.created&&(e.inputs=[],e.bindingDescriptions=[],e.attributeDescriptions=[])}}const DD={inputs:null,bindingDescriptions:!1,attributeDescriptions:null,indexBuffer:null};function R1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,DD,n),qe(t,e),e.bindingDescriptions=[],e.attributeDescriptions=[],e.inputs=[],He(t,e,["created","device","handle","indexBuffer"]),OD(t,e)}const LD=Ce(R1,"vtkWebGPUVertexInput");var VD={newInstance:LD,extend:R1};const mD=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  // var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,FD=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::Light::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  // var computedColor:vec4<f32> = vec4<f32>(1.0,0.5,0.5,1.0);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function BD(t,e){e.classHierarchy.push("vtkWebGPUSimpleMapper"),t.generateShaderDescriptions=(n,r,a)=>{const s=Lg.newInstance({type:"vertex",hash:n,code:e.vertexShaderTemplate}),i=Lg.newInstance({type:"fragment",hash:n,code:e.fragmentShaderTemplate}),o=r.getShaderDescriptions();o.push(s),o.push(i);const c=e.vertexShaderTemplate+e.fragmentShaderTemplate,u=new RegExp("//VTK::[^:]*::","g"),f=c.match(u).filter((l,h,v)=>v.indexOf(l)===h).map(l=>`replaceShader${l.substring(7,l.length-2)}`);for(let l=0;l<f.length;l++){const h=f[l];h!=="replaceShaderIOStructs"&&e.shaderReplacements.has(h)&&e.shaderReplacements.get(h)(n,r,a)}t.replaceShaderIOStructs(n,r,a)},t.replaceShaderIOStructs=(n,r,a)=>{const s=r.getShaderDescription("vertex");s.replaceShaderCode(null,a),r.getShaderDescription("fragment").replaceShaderCode(s)},t.replaceShaderRenderEncoder=(n,r,a)=>{e.renderEncoder.replaceShaderCode(r)},e.shaderReplacements.set("replaceShaderRenderEncoder",t.replaceShaderRenderEncoder),t.replaceShaderRenderer=(n,r,a)=>{if(!e.WebGPURenderer)return;const s=e.WebGPURenderer.getBindGroup().getShaderCode(r),i=r.getShaderDescription("vertex");let o=i.getCode();o=ae.substitute(o,"//VTK::Renderer::Dec",[s]).result,i.setCode(o);const c=r.getShaderDescription("fragment");o=c.getCode(),o=ae.substitute(o,"//VTK::Renderer::Dec",[s]).result,c.setCode(o)},e.shaderReplacements.set("replaceShaderRenderer",t.replaceShaderRenderer),t.replaceShaderMapper=(n,r,a)=>{const s=e.bindGroup.getShaderCode(r),i=r.getShaderDescription("vertex");let o=i.getCode();o=ae.substitute(o,"//VTK::Mapper::Dec",[s]).result,i.setCode(o);const c=r.getShaderDescription("fragment");c.addBuiltinInput("bool","@builtin(front_facing) frontFacing"),o=c.getCode(),o=ae.substitute(o,"//VTK::Mapper::Dec",[s]).result,c.setCode(o)},e.shaderReplacements.set("replaceShaderMapper",t.replaceShaderMapper),t.replaceShaderPosition=(n,r,a)=>{const s=r.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let i=s.getCode();i=ae.substitute(i,"//VTK::Position::Impl",["    output.Position = rendererUBO.SCPCMatrix*vertexBC;"]).result,s.setCode(i)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=(n,r,a)=>{r.getShaderDescription("vertex").addOutput("vec2<f32>","tcoordVS")},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.addTextureView=n=>{e.textureViews.includes(n)||e.textureViews.push(n)},t.prepareToDraw=n=>{e.renderEncoder=n,t.updateInput(),t.updateBuffers(),t.updateBindings(),t.updatePipeline()},t.updateInput=()=>{},t.updateBuffers=()=>{},t.updateBindings=()=>{e.bindGroup.setBindables(t.getBindables())},t.computePipelineHash=()=>{},t.registerDrawCallback=n=>{n.registerDrawCallback(e.pipeline,t.draw)},t.prepareAndDraw=n=>{t.prepareToDraw(n),n.setPipeline(e.pipeline),t.draw(n)},t.draw=n=>{const r=n.getBoundPipeline();n.activateBindGroup(e.bindGroup),e.WebGPURenderer&&e.WebGPURenderer.bindUBO(n),r.bindVertexInput(n,e.vertexInput);const a=e.vertexInput.getIndexBuffer();a?n.drawIndexed(a.getIndexCount(),e.numberOfInstances,0,0,0):n.draw(e.numberOfVertices,e.numberOfInstances,0,0)},t.getBindables=()=>{const n=[...e.additionalBindables];e.UBO&&n.push(e.UBO),e.SSBO&&n.push(e.SSBO);for(let r=0;r<e.textureViews.length;r++){n.push(e.textureViews[r]);const a=e.textureViews[r].getSampler();a&&n.push(a)}return n},t.updatePipeline=()=>{t.computePipelineHash(),e.pipeline=e.device.getPipeline(e.pipelineHash),e.pipeline||(e.pipeline=pD.newInstance(),e.pipeline.setDevice(e.device),e.WebGPURenderer&&e.pipeline.addBindGroupLayout(e.WebGPURenderer.getBindGroup()),e.pipeline.addBindGroupLayout(e.bindGroup),t.generateShaderDescriptions(e.pipelineHash,e.pipeline,e.vertexInput),e.pipeline.setTopology(e.topology),e.pipeline.setRenderEncoder(e.renderEncoder),e.pipeline.setVertexState(e.vertexInput.getVertexInputInformation()),e.device.createPipeline(e.pipelineHash,e.pipeline))}}const _D={additionalBindables:void 0,bindGroup:null,device:null,fragmentShaderTemplate:null,numberOfInstances:1,numberOfVertices:0,pipelineHash:null,shaderReplacements:null,SSBO:null,textureViews:null,topology:"triangle-list",UBO:null,vertexShaderTemplate:null,WebGPURenderer:null};function M1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_D,n),Be.extend(t,e,n),e.textureViews=[],e.vertexInput=VD.newInstance(),e.bindGroup=x1.newInstance({label:"mapperBG"}),e.additionalBindables=[],e.fragmentShaderTemplate=e.fragmentShaderTemplate||FD,e.vertexShaderTemplate=e.vertexShaderTemplate||mD,e.shaderReplacements=new Map,E.get(t,e,["pipeline","vertexInput"]),E.setGet(t,e,["additionalBindables","device","fragmentShaderTemplate","interpolate","numberOfInstances","numberOfVertices","pipelineHash","shaderReplacements","SSBO","textureViews","topology","UBO","vertexShaderTemplate","WebGPURenderer"]),BD(t,e)}const UD=E.newInstance(M1,"vtkWebGPUSimpleMapper");var yf={newInstance:UD,extend:M1};function ND(t,e){e.classHierarchy.push("vtkWebGPUFullScreenQuad"),t.replaceShaderPosition=(n,r,a)=>{const s=r.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),s.addOutput("vec4<f32>","vertexVC");let i=s.getCode();i=ae.substitute(i,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);","output.vertexVC = vec4<f32>(vertexBC, 1);"]).result,s.setCode(i)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.updateBuffers=()=>{const n=e.device.getBufferManager().getFullScreenQuadBuffer();e.vertexInput.addBuffer(n,["vertexBC"]),e.numberOfVertices=6}}const kD={};function O1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kD,n),yf.extend(t,e,n),ND(t,e)}const GD=E.newInstance(O1,"vtkWebGPUFullScreenQuad");var jr={newInstance:GD,extend:O1};const bD={Verts:0,Lines:1,Triangles:2,Strips:3,LinesFromStrips:4,LinesFromTriangles:5,Points:6,UniformArray:7,PointArray:8,NormalsFromPoints:9,Texture:10,RawVertex:11,Storage:12,Index:13},$D={Start:0,Points:0,Lines:1,Triangles:2,TriangleStrips:3,TriangleEdges:4,TriangleStripEdges:5,End:6};var qa={BufferUsage:bD,PrimitiveTypes:$D};const po=["getMappedRange","mapAsync","unmap"];function WD(t,e,n,r){const a=r.byteLength,s=t.createBuffer({size:a,usage:GPUBufferUsage.COPY_SRC,mappedAtCreation:!0}),i=s.getMappedRange(0,a);new Uint8Array(i).set(new Uint8Array(r)),s.unmap();const o=t.createCommandEncoder();o.copyBufferToBuffer(s,0,e,n,a);const c=o.finish();t.queue.submit([c]),s.destroy()}function zD(t,e){e.classHierarchy.push("vtkWebGPUBuffer"),t.create=(n,r)=>{e.handle=e.device.getHandle().createBuffer({size:n,usage:r,label:e.label}),e.sizeInBytes=n,e.usage=r},t.write=n=>{WD(e.device.getHandle(),e.handle,0,n.buffer)},t.createAndWrite=(n,r)=>{const a=Math.ceil(n.byteLength/4)*4;e.handle=e.device.getHandle().createBuffer({size:a,usage:r,mappedAtCreation:!0,label:e.label}),e.sizeInBytes=a,e.usage=r,new Uint8Array(e.handle.getMappedRange()).set(new Uint8Array(n.buffer)),e.handle.unmap()};for(let n=0;n<po.length;n++)t[po[n]]=function(){return e.handle[po[n]](...arguments)}}const HD={device:null,handle:null,sizeInBytes:0,strideInBytes:0,arrayInformation:null,usage:null,label:null,sourceTime:null};function D1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,HD,n),E.obj(t,e),E.get(t,e,["handle","sizeInBytes","usage"]),E.setGet(t,e,["strideInBytes","device","arrayInformation","label","sourceTime"]),zD(t,e)}const AD=E.newInstance(D1);var Kr={newInstance:AD,extend:D1,...qa};const{Representation:mg}=Yr,{PrimitiveTypes:_n}=qa;class jD{constructor(){this.keys=new Uint32Array(10),this.values=new Uint32Array(10),this.count=0}clear(){this.count=0}has(e){for(let n=0;n<this.count;n++)if(this.keys[n]===e)return!0}get(e){for(let n=0;n<this.count;n++)if(this.keys[n]===e)return this.values[n]}set(e,n){this.count<9&&(this.keys[this.count]=e,this.values[this.count++]=n)}}function KD(t){switch(t){case _n.Points:return"points";case _n.Lines:return"lines";case _n.Triangles:case _n.TriangleEdges:return"polys";case _n.TriangleStripEdges:case _n.TriangleStrips:return"strips";default:return""}}function ds(t,e,n){let r=t.pointIdToFlatId[e];return r<0&&(r=t.flatId,t.pointIdToFlatId[e]=r,t.flatIdToPointId[t.flatId]=e,t.flatIdToCellId[t.flatId]=n,t.flatId++),r}function PD(t,e,n){const r=t.length;for(let i=0;i<r;i++){let o=t[i];if(n.cellProvokedMap.has(o)){n.ibo[n.iboId++]=n.cellProvokedMap.get(o);for(let c=i+1;c<i+r;c++){o=t[c%r];const u=ds(n,o,e);n.ibo[n.iboId++]=u}return}}for(let i=0;i<r;i++){let o=t[i];if(!n.provokedPointIds[o]){let c=ds(n,o,e);n.provokedPointIds[o]=1,n.cellProvokedMap.set(o,c),n.flatIdToCellId[c]=e,n.ibo[n.iboId++]=c;for(let u=i+1;u<i+r;u++)o=t[u%r],c=ds(n,o,e),n.ibo[n.iboId++]=c;return}}let a=t[0],s=n.flatId;n.cellProvokedMap.set(a,s),n.flatIdToPointId[n.flatId]=a,n.flatIdToCellId[n.flatId]=e,n.flatId++,n.ibo[n.iboId++]=s;for(let i=1;i<r;i++)a=t[i],s=ds(n,a,e),n.ibo[n.iboId++]=s}function XD(t,e,n){const r=t.length;n.iboSize+=r;for(let a=0;a<r;a++){const s=t[a];if(n.cellProvokedMap.has(s))return}for(let a=0;a<r;a++){const s=t[a];if(!n.provokedPointIds[s]){n.provokedPointIds[s]=1,n.cellProvokedMap.set(s,1);return}}n.cellProvokedMap.set(t[0],1),n.extraPoints++}let cn;const Fg=new Uint32Array(1),Ot=new Uint32Array(2),Rn=new Uint32Array(3),vo={anythingToPoints(t,e,n,r,a){for(let s=0;s<t;++s)Fg[0]=e[n+s],cn(Fg,r,a)},linesToWireframe(t,e,n,r,a){for(let s=0;s<t-1;++s)Ot[0]=e[n+s],Ot[1]=e[n+s+1],cn(Ot,r,a)},polysToWireframe(t,e,n,r,a){if(t>2)for(let s=0;s<t;++s)Ot[0]=e[n+s],Ot[1]=e[n+(s+1)%t],cn(Ot,r,a)},stripsToWireframe(t,e,n,r,a){if(t>2){for(let s=0;s<t-1;++s)Ot[0]=e[n+s],Ot[1]=e[n+s+1],cn(Ot,r,a);for(let s=0;s<t-2;s++)Ot[0]=e[n+s],Ot[1]=e[n+s+2],cn(Ot,r,a)}},polysToSurface(t,e,n,r,a){for(let s=0;s<t-2;s++)Rn[0]=e[n],Rn[1]=e[n+s+1],Rn[2]=e[n+s+2],cn(Rn,r,a)},stripsToSurface(t,e,n,r,a){for(let s=0;s<t-2;s++)Rn[0]=e[n+s],Rn[1]=e[n+s+1+s%2],Rn[2]=e[n+s+1+(s+1)%2],cn(Rn,r,a)}};function ID(t,e){e.classHierarchy.push("vtkWebGPUIndexBuffer"),t.buildIndexBuffer=n=>{const r=n.cells,a=n.primitiveType,s=n.representation,i=n.cellOffset,o=r.getData(),c=o.length,u=KD(a),g=n.numberOfPoints,f={provokedPointIds:new Uint8Array(g),extraPoints:0,iboSize:0,flatId:0,iboId:0,cellProvokedMap:new jD};let l=null;s===mg.POINTS||a===_n.Points?l=vo.anythingToPoints:s===mg.WIREFRAME||a===_n.Lines?l=vo[`${u}ToWireframe`]:l=vo[`${u}ToSurface`],cn=XD;let h=i||0;for(let v=0;v<c;)f.cellProvokedMap.clear(),l(o[v],o,v+1,h,f),v+=o[v]+1,h++;g<=65535?f.flatIdToPointId=new Uint16Array(g+f.extraPoints):f.flatIdToPointId=new Uint32Array(g+f.extraPoints),g+f.extraPoints<36863?f.pointIdToFlatId=new Int16Array(g):f.pointIdToFlatId=new Int32Array(g),g+f.extraPoints<=65535?(f.ibo=new Uint16Array(f.iboSize),n.format="uint16"):(f.ibo=new Uint32Array(f.iboSize),n.format="uint32"),h<=65535?f.flatIdToCellId=new Uint16Array(g+f.extraPoints):f.flatIdToCellId=new Uint32Array(g+f.extraPoints),f.pointIdToFlatId.fill(-1),f.provokedPointIds.fill(0),cn=PD,h=i||0;for(let v=0;v<c;)f.cellProvokedMap.clear(),l(o[v],o,v+1,h,f),v+=o[v]+1,h++;delete f.provokedPointIds,delete f.pointIdToFlatId,n.nativeArray=f.ibo,e.flatIdToPointId=f.flatIdToPointId,e.flatIdToCellId=f.flatIdToCellId,e.flatSize=f.flatId,e.indexCount=f.iboId}}const YD={flatIdToPointId:null,flatIdToCellId:null,flatSize:0,indexCount:0};function L1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,YD,n),Kr.extend(t,e,n),E.setGet(t,e,["flatIdToPointId","flatIdToCellId","flatSize","indexCount"]),ID(t,e)}const qD=E.newInstance(L1);var QD={newInstance:qD,extend:L1,...qa};const{BufferUsage:Mn}=qa,{vtkErrorMacro:ZD}=nn,{VtkDataTypes:er}=De,JD={};function eL(t){let e;switch(t.getDataType()){case er.UNSIGNED_CHAR:e="uint8";break;case er.FLOAT:e="float32";break;case er.UNSIGNED_INT:e="uint32";break;case er.INT:e="sint32";break;case er.DOUBLE:e="float32";break;case er.UNSIGNED_SHORT:e="uint16";break;case er.SHORT:e="sin16";break;default:e="float32";break}switch(t.getNumberOfComponents()){case 2:e+="x2";break;case 3:e.includes("32")||ZD(`unsupported x3 type for ${e}`),e+="x3";break;case 4:e+="x4";break}return e}function Bg(t,e,n,r,a){const s={},i=t.getFlatSize();if(!i)return s;let o=[0,0,0,0];a.shift&&(a.shift.length?o=a.shift:o.fill(a.shift));let c=[1,1,1,1];a.scale&&(a.scale.length?c=a.scale:c.fill(a.scale));const u=Object.prototype.hasOwnProperty.call(a,"packExtra")?a.packExtra:!1;let g,f=0;const l=n+(u?1:0),h=Xr(r,i*l);let v=t.getFlatIdToPointId();a.cellData&&(v=t.getFlatIdToCellId()),n===1?g=function(d){h[f++]=c[0]*e[d]+o[0]}:n===2?g=function(d){h[f++]=c[0]*e[d]+o[0],h[f++]=c[1]*e[d+1]+o[1]}:n===3&&!u?g=function(d){h[f++]=c[0]*e[d]+o[0],h[f++]=c[1]*e[d+1]+o[1],h[f++]=c[2]*e[d+2]+o[2]}:n===3&&u?g=function(d){h[f++]=c[0]*e[d]+o[0],h[f++]=c[1]*e[d+1]+o[1],h[f++]=c[2]*e[d+2]+o[2],h[f++]=c[3]*1+o[3]}:n===4&&(g=function(d){h[f++]=c[0]*e[d]+o[0],h[f++]=c[1]*e[d+1]+o[1],h[f++]=c[2]*e[d+2]+o[2],h[f++]=c[3]*e[d+3]+o[3]});for(let p=0;p<i;p++){const d=n*v[p];g(d)}return s.nativeArray=h,s}function tL(t,e,n,r){const a=[t[r*3]-t[n*3],t[r*3+1]-t[n*3+1],t[r*3+2]-t[n*3+2]],s=[t[e*3]-t[n*3],t[e*3+1]-t[n*3+1],t[e*3+2]-t[n*3+2]],i=[];return gt(a,s,i),Rt(i),i}function nL(t,e){const n=e.getData(),r=t.getData();if(!r||!n)return null;const a=new Int8Array(t.getNumberOfCells()*4),s=r.length;let i=0;for(let o=0;o<s;){const c=tL(n,r[o+1],r[o+2],r[o+3]);a[i++]=127*c[0],a[i++]=127*c[1],a[i++]=127*c[2],a[i++]=127,o+=r[o]+1}return a}function rL(t,e){e.classHierarchy.push("vtkWebGPUBufferManager");function n(r){r.dataArray&&!r.nativeArray&&(r.nativeArray=r.dataArray.getData());let a,s;if(r.usage===Mn.Index&&(a=QD.newInstance({label:r.label}),a.setDevice(e.device),s=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,a.buildIndexBuffer(r),a.createAndWrite(r.nativeArray,s),a.setArrayInformation([{format:r.format}])),a||(a=Kr.newInstance({label:r.label}),a.setDevice(e.device)),r.usage===Mn.UniformArray&&(s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a.createAndWrite(r.nativeArray,s)),r.usage===Mn.Storage&&(s=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,a.createAndWrite(r.nativeArray,s)),r.usage===Mn.Texture&&(s=GPUBufferUsage.COPY_SRC,a.createAndWrite(r.nativeArray,s)),r.usage===Mn.PointArray){s=GPUBufferUsage.VERTEX;const i=Xe.getNativeTypeFromBufferFormat(r.format),o=Bg(r.indexBuffer,r.dataArray.getData(),r.dataArray.getNumberOfComponents(),i,{packExtra:r.packExtra,shift:r.shift,scale:r.scale,cellData:r.cellData,cellOffset:r.cellOffset});a.createAndWrite(o.nativeArray,s),a.setStrideInBytes(Xe.getByteStrideFromBufferFormat(r.format)),a.setArrayInformation([{offset:0,format:r.format,interpolation:r.cellData?"flat":"perspective"}])}if(r.usage===Mn.NormalsFromPoints){s=GPUBufferUsage.VERTEX;const i=Xe.getNativeTypeFromBufferFormat(r.format),o=nL(r.cells,r.dataArray),c=Bg(r.indexBuffer,o,4,i,{cellData:!0});a.createAndWrite(c.nativeArray,s),a.setStrideInBytes(Xe.getByteStrideFromBufferFormat(r.format)),a.setArrayInformation([{offset:0,format:r.format,interpolation:"flat"}])}return r.usage===Mn.RawVertex&&(s=GPUBufferUsage.VERTEX,a.createAndWrite(r.nativeArray,s),a.setStrideInBytes(Xe.getByteStrideFromBufferFormat(r.format)),a.setArrayInformation([{offset:0,format:r.format}])),a.setSourceTime(r.time),a}t.hasBuffer=r=>e.device.hasCachedObject(r),t.getBuffer=r=>r.hash?e.device.getCachedObject(r.hash,n,r):n(r),t.getBufferForPointArray=(r,a)=>{const s=eL(r),i={hash:`${r.getMTime()}I${a.getMTime()}${s}`,usage:Mn.PointArray,format:s,dataArray:r,indexBuffer:a};return t.getBuffer(i)},t.getFullScreenQuadBuffer=()=>{if(e.fullScreenQuadBuffer)return e.fullScreenQuadBuffer;e.fullScreenQuadBuffer=Kr.newInstance(),e.fullScreenQuadBuffer.setDevice(e.device);const r=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]);return e.fullScreenQuadBuffer.createAndWrite(r,GPUBufferUsage.VERTEX),e.fullScreenQuadBuffer.setStrideInBytes(12),e.fullScreenQuadBuffer.setArrayInformation([{offset:0,format:"float32x3"}]),e.fullScreenQuadBuffer}}const aL={device:null,fullScreenQuadBuffer:null};function V1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aL,n),qe(t,e),He(t,e,["device"]),rL(t,e)}const sL=Ce(V1);var Cr={newInstance:sL,extend:V1,...JD,...qa};const{BufferUsage:iL}=Cr,{vtkErrorMacro:Mr}=E;function oL(t,e){e.classHierarchy.push("vtkWebGPUStorageBuffer"),t.addEntry=(n,r)=>{if(e._bufferEntryNames.has(n)){Mr(`entry named ${n} already exists`);return}e._bufferEntryNames.set(n,e.bufferEntries.length);const a=Xe.getByteStrideFromShaderFormat(r);e.bufferEntries.push({name:n,type:r,sizeInBytes:a,offset:e.sizeInBytes,nativeType:Xe.getNativeTypeFromShaderFormat(r)}),e.sizeInBytes+=a},t.send=n=>{if(!e._buffer){const r={nativeArray:e.Float32Array,usage:iL.Storage,label:e.label};e._buffer=n.getBufferManager().getBuffer(r),e.bindGroupTime.modified(),e._sendTime.modified();return}n.getHandle().queue.writeBuffer(e._buffer.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes*e.numberOfInstances),e._sendTime.modified()},t.createView=n=>{n in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes*e.numberOfInstances)),e[n]=E.newTypedArray(n,e.arrayBuffer))},t.setValue=(n,r,a)=>{const s=e._bufferEntryNames.get(n);if(s===void 0){Mr(`entry named ${n} not found in UBO`);return}const i=e.bufferEntries[s];t.createView(i.nativeType);const o=e[i.nativeType];o[(i.offset+r*e.sizeInBytes)/o.BYTES_PER_ELEMENT]=a},t.setArray=(n,r,a)=>{const s=e._bufferEntryNames.get(n);if(s===void 0){Mr(`entry named ${n} not found in UBO`);return}const i=e.bufferEntries[s];t.createView(i.nativeType);const o=e[i.nativeType],c=(i.offset+r*e.sizeInBytes)/o.BYTES_PER_ELEMENT;for(let u=0;u<a.length;u++)o[c+u]=a[u]},t.setAllInstancesFromArray=(n,r)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){Mr(`entry named ${n} not found in UBO`);return}const s=e.bufferEntries[a];t.createView(s.nativeType);const i=e[s.nativeType],o=r.length/e.numberOfInstances;for(let c=0;c<e.numberOfInstances;c++){const u=(s.offset+c*e.sizeInBytes)/i.BYTES_PER_ELEMENT;for(let g=0;g<o;g++)i[u+g]=r[c*o+g]}},t.setAllInstancesFromArrayColorToFloat=(n,r)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){Mr(`entry named ${n} not found in UBO`);return}const s=e.bufferEntries[a];t.createView(s.nativeType);const i=e[s.nativeType],o=r.length/e.numberOfInstances;for(let c=0;c<e.numberOfInstances;c++){const u=(s.offset+c*e.sizeInBytes)/i.BYTES_PER_ELEMENT;for(let g=0;g<o;g++)i[u+g]=r[c*o+g]/255}},t.setAllInstancesFromArray3x3To4x4=(n,r)=>{const a=e._bufferEntryNames.get(n);if(a===void 0){Mr(`entry named ${n} not found in UBO`);return}const s=e.bufferEntries[a];t.createView(s.nativeType);const i=e[s.nativeType],o=9;for(let c=0;c<e.numberOfInstances;c++){const u=(s.offset+c*e.sizeInBytes)/i.BYTES_PER_ELEMENT;for(let g=0;g<3;g++)for(let f=0;f<3;f++)i[u+g*4+f]=r[c*o+g*3+f]}},t.getSendTime=()=>e._sendTime.getMTime(),t.getShaderCode=(n,r)=>{const a=[`struct ${e.label}StructEntry
{`];for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];a.push(`  ${i.name}: ${i.type},`)}return a.push(`
};
struct ${e.label}Struct
{
  values: array<${e.label}StructEntry>,
};
@binding(${n}) @group(${r}) var<storage, read> ${e.label}: ${e.label}Struct;
`),a.join(`
`)},t.getBindGroupEntry=()=>({resource:{buffer:e._buffer.getHandle()}}),t.clearData=()=>{e.numberOfInstances=0,e.sizeInBytes=0,e.bufferEntries=[],e._bufferEntryNames=new Map,e._buffer=null,delete e.arrayBuffer,delete e.Float32Array}}const cL={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,numberOfInstances:1};function m1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cL,n),E.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e._sendTime={},E.obj(e._sendTime,{mtime:0}),e.bindGroupTime={},E.obj(e.bindGroupTime,{mtime:0}),e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"read-only-storage"}},E.get(t,e,["bindGroupTime"]),E.setGet(t,e,["device","bindGroupLayoutEntry","label","numberOfInstances","sizeInBytes"]),oL(t,e)}const fL=E.newInstance(m1,"vtkWebGPUStorageBuffer");var ic={newInstance:fL,extend:m1};const{BufferUsage:uL}=Cr,{vtkErrorMacro:yo}=E;function gL(t,e){e.classHierarchy.push("vtkWebGPUUniformBuffer"),t.addEntry=(n,r)=>{if(e._bufferEntryNames.has(n)){yo(`entry named ${n} already exists`);return}e.sortDirty=!0,e._bufferEntryNames.set(n,e.bufferEntries.length),e.bufferEntries.push({name:n,type:r,sizeInBytes:Xe.getByteStrideFromShaderFormat(r),offset:-1,nativeType:Xe.getNativeTypeFromShaderFormat(r),packed:!1})},t.sortBufferEntries=()=>{if(!e.sortDirty)return;let n=0;const r=[];let a=4;for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];i.sizeInBytes%16===0&&(a=Math.max(16,a)),i.sizeInBytes%8===0&&(a=Math.max(8,a))}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];i.packed===!1&&i.sizeInBytes%16===0&&(i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes)}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];if(i.packed===!1&&i.sizeInBytes===12)for(let o=0;o<e.bufferEntries.length;o++){const c=e.bufferEntries[o];if(c.packed===!1&&c.sizeInBytes===4){i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes,c.packed=!0,c.offset=n,r.push(c),n+=c.sizeInBytes;break}}}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];if(!i.packed&&i.sizeInBytes%8===0)for(let o=s+1;o<e.bufferEntries.length;o++){const c=e.bufferEntries[o];if(!c.packed&&c.sizeInBytes%8===0){i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes,c.packed=!0,c.offset=n,r.push(c),n+=c.sizeInBytes;break}}}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];if(!i.packed&&i.sizeInBytes%8===0){let o=!1;for(let c=0;!o&&c<e.bufferEntries.length;c++){const u=e.bufferEntries[c];if(!u.packed&&u.sizeInBytes===4)for(let g=c+1;g<e.bufferEntries.length;g++){const f=e.bufferEntries[g];if(!f.packed&&f.sizeInBytes===4){i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes,u.packed=!0,u.offset=n,r.push(u),n+=u.sizeInBytes,f.packed=!0,f.offset=n,r.push(f),n+=f.sizeInBytes,o=!0;break}}}}}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];!i.packed&&i.sizeInBytes>4&&(i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes)}for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];i.packed||(i.packed=!0,i.offset=n,r.push(i),n+=i.sizeInBytes)}e.bufferEntries=r,e._bufferEntryNames.clear();for(let s=0;s<e.bufferEntries.length;s++)e._bufferEntryNames.set(e.bufferEntries[s].name,s);e.sizeInBytes=n,e.sizeInBytes=a*Math.ceil(e.sizeInBytes/a),e.sortDirty=!1},t.sendIfNeeded=n=>{if(!e.UBO){const r={nativeArray:e.Float32Array,usage:uL.UniformArray,label:e.label};e.UBO=n.getBufferManager().getBuffer(r),e.bindGroupTime.modified(),e.sendDirty=!1}e.sendDirty&&(n.getHandle().queue.writeBuffer(e.UBO.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes),e.sendDirty=!1),e.sendTime.modified()},t.createView=n=>{n in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes)),e[n]=E.newTypedArray(n,e.arrayBuffer))},t.setValue=(n,r)=>{t.sortBufferEntries();const a=e._bufferEntryNames.get(n);if(a===void 0){yo(`entry named ${n} not found in UBO`);return}const s=e.bufferEntries[a];t.createView(s.nativeType);const i=e[s.nativeType];s.lastValue!==r&&(i[s.offset/i.BYTES_PER_ELEMENT]=r,e.sendDirty=!0),s.lastValue=r},t.setArray=(n,r)=>{t.sortBufferEntries();const a=e._bufferEntryNames.get(n);if(a===void 0){yo(`entry named ${n} not found in UBO`);return}const s=e.bufferEntries[a];t.createView(s.nativeType);const i=e[s.nativeType];let o=!1;for(let c=0;c<r.length;c++)(!s.lastValue||s.lastValue[c]!==r[c])&&(i[s.offset/i.BYTES_PER_ELEMENT+c]=r[c],o=!0);o&&(e.sendDirty=!0,s.lastValue=[...r])},t.getBindGroupEntry=()=>({resource:{buffer:e.UBO.getHandle()}}),t.getSendTime=()=>e.sendTime.getMTime(),t.getShaderCode=(n,r)=>{t.sortBufferEntries();const a=[`struct ${e.label}Struct
{`];for(let s=0;s<e.bufferEntries.length;s++){const i=e.bufferEntries[s];a.push(`  ${i.name}: ${i.type},`)}return a.push(`};
@binding(${n}) @group(${r}) var<uniform> ${e.label}: ${e.label}Struct;`),a.join(`
`)}}const lL={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,bindGroupLayoutEntry:null,bindGroupEntry:null};function F1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lL,n),E.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"uniform"}},e.sendTime={},E.obj(e.sendTime,{mtime:0}),e.bindGroupTime={},E.obj(e.bindGroupTime,{mtime:0}),e.sendDirty=!0,e.sortDirty=!0,E.get(t,e,["binding","bindGroupTime"]),E.setGet(t,e,["bindGroupLayoutEntry","device","label","sizeInBytes"]),gL(t,e)}const hL=E.newInstance(F1,"vtkWebGPUUniformBuffer");var gr={newInstance:hL,extend:F1};const{vtkDebugMacro:pL}=nn,_g=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = mapperUBO.BackgroundColor;

  //VTK::RenderEncoder::Impl
  return output;
}
`,dL=`
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec4<f32> = vec4<f32>(input.vertexVC.xy, -1, 1);
  var V: vec4<f32> = normalize(mapperUBO.FSQMatrix * tcoord); // vec2<f32>((input.tcoordVS.x - 0.5) * 2, -(input.tcoordVS.y - 0.5) * 2);
  // textureSampleLevel gets rid of some ugly artifacts
  var background = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, vecToRectCoord(V.xyz), 0.0);
  var computedColor: vec4<f32> = vec4<f32>(background.rgb, 1);

  //VTK::RenderEncoder::Impl
  return output;
}
`,vs=new Float64Array(16),Ug=new Float64Array(16);function vL(t){return t.getPositional()?t.getConeAngle()>=90?0:2:1}function yL(t,e){e.classHierarchy.push("vtkWebGPURenderer"),t.buildPass=n=>{if(n){if(!e.renderable)return;e.camera=e.renderable.getActiveCamera(),t.updateLights(),t.prepareNodes(),t.addMissingNode(e.camera),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes(),e.webgpuCamera=t.getViewNodeFor(e.camera,e.webgpuCamera),t.updateStabilizedMatrix()}},t.updateStabilizedMatrix=()=>{const n=e.camera.getClippingRange(),r=e.camera.getPositionByReference(),a=e.camera.getDirectionOfProjectionByReference(),s=[],i=[];Dn(i,a,.5*(n[0]+n[1])),ca(s,r,i),$o(i,s,e.stabilizedCenter),p0(i)/(n[1]-n[0])>e.recenterThreshold&&(e.stabilizedCenter=s,e.stabilizedTime.modified())},t.updateLights=()=>{let n=0;const r=e.renderable.getLightsByReference();for(let a=0;a<r.length;++a)r[a].getSwitch()>0&&n++;return n||(pL("No lights are on, creating one."),e.renderable.createLight()),n},t.updateUBO=()=>{const n=e.UBO.getSendTime();if(e._parent.getMTime()>n||t.getMTime()>n||e.camera.getMTime()>n||e.renderable.getMTime()>n){const r=e.webgpuCamera.getKeyMatrices(t);e.UBO.setArray("WCVCMatrix",r.wcvc),e.UBO.setArray("SCPCMatrix",r.scpc),e.UBO.setArray("PCSCMatrix",r.pcsc),e.UBO.setArray("SCVCMatrix",r.scvc),e.UBO.setArray("VCPCMatrix",r.vcpc),e.UBO.setArray("WCVCNormals",r.normalMatrix),e.UBO.setValue("LightCount",e.renderable.getLights().length),e.UBO.setValue("MaxEnvironmentMipLevel",e.renderable.getEnvironmentTexture()?.getMipLevel()),e.UBO.setValue("BackgroundDiffuseStrength",e.renderable.getEnvironmentTextureDiffuseStrength()),e.UBO.setValue("BackgroundSpecularStrength",e.renderable.getEnvironmentTextureSpecularStrength());const a=t.getYInvertedTiledSizeAndOrigin();e.UBO.setArray("viewportSize",[a.usize,a.vsize]),e.UBO.setValue("cameraParallel",e.camera.getParallelProjection());const s=e._parent.getDevice();e.UBO.sendIfNeeded(s)}},t.updateSSBO=()=>{const n=e.renderable.getLights(),r=e.webgpuCamera.getKeyMatrices(t);let a=`${e.renderable.getMTime()}`;for(let s=0;s<n.length;s++)a+=n[s].getMTime();if(a!==e.lightTimeString){const s=new Float32Array(n.length*4),i=new Float32Array(n.length*4),o=new Float32Array(n.length*4),c=new Float32Array(n.length*4);for(let g=0;g<n.length;g++){const f=g*4,l=n[g].getPosition();Te(l,l,r.wcvc),s[f]=l[0],s[f+1]=l[1],s[f+2]=l[2],s[f+3]=0,i[f]=-n[g].getDirection()[0],i[f+1]=-n[g].getDirection()[1],i[f+2]=-n[g].getDirection()[2],i[f+3]=0,o[f]=n[g].getColor()[0],o[f+1]=n[g].getColor()[1],o[f+2]=n[g].getColor()[2],o[f+3]=n[g].getIntensity()*5,c[f]=vL(n[g]),c[f+1]=Math.cos(me(n[g].getConeAngle())),c[f+2]=Math.cos(me(n[g].getConeAngle()+n[g].getConeFalloff())),c[f+3]=0}e.SSBO.clearData(),e.SSBO.setNumberOfInstances(n.length),e.SSBO.addEntry("LightPos","vec4<f32>"),e.SSBO.addEntry("LightDir","vec4<f32>"),e.SSBO.addEntry("LightColor","vec4<f32>"),e.SSBO.addEntry("LightData","vec4<f32>"),e.SSBO.setAllInstancesFromArray("LightPos",s),e.SSBO.setAllInstancesFromArray("LightDir",i),e.SSBO.setAllInstancesFromArray("LightColor",o),e.SSBO.setAllInstancesFromArray("LightData",c);const u=e._parent.getDevice();e.SSBO.send(u)}e.lightTimeString=a},t.scissorAndViewport=n=>{const r=t.getYInvertedTiledSizeAndOrigin();n.getHandle().setViewport(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize,0,1),n.getHandle().setScissorRect(r.lowerLeftU,r.lowerLeftV,r.usize,r.vsize)},t.bindUBO=n=>{n.activateBindGroup(e.bindGroup)},t.opaquePass=n=>{n?(e.renderEncoder.begin(e._parent.getCommandEncoder()),t.updateUBO(),t.updateSSBO()):(t.scissorAndViewport(e.renderEncoder),t.clear(),e.renderEncoder.end())},t.clear=()=>{if(e.renderable.getTransparent()||e.suppressClear)return;const n=e._parent.getDevice();if(!e.clearFSQ){e.clearFSQ=jr.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(_g);const s=gr.newInstance({label:"mapperUBO"});s.addEntry("FSQMatrix","mat4x4<f32>"),s.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(s),e.backgroundTex=e.renderable.getEnvironmentTexture()}if(e.clearFSQ.getPipelineHash()!=="clearfsqwithtexture"&&e.renderable.getUseEnvironmentTextureAsBackground()&&e.backgroundTex?.getImageLoaded()){e.clearFSQ.setFragmentShaderTemplate(dL);const s=gr.newInstance({label:"mapperUBO"});s.addEntry("FSQMatrix","mat4x4<f32>"),s.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(s);const i=n.getTextureManager().getTextureForVTKTexture(e.backgroundTex,"EnvironmentTexture");if(i.getReady()){const o=i.createView("EnvironmentTexture");e.clearFSQ.setTextureViews([o]),e.backgroundTexLoaded=!0;const c=e.backgroundTex.getInterpolate()?"linear":"nearest";o.addSampler(n,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:c,magFilter:c,mipmapFilter:"linear"})}e.clearFSQ.setPipelineHash("clearfsqwithtexture")}else if(e.clearFSQ.getPipelineHash()==="clearfsqwithtexture"&&!e.renderable.getUseEnvironmentTextureAsBackground()){e.clearFSQ=jr.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(_g);const s=gr.newInstance({label:"mapperUBO"});s.addEntry("FSQMatrix","mat4x4<f32>"),s.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(s)}const r=e.webgpuCamera.getKeyMatrices(t),a=e.renderable.getBackgroundByReference();e.clearFSQ.getUBO().setArray("BackgroundColor",a),Oe(Ug,r.normalMatrix),ko(vs,r.scvc,r.pcsc),ko(vs,Ug,vs),e.clearFSQ.getUBO().setArray("FSQMatrix",vs),e.clearFSQ.getUBO().sendIfNeeded(n),e.clearFSQ.prepareAndDraw(e.renderEncoder)},t.translucentPass=n=>{n?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.volumeDepthRangePass=n=>{n?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.getAspectRatio=()=>{const n=e._parent.getSizeByReference(),r=e.renderable.getViewportByReference();return n[0]*(r[2]-r[0])/((r[3]-r[1])*n[1])},t.convertToOpenGLDepth=n=>e.webgpuCamera.convertToOpenGLDepth(n),t.getYInvertedTiledSizeAndOrigin=()=>{const n=t.getTiledSizeAndOrigin(),r=e._parent.getSizeByReference();return n.lowerLeftV=r[1]-n.vsize-n.lowerLeftV,n},t.getTiledSizeAndOrigin=()=>{const n=e.renderable.getViewportByReference(),r=[0,0,1,1],a=n[0]-r[0],s=n[1]-r[1],i=e._parent.normalizedDisplayToDisplay(a,s),o=Math.round(i[0]),c=Math.round(i[1]),u=n[2]-r[0],g=n[3]-r[1],f=e._parent.normalizedDisplayToDisplay(u,g);let l=Math.round(f[0])-o,h=Math.round(f[1])-c;return l<0&&(l=0),h<0&&(h=0),{usize:l,vsize:h,lowerLeftU:o,lowerLeftV:c}},t.getPropFromID=n=>{for(let r=0;r<e.children.length;r++)if((e.children[r].getPropID?e.children[r].getPropID():-1)===n)return e.children[r];return null},t.getStabilizedTime=()=>e.stabilizedTime.getMTime(),t.releaseGraphicsResources=()=>{e.selector!==null&&e.selector.releaseGraphicsResources()}}const TL={bindGroup:null,selector:null,renderEncoder:null,recenterThreshold:20,suppressClear:!1,stabilizedCenter:[0,0,0]};function xL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TL,n),Be.extend(t,e,n),e.UBO=gr.newInstance({label:"rendererUBO"}),e.UBO.addEntry("WCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("PCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("VCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("WCVCNormals","mat4x4<f32>"),e.UBO.addEntry("viewportSize","vec2<f32>"),e.UBO.addEntry("LightCount","i32"),e.UBO.addEntry("MaxEnvironmentMipLevel","f32"),e.UBO.addEntry("BackgroundDiffuseStrength","f32"),e.UBO.addEntry("BackgroundSpecularStrength","f32"),e.UBO.addEntry("cameraParallel","u32"),e.SSBO=ic.newInstance({label:"rendererLightSSBO"}),e.lightTimeString="",e.bindGroup=x1.newInstance({label:"rendererBG"}),e.bindGroup.setBindables([e.UBO,e.SSBO]),e.tmpMat4=ue(new Float64Array(16)),e.stabilizedTime={},qe(e.stabilizedTime,{mtime:0}),ht(t,e,["bindGroup","stabilizedTime"]),Ir(t,e,["stabilizedCenter"]),He(t,e,["renderEncoder","selector","suppressClear","UBO"]),yL(t,e)}const SL=Ce(xL,"vtkWebGPURenderer");rn("vtkRenderer",SL);const{CoordinateSystem:Ng}=Ya;function CL(t,e){e.classHierarchy.push("vtkWebGPUActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();const r=e.renderable.getMatrix();e.bufferShift[0]=r[3],e.bufferShift[1]=r[7],e.bufferShift[2]=r[11];const a=n.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Ng.WORLD&&(e.bufferShift[0]-=a[0],e.bufferShift[1]-=a[1],e.bufferShift[2]-=a[2]),Oe(e.keyMatrices.bcwc,r),e.renderable.getIsIdentity()?ue(e.keyMatrices.normalMatrix):(Qe(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,ut(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),Oe(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),Ue(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Ng.WORLD?Ue(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-a[0],-a[1],-a[2]]):Qe(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}const wL={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function EL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wL,n),Be.extend(t,e,n),e.keyMatricesTime={},E.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},E.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],CL(t,e)}const RL=E.newInstance(EL);rn("vtkActor",RL);const{CoordinateSystem:kg}=Ya;function ML(t,e){e.classHierarchy.push("vtkWebGPUActor2D"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.traverseTranslucentPass=n=>{!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(n,!0),e.children[0]&&e.children[0].traverse(n),t.apply(n,!1))},t.queryPass=(n,r)=>{if(n){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?r.incrementOpaqueActorCount():r.incrementTranslucentActorCount()}},t.getBufferShift=n=>(t.getKeyMatrices(n),e.bufferShift),t.getKeyMatrices=n=>{if(Math.max(e.renderable.getMTime(),n.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.bufferShift[0]=0,e.bufferShift[1]=0,e.bufferShift[2]=0;const r=n.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===kg.WORLD&&(e.bufferShift[0]-=r[0],e.bufferShift[1]-=r[1],e.bufferShift[2]-=r[2]),ue(e.keyMatrices.bcwc),ue(e.keyMatrices.normalMatrix),Ue(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===kg.WORLD?Ue(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-r[0],-r[1],-r[2]]):Qe(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}const OL={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function DL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,OL,n),Be.extend(t,e,n),e.keyMatricesTime={},E.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},E.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],ML(t,e)}const LL=E.newInstance(DL);rn("vtkActor2D",LL);function VL(t,e){e.classHierarchy.push("vtkWebGPUCubeAxesActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,s=e.WebGPURenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([s.usize,s.vsize],a,e.WebGPURenderWindow.getRenderable())}}}const mL={};function FL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mL,n),Be.extend(t,e,n),e.CubeAxesActorHelper=Yp.newCubeAxesActorHelper(),VL(t,e)}const BL=Ce(FL,"vtkWebGPUCubeAxesActor");rn("vtkCubeAxesActor",BL);const{DisplayLocation:oc}=u1;function _L(t,e){e.classHierarchy.push("vtkProperty2D"),t.setDisplayLocationToBackground=()=>t.setDisplayLocation(oc.BACKGROUND),t.setDisplayLocationToForeground=()=>t.setDisplayLocation(oc.FOREGROUND),t.setRepresentationToWireframe=()=>t.setRepresentation(mt.WIREFRAME),t.setRepresentationToSurface=()=>t.setRepresentation(mt.SURFACE),t.setRepresentationToPoints=()=>t.setRepresentation(mt.POINTS),t.getRepresentationAsString=()=>E.enumToString(mt,e.representation)}const UL={color:[1,1,1],opacity:1,pointSize:1,lineWidth:1,representation:mt.SURFACE,displayLocation:oc.FOREGROUND};function NL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UL,n),E.obj(t,e),E.setGet(t,e,["opacity","lineWidth","pointSize","displayLocation","representation"]),E.setGetArray(t,e,["color"],3),_L(t,e)}E.newInstance(NL,"vtkProperty2D");var kL={...u1};const{BufferUsage:Ke,PrimitiveTypes:rt}=Cr,{Representation:ys}=Yr,{ScalarMode:Ts}=vr,{CoordinateSystem:GL}=Ya,{DisplayLocation:Gg}=kL,bL=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,$L=`
struct PBRData {
  diffuse: vec3<f32>,
  specular: vec3<f32>,
}

struct Material {
  ior: f32,
  roughness: f32,
  metallic: f32,
  base: vec3<f32>,
};

struct DirectionalLight {
  direction: vec3<f32>,
  color: vec3<f32>,
};

struct PointLight {
  position: vec3<f32>,
  color: vec3<f32>,
};

struct SpotLight {
  position: vec3<f32>,
  direction: vec3<f32>,
  cones: vec2<f32>,
  color: vec3<f32>,
};

const pi: f32 = 3.14159265359;

// Dot product with the max already in it
fn mdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  return max(0.0, dot(a, b));
}
// Dot product with a max in it that does not allow for negative values
// Physically based rendering is accurate as long as normals are accurate,
// however this is pretty often not the case. In order to prevent negative
// values from ruining light calculations and creating zones of zero light,
// this remapping is used, which smoothly clamps the dot product between
// zero and one while still maintaining a good amount of accuracy.
fn cdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  var d: f32 = max(0.0, dot(a, b));
  d = pow((d + 1.0) / 2.0, 2.6);
  return d;
}

// Lambertian diffuse model
fn lambertDiffuse(base: vec3<f32>, N: vec3<f32>, L: vec3<f32>) -> vec3<f32> {
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5);
  return (base/pi)*NdotL;
}

// Yasuhiro Fujii improvement on the Oren-Nayar model
// https://mimosa-pudica.net/improved-oren-nayar.html
// p is surface color, o is roughness
fn fujiiOrenNayar(p: vec3<f32>, o: f32, N: vec3<f32>, L: vec3<f32>, V: vec3<f32>) -> vec3<f32> {
  var invpi: f32 = 0.31830988618; // 1/pi

  var o2 = o*o;
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5); // Less physically accurate, but hides the "seams" between lights better

  var NdotV: f32 = mdot(N, V);
  var LdotV: f32 = mdot(L, V);

  var s: f32 = LdotV - NdotL*NdotV;
  var t: f32 = mix(1.0, max(NdotL, NdotV), step(0.0, s)); // Mix with step is the equivalent of an if statement
  var A: vec3<f32> = 0.5*(o2 / (o2 + 0.33)) + 0.17*p*(o2 / (o2 + 0.13));
  A = invpi*(1 - A);
  var B: f32 = 0.45*(o2 / (o2 + 0.09));
  B = invpi*B;

  return p*NdotL*(A + B*(s/t));
}

// Fresnel portion of BRDF (IOR only, simplified)
fn schlickFresnelIOR(V: vec3<f32>, N: vec3<f32>, ior: f32, k: f32) -> f32 {
  var NdotV: f32 = mdot(V, N);
  var F0: f32 = (pow((ior - 1.0), 2.0) + k*k) / (pow((ior + 1.0), 2.0) + k*k); // This takes into account the roughness, which the other one does not
  return F0 + (1.0 - F0) * pow((1.0-NdotV), 5.0);
}

// Fresnel portion of BRDF (Color ior, better)
fn schlickFresnelRGB(V: vec3<f32>, N: vec3<f32>, F0: vec3<f32>) -> vec3<f32> {
  var NdotV: f32 = mdot(V, N);
  return F0 + (1.0 - F0) * pow((1-NdotV), 5.0);
}

// Normal portion of BRDF
// https://learnopengl.com/PBR/Theory
// Trowbridge-Reitz GGX functions: normal, halfway, roughness^2
fn trGGX(N: vec3<f32>, H: vec3<f32>, a: f32) -> f32 {
  var a2: f32 = a*a;
  var NdotH = mdot(N, H);
  var NdotH2 = NdotH*NdotH;

  var denom: f32 = NdotH2 * (a2 - 1.0) + 1.0;

  return a2 / max((pi*denom*denom), 0.000001);
}

// A VERY bad approximation of anisotropy. Real anisotropic calculations require tangent and bitangent
fn anisotrophicTrGGX(N: vec3<f32>, H: vec3<f32>, O: vec3<f32>, s: f32, a: f32) -> f32 {
  var Op: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(O) * s, 0.)).xyz;

  var ggx1: f32 = trGGX(N + Op*s, H, a);
  var ggx2: f32 = trGGX(N - Op*s, H, a);
  return (0.5 * ggx1 + 0.5 * ggx2);
}

// Geometry portion of BRDF
fn schlickGGX(N: vec3<f32>, X: vec3<f32>, k: f32) -> f32 {
  var NdotX = cdot(N, X);
  return NdotX / max(0.000001, (NdotX*(1.0-k) + k));
}

fn smithSurfaceRoughness(N: vec3<f32>, V: vec3<f32>, L: vec3<f32>, k: f32) -> f32 {
  var ggx1: f32 = min(1.0, schlickGGX(N, V, k));
  var ggx2: f32 = min(1.0, schlickGGX(N, L, k));
  return ggx1*ggx2;
}

// BRDF Combination
fn cookTorrance(D: f32, F: f32, G: f32, N: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> f32 {
  var num: f32 = D*F*G;
  var denom: f32 = 4*cdot(V, N)*cdot(L, N);

  return num / max(denom, 0.000001);
}

// Different lighting calculations for different light sources
fn calcDirectionalLight(N: vec3<f32>, V: vec3<f32>, mat: Material, light: DirectionalLight) -> PBRData {
  var L: vec3<f32> = normalize(light.direction); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector

  var alpha = mat.roughness * mat.roughness;
  var k: f32 = alpha * alpha / 2.0;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L); // Fresnel term is replaced with 1 because it is added later
  var incoming: vec3<f32> = light.color;
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5);

  var specular: vec3<f32> = brdf * incoming * angle;
  // Oren-Nayar gives a clay-like effect when fully rough which some people may not want, so it might be better to give a separate
  // control property for the diffuse vs specular roughness
  var diffuse: vec3<f32> = incoming * fujiiOrenNayar(mat.base, mat.roughness, N, L, V);
  // Stores the specular and diffuse separately to allow for finer post processing
  var out = PBRData(diffuse, specular);

  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

fn calcPointLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, mat: Material, light: PointLight) -> PBRData {
  var L: vec3<f32> = normalize(light.position - fragPos);
  var H: vec3<f32> = normalize(L + V);
  var dist = distance(light.position, fragPos);

  var alpha = mat.roughness * mat.roughness;
  var k: f32 = alpha * alpha / 2.0;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  var F: f32 = schlickFresnelIOR(V, N, mat.ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);
  var incoming: vec3<f32> = light.color * (1.0 / (dist * dist));
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" between light sources

  var specular: vec3<f32> = brdf * incoming * angle;
  var diffuse: vec3<f32> = incoming * fujiiOrenNayar(mat.base, mat.roughness, N, L, V);
  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);

  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// For a reason unknown to me, spheres dont seem to behave propperly with head-on spot lights
fn calcSpotLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, mat: Material, light: SpotLight) -> PBRData {
  var L: vec3<f32> = normalize(light.position - fragPos);
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(light.position, fragPos);

  var alpha = mat.roughness * mat.roughness;
  var k: f32 = alpha * alpha / 2.0; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);

  var theta: f32 = mdot(normalize(light.direction), L);
  var epsilon: f32 = light.cones.x - light.cones.y;
  var intensity: f32 = (theta - light.cones.y) / epsilon;
  intensity = clamp(intensity, 0.0, 1.0);
  intensity /= dist * dist;

  var incoming: vec3<f32> = light.color * intensity;

  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" between light sources

  var specular: vec3<f32> = brdf * incoming * angle;
  var diffuse: vec3<f32> = incoming * fujiiOrenNayar(mat.base, mat.roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);

  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// Environment mapping stuff
// Takes in a vector and converts it to an equivalent coordinate in a rectilinear texture. Should be replaced with cubemaps at some point
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::TCoord::Dec

// optional surface normal declaration
//VTK::Normal::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  // Temporary ambient, diffuse, and opacity
  var ambientColor: vec4<f32> = mapperUBO.AmbientColor;
  var diffuseColor: vec4<f32> = mapperUBO.DiffuseColor;
  var opacity: f32 = mapperUBO.Opacity;
  var ior: f32 = mapperUBO.BaseIOR;

  // This should be declared somewhere else
  var _diffuseMap: vec4<f32> = vec4<f32>(1.0);
  var _roughnessMap: vec4<f32> = vec4<f32>(1.0);
  var _metallicMap: vec4<f32> = vec4<f32>(1.0);
  var _normalMap: vec4<f32> = vec4<f32>(0.0, 0.0, 1.0, 0.0); // normal map was setting off the normal vector detection in fragment
  var _ambientOcclusionMap: vec4<f32> = vec4<f32>(1.);
  var _emissionMap: vec4<f32> = vec4<f32>(0.);

  //VTK::Color::Impl

  //VTK::TCoord::Impl

  //VTK::Normal::Impl

  var computedColor: vec4<f32> = vec4<f32>(diffuseColor.rgb, 1.0);

  //VTK::Light::Impl

  //VTK::Select::Impl

  // Use texture alpha for transparency
  computedColor.a = mapperUBO.Opacity * _diffuseMap.a;
  if (computedColor.a == 0.0) { discard; };

  //VTK::Position::Impl

  //VTK::RenderEncoder::Impl

  return output;
}
`;function bg(t){return t.indexOf("edge")>=0}function WL(t,e){e.classHierarchy.push("vtkWebGPUCellArrayMapper"),t.buildPass=n=>{n&&(e.is2D?(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.forceZValue=!0):(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.forceZValue=!1),e.coordinateSystem=e.WebGPUActor.getRenderable().getCoordinateSystem(),e.useRendererMatrix=e.coordinateSystem!==GL.DISPLAY,e.WebGPURenderer=e.WebGPUActor.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice())},t.translucentPass=n=>{n&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.opaquePass=n=>{n&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.updateUBO=()=>{const r=e.WebGPUActor.getRenderable().getProperty(),a=e.UBO.getSendTime();if(t.getMTime()<=a&&r.getMTime()<=a&&e.renderable.getMTime()<=a)return;const s=e.WebGPUActor.getKeyMatrices(e.WebGPURenderer);if(e.UBO.setArray("BCWCMatrix",s.bcwc),e.UBO.setArray("BCSCMatrix",s.bcsc),e.UBO.setArray("MCWCNormals",s.normalMatrix),e.is2D){const o=r.getDisplayLocation?.()??Gg.BACKGROUND;e.UBO.setValue("ZValue",o===Gg.FOREGROUND?1:0);const c=r.getColorByReference();e.UBO.setValue("AmbientIntensity",1),e.UBO.setArray("DiffuseColor",[...c,1]),e.UBO.setValue("DiffuseIntensity",0),e.UBO.setValue("SpecularIntensity",0)}else e.UBO.setValue("AmbientIntensity",r.getAmbient()),e.UBO.setArray("AmbientColor",[...r.getAmbientColorByReference(),1]),e.UBO.setValue("DiffuseIntensity",r.getDiffuse()),e.UBO.setArray("DiffuseColor",[...r.getDiffuseColorByReference(),1]),e.UBO.setValue("Roughness",r.getRoughness()),e.UBO.setValue("BaseIOR",r.getBaseIOR()),e.UBO.setValue("Metallic",r.getMetallic()),e.UBO.setValue("NormalStrength",r.getNormalStrength()),e.UBO.setValue("Emission",r.getEmission()),e.UBO.setValue("SpecularIntensity",r.getSpecular()),r.getSpecularColorByReference()&&e.UBO.setArray("SpecularColor",[...r.getSpecularColorByReference(),1]);const i=r.getEdgeColorByReference?.();i&&e.UBO.setArray("EdgeColor",[...i,1]),e.UBO.setValue("LineWidth",r.getLineWidth()),e.UBO.setValue("Opacity",r.getOpacity()),e.UBO.setValue("PropID",e.WebGPUActor.getPropID()),e.UBO.sendIfNeeded(e.WebGPURenderWindow.getDevice())},t.haveWideLines=()=>{const n=e.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();return n.getProperty().getLineWidth()<=1||e.primitiveType===rt.Verts?!1:e.primitiveType===rt.Triangles||e.primitiveType===rt.TriangleStrips?r===ys.WIREFRAME:!0},t.replaceShaderPosition=(n,r,a)=>{const s=r.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),s.hasOutput("vertexVC")||s.addOutput("vec4<f32>","vertexVC");let i=s.getCode();e.useRendererMatrix?(i=ae.substitute(i,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = rendererUBO.SCPCMatrix*mapperUBO.BCSCMatrix*vertexBC;","    output.vertexVC = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);","//VTK::Position::Impl"]).result,e.forceZValue&&(i=ae.substitute(i,"//VTK::Position::Impl",["pCoord = vec4<f32>(pCoord.xyz/pCoord.w, 1.0);","pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)):(i=ae.substitute(i,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = mapperUBO.BCSCMatrix*vertexBC;","    pCoord.x = 2.0* pCoord.x / rendererUBO.viewportSize.x - 1.0;","    pCoord.y = 2.0* pCoord.y / rendererUBO.viewportSize.y - 1.0;","    pCoord.z = 0.5 - 0.5 * pCoord.z;","//VTK::Position::Impl"]).result,e.forceZValue&&(i=ae.substitute(i,"//VTK::Position::Impl",["    pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)),t.haveWideLines()&&(s.addBuiltinInput("u32","@builtin(instance_index) instanceIndex"),i=ae.substitute(i,"//VTK::Position::Impl",["    var tmpPos: vec4<f32> = pCoord;","    var numSteps: f32 = ceil(mapperUBO.LineWidth - 1.0);","    var offset: f32 = (mapperUBO.LineWidth - 1.0) * (f32(input.instanceIndex / 2u) - numSteps/2.0) / numSteps;","    var tmpPos2: vec3<f32> = tmpPos.xyz / tmpPos.w;","    tmpPos2.x = tmpPos2.x + 2.0 * (f32(input.instanceIndex) % 2.0) * offset / rendererUBO.viewportSize.x;","    tmpPos2.y = tmpPos2.y + 2.0 * (f32(input.instanceIndex + 1u) % 2.0) * offset / rendererUBO.viewportSize.y;","    tmpPos2.z = min(1.0, tmpPos2.z + 0.00001);","    pCoord = vec4<f32>(tmpPos2.xyz * tmpPos.w, tmpPos.w);","//VTK::Position::Impl"]).result),i=ae.substitute(i,"//VTK::Position::Impl",["    output.Position = pCoord;"]).result,s.setCode(i)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderNormal=(n,r,a)=>{const s=a.getBuffer("normalMC"),i=e.WebGPUActor.getRenderable();if(s){const o=r.getShaderDescription("vertex");o.hasOutput("normalVC")||o.addOutput("vec3<f32>","normalVC",s.getArrayInformation()[0].interpolation),o.hasOutput("tangentVC")||o.addOutput("vec3<f32>","tangentVC",s.getArrayInformation()[0].interpolation),o.hasOutput("bitangentVC")||o.addOutput("vec3<f32>","bitangentVC",s.getArrayInformation()[0].interpolation);let c=o.getCode();c=ae.substitute(c,"//VTK::Normal::Impl",["  output.normalVC = normalize((rendererUBO.WCVCNormals * mapperUBO.MCWCNormals * normalMC).xyz);","  var c1: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 0, 1));","  var c2: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 1, 0));","  var tangent: vec3<f32> = mix(c1, c2, distance(c1, c2));","  output.tangentVC = normalize(tangent);","  output.bitangentVC = normalize(cross(output.normalVC, tangent));"]).result,o.setCode(c);const u=r.getShaderDescription("fragment");c=u.getCode(),i.getProperty().getNormalTexture()?c=ae.substitute(c,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  var tangent: vec3<f32> = input.tangentVC;","  var bitangent: vec3<f32> = input.bitangentVC;","  var TCVCMatrix: mat3x3<f32> = mat3x3<f32>(","    tangent.x, bitangent.x, normal.x,","    tangent.y, bitangent.y, normal.y,","    tangent.z, bitangent.z, normal.z,","  );","  var mappedNormal: vec3<f32> = TCVCMatrix * (_normalMap.xyz * 2 - 1);","  normal = mix(normal, mappedNormal, mapperUBO.NormalStrength);","  normal = normalize(normal);"]).result:c=ae.substitute(c,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  normal = normalize(normal);"]).result,u.setCode(c)}},e.shaderReplacements.set("replaceShaderNormal",t.replaceShaderNormal),t.replaceShaderLight=(n,r,a)=>{if(n.includes("sel"))return;const s=r.getShaderDescription("vertex");s.hasOutput("vertexVC")||s.addOutput("vec4<f32>","vertexVC");const i=e.WebGPURenderer.getRenderable(),o=r.getShaderDescription("fragment");let c=o.getCode();if(c.includes("var normal:")&&e.useRendererMatrix&&!bg(n)&&!e.is2D&&!n.includes("sel")){const u=["  let fragPos = vec3<f32>(input.vertexVC.xyz);","  let V = mix(normalize(-fragPos), vec3<f32>(0, 0, 1), f32(rendererUBO.cameraParallel)); // View Vector","  let baseColor = _diffuseMap.rgb * diffuseColor.rgb;","  let roughness = max(0.000001, mapperUBO.Roughness * _roughnessMap.r);","  let metallic = mapperUBO.Metallic * _metallicMap.r;","  let alpha = roughness * roughness;","  let k = alpha * alpha / 2.0;","  var diffuse = vec3<f32>(0.);","  var specular = vec3<f32>(0.);","  let emission = _emissionMap.rgb * mapperUBO.Emission;","","  // Material struct","  let mat = Material(ior, roughness, metallic, baseColor);","","  {","    var i = 0;","    loop {","      if (!(i < rendererUBO.LightCount)) { break; }","      switch (i32(rendererLightSSBO.values[i].LightData.x)) {","         // Point Light","         case 0 {","           let color = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           let pos = (rendererLightSSBO.values[i].LightPos).xyz;","           let pointLight = PointLight(pos, color);","           let result = calcPointLight(normal, V, fragPos, mat, pointLight);","           diffuse += max(vec3<f32>(0), result.diffuse);","           specular += max(vec3<f32>(0), result.specular);","          }","         // Directional light","         case 1 {","           let dir = normalize((rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz);","           let color = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           let dirLight = DirectionalLight(dir, color);","           let result = calcDirectionalLight(normal, V, mat, dirLight); // diffuseColor.rgb needs to be fixed with a more dynamic diffuse color","           diffuse += max(vec3<f32>(0), result.diffuse);","           specular += max(vec3<f32>(0), result.specular);","         }","         // Spot Light","         case 2 {","           let color = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           let pos = (rendererLightSSBO.values[i].LightPos).xyz;","           let dir = normalize((rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz);","           let cones = vec2<f32>(rendererLightSSBO.values[i].LightData.y, rendererLightSSBO.values[i].LightData.z);","           let spotLight = SpotLight(pos, dir, cones, color);","           let result = calcSpotLight(normal, V, fragPos, mat, spotLight);","           diffuse += max(vec3<f32>(0), result.diffuse);","           specular += max(vec3<f32>(0), result.specular);","         }","         default { continue; }","       }","      continuing { i++; }","    }","  }","  let fresnel = min(1.0, schlickFresnelIOR(V, normal, ior, k)); // Fresnel","  // This could be controlled with its own variable (that isnt base color) for better artistic control","  let fresnelMetallic = schlickFresnelRGB(V, normal, baseColor); // Fresnel for metal, takes color into account","  let kS = min(vec3<f32>(1.0), mix(vec3<f32>(fresnel), fresnelMetallic, metallic));","  let kD = (1.0 - kS) * (1.0 - metallic);","  let PBR = mapperUBO.DiffuseIntensity * kD * diffuse + kS * specular;","  computedColor = vec4<f32>(PBR + emission, mapperUBO.Opacity);"];i.getEnvironmentTexture()?.getImageLoaded()&&u.push("  // To get diffuse IBL, the texture is sampled with normals in worldspace","  let diffuseIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(normal, 1.)).xyz;","  let diffuseCoords = vecToRectCoord(diffuseIBLCoords);","  // To get specular IBL, the texture is sampled as the worldspace reflection between the normal and view vectors","  // Reflections are first calculated in viewspace, then converted to worldspace to sample the environment","  let VreflN = normalize(reflect(-V, normal));","  let reflectionIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(VreflN, 1.)).xyz;","  let specularCoords = vecToRectCoord(reflectionIBLCoords);","  let diffuseIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, diffuseCoords, rendererUBO.MaxEnvironmentMipLevel);","  let level = roughness * rendererUBO.MaxEnvironmentMipLevel;","  let specularIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, specularCoords, level);","  let specularIBLContribution = specularIBL.rgb * rendererUBO.BackgroundSpecularStrength;","  computedColor += vec4<f32>(specularIBLContribution * kS, 0);","  let diffuseIBLContribution = diffuseIBL.rgb * rendererUBO.BackgroundDiffuseStrength;","  computedColor += vec4<f32>(diffuseIBLContribution * baseColor * _ambientOcclusionMap.rgb * kD, 0);"),c=ae.substitute(c,"//VTK::Light::Impl",u).result,o.setCode(c)}else c=ae.substitute(c,"//VTK::Light::Impl",["  let diffuse = diffuseColor.rgb;","  let specular = mapperUBO.SpecularColor.rgb * mapperUBO.SpecularColor.a;","  computedColor = vec4<f32>(diffuse * _diffuseMap.rgb, mapperUBO.Opacity);"]).result,o.setCode(c)},e.shaderReplacements.set("replaceShaderLight",t.replaceShaderLight),t.replaceShaderColor=(n,r,a)=>{if(bg(n)){const u=r.getShaderDescription("fragment");let g=u.getCode();g=ae.substitute(g,"//VTK::Color::Impl",["ambientColor = mapperUBO.EdgeColor;","diffuseColor = mapperUBO.EdgeColor;"]).result,u.setCode(g);return}const s=a.getBuffer("colorVI");if(!s)return;const i=r.getShaderDescription("vertex");i.addOutput("vec4<f32>","color",s.getArrayInformation()[0].interpolation);let o=i.getCode();o=ae.substitute(o,"//VTK::Color::Impl",["  output.color = colorVI;"]).result,i.setCode(o);const c=r.getShaderDescription("fragment");o=c.getCode(),o=ae.substitute(o,"//VTK::Color::Impl",["ambientColor = input.color;","diffuseColor = input.color;","opacity = mapperUBO.Opacity * input.color.a;"]).result,c.setCode(o)},e.shaderReplacements.set("replaceShaderColor",t.replaceShaderColor),t.replaceShaderTCoord=(n,r,a)=>{if(!a.hasAttribute("tcoord"))return;const s=r.getShaderDescription("vertex"),i=a.getBuffer("tcoord"),o=Xe.getNumberOfComponentsFromBufferFormat(i.getArrayInformation()[0].format);let c=s.getCode();s.addOutput(`vec${o}<f32>`,"tcoordVS"),c=ae.substitute(c,"//VTK::TCoord::Impl",["  output.tcoordVS = tcoord;"]).result,s.setCode(c);const u=r.getShaderDescription("fragment");c=u.getCode();const g=e.WebGPUActor.getRenderable(),f=g.getProperty(),l=C=>C?C.getDimensionality()===o:!1,h=[],v=f.getDiffuseTexture?.();(v?.getImageLoaded()||g.getTextures()[0]||e.colorTexture)&&(l(v)||l(g.getTextures()[0])||l(e.colorTexture))&&h.push("_diffuseMap = textureSample(DiffuseTexture, DiffuseTextureSampler, input.tcoordVS);");const p=f.getORMTexture?.(),d=f.getRMTexture?.(),y=f.getRoughnessTexture?.(),S=f.getMetallicTexture?.(),x=f.getAmbientOcclusionTexture?.(),T=f.getEmissionTexture?.(),w=f.getNormalTexture?.();p?.getImageLoaded()?l(p)&&h.push("_ambientOcclusionMap = textureSample(ORMTexture, ORMTextureSampler, input.tcoordVS).rrra;","_roughnessMap = textureSample(ORMTexture, ORMTextureSampler, input.tcoordVS).ggga;","_metallicMap = textureSample(ORMTexture, ORMTextureSampler, input.tcoordVS).bbba;"):d?.getImageLoaded()?l(d)&&h.push("_roughnessMap = textureSample(RMTexture, RMTextureSampler, input.tcoordVS).ggga;","_metallicMap = textureSample(RMTexture, RMTextureSampler, input.tcoordVS).bbba;"):(y?.getImageLoaded()&&l(y)&&h.push("_roughnessMap = textureSample(RoughnessTexture, RoughnessTextureSampler, input.tcoordVS).ggga;"),S?.getImageLoaded()&&l(S)&&h.push("_metallicMap = textureSample(MetallicTexture, MetallicTextureSampler, input.tcoordVS).bbba;"),x?.getImageLoaded()&&l(x)&&h.push("_ambientOcclusionMap = textureSample(AmbientOcclusionTexture, AmbientOcclusionTextureSampler, input.tcoordVS).rrra;")),T?.getImageLoaded()&&l(T)&&h.push("_emissionMap = textureSample(EmissionTexture, EmissionTextureSampler, input.tcoordVS);"),w?.getImageLoaded()&&l(w)&&h.push("_normalMap = textureSample(NormalTexture, NormalTextureSampler, input.tcoordVS);"),c=ae.substitute(c,"//VTK::TCoord::Impl",h).result,u.setCode(c)},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderSelect=(n,r,a)=>{if(n.includes("sel")){const s=r.getShaderDescription("fragment");let i=s.getCode();i=ae.substitute(i,"//VTK::Select::Impl",["  var compositeID: u32 = 0u;"]).result,s.setCode(i)}},e.shaderReplacements.set("replaceShaderSelect",t.replaceShaderSelect),t.getUsage=(n,r)=>n===ys.POINTS||r===rt.Points?Ke.Verts:r===rt.Lines?Ke.Lines:n===ys.WIREFRAME?r===rt.Triangles?Ke.LinesFromTriangles:Ke.LinesFromStrips:r===rt.Triangles?Ke.Triangles:r===rt.TriangleStrips?Ke.Strips:r===rt.TriangleEdges?Ke.LinesFromTriangles:Ke.LinesFromStrips,t.getHashFromUsage=n=>`pt${n}`,t.getTopologyFromUsage=n=>{switch(n){case Ke.Triangles:return"triangle-list";case Ke.Verts:return"point-list";case Ke.Lines:default:return"line-list"}},t.buildVertexInput=()=>{const n=e.currentInput,r=e.cellArray,a=e.primitiveType;let i=e.WebGPUActor.getRenderable().getProperty().getRepresentation();const o=e.WebGPURenderWindow.getDevice();let c=!1;a===rt.TriangleEdges&&(c=!0,i=ys.WIREFRAME);const u=e.vertexInput,g=n.getPoints();let f=null;if(r?(f=o.getBufferManager().getBuffer({hash:`R${i}P${a}${r.getMTime()}`,usage:Ke.Index,cells:r,numberOfPoints:g.getNumberOfPoints(),primitiveType:a,representation:i}),u.setIndexBuffer(f)):u.setIndexBuffer(null),g){const p=e.WebGPUActor.getBufferShift(e.WebGPURenderer);u.addBuffer(o.getBufferManager().getBuffer({hash:`${g.getMTime()}I${f?.getMTime?.()??0}${p.join()}float32x4`,usage:Ke.PointArray,format:"float32x4",dataArray:g,indexBuffer:f,shift:p,packExtra:!0}),["vertexBC"])}else u.removeBufferIfPresent("vertexBC");const l=t.getUsage(i,a);if(e._usesCellNormals=!1,!e.is2D&&(l===Ke.Triangles||l===Ke.Strips)){const p=n.getPointData().getNormals(),d={format:"snorm8x4",indexBuffer:f,packExtra:!0,shift:0,scale:127};p?(d.hash=`${p.getMTime()}I${f.getMTime()}snorm8x4`,d.dataArray=p,d.usage=Ke.PointArray,u.addBuffer(o.getBufferManager().getBuffer(d),["normalMC"])):a===rt.Triangles?(e._usesCellNormals=!0,d.hash=`PFN${g.getMTime()}I${f.getMTime()}snorm8x4`,d.dataArray=g,d.cells=r,d.usage=Ke.NormalsFromPoints,u.addBuffer(o.getBufferManager().getBuffer(d),["normalMC"])):u.removeBufferIfPresent("normalMC")}else u.removeBufferIfPresent("normalMC");let h=!1;if(e.renderable.getScalarVisibility()){const p=e.renderable.getColorMapColors();if(p&&!c){const d=e.renderable.getScalarMode(),y=(d===Ts.USE_CELL_DATA||d===Ts.USE_CELL_FIELD_DATA||d===Ts.USE_FIELD_DATA||!n.getPointData().getScalars())&&d!==Ts.USE_POINT_FIELD_DATA&&p;u.addBuffer(o.getBufferManager().getBuffer({usage:Ke.PointArray,format:"unorm8x4",hash:`${y}${p.getMTime()}I${f.getMTime()}unorm8x4`,dataArray:p,indexBuffer:f,cellData:y,cellOffset:0}),["colorVI"]),h=!0}}h||u.removeBufferIfPresent("colorVI");let v=null;e.renderable.getInterpolateScalarsBeforeMapping?.()&&e.renderable.getColorCoordinates()?v=e.renderable.getColorCoordinates():v=n.getPointData().getTCoords(),v&&!c?u.addBuffer(o.getBufferManager().getBufferForPointArray(v,u.getIndexBuffer()),["tcoord"]):u.removeBufferIfPresent("tcoord")},t.updateTextures=()=>{const n=[],r=[],a=e.renderable.getColorTextureMap?.();a&&!e.colorTexture&&(e.colorTexture=Wa.newInstance({label:"polyDataColor"})),a&&(e.colorTexture.setInputData(a),r.push(["DiffuseTexture",e.colorTexture]));const s=e.WebGPUActor.getRenderable(),i=e.WebGPURenderer.getRenderable();[["DiffuseTexture",s.getProperty().getDiffuseTexture?.()],["DiffuseTexture",s.getTextures()[0]],["DiffuseTexture",e.colorTexture],["ORMTexture",s.getProperty().getORMTexture?.()],["RMTexture",s.getProperty().getRMTexture?.()],["RoughnessTexture",s.getProperty().getRoughnessTexture?.()],["MetallicTexture",s.getProperty().getMetallicTexture?.()],["NormalTexture",s.getProperty().getNormalTexture?.()],["AmbientOcclusionTexture",s.getProperty().getAmbientOcclusionTexture?.()],["EmissionTexture",s.getProperty().getEmissionTexture?.()],["EnvironmentTexture",i.getEnvironmentTexture?.()]].forEach(c=>{let[u,g]=c;g&&((g.getInputData()||g.getJsImageData()||g.getCanvas()||g.getImageBitmap())&&r.push([u,g]),g.getImage()&&g.getImageLoaded()&&r.push([u,g]))}),r.forEach(c=>{let[u,g]=c;const f=e.device.getTextureManager().getTextureForVTKTexture(g,u);if(!f.getReady())return;let l=!1;for(let h=0;h<e.textures.length;++h)if(e.textures[h]===f){l=!0,n[h]=!0;break}if(!l){n[e.textures.length]=!0;const h=f.createView(u);e.textures.push(f),e.textureViews.push(h);const v=g.getInterpolate()?"linear":"nearest";let p=null;g.getEdgeClamp()&&g.getRepeat()?p="mirror-repeat":g.getEdgeClamp()?p="clamp-to-edge":g.getRepeat()&&(p="repeat");let d={addressModeU:p,addressModeV:p,addressModeW:p,minFilter:v,magFilter:v};u==="EnvironmentTexture"&&(d={addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:v,magFilter:v,mipmapFilter:"linear"}),h.addSampler(e.device,d)}});for(let c=e.textures.length-1;c>=0;c--)n[c]||(e.textures.splice(c,1),e.textureViews.splice(c,1))},t.computePipelineHash=()=>{let n=`pd${e.useRendererMatrix?"r":""}${e.forceZValue?"z":""}`;if(e.primitiveType===rt.TriangleEdges||e.primitiveType===rt.TriangleStripEdges)n+="edge";else{if(e.vertexInput.hasAttribute("normalMC")&&(n+="n"),e.vertexInput.hasAttribute("colorVI")&&(n+="c"),e.vertexInput.hasAttribute("tcoord")){const a=e.vertexInput.getBuffer("tcoord"),s=Xe.getNumberOfComponentsFromBufferFormat(a.getArrayInformation()[0].format);n+=`t${s}`}e.textures.length&&(n+=`tx${e.textures.length}`)}e._usesCellNormals&&(n+="cn"),e.SSBO&&(n+="ssbo");const r=t.getHashFromUsage(e.usage);n+=r,n+=e.renderEncoder.getPipelineHash(),e.pipelineHash=n},t.updateBuffers=()=>{e.primitiveType!==rt.TriangleEdges&&e.primitiveType!==rt.TriangleStripEdges&&t.updateTextures();const n=e.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();e.usage=t.getUsage(r,e.primitiveType),t.buildVertexInput();const a=e.vertexInput.getBuffer("vertexBC");if(t.setNumberOfVertices(a.getSizeInBytes()/a.getStrideInBytes()),t.setTopology(t.getTopologyFromUsage(e.usage)),t.updateUBO(),t.haveWideLines()){const s=n.getProperty();t.setNumberOfInstances(Math.ceil(s.getLineWidth()*2))}else t.setNumberOfInstances(1)}}const zL={is2D:!1,cellArray:null,currentInput:null,cellOffset:0,primitiveType:0,colorTexture:null,renderEncoder:null,textures:null};function B1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zL,n),yf.extend(t,e,n),e.fragmentShaderTemplate=$L,e.vertexShaderTemplate=bL,e._tmpMat3=jn(new Float64Array(9)),e._tmpMat4=ue(new Float64Array(16)),e.UBO=gr.newInstance({label:"mapperUBO"}),e.UBO.addEntry("BCWCMatrix","mat4x4<f32>"),e.UBO.addEntry("BCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("MCWCNormals","mat4x4<f32>"),e.UBO.addEntry("AmbientColor","vec4<f32>"),e.UBO.addEntry("DiffuseColor","vec4<f32>"),e.UBO.addEntry("EdgeColor","vec4<f32>"),e.UBO.addEntry("SpecularColor","vec4<f32>"),e.UBO.addEntry("AmbientIntensity","f32"),e.UBO.addEntry("DiffuseIntensity","f32"),e.UBO.addEntry("Roughness","f32"),e.UBO.addEntry("Metallic","f32"),e.UBO.addEntry("Ambient","f32"),e.UBO.addEntry("Normal","f32"),e.UBO.addEntry("Emission","f32"),e.UBO.addEntry("NormalStrength","f32"),e.UBO.addEntry("BaseIOR","f32"),e.UBO.addEntry("SpecularIntensity","f32"),e.UBO.addEntry("LineWidth","f32"),e.UBO.addEntry("Opacity","f32"),e.UBO.addEntry("ZValue","f32"),e.UBO.addEntry("PropID","u32"),e.UBO.addEntry("ClipNear","f32"),e.UBO.addEntry("ClipFar","f32"),e.UBO.addEntry("Time","u32"),He(t,e,["cellArray","currentInput","cellOffset","is2D","primitiveType","renderEncoder"]),e.textures=[],WL(t,e)}const HL=Ce(B1,"vtkWebGPUCellArrayMapper");var _1={newInstance:HL,extend:B1};const{PrimitiveTypes:Dt}=Cr;function AL(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper"),t.createCellArrayMapper=()=>_1.newInstance(),t.buildPass=n=>{if(n){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.renderable.getStatic()||e.renderable.update();const r=e.renderable.getInputData();e.renderable.mapScalars(r,1),t.updateCellArrayMappers(r)}},t.updateCellArrayMappers=n=>{if(!n){ie("No input!");return}const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],a=[];let s=0;for(let i=Dt.Points;i<=Dt.TriangleStrips;i++)if(r[i].getNumberOfValues()>0){e.primitives[i]||(e.primitives[i]=t.createCellArrayMapper());const o=e.primitives[i];o.setCellArray(r[i]),o.setCurrentInput(n),o.setCellOffset(s),o.setPrimitiveType(i),o.setRenderable(e.renderable),s+=r[i].getNumberOfCells(),a.push(o)}else e.primitives[i]=null;if(e.WebGPUActor.getRenderable().getProperty().getEdgeVisibility()){if(r[Dt.Triangles].getNumberOfValues()>0){const i=Dt.TriangleEdges;e.primitives[i]||(e.primitives[i]=t.createCellArrayMapper());const o=e.primitives[i];o.setCellArray(r[Dt.Triangles]),o.setCurrentInput(n),o.setCellOffset(e.primitives[Dt.Triangles].getCellOffset()),o.setPrimitiveType(i),o.setRenderable(e.renderable),a.push(o)}else e.primitives[Dt.TriangleEdges]=null;if(r[Dt.TriangleStrips].getNumberOfValues()>0){const i=Dt.TriangleStripEdges;e.primitives[i]||(e.primitives[i]=t.createCellArrayMapper());const o=e.primitives[i];o.setCellArray(r[Dt.TriangleStrips]),o.setCurrentInput(n),o.setCellOffset(e.primitives[Dt.TriangleStrips].getCellOffset()),o.setPrimitiveType(i),o.setRenderable(e.renderable),a.push(o)}else e.primitives[Dt.TriangleStripEdges]=null}t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}const jL={primitives:null};function KL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jL,n),Be.extend(t,e,n),e.primitives=[],AL(t,e)}const PL=Ce(KL,"vtkWebGPUPolyDataMapper");rn("vtkMapper",PL);const{PrimitiveTypes:$g}=Cr;function XL(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper2D"),t.createCellArrayMapper=()=>_1.newInstance(),t.buildPass=n=>{if(n){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.renderable.getStatic()||e.renderable.update();const r=e.renderable.getInputData();e.renderable.mapScalars(r,1),t.updateCellArrayMappers(r)}},t.updateCellArrayMappers=n=>{const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],a=[];let s=0;for(let i=$g.Points;i<=$g.Triangles;i++)if(r[i].getNumberOfValues()>0){e.primitives[i]||(e.primitives[i]=t.createCellArrayMapper());const o=e.primitives[i];o.setCellArray(r[i]),o.setCurrentInput(n),o.setCellOffset(s),o.setPrimitiveType(i),o.setRenderable(e.renderable),o.setIs2D(!0),s+=r[i].getNumberOfCells(),a.push(o)}else e.primitives[i]=null;t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}function IL(t){return{primitives:[],...t}}function YL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IL(n)),Be.extend(t,e,n),e.primitives=[],XL(t,e)}const qL=Ce(YL,"vtkWebGPUPolyDataMapper2D");rn("vtkMapper2D",qL);function QL(t,e){e.classHierarchy.push("vtkWebGPUScalarBarActor"),t.buildPass=n=>{n&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=(n,r)=>{if(n){const a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,s=e.WebGPURenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([s.usize,s.vsize],a,e.WebGPURenderWindow.getRenderable())}}}const ZL={};function JL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZL,n),Be.extend(t,e,n),e.scalarBarActorHelper=d1.newScalarBarActorHelper(),QL(t,e)}const eV=Ce(JL,"vtkWebGPUScalarBarActor");rn("vtkScalarBarActor",eV);function tV(t,e){e.classHierarchy.push("vtkWebGPUSampler"),t.create=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.device=n,e.options.addressModeU=r.addressModeU?r.addressModeU:"clamp-to-edge",e.options.addressModeV=r.addressModeV?r.addressModeV:"clamp-to-edge",e.options.addressModeW=r.addressModeW?r.addressModeW:"clamp-to-edge",e.options.magFilter=r.magFilter?r.magFilter:"nearest",e.options.minFilter=r.minFilter?r.minFilter:"nearest",e.options.mipmapFilter=r.mipmapFilter?r.mipmapFilter:"nearest",e.options.label=e.label,e.handle=e.device.getHandle().createSampler(e.options),e.bindGroupTime.modified()},t.getShaderCode=(n,r)=>`@binding(${n}) @group(${r}) var ${e.label}: sampler;`,t.getBindGroupEntry=()=>({resource:e.handle})}const nV={device:null,handle:null,label:null,options:null};function U1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nV,n),E.obj(t,e),e.options={},e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,sampler:{}},e.bindGroupTime={},E.obj(e.bindGroupTime,{mtime:0}),E.get(t,e,["bindGroupTime","handle","options"]),E.setGet(t,e,["bindGroupLayoutEntry","device","label"]),tV(t,e)}const rV=E.newInstance(U1);var Tf={newInstance:rV,extend:U1};function aV(t,e){e.classHierarchy.push("vtkWebGPUTextureView"),t.create=(n,r)=>{e.texture=n,e.options=r,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=n.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;const a=Xe.getDetailsFromTextureFormat(e.texture.getFormat());e.bindGroupLayoutEntry.texture.sampleType=a.sampleType},t.createFromTextureHandle=(n,r)=>{e.texture=null,e.options=r,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=n,e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;const a=Xe.getDetailsFromTextureFormat(r.format);e.bindGroupLayoutEntry.texture.sampleType=a.sampleType,e.bindGroupTime.modified()},t.getBindGroupEntry=()=>({resource:t.getHandle()}),t.getShaderCode=(n,r)=>{let a="f32";e.bindGroupLayoutEntry.texture.sampleType==="sint"?a="i32":e.bindGroupLayoutEntry.texture.sampleType==="uint"&&(a="u32");let s=`@binding(${n}) @group(${r}) var ${e.label}: texture_${e.options.dimension}<${a}>;`;return e.bindGroupLayoutEntry.texture.sampleType==="depth"&&(s=`@binding(${n}) @group(${r}) var ${e.label}: texture_depth_${e.options.dimension};`),s},t.addSampler=(n,r)=>{const a=Tf.newInstance({label:`${e.label}Sampler`});a.create(n,r),t.setSampler(a)},t.getBindGroupTime=()=>(e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.bindGroupTime),t.getHandle=()=>(e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.handle)}const sV={texture:null,handle:null,sampler:null,label:null};function N1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sV,n),E.obj(t,e),e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d"}},e.bindGroupTime={},E.obj(e.bindGroupTime,{mtime:0}),E.get(t,e,["bindGroupTime","texture"]),E.setGet(t,e,["bindGroupLayoutEntry","label","sampler"]),aV(t,e)}const iV=E.newInstance(N1);var k1={newInstance:iV,extend:N1};function oV(t,e){e.classHierarchy.push("vtkWebGPUTexture"),t.create=(n,r)=>{e.device=n,e.width=r.width,e.height=r.height,e.depth=r.depth?r.depth:1;const a=e.depth===1?"2d":"3d";e.format=r.format?r.format:"rgba8unorm",e.mipLevel=r.mipLevel?r.mipLevel:0,e.usage=r.usage?r.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label,dimension:a,mipLevelCount:e.mipLevel+1})},t.assignFromHandle=(n,r,a)=>{e.device=n,e.handle=r,e.width=a.width,e.height=a.height,e.depth=a.depth?a.depth:1,e.format=a.format?a.format:"rgba8unorm",e.usage=a.usage?a.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},t.writeImageData=n=>{let r=[];const a=f=>{e.device.getHandle().queue.copyExternalImageToTexture({source:f,flipY:n.flip},{texture:e.handle,premultipliedAlpha:!0,mipLevel:0,origin:{x:0,y:0,z:0}},[f.width,f.height,e.depth]),t.getDimensionality()!==3&&e.mipLevel>0&&Wa.generateMipmaps(e.device.getHandle(),e.handle,e.mipLevel+1),e.ready=!0};if(n.canvas){a(n.canvas);return}if(n.imageBitmap){n.width=n.imageBitmap.width,n.height=n.imageBitmap.height,n.depth=1,n.format="rgba8unorm",n.flip=!0,a(n.imageBitmap);return}if(n.jsImageData){n.width=n.jsImageData.width,n.height=n.jsImageData.height,n.depth=1,n.format="rgba8unorm",n.flip=!0,a(n.jsImageData);return}if(n.image){n.width=n.image.width,n.height=n.image.height,n.depth=1,n.format="rgba8unorm",n.flip=!0,a(n.image);return}const s=Xe.getDetailsFromTextureFormat(e.format);let i=e.width*s.stride;const o=(f,l,h)=>{const v=s.elementSize===2&&s.sampleType==="float",p=f.BYTES_PER_ELEMENT,d=f.length/(l*h)*p;if(!v&&d%256===0)return[f,d];const y=d/p,S=s.elementSize,x=256*Math.floor((y*S+255)/256),T=x/S,w=E.newTypedArray(v?"Uint16Array":f.constructor.name,T*l*h),C=l*h;if(v)for(let R=0;R<C;R++){const M=R*y,m=R*T;for(let L=0;L<y;L++)w[m+L]=kt.toHalf(f[M+L])}else if(T===y)w.set(f);else for(let R=0;R<C;R++)w.set(f.subarray(R*y,(R+1)*y),R*T);return[w,x]};n.nativeArray&&(r=n.nativeArray);const c=t.getDimensionality()===3,u=o(r,e.height,c?e.depth:1);i=u[1];const g=u[0];e.device.getHandle().queue.writeTexture({texture:e.handle,mipLevel:0,origin:{x:0,y:0,z:0}},g,{offset:0,bytesPerRow:i,rowsPerImage:e.height},{width:e.width,height:e.height,depthOrArrayLayers:c?e.depth:1}),!c&&e.mipLevel>0&&Wa.generateMipmaps(e.device.getHandle(),e.handle,e.mipLevel+1),e.ready=!0},t.getScale=()=>{const n=Xe.getDetailsFromTextureFormat(e.format);return n.elementSize===2&&n.sampleType==="float"?1:255},t.getNumberOfComponents=()=>Xe.getDetailsFromTextureFormat(e.format).numComponents,t.getDimensionality=()=>{let n=0;return e.width>1&&n++,e.height>1&&n++,e.depth>1&&n++,n},t.resizeToMatch=n=>{(n.getWidth()!==e.width||n.getHeight()!==e.height||n.getDepth()!==e.depth)&&(e.width=n.getWidth(),e.height=n.getHeight(),e.depth=n.getDepth(),e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.resize=function(n,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;(n!==e.width||r!==e.height||a!==e.depth)&&(e.width=n,e.height=r,e.depth=a,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.createView=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};r.dimension||(r.dimension=e.depth===1?"2d":"3d");const a=k1.newInstance({label:n});return a.create(t,r),a}}const cV={device:null,handle:null,buffer:null,ready:!1,label:null};function G1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cV,n),E.obj(t,e),E.get(t,e,["handle","ready","width","height","depth","format","usage"]),E.setGet(t,e,["device","label"]),oV(t,e)}const fV=E.newInstance(G1);var en={newInstance:fV,extend:G1};function uV(t,e){e.classHierarchy.push("vtkWebGPUPixelSpaceCallbackMapper"),t.opaquePass=(n,r)=>{e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent();const a=e.WebGPURenderer.getAspectRatio(),s=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,i=e.WebGPURenderer.getTiledSizeAndOrigin(),o=null;e.renderable.getUseZValues(),e.renderable.invokeCallback(e.renderable.getInputData(),s,a,i,o)}}const gV={};function lV(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gV,n),Be.extend(t,e,n),uV(t,e)}const hV=E.newInstance(lV,"vtkWebGPUPixelSpaceCallbackMapper");rn("vtkPixelSpaceCallbackMapper",hV);const{vtkDebugMacro:xs}=E;function pV(t,e){e.classHierarchy.push("vtkCamera");const n=new Float64Array(3),r=new Float64Array([0,0,-1]),a=new Float64Array([0,1,0]),s=ue(new Float64Array(16)),i=ue(new Float64Array(16)),o=new Float64Array(3),c=new Float64Array(3),u=new Float64Array(3),g=ue(new Float64Array(16)),f=ue(new Float64Array(16)),l=new Float64Array(3),h=new Float64Array(3);function v(){e.viewPlaneNormal[0]=-e.directionOfProjection[0],e.viewPlaneNormal[1]=-e.directionOfProjection[1],e.viewPlaneNormal[2]=-e.directionOfProjection[2]}t.orthogonalizeViewUp=()=>{const p=t.getViewMatrix();e.viewUp[0]=p[4],e.viewUp[1]=p[5],e.viewUp[2]=p[6],t.modified()},t.setPosition=(p,d,y)=>{p===e.position[0]&&d===e.position[1]&&y===e.position[2]||(e.position[0]=p,e.position[1]=d,e.position[2]=y,t.computeDistance(),t.modified())},t.setFocalPoint=(p,d,y)=>{p===e.focalPoint[0]&&d===e.focalPoint[1]&&y===e.focalPoint[2]||(e.focalPoint[0]=p,e.focalPoint[1]=d,e.focalPoint[2]=y,t.computeDistance(),t.modified())},t.setDistance=p=>{if(e.distance===p)return;e.distance=p,e.distance<1e-20&&(e.distance=1e-20,xs("Distance is set to minimum."));const d=e.directionOfProjection;e.focalPoint[0]=e.position[0]+d[0]*e.distance,e.focalPoint[1]=e.position[1]+d[1]*e.distance,e.focalPoint[2]=e.position[2]+d[2]*e.distance,t.modified()},t.computeDistance=()=>{const p=e.focalPoint[0]-e.position[0],d=e.focalPoint[1]-e.position[1],y=e.focalPoint[2]-e.position[2];if(e.distance=Math.sqrt(p*p+d*d+y*y),e.distance<1e-20){e.distance=1e-20,xs("Distance is set to minimum.");const S=e.directionOfProjection;e.focalPoint[0]=e.position[0]+S[0]*e.distance,e.focalPoint[1]=e.position[1]+S[1]*e.distance,e.focalPoint[2]=e.position[2]+S[2]*e.distance}e.directionOfProjection[0]=p/e.distance,e.directionOfProjection[1]=d/e.distance,e.directionOfProjection[2]=y/e.distance,v()},t.dolly=p=>{if(p<=0)return;const d=e.distance/p;t.setPosition(e.focalPoint[0]-d*e.directionOfProjection[0],e.focalPoint[1]-d*e.directionOfProjection[1],e.focalPoint[2]-d*e.directionOfProjection[2])},t.roll=p=>{const d=e.position,y=e.focalPoint,S=e.viewUp,x=new Float64Array([S[0],S[1],S[2],0]);ue(g);const T=new Float64Array([y[0]-d[0],y[1]-d[1],y[2]-d[2]]);Bt(g,g,me(p),T),ea(x,x,g),e.viewUp[0]=x[0],e.viewUp[1]=x[1],e.viewUp[2]=x[2],t.modified()},t.azimuth=p=>{const d=e.focalPoint;ue(f),Ue(f,f,d),Bt(f,f,me(p),e.viewUp),Ue(f,f,[-d[0],-d[1],-d[2]]),Te(l,e.position,f),t.setPosition(l[0],l[1],l[2])},t.yaw=p=>{const d=e.position;ue(f),Ue(f,f,d),Bt(f,f,me(p),e.viewUp),Ue(f,f,[-d[0],-d[1],-d[2]]),Te(h,e.focalPoint,f),t.setFocalPoint(h[0],h[1],h[2])},t.elevation=p=>{const d=e.focalPoint,y=t.getViewMatrix(),S=[-y[0],-y[1],-y[2]];ue(f),Ue(f,f,d),Bt(f,f,me(p),S),Ue(f,f,[-d[0],-d[1],-d[2]]),Te(l,e.position,f),t.setPosition(l[0],l[1],l[2])},t.pitch=p=>{const d=e.position,y=t.getViewMatrix(),S=[y[0],y[1],y[2]];ue(f),Ue(f,f,d),Bt(f,f,me(p),S),Ue(f,f,[-d[0],-d[1],-d[2]]),Te(h,e.focalPoint,f),t.setFocalPoint(...h)},t.zoom=p=>{p<=0||(e.parallelProjection?e.parallelScale/=p:e.viewAngle/=p,t.modified())},t.translate=(p,d,y)=>{const S=[p,d,y];Hr(e.position,S,e.position),Hr(e.focalPoint,S,e.focalPoint),t.computeDistance(),t.modified()},t.applyTransform=p=>{const d=[...e.viewUp,1],y=[],S=[],x=[];d[0]+=e.position[0],d[1]+=e.position[1],d[2]+=e.position[2],ea(y,[...e.position,1],p),ea(S,[...e.focalPoint,1],p),ea(x,d,p),x[0]-=y[0],x[1]-=y[1],x[2]-=y[2],t.setPosition(...y.slice(0,3)),t.setFocalPoint(...S.slice(0,3)),t.setViewUp(...x.slice(0,3))},t.getThickness=()=>e.clippingRange[1]-e.clippingRange[0],t.setThickness=p=>{let d=p;d<1e-20&&(d=1e-20,xs("Thickness is set to minimum.")),t.setClippingRange(e.clippingRange[0],e.clippingRange[0]+d)},t.setThicknessFromFocalPoint=p=>{let d=p;d<1e-20&&(d=1e-20,xs("Thickness is set to minimum.")),t.setClippingRange(e.distance-d/2,e.distance+d/2)},t.setRoll=p=>{},t.getRoll=()=>{},t.setObliqueAngles=(p,d)=>{},t.getOrientation=()=>{},t.getOrientationWXYZ=()=>{},t.getFrustumPlanes=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Float64Array(24);const y=[[1,0,0,1],[-1,0,0,1],[0,1,0,1],[0,-1,0,1],[0,0,1,1],[0,0,-1,1]],S=t.getCompositeProjectionMatrix(p,-1,1);for(let x=0;x<6;x++)ea(y[x],y[x],S),rC(y[x]),d[4*x+0]=y[x][0],d[4*x+1]=y[x][1],d[4*x+2]=y[x][2],d[4*x+3]=y[x][3];return d},t.getCameraLightTransformMatrix=p=>(Qe(p,e.cameraLightTransform),p),t.computeCameraLightTransform=()=>{Qe(s,t.getViewMatrix()),ut(s,s),r0(i,[e.distance,e.distance,e.distance]),Ne(s,s,i),ue(e.cameraLightTransform),Ue(e.cameraLightTransform,s,[0,0,-1])},t.deepCopy=p=>{},t.physicalOrientationToWorldDirection=p=>{const d=su(p[0],p[1],p[2],p[3]),y=hr(),S=su(0,0,1,0);return px(y,d),au(S,d,S),au(S,S,y),[S[0],S[1],S[2]]},t.getPhysicalToWorldMatrix=p=>{t.getWorldToPhysicalMatrix(p),ut(p,p)},t.getWorldToPhysicalMatrix=p=>{ue(p);const d=[3];gt(e.physicalViewNorth,e.physicalViewUp,d),p[0]=d[0],p[1]=d[1],p[2]=d[2],p[4]=e.physicalViewUp[0],p[5]=e.physicalViewUp[1],p[6]=e.physicalViewUp[2],p[8]=-e.physicalViewNorth[0],p[9]=-e.physicalViewNorth[1],p[10]=-e.physicalViewNorth[2],Oe(p,p),qt(o,1/e.physicalScale,1/e.physicalScale,1/e.physicalScale),lr(p,p,o),Ue(p,p,e.physicalTranslation)},t.computeViewParametersFromViewMatrix=p=>{ut(s,p),Te(o,n,s),t.computeDistance();const d=e.distance;t.setPosition(o[0],o[1],o[2]),Te(c,r,s),kn(c,c,o),$n(c,c),t.setDirectionOfProjection(c[0],c[1],c[2]),Te(u,a,s),kn(u,u,o),$n(u,u),t.setViewUp(u[0],u[1],u[2]),t.setDistance(d)},t.computeViewParametersFromPhysicalMatrix=p=>{t.getWorldToPhysicalMatrix(s),Ne(s,p,s),t.computeViewParametersFromViewMatrix(s)},t.setModelTransformMatrix=p=>{e.modelTransformMatrix=p},t.getModelTransformMatrix=()=>e.modelTransformMatrix,t.setViewMatrix=p=>{e.viewMatrix=p,e.viewMatrix&&(Qe(s,e.viewMatrix),t.computeViewParametersFromViewMatrix(s),Oe(e.viewMatrix,e.viewMatrix))},t.getViewMatrix=()=>{if(e.viewMatrix)return e.modelTransformMatrix?(Ne(s,e.viewMatrix,e.modelTransformMatrix),s):e.viewMatrix;g0(s,e.position,e.focalPoint,e.viewUp),Oe(s,s);const p=new Float64Array(16);return e.modelTransformMatrix?Ne(p,s,e.modelTransformMatrix):Qe(p,s),p},t.setProjectionMatrix=p=>{e.projectionMatrix=p},t.getProjectionMatrix=(p,d,y)=>{const S=new Float64Array(16);if(ue(S),e.projectionMatrix){const w=1/e.physicalScale;return qt(o,w,w,w),Qe(S,e.projectionMatrix),lr(S,S,o),Oe(S,S),S}ue(s);const x=e.clippingRange[1]-e.clippingRange[0],T=[e.clippingRange[0]+(d+1)*x/2,e.clippingRange[0]+(y+1)*x/2];if(e.parallelProjection){const w=e.parallelScale*p,C=e.parallelScale,R=(e.windowCenter[0]-1)*w,M=(e.windowCenter[0]+1)*w,m=(e.windowCenter[1]-1)*C,L=(e.windowCenter[1]+1)*C;u0(s,R,M,m,L,T[0],T[1]),Oe(s,s)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const w=Math.tan(me(e.viewAngle)/2);let C,R;e.useHorizontalViewAngle===!0?(C=e.clippingRange[0]*w,R=e.clippingRange[0]*w/p):(C=e.clippingRange[0]*w*p,R=e.clippingRange[0]*w);const M=(e.windowCenter[0]-1)*C,m=(e.windowCenter[0]+1)*C,L=(e.windowCenter[1]-1)*R,V=(e.windowCenter[1]+1)*R,F=T[0],B=T[1];s[0]=2*F/(m-M),s[5]=2*F/(V-L),s[2]=(M+m)/(m-M),s[6]=(L+V)/(V-L),s[10]=-(F+B)/(B-F),s[14]=-1,s[11]=-2*F*B/(B-F),s[15]=0}}return Qe(S,s),S},t.getCompositeProjectionMatrix=(p,d,y)=>{const S=t.getViewMatrix(),x=t.getProjectionMatrix(p,d,y);return Ne(x,S,x),x},t.setDirectionOfProjection=(p,d,y)=>{if(e.directionOfProjection[0]===p&&e.directionOfProjection[1]===d&&e.directionOfProjection[2]===y)return;e.directionOfProjection[0]=p,e.directionOfProjection[1]=d,e.directionOfProjection[2]=y;const S=e.directionOfProjection;e.focalPoint[0]=e.position[0]+S[0]*e.distance,e.focalPoint[1]=e.position[1]+S[1]*e.distance,e.focalPoint[2]=e.position[2]+S[2]*e.distance,v()},t.setDeviceAngles=(p,d,y,S)=>{const x=[3];gt(e.physicalViewNorth,e.physicalViewUp,x);const T=ue(new Float64Array(16));Bt(T,T,me(p),e.physicalViewUp),Bt(T,T,me(d),x),Bt(T,T,me(y),e.physicalViewNorth),Bt(T,T,me(-S),e.physicalViewUp);const w=new Float64Array([-e.physicalViewUp[0],-e.physicalViewUp[1],-e.physicalViewUp[2]]),C=new Float64Array(e.physicalViewNorth);Te(w,w,T),Te(C,C,T),t.setDirectionOfProjection(w[0],w[1],w[2]),t.setViewUp(C[0],C[1],C[2]),t.modified()},t.setOrientationWXYZ=(p,d,y,S)=>{const x=ue(new Float64Array(16));if(p!==0&&(d!==0||y!==0||S!==0)){const C=me(p),R=hr();Gc(R,[d,y,S],C),Ra(x,R)}const T=new Float64Array(3);Te(T,[0,0,-1],x);const w=new Float64Array(3);Te(w,[0,1,0],x),t.setDirectionOfProjection(...T),t.setViewUp(...w),t.modified()},t.computeClippingRange=p=>{let d=null,y=null;d=e.viewPlaneNormal,y=e.position;const S=-d[0],x=-d[1],T=-d[2],w=-(S*y[0]+x*y[1]+T*y[2]),C=[S*p[0]+x*p[2]+T*p[4]+w,1e-18];for(let R=0;R<2;R++)for(let M=0;M<2;M++)for(let m=0;m<2;m++){const L=S*p[m]+x*p[2+M]+T*p[4+R]+w;C[0]=L<C[0]?L:C[0],C[1]=L>C[1]?L:C[1]}return C}}const dV={position:[0,0,1],focalPoint:[0,0,0],viewUp:[0,1,0],directionOfProjection:[0,0,-1],parallelProjection:!1,useHorizontalViewAngle:!1,viewAngle:30,parallelScale:1,clippingRange:[.01,1000.01],windowCenter:[0,0],viewPlaneNormal:[0,0,1],useOffAxisProjection:!1,screenBottomLeft:[-.5,-.5,-.5],screenBottomRight:[.5,-.5,-.5],screenTopRight:[.5,.5,-.5],freezeFocalPoint:!1,projectionMatrix:null,viewMatrix:null,modelTransformMatrix:null,cameraLightTransform:xi(),physicalTranslation:[0,0,0],physicalScale:1,physicalViewUp:[0,1,0],physicalViewNorth:[0,0,-1]};function b1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dV,n),E.obj(t,e),E.get(t,e,["distance"]),E.setGet(t,e,["parallelProjection","useHorizontalViewAngle","viewAngle","parallelScale","useOffAxisProjection","freezeFocalPoint","physicalScale"]),E.getArray(t,e,["directionOfProjection","viewPlaneNormal","position","focalPoint"]),E.setGetArray(t,e,["clippingRange","windowCenter"],2),E.setGetArray(t,e,["viewUp","screenBottomLeft","screenBottomRight","screenTopRight","physicalTranslation","physicalViewUp","physicalViewNorth"],3),pV(t,e)}const vV=E.newInstance(b1,"vtkCamera");var yV={newInstance:vV,extend:b1};function TV(t,e){e.classHierarchy.push("vtkLight");const n=new Float64Array(3);t.getTransformedPosition=()=>(e.transformMatrix?Te(n,e.position,e.transformMatrix):qt(n,e.position[0],e.position[1],e.position[2]),n),t.getTransformedFocalPoint=()=>(e.transformMatrix?Te(n,e.focalPoint,e.transformMatrix):qt(n,e.focalPoint[0],e.focalPoint[1],e.focalPoint[2]),n),t.getDirection=()=>(e.directionMTime<e.mtime&&($o(e.direction,e.focalPoint,e.position),Rt(e.direction),e.directionMTime=e.mtime),e.direction),t.setDirection=r=>{const a=new Float64Array(3);$o(a,e.position,r),e.focalPoint=a},t.setDirectionAngle=(r,a)=>{const s=me(r),i=me(a);t.setPosition(Math.cos(s)*Math.sin(i),Math.sin(s),Math.cos(s)*Math.cos(i)),t.setFocalPoint(0,0,0),t.setPositional(0)},t.setLightTypeToHeadLight=()=>{t.setLightType("HeadLight")},t.setLightTypeToCameraLight=()=>{t.setLightType("CameraLight")},t.setLightTypeToSceneLight=()=>{t.setTransformMatrix(null),t.setLightType("SceneLight")},t.lightTypeIsHeadLight=()=>e.lightType==="HeadLight",t.lightTypeIsSceneLight=()=>e.lightType==="SceneLight",t.lightTypeIsCameraLight=()=>e.lightType==="CameraLight"}const xV={switch:!0,intensity:1,color:[1,1,1],position:[0,0,1],focalPoint:[0,0,0],positional:!1,exponent:1,coneAngle:30,coneFalloff:5,attenuationValues:[1,0,0],transformMatrix:null,lightType:"SceneLight",shadowAttenuation:1,direction:[0,0,0],directionMTime:0};function SV(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xV,n),E.obj(t,e),E.setGet(t,e,["intensity","switch","positional","exponent","coneAngle","coneFalloff","transformMatrix","lightType","shadowAttenuation","attenuationValues"]),E.setGetArray(t,e,["color","position","focalPoint","attenuationValues"],3),TV(t,e)}const CV=E.newInstance(SV,"vtkLight");var wV={newInstance:CV};const{vtkErrorMacro:Hs}=E;function EV(t){return()=>Hs(`vtkViewport::${t} - NOT IMPLEMENTED`)}function RV(t,e){e.classHierarchy.push("vtkViewport"),t.getViewProps=()=>e.props,t.hasViewProp=r=>e.props.includes(r),t.addViewProp=r=>{r&&!t.hasViewProp(r)&&e.props.push(r)},t.removeViewProp=r=>{const a=e.props.filter(s=>s!==r);e.props.length!==a.length&&(e.props=a)},t.removeAllViewProps=()=>{e.props=[]};function n(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];a.push(r);const s=r.getNestedProps();if(s&&s.length)for(let i=0;i<s.length;i++)n(s[i],a);return a}t.getViewPropsWithNestedProps=()=>{let r=[];e.actors2D=[];for(let a=0;a<e.props.length;a++){const s=e.props[a].getActors2D();s&&(!Array.isArray(s)||s.length>0)?e.actors2D=e.actors2D.concat(s):n(e.props[a],r)}return e.actors2D.sort((a,s)=>a.getLayerNumber()-s.getLayerNumber()),r=r.concat(e.actors2D),r},t.addActor2D=t.addViewProp,t.removeActor2D=r=>{t.removeViewProp(r)},t.getActors2D=()=>(e.actors2D=[],e.props.forEach(r=>{e.actors2D=e.actors2D.concat(r.getActors2D())}),e.actors2D),t.displayToView=()=>Hs("call displayToView on your view instead"),t.viewToDisplay=()=>Hs("callviewtodisplay on your view instead"),t.getSize=()=>Hs("call getSize on your View instead"),t.normalizedDisplayToProjection=(r,a,s)=>{const i=t.normalizedDisplayToNormalizedViewport(r,a,s);return t.normalizedViewportToProjection(i[0],i[1],i[2])},t.normalizedDisplayToNormalizedViewport=(r,a,s)=>{const i=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[(r-e.viewport[0])/i[0],(a-e.viewport[1])/i[1],s]},t.normalizedViewportToProjection=(r,a,s)=>[r*2-1,a*2-1,s*2-1],t.projectionToNormalizedDisplay=(r,a,s)=>{const i=t.projectionToNormalizedViewport(r,a,s);return t.normalizedViewportToNormalizedDisplay(i[0],i[1],i[2])},t.normalizedViewportToNormalizedDisplay=(r,a,s)=>{const i=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[r*i[0]+e.viewport[0],a*i[1]+e.viewport[1],s]},t.projectionToNormalizedViewport=(r,a,s)=>[(r+1)*.5,(a+1)*.5,(s+1)*.5],t.PickPropFrom=EV("PickPropFrom")}const MV={background:[0,0,0],background2:[.2,.2,.2],gradientBackground:!1,viewport:[0,0,1,1],aspect:[1,1],pixelAspect:[1,1],props:[],actors2D:[]};function $1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MV,n),E.obj(t,e),E.event(t,e,"event"),E.setGetArray(t,e,["viewport"],4),E.setGetArray(t,e,["background","background2"],3),RV(t,e)}const OV=E.newInstance($1,"vtkViewport");var DV={newInstance:OV,extend:$1};const{vtkDebugMacro:sa,vtkErrorMacro:Vn,vtkWarningMacro:LV}=nn;function Wg(t){return()=>Vn(`vtkRenderer::${t} - NOT IMPLEMENTED`)}function VV(t,e){e.classHierarchy.push("vtkRenderer");const n={type:"ComputeVisiblePropBoundsEvent",renderer:t},r={type:"ResetCameraClippingRangeEvent",renderer:t},a={type:"ResetCameraEvent",renderer:t};t.updateCamera=()=>(e.activeCamera||(sa("No cameras are on, creating one."),t.getActiveCameraAndResetIfCreated()),e.activeCamera.render(t),!0),t.updateLightsGeometryToFollowCamera=()=>{const s=t.getActiveCameraAndResetIfCreated();e.lights.forEach(i=>{i.lightTypeIsSceneLight()||(i.lightTypeIsHeadLight()?(i.setPositionFrom(s.getPositionByReference()),i.setFocalPointFrom(s.getFocalPointByReference()),i.modified(s.getMTime())):i.lightTypeIsCameraLight()?i.setTransformMatrix(s.getCameraLightTransformMatrix(xi())):Vn("light has unknown light type",i.get()))})},t.updateLightGeometry=()=>e.lightFollowCamera?t.updateLightsGeometryToFollowCamera():!0,t.allocateTime=Wg("allocateTime"),t.updateGeometry=Wg("updateGeometry"),t.getVTKWindow=()=>e._renderWindow,t.setLayer=s=>{sa(t.getClassName(),t,"setting Layer to ",s),e.layer!==s&&(e.layer=s,t.modified()),t.setPreserveColorBuffer(!!s)},t.setActiveCamera=s=>e.activeCamera===s?!1:(e.activeCamera=s,t.modified(),t.invokeEvent({type:"ActiveCameraEvent",camera:s}),!0),t.makeCamera=()=>{const s=yV.newInstance();return t.invokeEvent({type:"CreateCameraEvent",camera:s}),s},t.getActiveCamera=()=>(e.activeCamera||(e.activeCamera=t.makeCamera()),e.activeCamera),t.getActiveCameraAndResetIfCreated=()=>(e.activeCamera||(t.getActiveCamera(),t.resetCamera()),e.activeCamera),t.getActors=()=>(e.actors=[],e.props.forEach(s=>{e.actors=e.actors.concat(s.getActors())}),e.actors),t.addActor=t.addViewProp,t.removeActor=s=>{e.actors=e.actors.filter(i=>i!==s),t.removeViewProp(s),t.modified()},t.removeAllActors=()=>{t.getActors().forEach(i=>{t.removeViewProp(i)}),e.actors=[],t.modified()},t.getVolumes=()=>(e.volumes=[],e.props.forEach(s=>{e.volumes=e.volumes.concat(s.getVolumes())}),e.volumes),t.addVolume=t.addViewProp,t.removeVolume=s=>{e.volumes=e.volumes.filter(i=>i!==s),t.removeViewProp(s),t.modified()},t.removeAllVolumes=()=>{t.getVolumes().forEach(i=>{t.removeViewProp(i)}),e.volumes=[],t.modified()},t.hasLight=s=>e.lights.includes(s),t.addLight=s=>{s&&!t.hasLight(s)&&(e.lights.push(s),t.modified())},t.removeLight=s=>{e.lights=e.lights.filter(i=>i!==s),t.modified()},t.removeAllLights=()=>{e.lights=[],t.modified()},t.setLightCollection=s=>{e.lights=s,t.modified()},t.makeLight=wV.newInstance,t.createLight=()=>{e.automaticLightCreation&&(e._createdLight&&(t.removeLight(e._createdLight),e._createdLight.delete(),e._createdLight=null),e._createdLight=t.makeLight(),t.addLight(e._createdLight),e._createdLight.setLightTypeToHeadLight(),e._createdLight.setPosition(t.getActiveCamera().getPosition()),e._createdLight.setFocalPoint(t.getActiveCamera().getFocalPoint()))},t.normalizedDisplayToWorld=(s,i,o,c)=>{let u=t.normalizedDisplayToProjection(s,i,o);return u=t.projectionToView(u[0],u[1],u[2],c),t.viewToWorld(u[0],u[1],u[2])},t.worldToNormalizedDisplay=(s,i,o,c)=>{let u=t.worldToView(s,i,o);return u=t.viewToProjection(u[0],u[1],u[2],c),t.projectionToNormalizedDisplay(u[0],u[1],u[2])},t.viewToWorld=(s,i,o)=>{if(e.activeCamera===null)return Vn("ViewToWorld: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const c=e.activeCamera.getViewMatrix();ut(c,c),Oe(c,c);const u=new Float64Array([s,i,o]);return Te(u,u,c),u},t.projectionToView=(s,i,o,c)=>{if(e.activeCamera===null)return Vn("ProjectionToView: no active camera, cannot compute projection to view, returning 0,0,0"),[0,0,0];const u=e.activeCamera.getProjectionMatrix(c,-1,1);ut(u,u),Oe(u,u);const g=new Float64Array([s,i,o]);return Te(g,g,u),g},t.worldToView=(s,i,o)=>{if(e.activeCamera===null)return Vn("WorldToView: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const c=e.activeCamera.getViewMatrix();Oe(c,c);const u=new Float64Array([s,i,o]);return Te(u,u,c),u},t.viewToProjection=(s,i,o,c)=>{if(e.activeCamera===null)return Vn("ViewToProjection: no active camera, cannot compute view to projection, returning 0,0,0"),[0,0,0];const u=e.activeCamera.getProjectionMatrix(c,-1,1);Oe(u,u);const g=new Float64Array([s,i,o]);return Te(g,g,u),g},t.computeVisiblePropBounds=()=>{e.allBounds[0]=he.INIT_BOUNDS[0],e.allBounds[1]=he.INIT_BOUNDS[1],e.allBounds[2]=he.INIT_BOUNDS[2],e.allBounds[3]=he.INIT_BOUNDS[3],e.allBounds[4]=he.INIT_BOUNDS[4],e.allBounds[5]=he.INIT_BOUNDS[5];let s=!0;t.invokeEvent(n);for(let i=0;i<e.props.length;++i){const o=e.props[i];if(o.getVisibility()&&o.getUseBounds()){const c=o.getBounds();c&&bs(c)&&(s=!1,c[0]<e.allBounds[0]&&(e.allBounds[0]=c[0]),c[1]>e.allBounds[1]&&(e.allBounds[1]=c[1]),c[2]<e.allBounds[2]&&(e.allBounds[2]=c[2]),c[3]>e.allBounds[3]&&(e.allBounds[3]=c[3]),c[4]<e.allBounds[4]&&(e.allBounds[4]=c[4]),c[5]>e.allBounds[5]&&(e.allBounds[5]=c[5]))}}return s&&(tf(e.allBounds),sa("Can't compute bounds, no 3D props are visible")),e.allBounds},t.resetCamera=function(){const i=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:null)||t.computeVisiblePropBounds(),o=[0,0,0];if(!bs(i))return sa("Cannot reset camera!"),!1;let c=null;if(t.getActiveCamera())c=e.activeCamera.getViewPlaneNormal();else return Vn("Trying to reset non-existent camera"),!1;e.activeCamera.setViewAngle(30),o[0]=(i[0]+i[1])/2,o[1]=(i[2]+i[3])/2,o[2]=(i[4]+i[5])/2;let u=i[1]-i[0],g=i[3]-i[2],f=i[5]-i[4];u*=u,g*=g,f*=f;let l=u+g+f;l=l===0?1:l,l=Math.sqrt(l)*.5;const h=me(e.activeCamera.getViewAngle()),v=l,p=l/Math.sin(h*.5),d=e.activeCamera.getViewUp();return Math.abs(ee(d,c))>.999&&(LV("Resetting view-up since view plane normal is parallel"),e.activeCamera.setViewUp(-d[2],d[0],d[1])),e.activeCamera.setFocalPoint(o[0],o[1],o[2]),e.activeCamera.setPosition(o[0]+p*c[0],o[1]+p*c[1],o[2]+p*c[2]),t.resetCameraClippingRange(i),e.activeCamera.setParallelScale(v),e.activeCamera.setPhysicalScale(l),e.activeCamera.setPhysicalTranslation(-o[0],-o[1],-o[2]),t.invokeEvent(a),!0},t.resetCameraClippingRange=function(){const i=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:null)||t.computeVisiblePropBounds();if(!bs(i))return sa("Cannot reset camera clipping range!"),!1;if(t.getActiveCameraAndResetIfCreated(),!e.activeCamera)return Vn("Trying to reset clipping range of non-existent camera"),!1;const o=e.activeCamera.computeClippingRange(i);let c=0;if(e.activeCamera.getParallelProjection())c=.2*e.activeCamera.getParallelScale();else{const u=me(e.activeCamera.getViewAngle());c=.2*Math.tan(u/2)*o[1]}return o[1]-o[0]<c&&(c=c-o[1]+o[0],o[1]+=c/2,o[0]-=c/2),o[0]<0&&(o[0]=0),o[0]=.99*o[0]-(o[1]-o[0])*e.clippingRangeExpansion,o[1]=1.01*o[1]+(o[1]-o[0])*e.clippingRangeExpansion,o[0]=o[0]>=o[1]?.01*o[1]:o[0],e.nearClippingPlaneTolerance||(e.nearClippingPlaneTolerance=.01),o[0]<e.nearClippingPlaneTolerance*o[1]&&(o[0]=e.nearClippingPlaneTolerance*o[1]),e.activeCamera.setClippingRange(o[0],o[1]),t.invokeEvent(r),!1},t.setRenderWindow=s=>{s!==e._renderWindow&&(e._vtkWindow=s,e._renderWindow=s)},t.visibleActorCount=()=>e.props.filter(s=>s.getVisibility()).length,t.visibleVolumeCount=t.visibleActorCount,t.getMTime=()=>{let s=e.mtime;const i=e.activeCamera?e.activeCamera.getMTime():0;i>s&&(s=i);const o=e._createdLight?e._createdLight.getMTime():0;return o>s&&(s=o),s},t.getTransparent=()=>!!e.preserveColorBuffer,t.isActiveCameraCreated=()=>!!e.activeCamera}const mV={pickedProp:null,activeCamera:null,allBounds:[],ambient:[1,1,1],allocatedRenderTime:100,timeFactor:1,automaticLightCreation:!0,twoSidedLighting:!0,lastRenderTimeInSeconds:-1,renderWindow:null,lights:[],actors:[],volumes:[],lightFollowCamera:!0,numberOfPropsRendered:0,propArray:null,pathArray:null,layer:0,preserveColorBuffer:!1,preserveDepthBuffer:!1,computeVisiblePropBounds:Ri(),interactive:!0,nearClippingPlaneTolerance:0,clippingRangeExpansion:.05,erase:!0,draw:!0,useShadows:!1,useDepthPeeling:!1,occlusionRatio:0,maximumNumberOfPeels:4,selector:null,delegate:null,texturedBackground:!1,backgroundTexture:null,environmentTexture:null,environmentTextureDiffuseStrength:1,environmentTextureSpecularStrength:1,useEnvironmentTextureAsBackground:!1,pass:0};function W1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};for(Object.assign(e,mV,n),DV.extend(t,e,n),e.background||(e.background=[0,0,0,1]);e.background.length<3;)e.background.push(0);e.background.length===3&&e.background.push(1),ht(t,e,["_renderWindow","allocatedRenderTime","timeFactor","lastRenderTimeInSeconds","numberOfPropsRendered","lastRenderingUsedDepthPeeling","selector"]),He(t,e,["twoSidedLighting","lightFollowCamera","automaticLightCreation","erase","draw","nearClippingPlaneTolerance","clippingRangeExpansion","backingStore","interactive","layer","preserveColorBuffer","preserveDepthBuffer","useDepthPeeling","occlusionRatio","maximumNumberOfPeels","delegate","backgroundTexture","texturedBackground","environmentTexture","environmentTextureDiffuseStrength","environmentTextureSpecularStrength","useEnvironmentTextureAsBackground","useShadows","pass"]),Ir(t,e,["actors","volumes","lights"]),zc(t,e,["background"],4,1),ja(t,e,["renderWindow"]),VV(t,e)}const FV=Ce(W1,"vtkRenderer");var BV={newInstance:FV,extend:W1};const _V="WebGL",fi=Object.create(null);function xf(t,e){fi[t]=e}function UV(){return Object.keys(fi)}function z1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fi[t]&&fi[t](e)}function NV(t,e){e.classHierarchy.push("vtkRenderWindow"),t.addRenderer=n=>{t.hasRenderer(n)||(n.setRenderWindow(t),e.renderers.push(n),t.modified())},t.removeRenderer=n=>{e.renderers=e.renderers.filter(r=>r!==n),t.modified()},t.hasRenderer=n=>e.renderers.indexOf(n)!==-1,t.newAPISpecificView=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return z1(n||e.defaultViewAPI,r)},t.addView=n=>{t.hasView(n)||(n.setRenderable(t),e._views.push(n),t.modified())},t.removeView=n=>{e._views=e._views.filter(r=>r!==n),t.modified()},t.hasView=n=>e._views.indexOf(n)!==-1,t.preRender=()=>{e.renderers.forEach(n=>{n.isActiveCameraCreated()||n.resetCamera()})},t.render=()=>{t.preRender(),e.interactor?e.interactor.render():e._views.forEach(n=>n.traverseAllPasses())},t.getStatistics=()=>{const n={propCount:0,invisiblePropCount:0,gpuMemoryMB:0};return e._views.forEach(r=>{r.getGraphicsMemoryInfo&&(n.gpuMemoryMB+=r.getGraphicsMemoryInfo()/1e6)}),e.renderers.forEach(r=>{const a=r.getViewProps(),s=e._views[0].getViewNodeFor(r);a.forEach(i=>{if(i.getVisibility()){n.propCount+=1;const o=i.getMapper&&i.getMapper();if(o&&o.getPrimitiveCount){const c=s.getViewNodeFor(o);if(c){c.getAllocatedGPUMemoryInBytes&&(n.gpuMemoryMB+=c.getAllocatedGPUMemoryInBytes()/1e6);const u=o.getPrimitiveCount();Object.keys(u).forEach(g=>{n[g]||(n[g]=0),n[g]+=u[g]})}}}else n.invisiblePropCount+=1})}),n.str=Object.keys(n).map(r=>`${r}: ${n[r]}`).join(`
`),n},t.captureImages=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return E.setImmediate(t.render),e._views.map(a=>a.captureNextImage?a.captureNextImage(n,r):void 0).filter(a=>!!a)},t.addRenderWindow=n=>e.childRenderWindows.includes(n)?!1:(e.childRenderWindows.push(n),t.modified(),!0),t.removeRenderWindow=n=>{const r=e.childRenderWindows.findIndex(a=>a===n);return r<0?!1:(e.childRenderWindows.splice(r,1),t.modified(),!0)}}const kV={defaultViewAPI:_V,renderers:[],views:[],interactor:null,neverRendered:!0,numberOfLayers:1,childRenderWindows:[]};function H1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kV,n),E.obj(t,e),E.setGet(t,e,["interactor","numberOfLayers","_views","defaultViewAPI"]),E.get(t,e,["neverRendered"]),E.getArray(t,e,["renderers","childRenderWindows"]),E.moveToProtected(t,e,["views"]),E.event(t,e,"completion"),NV(t,e)}const GV=E.newInstance(H1,"vtkRenderWindow");var bV={newInstance:GV,extend:H1,registerViewConstructor:xf,listViewAPIs:UV,newAPISpecificView:z1};const cc={Unknown:0,LeftController:1,RightController:2},da={Unknown:0,Trigger:1,TrackPad:2,Grip:3,Thumbstick:4,A:5,B:6,ApplicationMenu:7},$V={Unknown:0,TouchpadX:1,TouchpadY:2,ThumbstickX:3,ThumbstickY:4},WV={LeftButton:1,MiddleButton:2,RightButton:3};var A1={Device:cc,Input:da,Axis:$V,MouseButton:WV};const{Device:Ss,Input:ar}=A1,{vtkWarningMacro:Cs,vtkErrorMacro:ws,normalizeWheel:zV,vtkOnceErrorMacro:HV}=E,Or={ctrlKey:!1,altKey:!1,shiftKey:!1},To={"xr-standard":[ar.Trigger,ar.Grip,ar.TrackPad,ar.Thumbstick,ar.A,ar.B]},Sf=["StartAnimation","Animation","EndAnimation","PointerEnter","PointerLeave","MouseEnter","MouseLeave","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteraction","Interaction","EndInteraction","AnimationFrameRateUpdate"];function ia(t){t.cancelable&&t.preventDefault()}function Es(t){const e=Object.create(null);return t.forEach(n=>{let{pointerId:r,position:a}=n;e[r]=a}),e}function AV(t,e){e.classHierarchy.push("vtkRenderWindowInteractor");const n={...t},r=new Set,a=new Map;let s=1;t.start=()=>{!e.initialized&&(t.initialize(),!e.initialized)||t.startEventLoop()},t.setRenderWindow=p=>{ws("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},t.setInteractorStyle=p=>{e.interactorStyle!==p&&(e.interactorStyle!=null&&e.interactorStyle.setInteractor(null),e.interactorStyle=p,e.interactorStyle!=null&&e.interactorStyle.getInteractor()!==t&&e.interactorStyle.setInteractor(t))},t.initialize=()=>{e.initialized=!0,t.enable(),t.render()},t.enable=()=>t.setEnabled(!0),t.disable=()=>t.setEnabled(!1),t.startEventLoop=()=>Cs("empty event loop");function i(p,d){e._forcedRenderer||(e.currentRenderer=t.findPokedRenderer(p,d))}t.getCurrentRenderer=()=>(e.currentRenderer||i(0,0),e.currentRenderer);function o(p){const d=e._view.getCanvas(),y=d.getBoundingClientRect(),S=d.width/y.width,x=d.height/y.height,T={x:S*(p.clientX-y.left),y:x*(y.height-p.clientY+y.top),z:0,movementX:S*p.movementX,movementY:x*p.movementY};return(a.size<=1||!e.currentRenderer)&&i(T.x,T.y),T}const c=e._getScreenEventPositionFor||o;function u(p){return{controlKey:p.ctrlKey,altKey:p.altKey,shiftKey:p.shiftKey}}function g(p){const d=u(p);return{key:p.key,keyCode:p.charCode,...d}}function f(p){return p.pointerType||""}const l=()=>{if(e.container===null)return;const{container:p}=e;p.addEventListener("contextmenu",ia),p.addEventListener("wheel",t.handleWheel),p.addEventListener("DOMMouseScroll",t.handleWheel),p.addEventListener("pointerenter",t.handlePointerEnter),p.addEventListener("pointerleave",t.handlePointerLeave),p.addEventListener("pointermove",t.handlePointerMove,{passive:!1}),p.addEventListener("pointerdown",t.handlePointerDown,{passive:!1}),p.addEventListener("pointerup",t.handlePointerUp),p.addEventListener("pointercancel",t.handlePointerCancel),p.addEventListener("keypress",t.handleKeyPress),p.addEventListener("keydown",t.handleKeyDown),document.addEventListener("keyup",t.handleKeyUp),document.addEventListener("pointerlockchange",t.handlePointerLockChange),p.tabIndex=0,p.style.touchAction="none",p.style.userSelect="none",p.style.webkitTapHighlightColor="rgba(0,0,0,0)"};t.bindEvents=p=>{if(p===null)return;n.setContainer(p)&&l()};const h=()=>{clearTimeout(e.moveTimeoutID),clearTimeout(e.wheelTimeoutID),e.moveTimeoutID=0,e.wheelTimeoutID=0,s=1;const{container:p}=e;p&&(p.removeEventListener("contextmenu",ia),p.removeEventListener("wheel",t.handleWheel),p.removeEventListener("DOMMouseScroll",t.handleWheel),p.removeEventListener("pointerenter",t.handlePointerEnter),p.removeEventListener("pointerleave",t.handlePointerLeave),p.removeEventListener("pointermove",t.handlePointerMove,{passive:!1}),p.removeEventListener("pointerdown",t.handlePointerDown,{passive:!1}),p.removeEventListener("pointerup",t.handlePointerUp),p.removeEventListener("pointercancel",t.handlePointerCancel),p.removeEventListener("keypress",t.handleKeyPress),p.removeEventListener("keydown",t.handleKeyDown)),document.removeEventListener("keyup",t.handleKeyUp),document.removeEventListener("pointerlockchange",t.handlePointerLockChange),a.clear()};t.unbindEvents=()=>{h(),n.setContainer(null)},t.handleKeyPress=p=>{const d=g(p);t.keyPressEvent(d)},t.handleKeyDown=p=>{const d=g(p);t.keyDownEvent(d)},t.handleKeyUp=p=>{const d=g(p);t.keyUpEvent(d)},t.handlePointerEnter=p=>{const d={...u(p),position:c(p),deviceType:f(p)};t.pointerEnterEvent(d),d.deviceType==="mouse"&&t.mouseEnterEvent(d)},t.handlePointerLeave=p=>{const d={...u(p),position:c(p),deviceType:f(p)};t.pointerLeaveEvent(d),d.deviceType==="mouse"&&t.mouseLeaveEvent(d)},t.handlePointerDown=p=>{if(!(p.button>2||t.isPointerLocked()))switch(e.preventDefaultOnPointerDown&&ia(p),p.target.hasPointerCapture(p.pointerId)&&p.target.releasePointerCapture(p.pointerId),e.container.setPointerCapture(p.pointerId),a.has(p.pointerId)&&Cs("[RenderWindowInteractor] duplicate pointerId detected"),a.set(p.pointerId,{pointerId:p.pointerId,position:c(p)}),p.pointerType){case"pen":case"touch":t.handleTouchStart(p);break;case"mouse":default:t.handleMouseDown(p);break}},t.handlePointerUp=p=>{if(a.has(p.pointerId))switch(e.preventDefaultOnPointerUp&&ia(p),a.delete(p.pointerId),e.container.releasePointerCapture(p.pointerId),p.pointerType){case"pen":case"touch":t.handleTouchEnd(p);break;case"mouse":default:t.handleMouseUp(p);break}},t.handlePointerCancel=p=>{if(a.has(p.pointerId))switch(a.delete(p.pointerId),p.pointerType){case"pen":case"touch":t.handleTouchEnd(p);break;case"mouse":default:t.handleMouseUp(p);break}},t.handlePointerMove=p=>{if(a.has(p.pointerId)){const d=a.get(p.pointerId);d.position=c(p)}switch(p.pointerType){case"pen":case"touch":t.handleTouchMove(p);break;case"mouse":default:t.handleMouseMove(p);break}},t.handleMouseDown=p=>{const d={...u(p),position:c(p),deviceType:f(p)};switch(p.button){case 0:t.leftButtonPressEvent(d);break;case 1:t.middleButtonPressEvent(d);break;case 2:t.rightButtonPressEvent(d);break;default:ws(`Unknown mouse button pressed: ${p.button}`);break}},t.requestPointerLock=()=>{e.container&&e.container.requestPointerLock()},t.exitPointerLock=()=>document.exitPointerLock?.(),t.isPointerLocked=()=>!!e.container&&document.pointerLockElement===e.container,t.handlePointerLockChange=()=>{t.isPointerLocked()?t.startPointerLockEvent():t.endPointerLockEvent()};function v(){e._view&&e.enabled&&e.enableRender&&(e.inRender=!0,e._view.traverseAllPasses(),e.inRender=!1),t.invokeRenderEvent()}t.requestAnimation=p=>{if(p===void 0){ws("undefined requester, can not start animating");return}if(r.has(p)){Cs("requester is already registered for animating");return}r.add(p),!e.animationRequest&&r.size===1&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.extendAnimation=p=>{const d=Date.now()+p;e._animationExtendedEnd=Math.max(e._animationExtendedEnd,d),!e.animationRequest&&r.size===0&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.isAnimating=()=>e.xrAnimation||e.animationRequest!==null,t.cancelAnimation=function(p){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r.has(p)){if(!d){const y=p&&p.getClassName?p.getClassName():p;Cs(`${y} did not request an animation`)}return}r.delete(p),e.animationRequest&&r.size===0&&Date.now()>e._animationExtendedEnd&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.switchToXRAnimation=()=>{e.animationRequest&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null),e.xrAnimation=!0},t.returnFromXRAnimation=()=>{e.xrAnimation=!1,r.size!==0&&(e.recentAnimationFrameRate=10,e.animationRequest=requestAnimationFrame(t.handleAnimation))},t.updateXRGamepads=(p,d,y)=>{p.inputSources.forEach(S=>{const x=S.gripSpace==null?null:d.getPose(S.gripSpace,y),T=S.gripSpace==null?null:d.getPose(S.targetRaySpace,y),w=S.gamepad,C=S.handedness;if(w){w.index in e.lastGamepadValues||(e.lastGamepadValues[w.index]={left:{buttons:{}},right:{buttons:{}},none:{buttons:{}}});for(let R=0;R<w.buttons.length;++R)R in e.lastGamepadValues[w.index][C].buttons||(e.lastGamepadValues[w.index][C].buttons[R]=!1),e.lastGamepadValues[w.index][C].buttons[R]!==w.buttons[R].pressed&&x!=null&&(t.button3DEvent({gamepad:w,position:x.transform.position,orientation:x.transform.orientation,targetPosition:T.transform.position,targetOrientation:T.transform.orientation,pressed:w.buttons[R].pressed,device:S.handedness==="left"?Ss.LeftController:Ss.RightController,input:To[w.mapping]&&To[w.mapping][R]?To[w.mapping][R]:ar.Trigger}),e.lastGamepadValues[w.index][C].buttons[R]=w.buttons[R].pressed),e.lastGamepadValues[w.index][C].buttons[R]&&x!=null&&t.move3DEvent({gamepad:w,position:x.transform.position,orientation:x.transform.orientation,targetPosition:T.transform.position,targetOrientation:T.transform.orientation,device:S.handedness==="left"?Ss.LeftController:Ss.RightController})}})},t.handleMouseMove=p=>{const d={...u(p),position:c(p),deviceType:f(p)};e.moveTimeoutID===0?t.startMouseMoveEvent(d):(t.mouseMoveEvent(d),clearTimeout(e.moveTimeoutID)),e.moveTimeoutID=setTimeout(()=>{t.endMouseMoveEvent(),e.moveTimeoutID=0},200)},t.handleAnimation=()=>{const p=Date.now();e._animationFrameCount++,p-e._animationStartTime>1e3&&e._animationFrameCount>1&&(e.recentAnimationFrameRate=1e3*(e._animationFrameCount-1)/(p-e._animationStartTime),e.lastFrameTime=1/e.recentAnimationFrameRate,t.animationFrameRateUpdateEvent(),e._animationStartTime=p,e._animationFrameCount=1),t.animationEvent(),v(),r.size>0||Date.now()<e._animationExtendedEnd?e.animationRequest=requestAnimationFrame(t.handleAnimation):(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.handleWheel=p=>{ia(p);const d={...zV(p),...u(p),position:c(p),deviceType:f(p)};e.wheelTimeoutID===0&&(Math.abs(d.spinY)>=.3?s=Math.abs(d.spinY):s=1),d.spinY/=s,e.wheelTimeoutID===0?(t.startMouseWheelEvent(d),t.mouseWheelEvent(d)):(t.mouseWheelEvent(d),clearTimeout(e.wheelTimeoutID)),e.mouseScrollDebounceByPass?(t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0):e.wheelTimeoutID=setTimeout(()=>{t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0},200)},t.handleMouseUp=p=>{const d={...u(p),position:c(p),deviceType:f(p)};switch(p.button){case 0:t.leftButtonReleaseEvent(d);break;case 1:t.middleButtonReleaseEvent(d);break;case 2:t.rightButtonReleaseEvent(d);break;default:ws(`Unknown mouse button released: ${p.button}`);break}},t.handleTouchStart=p=>{const d=[...a.values()];if(e.recognizeGestures&&d.length>1){const y=Es(a);if(d.length===2){const S={...u(Or),position:d[0].position,deviceType:f(p)};t.leftButtonReleaseEvent(S)}t.recognizeGesture("TouchStart",y)}else if(d.length===1){const y={...u(Or),position:c(p),deviceType:f(p)};t.leftButtonPressEvent(y)}},t.handleTouchMove=p=>{const d=[...a.values()];if(e.recognizeGestures&&d.length>1){const y=Es(a);t.recognizeGesture("TouchMove",y)}else if(d.length===1){const y={...u(Or),position:d[0].position,deviceType:f(p)};t.mouseMoveEvent(y)}},t.handleTouchEnd=p=>{const d=[...a.values()];if(e.recognizeGestures)if(d.length===0){const y={...u(Or),position:c(p),deviceType:f(p)};t.leftButtonReleaseEvent(y)}else if(d.length===1){const y=Es(a);t.recognizeGesture("TouchEnd",y);const S={...u(Or),position:d[0].position,deviceType:f(p)};t.leftButtonPressEvent(S)}else{const y=Es(a);t.recognizeGesture("TouchMove",y)}else if(d.length===1){const y={...u(Or),position:d[0].position,deviceType:f(p)};t.leftButtonReleaseEvent(y)}},t.setView=p=>{e._view!==p&&(e._view=p,e._view.getRenderable().setInteractor(t),t.modified())},t.getFirstRenderer=()=>e._view?.getRenderable()?.getRenderersByReference()?.[0],t.findPokedRenderer=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!e._view)return null;const y=e._view?.getRenderable()?.getRenderers();if(!y||y.length===0)return null;y.sort((C,R)=>C.getLayer()-R.getLayer());let S=null,x=null,T=null,w=y.length;for(;w--;){const C=y[w];if(e._view.isInViewport(p,d,C)&&C.getInteractive()){T=C;break}S===null&&C.getInteractive()&&(S=C),x===null&&e._view.isInViewport(p,d,C)&&(x=C)}return T===null&&(T=S),T===null&&(T=x),T==null&&(T=y[0]),T},t.render=()=>{!t.isAnimating()&&!e.inRender&&v()},Sf.forEach(p=>{const d=p.charAt(0).toLowerCase()+p.slice(1);t[`${d}Event`]=y=>{if(!e.enabled)return;if(!t.getCurrentRenderer()){HV(`
          Can not forward events without a current renderer on the interactor.
        `);return}const x={type:p,pokedRenderer:e.currentRenderer,firstRenderer:t.getFirstRenderer(),...y};t[`invoke${p}`](x)}}),t.recognizeGesture=(p,d)=>{if(Object.keys(d).length>2)return;if(e.startingEventPositions||(e.startingEventPositions={}),p==="TouchStart"){Object.keys(d).forEach(L=>{e.startingEventPositions[L]=d[L]}),e.currentGesture="Start";return}if(p==="TouchEnd"){e.currentGesture==="Pinch"&&(t.render(),t.endPinchEvent()),e.currentGesture==="Rotate"&&(t.render(),t.endRotateEvent()),e.currentGesture==="Pan"&&(t.render(),t.endPanEvent()),e.currentGesture="Start",e.startingEventPositions={};return}let y=0;const S=[],x=[];Object.keys(d).forEach(L=>{S[y]=d[L],x[y]=e.startingEventPositions[L],y++});const T=Math.sqrt((x[0].x-x[1].x)*(x[0].x-x[1].x)+(x[0].y-x[1].y)*(x[0].y-x[1].y)),w=Math.sqrt((S[0].x-S[1].x)*(S[0].x-S[1].x)+(S[0].y-S[1].y)*(S[0].y-S[1].y));let C=zr(Math.atan2(x[1].y-x[0].y,x[1].x-x[0].x)),R=zr(Math.atan2(S[1].y-S[0].y,S[1].x-S[0].x)),M=R-C;R=R+180>=360?R-180:R+180,C=C+180>=360?C-180:C+180,Math.abs(R-C)<Math.abs(M)&&(M=R-C);const m=[];if(m[0]=(S[0].x-x[0].x+S[1].x-x[1].x)/2,m[1]=(S[0].y-x[0].y+S[1].y-x[1].y)/2,p==="TouchMove")if(e.currentGesture==="Start"){let L=.01*Math.sqrt(e.container.clientWidth*e.container.clientWidth+e.container.clientHeight*e.container.clientHeight);L<15&&(L=15);const V=Math.abs(w-T),F=w*3.1415926*Math.abs(M)/360,B=Math.sqrt(m[0]*m[0]+m[1]*m[1]);if(V>L&&V>F&&V>B){e.currentGesture="Pinch";const _={scale:1,touches:d};t.startPinchEvent(_)}else if(F>L&&F>B){e.currentGesture="Rotate";const _={rotation:0,touches:d};t.startRotateEvent(_)}else if(B>L){e.currentGesture="Pan";const _={translation:[0,0],touches:d};t.startPanEvent(_)}}else{if(e.currentGesture==="Rotate"){const L={rotation:M,touches:d};t.rotateEvent(L)}if(e.currentGesture==="Pinch"){const L={scale:w/T,touches:d};t.pinchEvent(L)}if(e.currentGesture==="Pan"){const L={translation:m,touches:d};t.panEvent(L)}}},t.handleVisibilityChange=()=>{e._animationStartTime=Date.now(),e._animationFrameCount=0},t.setCurrentRenderer=p=>{e._forcedRenderer=!!p,e.currentRenderer=p},t.setContainer=p=>{h();const d=n.setContainer(p??null);return d&&l(),d},t.delete=()=>{for(;r.size;)t.cancelAnimation(r.values().next().value);typeof document.hidden<"u"&&document.removeEventListener("visibilitychange",t.handleVisibilityChange),e.container&&t.setContainer(null),n.delete()},typeof document.hidden<"u"&&document.addEventListener("visibilitychange",t.handleVisibilityChange,!1)}const jV={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,recentAnimationFrameRate:10,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{},preventDefaultOnPointerDown:!1,preventDefaultOnPointerUp:!1,mouseScrollDebounceByPass:!1};function j1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jV,n),E.obj(t,e),e._animationExtendedEnd=0,E.event(t,e,"RenderEvent"),Sf.forEach(r=>E.event(t,e,r)),E.get(t,e,["initialized","interactorStyle","lastFrameTime","recentAnimationFrameRate","_view"]),E.setGet(t,e,["container","lightFollowCamera","enabled","enableRender","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker","preventDefaultOnPointerDown","preventDefaultOnPointerUp","mouseScrollDebounceByPass"]),E.moveToProtected(t,e,["view"]),AV(t,e)}const KV=E.newInstance(j1,"vtkRenderWindowInteractor");var K1={newInstance:KV,extend:j1,handledEvents:Sf,...A1};const{vtkErrorMacro:PV,VOID:XV}=E;function IV(t,e,n,r){return t.getRenderWindow().getViews()[0].worldToDisplay(e,n,r,t)}function YV(t,e,n,r){return t.getRenderWindow().getViews()[0].displayToWorld(e,n,r,t)}const qV={computeWorldToDisplay:IV,computeDisplayToWorld:YV};function QV(t,e){e.classHierarchy.push("vtkInteractorObserver");const n={...t};function r(){for(;e.subscribedEvents.length;)e.subscribedEvents.pop().unsubscribe()}function a(){K1.handledEvents.forEach(s=>{t[`handle${s}`]&&e.subscribedEvents.push(e._interactor[`on${s}`](i=>e.processEvents?t[`handle${s}`](i):XV,e.priority))})}t.setInteractor=s=>{s!==e._interactor&&(r(),e._interactor=s,s&&e.enabled&&a(),t.modified())},t.setEnabled=s=>{s!==e.enabled&&(r(),s&&(e._interactor?a():PV(`
          The interactor must be set before subscribing to events
        `)),e.enabled=s,t.modified())},t.computeDisplayToWorld=(s,i,o,c)=>s?e._interactor.getView().displayToWorld(i,o,c,s):null,t.computeWorldToDisplay=(s,i,o,c)=>s?e._interactor.getView().worldToDisplay(i,o,c,s):null,t.setPriority=s=>{n.setPriority(s)&&e._interactor&&(r(),a())}}const ZV={enabled:!0,priority:0,processEvents:!0,subscribedEvents:[]};function P1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZV,n),E.obj(t,e),E.event(t,e,"InteractionEvent"),E.event(t,e,"StartInteractionEvent"),E.event(t,e,"EndInteractionEvent"),E.get(t,e,["_interactor","enabled"]),E.setGet(t,e,["priority","processEvents"]),E.moveToProtected(t,e,["interactor"]),QV(t,e)}const JV=E.newInstance(P1,"vtkInteractorObserver");var em={newInstance:JV,extend:P1,...qV};const tm={IS_START:0,IS_NONE:0,IS_ROTATE:1,IS_PAN:2,IS_SPIN:3,IS_DOLLY:4,IS_CAMERA_POSE:11,IS_WINDOW_LEVEL:1024,IS_SLICE:1025};var Cf={States:tm};const{States:It}=Cf,xo={Rotate:It.IS_ROTATE,Pan:It.IS_PAN,Spin:It.IS_SPIN,Dolly:It.IS_DOLLY,CameraPose:It.IS_CAMERA_POSE,WindowLevel:It.IS_WINDOW_LEVEL,Slice:It.IS_SLICE};function nm(t,e){e.classHierarchy.push("vtkInteractorStyle"),Object.keys(xo).forEach(n=>{E.event(t,e,`Start${n}Event`),t[`start${n}`]=()=>{e.state===It.IS_NONE&&(e.state=xo[n],e._interactor.requestAnimation(t),t.invokeStartInteractionEvent({type:"StartInteractionEvent"}),t[`invokeStart${n}Event`]({type:`Start${n}Event`}))},E.event(t,e,`End${n}Event`),t[`end${n}`]=()=>{e.state===xo[n]&&(e.state=It.IS_NONE,e._interactor.cancelAnimation(t),t.invokeEndInteractionEvent({type:"EndInteractionEvent"}),t[`invokeEnd${n}Event`]({type:`End${n}Event`}),e._interactor.render())}}),e.getRenderer=n=>e.focusedRenderer||n.pokedRenderer,t.handleKeyPress=n=>{const r=e._interactor;let a=null;switch(n.key){case"r":case"R":e.getRenderer(n).resetCamera(),r.render();break;case"w":case"W":a=e.getRenderer(n).getActors(),a.forEach(s=>{const i=s.getProperty();i.setRepresentationToWireframe&&i.setRepresentationToWireframe()}),r.render();break;case"s":case"S":a=e.getRenderer(n).getActors(),a.forEach(s=>{const i=s.getProperty();i.setRepresentationToSurface&&i.setRepresentationToSurface()}),r.render();break;case"v":case"V":a=e.getRenderer(n).getActors(),a.forEach(s=>{const i=s.getProperty();i.setRepresentationToPoints&&i.setRepresentationToPoints()}),r.render();break}}}const rm={state:It.IS_NONE,handleObservers:1,autoAdjustCameraClippingRange:1};function X1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rm,n),em.extend(t,e,n),E.setGet(t,e,["focusedRenderer"]),nm(t,e)}const am=E.newInstance(X1,"vtkInteractorStyle");var sm={newInstance:am,extend:X1,...Cf};const{States:Kt}=Cf;function im(t,e){e.classHierarchy.push("vtkInteractorStyleTrackballCamera"),t.handleMouseMove=n=>{const r=n.position,a=e.getRenderer(n);switch(e.state){case Kt.IS_ROTATE:t.handleMouseRotate(a,r),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_PAN:t.handleMousePan(a,r),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_DOLLY:t.handleMouseDolly(a,r),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_SPIN:t.handleMouseSpin(a,r),t.invokeInteractionEvent({type:"InteractionEvent"});break}e.previousPosition=r},t.handleButton3D=n=>{if(n&&n.pressed&&n.device===cc.RightController&&(n.input===da.Trigger||n.input===da.TrackPad)){t.startCameraPose();return}n&&!n.pressed&&n.device===cc.RightController&&(n.input===da.Trigger||n.input===da.TrackPad)&&e.state===Kt.IS_CAMERA_POSE&&t.endCameraPose()},t.handleMove3D=n=>{switch(e.state){case Kt.IS_CAMERA_POSE:t.updateCameraPose(n);break}},t.updateCameraPose=n=>{const r=e.getRenderer(n).getActiveCamera(),a=r.getPhysicalTranslation(),i=.5*.05*r.getPhysicalScale(),o=r.physicalOrientationToWorldDirection([n.orientation.x,n.orientation.y,n.orientation.z,n.orientation.w]);r.setPhysicalTranslation(a[0]+o[0]*i,a[1]+o[1]*i,a[2]+o[2]*i)},t.handleLeftButtonPress=n=>{const r=n.position;e.previousPosition=r,n.shiftKey?n.controlKey||n.altKey?t.startDolly():t.startPan():n.controlKey||n.altKey?t.startSpin():t.startRotate()},t.handleLeftButtonRelease=()=>{switch(e.state){case Kt.IS_DOLLY:t.endDolly();break;case Kt.IS_PAN:t.endPan();break;case Kt.IS_SPIN:t.endSpin();break;case Kt.IS_ROTATE:t.endRotate();break}},t.handleStartMouseWheel=()=>{t.startDolly()},t.handleEndMouseWheel=()=>{t.endDolly()},t.handleStartPinch=n=>{e.previousScale=n.scale,t.startDolly()},t.handleEndPinch=()=>{t.endDolly()},t.handleStartRotate=n=>{e.previousRotation=n.rotation,t.startRotate()},t.handleEndRotate=()=>{t.endRotate()},t.handleStartPan=n=>{e.previousTranslation=n.translation,t.startPan()},t.handleEndPan=()=>{t.endPan()},t.handlePinch=n=>{t.dollyByFactor(e.getRenderer(n),n.scale/e.previousScale),e.previousScale=n.scale},t.handlePan=n=>{const r=e.getRenderer(n).getActiveCamera();let a=r.getFocalPoint();a=t.computeWorldToDisplay(e.getRenderer(n),a[0],a[1],a[2]);const s=a[2],i=n.translation,o=e.previousTranslation,c=t.computeDisplayToWorld(e.getRenderer(n),a[0]+i[0]-o[0],a[1]+i[1]-o[1],s),u=t.computeDisplayToWorld(e.getRenderer(n),a[0],a[1],s),g=[];g[0]=u[0]-c[0],g[1]=u[1]-c[1],g[2]=u[2]-c[2],a=r.getFocalPoint();const f=r.getPosition();r.setFocalPoint(g[0]+a[0],g[1]+a[1],g[2]+a[2]),r.setPosition(g[0]+f[0],g[1]+f[1],g[2]+f[2]),e._interactor.getLightFollowCamera()&&e.getRenderer(n).updateLightsGeometryToFollowCamera(),r.orthogonalizeViewUp(),e.previousTranslation=n.translation},t.handleRotate=n=>{const r=e.getRenderer(n).getActiveCamera();r.roll(n.rotation-e.previousRotation),r.orthogonalizeViewUp(),e.previousRotation=n.rotation},t.handleMouseRotate=(n,r)=>{if(!e.previousPosition)return;const a=e._interactor,s=r.x-e.previousPosition.x,i=r.y-e.previousPosition.y,o=a.getView().getViewportSize(n);let c=-.1,u=-.1;o[0]&&o[1]&&(c=-20/o[1],u=-20/o[0]);const g=s*u*e.motionFactor,f=i*c*e.motionFactor,l=n.getActiveCamera();!Number.isNaN(g)&&!Number.isNaN(f)&&(l.azimuth(g),l.elevation(f),l.orthogonalizeViewUp()),e.autoAdjustCameraClippingRange&&n.resetCameraClippingRange(),a.getLightFollowCamera()&&n.updateLightsGeometryToFollowCamera()},t.handleMouseSpin=(n,r)=>{if(!e.previousPosition)return;const a=e._interactor,s=n.getActiveCamera(),i=a.getView().getViewportCenter(n),o=zr(Math.atan2(e.previousPosition.y-i[1],e.previousPosition.x-i[0])),c=zr(Math.atan2(r.y-i[1],r.x-i[0]))-o;Number.isNaN(c)||(s.roll(c),s.orthogonalizeViewUp())},t.handleMousePan=(n,r)=>{if(!e.previousPosition)return;const a=n.getActiveCamera();let s=a.getFocalPoint();s=t.computeWorldToDisplay(n,s[0],s[1],s[2]);const i=s[2],o=t.computeDisplayToWorld(n,r.x,r.y,i),c=t.computeDisplayToWorld(n,e.previousPosition.x,e.previousPosition.y,i),u=[];u[0]=c[0]-o[0],u[1]=c[1]-o[1],u[2]=c[2]-o[2],s=a.getFocalPoint();const g=a.getPosition();a.setFocalPoint(u[0]+s[0],u[1]+s[1],u[2]+s[2]),a.setPosition(u[0]+g[0],u[1]+g[1],u[2]+g[2]),e._interactor.getLightFollowCamera()&&n.updateLightsGeometryToFollowCamera()},t.handleMouseDolly=(n,r)=>{if(!e.previousPosition)return;const a=r.y-e.previousPosition.y,i=e._interactor.getView().getViewportCenter(n),o=e.motionFactor*a/i[1];t.dollyByFactor(n,1.1**o)},t.handleMouseWheel=n=>{const r=1-n.spinY/e.zoomFactor;t.dollyByFactor(e.getRenderer(n),r)},t.dollyByFactor=(n,r)=>{if(Number.isNaN(r))return;const a=n.getActiveCamera();a.getParallelProjection()?a.setParallelScale(a.getParallelScale()/r):(a.dolly(r),e.autoAdjustCameraClippingRange&&n.resetCameraClippingRange()),e._interactor.getLightFollowCamera()&&n.updateLightsGeometryToFollowCamera()}}const om={motionFactor:10,zoomFactor:10};function I1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,om,n),sm.extend(t,e,n),E.setGet(t,e,["motionFactor","zoomFactor"]),im(t,e)}const cm=E.newInstance(I1,"vtkInteractorStyleTrackballCamera");var fm={newInstance:cm,extend:I1};function um(t){return t}function wf(t){if(t===null||t==="null")return null;if(t==="true")return!0;if(t==="false")return!1;if(!(t===void 0||t==="undefined"))return t[0]==="["&&t[t.length-1]==="]"?t.substring(1,t.length-1).split(",").map(e=>wf(e.trim())):t===""||Number.isNaN(Number(t))?t:Number(t)}function gm(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window.location.search;const n={},r=t?wf:um;return new URLSearchParams(e).forEach((s,i)=>{i&&(n[i]=s?r(s):!0)}),n}var lm={toNativeType:wf,extractURLParameters:gm};function hm(t,e){e.classHierarchy.push("vtkFramebuffer"),t.getBothMode=()=>e.context.FRAMEBUFFER,t.saveCurrentBindingsAndBuffers=n=>{const r=typeof n<"u"?n:t.getBothMode();t.saveCurrentBindings(r),t.saveCurrentBuffers(r)},t.saveCurrentBindings=n=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling saveCurrentBindings");return}const r=e.context;e.previousDrawBinding=r.getParameter(e.context.FRAMEBUFFER_BINDING),e.previousActiveFramebuffer=e._openGLRenderWindow.getActiveFramebuffer()},t.saveCurrentBuffers=n=>{},t.restorePreviousBindingsAndBuffers=n=>{const r=typeof n<"u"?n:t.getBothMode();t.restorePreviousBindings(r),t.restorePreviousBuffers(r)},t.restorePreviousBindings=n=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling restorePreviousBindings");return}const r=e.context;r.bindFramebuffer(r.FRAMEBUFFER,e.previousDrawBinding),e._openGLRenderWindow.setActiveFramebuffer(e.previousActiveFramebuffer)},t.restorePreviousBuffers=n=>{},t.bind=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;r===null&&(r=e.context.FRAMEBUFFER),e.context.bindFramebuffer(r,e.glFramebuffer);for(let a=0;a<e.colorBuffers.length;a++)e.colorBuffers[a].bind();e._openGLRenderWindow.setActiveFramebuffer(t)},t.create=(n,r)=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling create");return}e.glFramebuffer=e.context.createFramebuffer(),e.glFramebuffer.width=n,e.glFramebuffer.height=r},t.setColorBuffer=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const a=e.context;if(!a){ie("you must set the OpenGLRenderWindow before calling setColorBuffer");return}let s=a.COLOR_ATTACHMENT0;if(r>0)if(e._openGLRenderWindow.getWebgl2())s+=r;else{ie("Using multiple framebuffer attachments requires WebGL 2");return}e.colorBuffers[r]=n,a.framebufferTexture2D(a.FRAMEBUFFER,s,a.TEXTURE_2D,n.getHandle(),0)},t.removeColorBuffer=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const r=e.context;if(!r){ie("you must set the OpenGLRenderWindow before calling removeColorBuffer");return}let a=r.COLOR_ATTACHMENT0;if(n>0)if(e._openGLRenderWindow.getWebgl2())a+=n;else{ie("Using multiple framebuffer attachments requires WebGL 2");return}r.framebufferTexture2D(r.FRAMEBUFFER,a,r.TEXTURE_2D,null,0),e.colorBuffers=e.colorBuffers.splice(n,1)},t.setDepthBuffer=n=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling setDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){const r=e.context;r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,n.getHandle(),0)}else ie("Attaching depth buffer textures to fbo requires WebGL 2")},t.removeDepthBuffer=()=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling removeDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){const n=e.context;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,null,0)}else ie("Attaching depth buffer textures to framebuffers requires WebGL 2")},t.getGLFramebuffer=()=>e.glFramebuffer,t.setOpenGLRenderWindow=n=>{e._openGLRenderWindow!==n&&(t.releaseGraphicsResources(),e._openGLRenderWindow=n,e.context=null,n&&(e.context=e._openGLRenderWindow.getContext()))},t.releaseGraphicsResources=()=>{e.glFramebuffer&&e.context.deleteFramebuffer(e.glFramebuffer)},t.getSize=()=>e.glFramebuffer==null?null:[e.glFramebuffer.width,e.glFramebuffer.height],t.populateFramebuffer=()=>{if(!e.context){ie("you must set the OpenGLRenderWindow before calling populateFrameBuffer");return}t.bind();const n=e.context,r=pn.newInstance();r.setOpenGLRenderWindow(e._openGLRenderWindow),r.setMinificationFilter(sc.LINEAR),r.setMagnificationFilter(sc.LINEAR),r.create2DFromRaw({width:e.glFramebuffer.width,height:e.glFramebuffer.height,numComps:4,dataType:Pe.UNSIGNED_CHAR,data:null}),t.setColorBuffer(r),e.depthTexture=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,e.depthTexture),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e.glFramebuffer.width,e.glFramebuffer.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e.depthTexture)},t.getColorTexture=()=>e.colorBuffers[0]}const pm={glFramebuffer:null,colorBuffers:null,depthTexture:null,previousDrawBinding:0,previousReadBinding:0,previousDrawBuffer:0,previousReadBuffer:0,previousActiveFramebuffer:null};function Y1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pm,n),qe(t,e),e.colorBuffers&&ie("you cannot initialize colorBuffers through the constructor. You should call setColorBuffer() instead."),e.colorBuffers=[],Ir(t,e,["colorBuffers"]),hm(t,e)}const dm=Ce(Y1,"vtkFramebuffer");var Ef={newInstance:dm,extend:Y1};function vm(t,e){e.classHierarchy.push("vtkRenderPass"),t.getOperation=()=>e.currentOperation,t.setCurrentOperation=n=>{e.currentOperation=n,e.currentTraverseOperation=`traverse${E.capitalize(e.currentOperation)}`},t.getTraverseOperation=()=>e.currentTraverseOperation,t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;e.deleted||(e._currentParent=r,e.preDelegateOperations.forEach(a=>{t.setCurrentOperation(a),n.traverse(t)}),e.delegates.forEach(a=>{a.traverse(n,t)}),e.postDelegateOperations.forEach(a=>{t.setCurrentOperation(a),n.traverse(t)}))}}const ym={delegates:[],currentOperation:null,preDelegateOperations:[],postDelegateOperations:[],currentParent:null};function q1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ym,n),E.obj(t,e),E.get(t,e,["currentOperation"]),E.setGet(t,e,["delegates","_currentParent","preDelegateOperations","postDelegateOperations"]),E.moveToProtected(t,e,["currentParent"]),vm(t,e)}const Tm=E.newInstance(q1,"vtkRenderPass");var Sn={newInstance:Tm,extend:q1};const{Representation:xm}=Yr,{vtkErrorMacro:zg}=E;function Sm(t){const e=N.substitute(t.Fragment,"//VTK::RenderPassFragmentShader::Impl",`
      float weight = gl_FragData[0].a * pow(max(1.1 - gl_FragCoord.z, 0.0), 2.0);
      gl_FragData[0] = vec4(gl_FragData[0].rgb*weight, gl_FragData[0].a);
      gl_FragData[1].r = weight;
    `,!1);t.Fragment=e.result}const Cm=`//VTK::System::Dec

in vec2 tcoord;

uniform sampler2D translucentRTexture;
uniform sampler2D translucentRGBATexture;

// the output of this shader
//VTK::Output::Dec

void main()
{
  vec4 t1Color = texture(translucentRGBATexture, tcoord);
  float t2Color = texture(translucentRTexture, tcoord).r;
  gl_FragData[0] = vec4(t1Color.rgb/max(t2Color,0.01), 1.0 - t1Color.a);
}
`;function wm(t,e){e.classHierarchy.push("vtkOpenGLOrderIndependentTranslucentPass"),t.createVertexBuffer=()=>{const n=new Float32Array([-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),r=new Float32Array([0,0,1,0,0,1,1,1]),a=new Uint16Array([4,0,1,3,2]),s=De.newInstance({numberOfComponents:3,values:n});s.setName("points");const i=De.newInstance({numberOfComponents:2,values:r});i.setName("tcoords");const o=De.newInstance({numberOfComponents:1,values:a});e.tris.getCABO().createVBO(o,"polys",xm.SURFACE,{points:s,tcoords:i,cellOffset:0}),e.VBOBuildTime.modified()},t.createFramebuffer=n=>{const r=n.getSize(),a=n.getContext();e.framebuffer=Ef.newInstance(),e.framebuffer.setOpenGLRenderWindow(n),e.framebuffer.create(...r),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind(),e.translucentRGBATexture=pn.newInstance(),e.translucentRGBATexture.setInternalFormat(a.RGBA16F),e.translucentRGBATexture.setFormat(a.RGBA),e.translucentRGBATexture.setOpenGLDataType(a.HALF_FLOAT),e.translucentRGBATexture.setOpenGLRenderWindow(n),e.translucentRGBATexture.create2DFromRaw({width:r[0],height:r[1],numComps:4,dataType:"Float32Array",data:null}),e.translucentRTexture=pn.newInstance(),e.translucentRTexture.setInternalFormat(a.R16F),e.translucentRTexture.setFormat(a.RED),e.translucentRTexture.setOpenGLDataType(a.HALF_FLOAT),e.translucentRTexture.setOpenGLRenderWindow(n),e.translucentRTexture.create2DFromRaw({width:r[0],height:r[1],numComps:1,dataType:"Float32Array",data:null}),e.translucentZTexture=pn.newInstance(),e.translucentZTexture.setOpenGLRenderWindow(n),e.translucentZTexture.createDepthFromRaw({width:r[0],height:r[1],dataType:"Float32Array",data:null}),e.framebuffer.setColorBuffer(e.translucentRGBATexture,0),e.framebuffer.setColorBuffer(e.translucentRTexture,1),e.framebuffer.setDepthBuffer(e.translucentZTexture)},t.createCopyShader=n=>{e.copyShader=n.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","attribute vec2 tcoordTC;","varying vec2 tcoord;","void main() { tcoord = tcoordTC; gl_Position = vertexDC; }"].join(`
`),Cm,"")},t.createVBO=n=>{const r=n.getContext();e.tris.setOpenGLRenderWindow(n),t.createVertexBuffer();const a=e.copyShader;e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(a,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),r.FLOAT,3,r.FALSE)||zg("Error setting vertexDC in copy shader VAO."),e.copyVAO.addAttributeArray(a,e.tris.getCABO(),"tcoordTC",e.tris.getCABO().getTCoordOffset(),e.tris.getCABO().getStride(),r.FLOAT,2,r.FALSE)||zg("Error setting vertexDC in copy shader VAO.")},t.traverse=(n,r,a)=>{if(e.deleted)return;const s=n.getSize(),i=n.getContext();if(e._supported=!1,r.getSelector()||!i||!n.getWebgl2()||!i.getExtension("EXT_color_buffer_half_float")&&!i.getExtension("EXT_color_buffer_float")){t.setCurrentOperation("translucentPass"),r.traverse(t);return}if(e._supported=!0,e.framebuffer===null)t.createFramebuffer(n);else{const c=e.framebuffer.getSize();c===null||c[0]!==s[0]||c[1]!==s[1]?(e.framebuffer.releaseGraphicsResources(),e.translucentRGBATexture.releaseGraphicsResources(n),e.translucentRTexture.releaseGraphicsResources(n),e.translucentZTexture.releaseGraphicsResources(n),t.createFramebuffer(n)):(e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind())}i.drawBuffers([i.COLOR_ATTACHMENT0]),i.clearBufferfv(i.COLOR,0,[0,0,0,0]),i.clearBufferfv(i.DEPTH,0,[1]),i.colorMask(!1,!1,!1,!1),a.getOpaqueActorCount()>0&&(a.setCurrentOperation("opaqueZBufferPass"),r.traverse(a)),i.colorMask(!0,!0,!0,!0),i.drawBuffers([i.COLOR_ATTACHMENT0,i.COLOR_ATTACHMENT1]),i.viewport(0,0,s[0],s[1]),i.scissor(0,0,s[0],s[1]),i.clearBufferfv(i.COLOR,0,[0,0,0,1]),i.clearBufferfv(i.COLOR,1,[0,0,0,0]),i.enable(i.DEPTH_TEST),i.enable(i.BLEND),i.blendFuncSeparate(i.ONE,i.ONE,i.ZERO,i.ONE_MINUS_SRC_ALPHA),t.setCurrentOperation("translucentPass"),r.traverse(t),i.drawBuffers([i.NONE]),e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null?t.createCopyShader(n):n.getShaderCache().readyShaderProgram(e.copyShader),e.copyVAO||(e.copyVAO=r1.newInstance(),e.copyVAO.setOpenGLRenderWindow(n)),e.copyVAO.bind(),e.VBOBuildTime.getMTime()<t.getMTime()&&t.createVBO(n),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),i.depthMask(!1),i.depthFunc(i.ALWAYS),i.viewport(0,0,s[0],s[1]),i.scissor(0,0,s[0],s[1]),e.translucentRGBATexture.activate(),e.copyShader.setUniformi("translucentRGBATexture",e.translucentRGBATexture.getTextureUnit()),e.translucentRTexture.activate(),e.copyShader.setUniformi("translucentRTexture",e.translucentRTexture.getTextureUnit()),i.drawArrays(i.TRIANGLES,0,e.tris.getCABO().getElementCount()),i.depthMask(!0),i.depthFunc(i.LEQUAL),e.translucentRGBATexture.deactivate(),e.translucentRTexture.deactivate();const o=r.getTiledSizeAndOrigin();i.scissor(o.lowerLeftU,o.lowerLeftV,o.usize,o.vsize),i.viewport(o.lowerLeftU,o.lowerLeftV,o.usize,o.vsize)},t.getShaderReplacement=()=>e._supported?Sm:null,t.releaseGraphicsResources=n=>{e.framebuffer&&(e.framebuffer.releaseGraphicsResources(n),e.framebuffer=null),e.translucentRGBATexture&&(e.translucentRGBATexture.releaseGraphicsResources(n),e.translucentRGBATexture=null),e.translucentRTexture&&(e.translucentRTexture.releaseGraphicsResources(n),e.translucentRTexture=null),e.translucentZTexture&&(e.translucentZTexture.releaseGraphicsResources(n),e.translucentZTexture=null),e.copyVAO&&(e.copyVAO.releaseGraphicsResources(n),e.copyVAO=null),e.copyShader&&(e.copyShader.releaseGraphicsResources(n),e.copyShader=null),e.tris&&(e.tris.releaseGraphicsResources(n),e.tris=null),t.modified()}}const Em={framebuffer:null,copyShader:null,tris:null};function Q1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Em,n),Sn.extend(t,e,n),e.VBOBuildTime={},E.obj(e.VBOBuildTime,{mtime:0}),e.tris=qr.newInstance(),E.get(t,e,["framebuffer"]),wm(t,e)}const Rm=E.newInstance(Q1,"vtkOpenGLOrderIndependentTranslucentPass");var Mm={newInstance:Rm,extend:Q1};function Om(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(e.deleted)return;e._currentParent=r,t.setCurrentOperation("buildPass"),n.traverse(t);const a=n.getRenderable().getNumberOfLayers(),s=n.getRenderable().getRenderersByReference();for(let i=0;i<a;i++)for(let o=0;o<s.length;o++){const c=s[o],u=n.getViewNodeFor(c);if(c.getDraw()&&c.getLayer()===i){if(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumeCount=0,e.overlayActorCount=0,t.setCurrentOperation("queryPass"),u.traverse(t),(e.opaqueActorCount>0||e.translucentActorCount>0)&&e.volumeCount>0||e.depthRequested){const g=n.getFramebufferSize();e.framebuffer===null&&(e.framebuffer=Ef.newInstance()),e.framebuffer.setOpenGLRenderWindow(n),e.framebuffer.saveCurrentBindingsAndBuffers();const f=e.framebuffer.getSize();(f===null||f[0]!==g[0]||f[1]!==g[1])&&(e.framebuffer.create(g[0],g[1]),e.framebuffer.populateFramebuffer()),e.framebuffer.bind(),t.setCurrentOperation("zBufferPass"),u.traverse(t),e.framebuffer.restorePreviousBindingsAndBuffers(),e.depthRequested=!1}t.setCurrentOperation("cameraPass"),u.traverse(t),e.opaqueActorCount>0&&(t.setCurrentOperation("opaquePass"),u.traverse(t)),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=Mm.newInstance()),e.translucentPass.traverse(n,u,t)),e.volumeCount>0&&(t.setCurrentOperation("volumePass"),u.traverse(t)),e.overlayActorCount>0&&(t.setCurrentOperation("overlayPass"),u.traverse(t))}}},t.getZBufferTexture=()=>e.framebuffer?e.framebuffer.getColorTexture():null,t.requestDepth=()=>{e.depthRequested=!0},t.incrementOpaqueActorCount=()=>e.opaqueActorCount++,t.incrementTranslucentActorCount=()=>e.translucentActorCount++,t.incrementVolumeCount=()=>e.volumeCount++,t.incrementOverlayActorCount=()=>e.overlayActorCount++}const Dm={opaqueActorCount:0,translucentActorCount:0,volumeCount:0,overlayActorCount:0,framebuffer:null,depthRequested:!1};function Z1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Dm,n),Sn.extend(t,e,n),E.get(t,e,["framebuffer","opaqueActorCount","translucentActorCount","volumeCount"]),Om(t,e)}const Lm=E.newInstance(Z1,"vtkForwardPass");var Vm={newInstance:Lm,extend:Z1};const{FieldAssociations:mm}=Sr;function Fm(t,e){e.classHierarchy.push("vtkHardwareSelector"),t.getSourceDataAsync=async(n,r,a,s,i)=>{},t.selectAsync=async(n,r,a,s,i)=>{const o=await t.getSourceDataAsync(n,r,a,s,i);return o?o.generateSelection(r,a,s,i):[]}}const Bm={fieldAssociation:mm.FIELD_ASSOCIATION_CELLS,captureZValues:!1};function J1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Bm,n),E.obj(t,e),E.setGet(t,e,["fieldAssociation","captureZValues"]),Fm(t,e)}const _m=E.newInstance(J1,"vtkHardwareSelector");var ed={newInstance:_m,extend:J1};const Um={GLOBALIDS:0,PEDIGREEIDS:1,VALUES:2,INDICES:3,FRUSTUM:4,LOCATIONS:5,THRESHOLDS:6,BLOCKS:7,QUERY:8},Nm={CELL:0,POINT:1,FIELD:2,VERTEX:3,EDGE:4,ROW:5};var km={SelectionContent:Um,SelectionField:Nm};function Gm(t,e){e.classHierarchy.push("vtkSelectionNode"),t.getBounds=()=>e.points.getBounds()}const bm={contentType:-1,fieldType:-1,properties:null,selectionList:[]};function td(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bm,n),E.obj(t,e),e.properties={},E.setGet(t,e,["contentType","fieldType","properties","selectionList"]),Gm(t,e)}const $m=E.newInstance(td,"vtkSelectionNode");var Vi={newInstance:$m,extend:td,...km};const{PassTypes:_e}=Ep,{SelectionContent:Wm,SelectionField:Hg}=Vi,{FieldAssociations:La}=Sr,{vtkErrorMacro:nd}=E,Nn=1;function rd(t){return`${t.propID} ${t.compositeID}`}function ad(t,e,n,r){if(!n)return 0;const a=(e*(r[2]-r[0]+1)+t)*4;return n[a+3]}function ln(t,e,n,r){if(!n)return 0;const a=(e*(r[2]-r[0]+1)+t)*4,s=n[a],i=n[a+1];return(n[a+2]*256+i)*256+s}function sd(t,e){let n=e;return n<<=24,n|=t,n}function zm(t,e,n,r){{if(r[0]=e[0],r[1]=e[1],e[0]<t.area[0]||e[0]>t.area[2]||e[1]<t.area[1]||e[1]>t.area[3])return null;const a=[e[0]-t.area[0],e[1]-t.area[1]],s=ln(a[0],a[1],t.pixBuffer[_e.ACTOR_PASS],t.area);if(s<=0||s-Nn>=t.props.length)return null;const i={};i.valid=!0,i.propID=s-Nn,i.prop=t.props[i.propID];let o=ln(a[0],a[1],t.pixBuffer[_e.COMPOSITE_INDEX_PASS],t.area);if((o<0||o>16777215)&&(o=0),i.compositeID=o-Nn,t.captureZValues){const g=(a[1]*(t.area[2]-t.area[0]+1)+a[0])*4;i.zValue=(256*t.zBuffer[g]+t.zBuffer[g+1])/65535,i.displayPosition=e}if(t.pixBuffer[_e.ID_LOW24]&&ad(a[0],a[1],t.pixBuffer[_e.ID_LOW24],t.area)===0)return i;const c=ln(a[0],a[1],t.pixBuffer[_e.ID_LOW24],t.area),u=ln(a[0],a[1],t.pixBuffer[_e.ID_HIGH24],t.area);return i.attributeID=sd(c,u),i}}function id(t,e,n,r,a){const s=[];let i=0;return e.forEach((o,c)=>{const u=Vi.newInstance();switch(u.setContentType(Wm.INDICES),t){case La.FIELD_ASSOCIATION_CELLS:u.setFieldType(Hg.CELL);break;case La.FIELD_ASSOCIATION_POINTS:u.setFieldType(Hg.POINT);break;default:nd("Unknown field association")}u.getProperties().propID=o.info.propID,u.getProperties().prop=o.info.prop,u.getProperties().compositeID=o.info.compositeID,u.getProperties().attributeID=o.info.attributeID,u.getProperties().pixelCount=o.pixelCount,n&&(u.getProperties().displayPosition=[o.info.displayPosition[0],o.info.displayPosition[1],o.info.zValue],u.getProperties().worldPosition=a.displayToWorld(o.info.displayPosition[0],o.info.displayPosition[1],o.info.zValue,r)),u.setSelectionList(o.attributeIDs),s[i]=u,i++}),s}function Hm(t,e,n,r,a){const s=Math.floor(e),i=Math.floor(n),o=Math.floor(r),c=Math.floor(a),u=new Map,g=[0,0];for(let f=i;f<=c;f++)for(let l=s;l<=o;l++){const v=zm(t,[l,f],0,g);if(v&&v.valid){const p=rd(v);if(!u.has(p))u.set(p,{info:v,pixelCount:1,attributeIDs:[v.attributeID]});else{const d=u.get(p);d.pixelCount++,t.captureZValues&&v.zValue<d.info.zValue&&(d.info=v),d.attributeIDs.indexOf(v.attributeID)===-1&&d.attributeIDs.push(v.attributeID)}}}return id(t.fieldAssociation,u,t.captureZValues,t.renderer,t.openGLRenderWindow)}function Am(t,e){e.classHierarchy.push("vtkOpenGLHardwareSelector"),t.releasePixBuffers=()=>{e.rawPixBuffer=[],e.pixBuffer=[],e.zBuffer=null},t.beginSelection=()=>{e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer,e._openGLRenderer),e.maxAttributeId=0;const r=e._openGLRenderWindow.getSize();if(!e.framebuffer)e.framebuffer=Ef.newInstance(),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.create(r[0],r[1]),e.framebuffer.populateFramebuffer();else{e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers();const a=e.framebuffer.getSize();!a||a[0]!==r[0]||a[1]!==r[1]?(e.framebuffer.create(r[0],r[1]),e.framebuffer.populateFramebuffer()):e.framebuffer.bind()}if(e._openGLRenderer.clear(),e._openGLRenderer.setSelector(t),e.hitProps={},e.propPixels={},e.props=[],t.releasePixBuffers(),e.fieldAssociation===La.FIELD_ASSOCIATION_POINTS){const a=e._openGLRenderWindow.getContext(),s=a.isEnabled(a.BLEND);a.disable(a.BLEND),e._openGLRenderWindow.traverseAllPasses(),s&&a.enable(a.BLEND)}},t.endSelection=()=>{e.hitProps={},e._openGLRenderer.setSelector(null),e.framebuffer.restorePreviousBindingsAndBuffers()},t.preCapturePass=()=>{const r=e._openGLRenderWindow.getContext();e.originalBlending=r.isEnabled(r.BLEND),r.disable(r.BLEND)},t.postCapturePass=()=>{const r=e._openGLRenderWindow.getContext();e.originalBlending&&r.enable(r.BLEND)},t.select=()=>{let r=null;return t.captureBuffers()&&(r=t.generateSelection(e.area[0],e.area[1],e.area[2],e.area[3]),t.releasePixBuffers()),r},t.getSourceDataAsync=async(r,a,s,i,o)=>{if(e._renderer=r,a===void 0){const u=e._openGLRenderWindow.getSize();t.setArea(0,0,u[0]-1,u[1]-1)}else t.setArea(a,s,i,o);if(!t.captureBuffers())return!1;const c={area:[...e.area],pixBuffer:[...e.pixBuffer],captureZValues:e.captureZValues,zBuffer:e.zBuffer,props:[...e.props],fieldAssociation:e.fieldAssociation,renderer:r,openGLRenderWindow:e._openGLRenderWindow};return c.generateSelection=function(){for(var u=arguments.length,g=new Array(u),f=0;f<u;f++)g[f]=arguments[f];return Hm(c,...g)},c},t.captureBuffers=()=>{if(!e._renderer||!e._openGLRenderWindow)return nd("Renderer and view must be set before calling Select."),!1;e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer,e._openGLRenderer),e._openGLRenderWindow.getRenderable().preRender(),t.invokeEvent({type:"StartEvent"}),e.originalBackground=e._renderer.getBackgroundByReference(),e._renderer.setBackground(0,0,0,0);const r=e._openGLRenderWindow.getRenderPasses();t.beginSelection();const a=[];for(e.currentPass=_e.MIN_KNOWN_PASS;e.currentPass<=_e.MAX_KNOWN_PASS;e.currentPass++)t.passRequired(e.currentPass)&&(t.preCapturePass(e.currentPass),e.captureZValues&&e.currentPass===_e.ACTOR_PASS&&typeof r[0].requestDepth=="function"&&typeof r[0].getFramebuffer=="function"&&r[0].requestDepth(),e._openGLRenderWindow.traverseAllPasses(),t.postCapturePass(e.currentPass),t.savePixelBuffer(e.currentPass),a.push(e.currentPass));return a.forEach(s=>{e.currentPass=s,t.processPixelBuffers()}),e.currentPass=_e.MAX_KNOWN_PASS,t.endSelection(),e._renderer.setBackground(e.originalBackground),t.invokeEvent({type:"EndEvent"}),!0},t.processPixelBuffers=()=>{e.props.forEach((r,a)=>{t.isPropHit(a)&&r.processSelectorPixelBuffers(t,e.propPixels[a])})},t.passRequired=r=>{if(r===_e.ID_HIGH24){if(e.fieldAssociation===La.FIELD_ASSOCIATION_POINTS)return e.maximumPointId>16777215;if(e.fieldAssociation===La.FIELD_ASSOCIATION_CELLS)return e.maximumCellId>16777215}return!0},t.savePixelBuffer=r=>{if(e.pixBuffer[r]=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),!e.rawPixBuffer[r]){const a=(e.area[2]-e.area[0]+1)*(e.area[3]-e.area[1]+1)*4;e.rawPixBuffer[r]=new Uint8Array(a),e.rawPixBuffer[r].set(e.pixBuffer[r])}if(r===_e.ACTOR_PASS){if(e.captureZValues){const a=e._openGLRenderWindow.getRenderPasses();if(typeof a[0].requestDepth=="function"&&typeof a[0].getFramebuffer=="function"){const s=a[0].getFramebuffer();s.saveCurrentBindingsAndBuffers(),s.bind(),e.zBuffer=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),s.restorePreviousBindingsAndBuffers()}}t.buildPropHitList(e.rawPixBuffer[r])}},t.buildPropHitList=r=>{let a=0;for(let s=0;s<=e.area[3]-e.area[1];s++)for(let i=0;i<=e.area[2]-e.area[0];i++){let o=ln(i,s,r,e.area);o>0&&(o--,o in e.hitProps||(e.hitProps[o]=!0,e.propPixels[o]=[]),e.propPixels[o].push(a*4)),++a}},t.renderProp=r=>{e.currentPass===_e.ACTOR_PASS&&(t.setPropColorValueFromInt(e.props.length+Nn),e.props.push(r))},t.renderCompositeIndex=r=>{e.currentPass===_e.COMPOSITE_INDEX_PASS&&t.setPropColorValueFromInt(r+Nn)},t.renderAttributeId=r=>{r<0||(e.maxAttributeId=r>e.maxAttributeId?r:e.maxAttributeId)},t.passTypeToString=r=>E.enumToString(_e,r),t.isPropHit=r=>!!e.hitProps[r],t.setPropColorValueFromInt=r=>{e.propColorValue[0]=r%256/255,e.propColorValue[1]=Math.floor(r/256)%256/255,e.propColorValue[2]=Math.floor(r/65536)%256/255},t.getPixelInformation=(r,a,s)=>{const i=a<0?0:a;if(console.log("getPixelInformation called",i),i===0){if(s[0]=r[0],s[1]=r[1],r[0]<e.area[0]||r[0]>e.area[2]||r[1]<e.area[1]||r[1]>e.area[3])return null;console.log(r),console.log(e.area);const g=[r[0]-e.area[0],r[1]-e.area[1]];console.log("adjusted displayPosition",g);const f=ln(g[0],g[1],e.pixBuffer[_e.ACTOR_PASS],e.area);if(console.log("actorid",f),f<=0||f-Nn>=e.props.length)return null;const l={};l.valid=!0,l.propID=f-Nn,l.prop=e.props[l.propID];let h=ln(g[0],g[1],e.pixBuffer[_e.COMPOSITE_INDEX_PASS],e.area);if((h<0||h>16777215)&&(h=0),l.compositeID=h-Nn,e.captureZValues){const d=(g[1]*(e.area[2]-e.area[0]+1)+g[0])*4;l.zValue=(256*e.zBuffer[d]+e.zBuffer[d+1])/65535,l.displayPosition=r}if(e.pixBuffer[_e.ID_LOW24]&&ad(g[0],g[1],e.pixBuffer[_e.ID_LOW24],e.area)===0)return l;const v=ln(g[0],g[1],e.pixBuffer[_e.ID_LOW24],e.area),p=ln(g[0],g[1],e.pixBuffer[_e.ID_HIGH24],e.area);return l.attributeID=sd(v,p),l}const o=[r[0],r[1]],c=[0,0];let u=t.getPixelInformation(r,0,s);if(u&&u.valid)return u;for(let g=1;g<i;++g){for(let f=o[1]>g?o[1]-g:0;f<=o[1]+g;++f)if(c[1]=f,o[0]>=g&&(c[0]=o[0]-g,u=t.getPixelInformation(c,0,s),u&&u.valid)||(c[0]=o[0]+g,u=t.getPixelInformation(c,0,s),u&&u.valid))return u;for(let f=o[0]>=g?o[0]-(g-1):0;f<=o[0]+(g-1);++f)if(c[0]=f,o[1]>=g&&(c[1]=o[1]-g,u=t.getPixelInformation(c,0,s),u&&u.valid)||(c[1]=o[1]+g,u=t.getPixelInformation(c,0,s),u&&u.valid))return u}return s[0]=r[0],s[1]=r[1],null},t.generateSelection=(r,a,s,i)=>{const o=Math.floor(r),c=Math.floor(a),u=Math.floor(s),g=Math.floor(i),f=new Map,l=[0,0];for(let h=c;h<=g;h++)for(let v=o;v<=u;v++){const p=[v,h],d=t.getPixelInformation(p,0,l);if(d&&d.valid){const y=rd(d);if(!f.has(y))f.set(y,{info:d,pixelCount:1,attributeIDs:[d.attributeID]});else{const S=f.get(y);S.pixelCount++,e.captureZValues&&d.zValue<S.info.zValue&&(S.info=d),S.attributeIDs.indexOf(d.attributeID)===-1&&S.attributeIDs.push(d.attributeID)}}}return id(e.fieldAssociation,f,e.captureZValues,e._renderer,e._openGLRenderWindow)},t.getRawPixelBuffer=r=>e.rawPixBuffer[r],t.getPixelBuffer=r=>e.pixBuffer[r],t.attach=(r,a)=>{e._openGLRenderWindow=r,e._renderer=a};const n=t.setArea;t.setArea=function(){return n(...arguments)?(e.area[0]=Math.floor(e.area[0]),e.area[1]=Math.floor(e.area[1]),e.area[2]=Math.floor(e.area[2]),e.area[3]=Math.floor(e.area[3]),!0):!1}}const jm={area:void 0,currentPass:-1,propColorValue:null,props:null,maximumPointId:0,maximumCellId:0,idOffset:1};function od(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jm,n),ed.extend(t,e,n),e.propColorValue=[0,0,0],e.props=[],e.area||(e.area=[0,0,0,0]),E.setGetArray(t,e,["area"],4),E.setGet(t,e,["_renderer","currentPass","_openGLRenderWindow","maximumPointId","maximumCellId"]),E.setGetArray(t,e,["propColorValue"],3),E.moveToProtected(t,e,["renderer","openGLRenderWindow"]),E.event(t,e,"event"),Am(t,e)}const Km=E.newInstance(od,"vtkOpenGLHardwareSelector");var cd={newInstance:Km,extend:od,...Ep},So={exports:{}},Ag;function Pm(){return Ag||(Ag=1,(function(t,e){(function(n){t.exports=n()})(function(n){var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function a(y,S){var x=y[0],T=y[1],w=y[2],C=y[3];x+=(T&w|~T&C)+S[0]-680876936|0,x=(x<<7|x>>>25)+T|0,C+=(x&T|~x&w)+S[1]-389564586|0,C=(C<<12|C>>>20)+x|0,w+=(C&x|~C&T)+S[2]+606105819|0,w=(w<<17|w>>>15)+C|0,T+=(w&C|~w&x)+S[3]-1044525330|0,T=(T<<22|T>>>10)+w|0,x+=(T&w|~T&C)+S[4]-176418897|0,x=(x<<7|x>>>25)+T|0,C+=(x&T|~x&w)+S[5]+1200080426|0,C=(C<<12|C>>>20)+x|0,w+=(C&x|~C&T)+S[6]-1473231341|0,w=(w<<17|w>>>15)+C|0,T+=(w&C|~w&x)+S[7]-45705983|0,T=(T<<22|T>>>10)+w|0,x+=(T&w|~T&C)+S[8]+1770035416|0,x=(x<<7|x>>>25)+T|0,C+=(x&T|~x&w)+S[9]-1958414417|0,C=(C<<12|C>>>20)+x|0,w+=(C&x|~C&T)+S[10]-42063|0,w=(w<<17|w>>>15)+C|0,T+=(w&C|~w&x)+S[11]-1990404162|0,T=(T<<22|T>>>10)+w|0,x+=(T&w|~T&C)+S[12]+1804603682|0,x=(x<<7|x>>>25)+T|0,C+=(x&T|~x&w)+S[13]-40341101|0,C=(C<<12|C>>>20)+x|0,w+=(C&x|~C&T)+S[14]-1502002290|0,w=(w<<17|w>>>15)+C|0,T+=(w&C|~w&x)+S[15]+1236535329|0,T=(T<<22|T>>>10)+w|0,x+=(T&C|w&~C)+S[1]-165796510|0,x=(x<<5|x>>>27)+T|0,C+=(x&w|T&~w)+S[6]-1069501632|0,C=(C<<9|C>>>23)+x|0,w+=(C&T|x&~T)+S[11]+643717713|0,w=(w<<14|w>>>18)+C|0,T+=(w&x|C&~x)+S[0]-373897302|0,T=(T<<20|T>>>12)+w|0,x+=(T&C|w&~C)+S[5]-701558691|0,x=(x<<5|x>>>27)+T|0,C+=(x&w|T&~w)+S[10]+38016083|0,C=(C<<9|C>>>23)+x|0,w+=(C&T|x&~T)+S[15]-660478335|0,w=(w<<14|w>>>18)+C|0,T+=(w&x|C&~x)+S[4]-405537848|0,T=(T<<20|T>>>12)+w|0,x+=(T&C|w&~C)+S[9]+568446438|0,x=(x<<5|x>>>27)+T|0,C+=(x&w|T&~w)+S[14]-1019803690|0,C=(C<<9|C>>>23)+x|0,w+=(C&T|x&~T)+S[3]-187363961|0,w=(w<<14|w>>>18)+C|0,T+=(w&x|C&~x)+S[8]+1163531501|0,T=(T<<20|T>>>12)+w|0,x+=(T&C|w&~C)+S[13]-1444681467|0,x=(x<<5|x>>>27)+T|0,C+=(x&w|T&~w)+S[2]-51403784|0,C=(C<<9|C>>>23)+x|0,w+=(C&T|x&~T)+S[7]+1735328473|0,w=(w<<14|w>>>18)+C|0,T+=(w&x|C&~x)+S[12]-1926607734|0,T=(T<<20|T>>>12)+w|0,x+=(T^w^C)+S[5]-378558|0,x=(x<<4|x>>>28)+T|0,C+=(x^T^w)+S[8]-2022574463|0,C=(C<<11|C>>>21)+x|0,w+=(C^x^T)+S[11]+1839030562|0,w=(w<<16|w>>>16)+C|0,T+=(w^C^x)+S[14]-35309556|0,T=(T<<23|T>>>9)+w|0,x+=(T^w^C)+S[1]-1530992060|0,x=(x<<4|x>>>28)+T|0,C+=(x^T^w)+S[4]+1272893353|0,C=(C<<11|C>>>21)+x|0,w+=(C^x^T)+S[7]-155497632|0,w=(w<<16|w>>>16)+C|0,T+=(w^C^x)+S[10]-1094730640|0,T=(T<<23|T>>>9)+w|0,x+=(T^w^C)+S[13]+681279174|0,x=(x<<4|x>>>28)+T|0,C+=(x^T^w)+S[0]-358537222|0,C=(C<<11|C>>>21)+x|0,w+=(C^x^T)+S[3]-722521979|0,w=(w<<16|w>>>16)+C|0,T+=(w^C^x)+S[6]+76029189|0,T=(T<<23|T>>>9)+w|0,x+=(T^w^C)+S[9]-640364487|0,x=(x<<4|x>>>28)+T|0,C+=(x^T^w)+S[12]-421815835|0,C=(C<<11|C>>>21)+x|0,w+=(C^x^T)+S[15]+530742520|0,w=(w<<16|w>>>16)+C|0,T+=(w^C^x)+S[2]-995338651|0,T=(T<<23|T>>>9)+w|0,x+=(w^(T|~C))+S[0]-198630844|0,x=(x<<6|x>>>26)+T|0,C+=(T^(x|~w))+S[7]+1126891415|0,C=(C<<10|C>>>22)+x|0,w+=(x^(C|~T))+S[14]-1416354905|0,w=(w<<15|w>>>17)+C|0,T+=(C^(w|~x))+S[5]-57434055|0,T=(T<<21|T>>>11)+w|0,x+=(w^(T|~C))+S[12]+1700485571|0,x=(x<<6|x>>>26)+T|0,C+=(T^(x|~w))+S[3]-1894986606|0,C=(C<<10|C>>>22)+x|0,w+=(x^(C|~T))+S[10]-1051523|0,w=(w<<15|w>>>17)+C|0,T+=(C^(w|~x))+S[1]-2054922799|0,T=(T<<21|T>>>11)+w|0,x+=(w^(T|~C))+S[8]+1873313359|0,x=(x<<6|x>>>26)+T|0,C+=(T^(x|~w))+S[15]-30611744|0,C=(C<<10|C>>>22)+x|0,w+=(x^(C|~T))+S[6]-1560198380|0,w=(w<<15|w>>>17)+C|0,T+=(C^(w|~x))+S[13]+1309151649|0,T=(T<<21|T>>>11)+w|0,x+=(w^(T|~C))+S[4]-145523070|0,x=(x<<6|x>>>26)+T|0,C+=(T^(x|~w))+S[11]-1120210379|0,C=(C<<10|C>>>22)+x|0,w+=(x^(C|~T))+S[2]+718787259|0,w=(w<<15|w>>>17)+C|0,T+=(C^(w|~x))+S[9]-343485551|0,T=(T<<21|T>>>11)+w|0,y[0]=x+y[0]|0,y[1]=T+y[1]|0,y[2]=w+y[2]|0,y[3]=C+y[3]|0}function s(y){var S=[],x;for(x=0;x<64;x+=4)S[x>>2]=y.charCodeAt(x)+(y.charCodeAt(x+1)<<8)+(y.charCodeAt(x+2)<<16)+(y.charCodeAt(x+3)<<24);return S}function i(y){var S=[],x;for(x=0;x<64;x+=4)S[x>>2]=y[x]+(y[x+1]<<8)+(y[x+2]<<16)+(y[x+3]<<24);return S}function o(y){var S=y.length,x=[1732584193,-271733879,-1732584194,271733878],T,w,C,R,M,m;for(T=64;T<=S;T+=64)a(x,s(y.substring(T-64,T)));for(y=y.substring(T-64),w=y.length,C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T=0;T<w;T+=1)C[T>>2]|=y.charCodeAt(T)<<(T%4<<3);if(C[T>>2]|=128<<(T%4<<3),T>55)for(a(x,C),T=0;T<16;T+=1)C[T]=0;return R=S*8,R=R.toString(16).match(/(.*?)(.{0,8})$/),M=parseInt(R[2],16),m=parseInt(R[1],16)||0,C[14]=M,C[15]=m,a(x,C),x}function c(y){var S=y.length,x=[1732584193,-271733879,-1732584194,271733878],T,w,C,R,M,m;for(T=64;T<=S;T+=64)a(x,i(y.subarray(T-64,T)));for(y=T-64<S?y.subarray(T-64):new Uint8Array(0),w=y.length,C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T=0;T<w;T+=1)C[T>>2]|=y[T]<<(T%4<<3);if(C[T>>2]|=128<<(T%4<<3),T>55)for(a(x,C),T=0;T<16;T+=1)C[T]=0;return R=S*8,R=R.toString(16).match(/(.*?)(.{0,8})$/),M=parseInt(R[2],16),m=parseInt(R[1],16)||0,C[14]=M,C[15]=m,a(x,C),x}function u(y){var S="",x;for(x=0;x<4;x+=1)S+=r[y>>x*8+4&15]+r[y>>x*8&15];return S}function g(y){var S;for(S=0;S<y.length;S+=1)y[S]=u(y[S]);return y.join("")}g(o("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&(function(){function y(S,x){return S=S|0||0,S<0?Math.max(S+x,0):Math.min(S,x)}ArrayBuffer.prototype.slice=function(S,x){var T=this.byteLength,w=y(S,T),C=T,R,M,m,L;return x!==n&&(C=y(x,T)),w>C?new ArrayBuffer(0):(R=C-w,M=new ArrayBuffer(R),m=new Uint8Array(M),L=new Uint8Array(this,w,R),m.set(L),M)}})();function f(y){return/[\u0080-\uFFFF]/.test(y)&&(y=unescape(encodeURIComponent(y))),y}function l(y,S){var x=y.length,T=new ArrayBuffer(x),w=new Uint8Array(T),C;for(C=0;C<x;C+=1)w[C]=y.charCodeAt(C);return S?w:T}function h(y){return String.fromCharCode.apply(null,new Uint8Array(y))}function v(y,S,x){var T=new Uint8Array(y.byteLength+S.byteLength);return T.set(new Uint8Array(y)),T.set(new Uint8Array(S),y.byteLength),T}function p(y){var S=[],x=y.length,T;for(T=0;T<x-1;T+=2)S.push(parseInt(y.substr(T,2),16));return String.fromCharCode.apply(String,S)}function d(){this.reset()}return d.prototype.append=function(y){return this.appendBinary(f(y)),this},d.prototype.appendBinary=function(y){this._buff+=y,this._length+=y.length;var S=this._buff.length,x;for(x=64;x<=S;x+=64)a(this._hash,s(this._buff.substring(x-64,x)));return this._buff=this._buff.substring(x-64),this},d.prototype.end=function(y){var S=this._buff,x=S.length,T,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],C;for(T=0;T<x;T+=1)w[T>>2]|=S.charCodeAt(T)<<(T%4<<3);return this._finish(w,x),C=g(this._hash),y&&(C=p(C)),this.reset(),C},d.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},d.prototype.setState=function(y){return this._buff=y.buff,this._length=y.length,this._hash=y.hash,this},d.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},d.prototype._finish=function(y,S){var x=S,T,w,C;if(y[x>>2]|=128<<(x%4<<3),x>55)for(a(this._hash,y),x=0;x<16;x+=1)y[x]=0;T=this._length*8,T=T.toString(16).match(/(.*?)(.{0,8})$/),w=parseInt(T[2],16),C=parseInt(T[1],16)||0,y[14]=w,y[15]=C,a(this._hash,y)},d.hash=function(y,S){return d.hashBinary(f(y),S)},d.hashBinary=function(y,S){var x=o(y),T=g(x);return S?p(T):T},d.ArrayBuffer=function(){this.reset()},d.ArrayBuffer.prototype.append=function(y){var S=v(this._buff.buffer,y),x=S.length,T;for(this._length+=y.byteLength,T=64;T<=x;T+=64)a(this._hash,i(S.subarray(T-64,T)));return this._buff=T-64<x?new Uint8Array(S.buffer.slice(T-64)):new Uint8Array(0),this},d.ArrayBuffer.prototype.end=function(y){var S=this._buff,x=S.length,T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w,C;for(w=0;w<x;w+=1)T[w>>2]|=S[w]<<(w%4<<3);return this._finish(T,x),C=g(this._hash),y&&(C=p(C)),this.reset(),C},d.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.ArrayBuffer.prototype.getState=function(){var y=d.prototype.getState.call(this);return y.buff=h(y.buff),y},d.ArrayBuffer.prototype.setState=function(y){return y.buff=l(y.buff,!0),d.prototype.setState.call(this,y)},d.ArrayBuffer.prototype.destroy=d.prototype.destroy,d.ArrayBuffer.prototype._finish=d.prototype._finish,d.ArrayBuffer.hash=function(y,S){var x=c(new Uint8Array(y)),T=g(x);return S?p(T):T},d})})(So)),So.exports}var Xm=Pm();const Im=Si(Xm),Ym=["lastShaderProgramBound","context","_openGLRenderWindow"];function qm(t,e){e.classHierarchy.push("vtkShaderCache"),t.replaceShaderValues=(n,r,a)=>{let s=r;a.length>0&&(s=N.substitute(s,"VSOut","GSOut").result);const i=e._openGLRenderWindow.getWebgl2();let o=`
`,c=`#version 100
`;i?c=`#version 300 es
#define attribute in
#define textureCube texture
#define texture2D texture
#define textureCubeLod textureLod
#define texture2DLod textureLod
`:(e.context.getExtension("OES_standard_derivatives"),e.context.getExtension("EXT_frag_depth")&&(o=`#extension GL_EXT_frag_depth : enable
`),e.context.getExtension("EXT_shader_texture_lod")&&(o+=`#extension GL_EXT_shader_texture_lod : enable
#define textureCubeLod textureCubeLodEXT
#define texture2DLod texture2DLodEXT`)),s=N.substitute(s,"//VTK::System::Dec",[`${c}
`,i?"":`#extension GL_OES_standard_derivatives : enable
`,o,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;let u=N.substitute(n,"//VTK::System::Dec",[`${c}
`,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;if(i){u=N.substitute(u,"varying","out").result,s=N.substitute(s,"varying","in").result;let f="",l=0;for(;s.includes(`gl_FragData[${l}]`);)s=N.substitute(s,`gl_FragData\\[${l}\\]`,`fragOutput${l}`).result,f+=`layout(location = ${l}) out vec4 fragOutput${l};
`,l++;s=N.substitute(s,"//VTK::Output::Dec",f).result}const g=N.substitute(a,"//VTK::System::Dec",c).result;return{VSSource:u,FSSource:s,GSSource:g}},t.readyShaderProgramArray=(n,r,a)=>{const s=t.replaceShaderValues(n,r,a),i=t.getShaderProgram(s.VSSource,s.FSSource,s.GSSource);return t.readyShaderProgram(i)},t.readyShaderProgram=n=>!n||!n.getCompiled()&&!n.compileShader()||!t.bindShaderProgram(n)?null:n,t.getShaderProgram=(n,r,a)=>{const s=`${n}${r}${a}`,i=Im.hash(s);if(!(i in e.shaderPrograms)){const o=N.newInstance();return o.setContext(e.context),o.getVertexShader().setSource(n),o.getFragmentShader().setSource(r),a&&o.getGeometryShader().setSource(a),o.setMd5Hash(i),e.shaderPrograms[i]=o,o}return e.shaderPrograms[i]},t.releaseGraphicsResources=n=>{t.releaseCurrentShaderProgram(),Object.keys(e.shaderPrograms).map(r=>e.shaderPrograms[r]).forEach(r=>r.cleanup()),e.shaderPrograms={}},t.releaseCurrentShaderProgram=()=>{e.lastShaderProgramBound&&(e.lastShaderProgramBound.cleanup(),e.lastShaderProgramBound=null)},t.bindShaderProgram=n=>(e.lastShaderProgramBound===n||(e.lastShaderProgramBound&&e.lastShaderProgramBound.release(),n.bind(),e.lastShaderProgramBound=n),1)}const Qm={lastShaderProgramBound:null,shaderPrograms:null,context:null};function fd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Qm,n),e.shaderPrograms={},E.obj(t,e),E.setGet(t,e,Ym),E.moveToProtected(t,e,["openGLRenderWindow"]),qm(t,e)}const Zm=E.newInstance(fd,"vtkShaderCache");var Jm={newInstance:Zm,extend:fd};const{vtkErrorMacro:eF}=E;function tF(t,e){e.classHierarchy.push("vtkOpenGLTextureUnitManager"),t.deleteTable=()=>{for(let n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]===!0&&eF("some texture units  were not properly released");e.textureUnits=[],e.numberOfTextureUnits=0},t.setContext=n=>{if(e.context!==n){if(e.context!==0&&t.deleteTable(),e.context=n,e.context){e.numberOfTextureUnits=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS);for(let r=0;r<e.numberOfTextureUnits;++r)e.textureUnits[r]=!1}t.modified()}},t.allocate=()=>{for(let n=0;n<e.numberOfTextureUnits;n++)if(!t.isAllocated(n))return e.textureUnits[n]=!0,n;return-1},t.allocateUnit=n=>t.isAllocated(n)?-1:(e.textureUnits[n]=!0,n),t.isAllocated=n=>e.textureUnits[n],t.free=n=>{e.textureUnits[n]=!1},t.freeAll=()=>{for(let n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]=!1}}const nF={context:null,numberOfTextureUnits:0,textureUnits:0};function ud(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nF,n),E.obj(t,e),e.textureUnits=[],E.get(t,e,["numberOfTextureUnits"]),E.setGet(t,e,["context"]),tF(t,e)}const rF=E.newInstance(ud,"vtkOpenGLTextureUnitManager");var aF={newInstance:rF,extend:ud};function sF(t,e){e.classHierarchy.push("vtkRenderWindowViewNode"),t.getViewNodeFactory=()=>null,t.getAspectRatio=()=>e.size[0]/e.size[1],t.getAspectRatioForRenderer=n=>{const r=n.getViewportByReference();return e.size[0]*(r[2]-r[0])/((r[3]-r[1])*e.size[1])},t.isInViewport=(n,r,a)=>{const s=a.getViewportByReference(),i=t.getFramebufferSize();return s[0]*i[0]<=n&&s[2]*i[0]>=n&&s[1]*i[1]<=r&&s[3]*i[1]>=r},t.getViewportSize=n=>{const r=n.getViewportByReference(),a=t.getFramebufferSize();return[(r[2]-r[0])*a[0],(r[3]-r[1])*a[1]]},t.getViewportCenter=n=>{const r=t.getViewportSize(n);return[r[0]*.5,r[1]*.5]},t.displayToNormalizedDisplay=(n,r,a)=>{const s=t.getFramebufferSize();return[n/s[0],r/s[1],a]},t.normalizedDisplayToDisplay=(n,r,a)=>{const s=t.getFramebufferSize();return[n*s[0],r*s[1],a]},t.worldToView=(n,r,a,s)=>s.worldToView(n,r,a),t.viewToWorld=(n,r,a,s)=>s.viewToWorld(n,r,a),t.worldToDisplay=(n,r,a,s)=>{const i=s.worldToView(n,r,a),o=t.getViewportSize(s),c=s.viewToProjection(i[0],i[1],i[2],o[0]/o[1]),u=s.projectionToNormalizedDisplay(c[0],c[1],c[2]);return t.normalizedDisplayToDisplay(u[0],u[1],u[2])},t.displayToWorld=(n,r,a,s)=>{const i=t.displayToNormalizedDisplay(n,r,a),o=s.normalizedDisplayToProjection(i[0],i[1],i[2]),c=t.getViewportSize(s),u=s.projectionToView(o[0],o[1],o[2],c[0]/c[1]);return s.viewToWorld(u[0],u[1],u[2])},t.normalizedDisplayToViewport=(n,r,a,s)=>{let i=s.getViewportByReference();i=t.normalizedDisplayToDisplay(i[0],i[1],0);const o=t.normalizedDisplayToDisplay(n,r,a);return[o[0]-i[0]-.5,o[1]-i[1]-.5,a]},t.viewportToNormalizedViewport=(n,r,a,s)=>{const i=t.getViewportSize(s);return i&&i[0]!==0&&i[1]!==0?[n/(i[0]-1),r/(i[1]-1),a]:[n,r,a]},t.normalizedViewportToViewport=(n,r,a,s)=>{const i=t.getViewportSize(s);return[n*(i[0]-1),r*(i[1]-1),a]},t.displayToLocalDisplay=(n,r,a)=>{const s=t.getFramebufferSize();return[n,s[1]-r-1,a]},t.viewportToNormalizedDisplay=(n,r,a,s)=>{let i=s.getViewportByReference();i=t.normalizedDisplayToDisplay(i[0],i[1],0);const o=n+i[0]+.5,c=r+i[1]+.5;return t.displayToNormalizedDisplay(o,c,a)},t.getComputedDevicePixelRatio=()=>e.size[0]/t.getContainerSize()[0],t.getContainerSize=()=>{E.vtkErrorMacro("not implemented")},t.getPixelData=(n,r,a,s)=>{E.vtkErrorMacro("not implemented")},t.createSelector=()=>{E.vtkErrorMacro("not implemented")}}const iF={size:void 0,selector:void 0};function gd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iF,n),e.size||(e.size=[300,300]),E.getArray(t,e,["size"],2),E.get(t,e,["selector"]),Be.extend(t,e,n),sF(t,e)}const oF=E.newInstance(gd,"vtkRenderWindowViewNode");var ld={newInstance:oF,extend:gd};const cF="__getUnderlyingContext";function fF(){const t=new Map,e={apply(a,s,i){return t.has(i[0])?t.get(i[0]):a.apply(s,i)}};function n(a){return{apply(s,i,o){return t.set(a,o[0]),s.apply(i,o)}}}const r=Object.create(null);return r.getParameter=(a,s,i,o)=>new Proxy(o.bind(a),e),r.depthMask=(a,s,i,o)=>new Proxy(o.bind(a),n(a.DEPTH_WRITEMASK)),{get(a,s,i){if(s===cF)return()=>a;let o=Reflect.get(a,s,a);o instanceof Function&&(o=o.bind(a));const c=r[s];return c?c(a,s,i,o):o}}}const{vtkDebugMacro:jg,vtkErrorMacro:Kg}=E,uF={position:"absolute",top:0,left:0,width:"100%",height:"100%"},gF=["activateTexture","deactivateTexture","disableCullFace","enableCullFace","get3DContext","getActiveFramebuffer","getContext","getDefaultTextureByteSize","getDefaultTextureInternalFormat","getDefaultToWebgl2","getGLInformations","getGraphicsMemoryInfo","getGraphicsResourceForObject","getHardwareMaximumLineWidth","getPixelData","getShaderCache","getTextureUnitForTexture","getTextureUnitManager","getWebgl2","makeCurrent","releaseGraphicsResources","registerGraphicsResourceUser","unregisterGraphicsResourceUser","restoreContext","setActiveFramebuffer","setContext","setDefaultToWebgl2","setGraphicsResourceForObject"];function at(t,e,n){const r=t.createFramebuffer(),a=t.createTexture();t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,e,2,2,0,e,n,null),t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER);return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),s===t.FRAMEBUFFER_COMPLETE}let ui=0;const hd=[];function lF(){ui++,hd.forEach(t=>t(ui))}function hF(){ui--,hd.forEach(t=>t(ui))}function Pg(t){t.preventDefault()}function pF(t,e){e.classHierarchy.push("vtkOpenGLRenderWindow");let n;function r(){return n||(n=fF()),n}t.getViewNodeFactory=()=>e.myFactory,e.canvas.addEventListener("webglcontextlost",Pg,!1),e.canvas.addEventListener("webglcontextrestored",t.restoreContext,!1);const a=[0,0];function s(){e.renderable&&(e.size[0]!==a[0]||e.size[1]!==a[1])&&(a[0]=e.size[0],a[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1])),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(s),t.buildPass=f=>{if(f){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.addMissingNodes(e.renderable.getChildRenderWindowsByReference()),t.removeUnusedNodes(),t.initialize(),e.children.forEach(l=>{l.setOpenGLRenderWindow?.(t)})}},t.initialize=()=>{if(!e.initialized){if(e.rootOpenGLRenderWindow=t.getLastAncestorOfType("vtkOpenGLRenderWindow"),e.rootOpenGLRenderWindow)e.context2D=t.get2DContext();else{e.context=t.get3DContext(),t.resizeFromChildRenderWindows(),e.context&&lF(),e.textureUnitManager=aF.newInstance(),e.textureUnitManager.setContext(e.context),e.shaderCache.setContext(e.context);const f=e.context;f.blendFuncSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA),f.depthFunc(f.LEQUAL),f.enable(f.BLEND)}e.initialized=!0}},t.makeCurrent=()=>{e.context.makeCurrent()},t.setContainer=f=>{e.el&&e.el!==f&&(e.canvas.parentNode!==e.el&&Kg("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==f&&(e.el=f,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=()=>e.el,t.getContainerSize=()=>{if(!e.containerSize&&e.el){const{width:f,height:l}=e.el.getBoundingClientRect();e.containerSize=[f,l]}return e.containerSize||e.size},t.getFramebufferSize=()=>e.activeFramebuffer?.getSize()||e.size,t.getPixelData=(f,l,h,v)=>{const p=new Uint8Array((h-f+1)*(v-l+1)*4);return e.context.readPixels(f,l,h-f+1,v-l+1,e.context.RGBA,e.context.UNSIGNED_BYTE,p),p},t.get3DContext=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{preserveDrawingBuffer:!1,depth:!0,alpha:!0,powerPreference:"high-performance"},l=null;const h=typeof WebGL2RenderingContext<"u";return e.webgl2=!1,e.defaultToWebgl2&&h&&(l=e.canvas.getContext("webgl2",f),l&&(e.webgl2=!0,jg("using webgl2"))),l||(jg("using webgl1"),l=e.canvas.getContext("webgl",f)||e.canvas.getContext("experimental-webgl",f)),new Proxy(l,r())},t.get2DContext=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e.canvas.getContext("2d",f)},t.restoreContext=()=>{const f=Sn.newInstance();f.setCurrentOperation("Release"),f.traverse(t,null)},t.activateTexture=f=>{const l=e._textureResourceIds.get(f);if(l!==void 0){e.context.activeTexture(e.context.TEXTURE0+l);return}const h=t.getTextureUnitManager().allocate();if(h<0){Kg("Hardware does not support the number of textures defined.");return}e._textureResourceIds.set(f,h),e.context.activeTexture(e.context.TEXTURE0+h)},t.deactivateTexture=f=>{const l=e._textureResourceIds.get(f);l!==void 0&&(t.getTextureUnitManager().free(l),e._textureResourceIds.delete(f))},t.getTextureUnitForTexture=f=>{const l=e._textureResourceIds.get(f);return l!==void 0?l:-1},t.getDefaultTextureByteSize=function(f){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e.webgl2)switch(f){case Pe.CHAR:case Pe.SIGNED_CHAR:case Pe.UNSIGNED_CHAR:return 1;case l:case h:case Pe.UNSIGNED_SHORT:case Pe.SHORT:case Pe.VOID:return 2;default:return 4}return 1},t.getDefaultTextureInternalFormat=function(f,l){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e.webgl2)switch(f){case Pe.UNSIGNED_CHAR:switch(l){case 1:return e.context.R8;case 2:return e.context.RG8;case 3:return e.context.RGB8;case 4:default:return e.context.RGBA8}case(h&&!v&&Pe.UNSIGNED_SHORT):switch(l){case 1:return h.R16_EXT;case 2:return h.RG16_EXT;case 3:return h.RGB16_EXT;case 4:default:return h.RGBA16_EXT}case(h&&!v&&Pe.SHORT):switch(l){case 1:return h.R16_SNORM_EXT;case 2:return h.RG16_SNORM_EXT;case 3:return h.RGB16_SNORM_EXT;case 4:default:return h.RGBA16_SNORM_EXT}case Pe.UNSIGNED_SHORT:case Pe.SHORT:case Pe.FLOAT:default:switch(l){case 1:return v?e.context.R16F:e.context.R32F;case 2:return v?e.context.RG16F:e.context.RG32F;case 3:return v?e.context.RGB16F:e.context.RGB32F;case 4:default:return v?e.context.RGBA16F:e.context.RGBA32F}}switch(l){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:default:return e.context.RGBA}},t.setBackgroundImage=f=>{e.bgImage.src=f.src},t.setUseBackgroundImage=f=>{e.useBackgroundImage=f,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};function i(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.imageFormat;const l=document.createElement("canvas"),h=l.getContext("2d");l.width=e.canvas.width,l.height=e.canvas.height,h.drawImage(e.canvas,0,0);const v=e.canvas.getBoundingClientRect();e.renderable.getRenderers().forEach(S=>{S.getViewProps().forEach(T=>{if(T.getContainer){const C=T.getContainer().getElementsByTagName("canvas");for(let R=0;R<C.length;R++){const M=C[R],m=M.getBoundingClientRect(),L=m.x-v.x,V=m.y-v.y;h.drawImage(M,L,V)}}})});const y=l.toDataURL(f);l.remove(),t.invokeImageReady(y)}t.captureNextImage=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",{resetCamera:l=!1,size:h=null,scale:v=1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.deleted)return null;e.imageFormat=f;const p=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:h||v!==1?h||e.size.map(d=>d*v):null},new Promise((d,y)=>{const S=t.onImageReady(x=>{if(e._screenshot.size===null)e.notifyStartCaptureImage=p,S.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(T=>{let{restoreParamsFn:w,arg:C}=T;return w(C)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),d(x);else{const T=document.createElement("img");if(T.style=uF,T.src=x,e._screenshot.placeHolder=e.el.appendChild(T),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e.rootOpenGLRenderWindow?.resizeFromChildRenderWindows(),e._screenshot.size=null,t.modified(),l){const w=l!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(C=>{const R=C.getActiveCamera(),M=R.get("focalPoint","position","parallelScale");return{resetCameraArgs:w?{renderer:C}:void 0,resetCameraFn:w?l:C.resetCamera,restoreParamsFn:R.set,arg:JSON.parse(JSON.stringify(M))}}),e._screenshot.cameras.forEach(C=>{let{resetCameraFn:R,resetCameraArgs:M}=C;return R(M)})}t.traverseAllPasses()}})})};let o;t.getHardwareMaximumLineWidth=()=>{if(o!=null)return o;const f=t.get3DContext(),l=f.getParameter(f.ALIASED_LINE_WIDTH_RANGE);return o=l[1],l[1]},t.getGLInformations=()=>{if(e._glInformation)return e._glInformation;const f=t.get3DContext(),l=f.getExtension("OES_texture_float"),h=f.getExtension("OES_texture_half_float"),v=f.getExtension("WEBGL_debug_renderer_info"),p=f.getExtension("WEBGL_draw_buffers"),d=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),y=[["Max Vertex Attributes","MAX_VERTEX_ATTRIBS",f.getParameter(f.MAX_VERTEX_ATTRIBS)],["Max Varying Vectors","MAX_VARYING_VECTORS",f.getParameter(f.MAX_VARYING_VECTORS)],["Max Vertex Uniform Vectors","MAX_VERTEX_UNIFORM_VECTORS",f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS)],["Max Fragment Uniform Vectors","MAX_FRAGMENT_UNIFORM_VECTORS",f.getParameter(f.MAX_FRAGMENT_UNIFORM_VECTORS)],["Max Fragment Texture Image Units","MAX_TEXTURE_IMAGE_UNITS",f.getParameter(f.MAX_TEXTURE_IMAGE_UNITS)],["Max Vertex Texture Image Units","MAX_VERTEX_TEXTURE_IMAGE_UNITS",f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS)],["Max Combined Texture Image Units","MAX_COMBINED_TEXTURE_IMAGE_UNITS",f.getParameter(f.MAX_COMBINED_TEXTURE_IMAGE_UNITS)],["Max 2D Texture Size","MAX_TEXTURE_SIZE",f.getParameter(f.MAX_TEXTURE_SIZE)],["Max Cube Texture Size","MAX_CUBE_MAP_TEXTURE_SIZE",f.getParameter(f.MAX_CUBE_MAP_TEXTURE_SIZE)],["Max Texture Anisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT",d&&f.getParameter(d.MAX_TEXTURE_MAX_ANISOTROPY_EXT)],["Point Size Range","ALIASED_POINT_SIZE_RANGE",f.getParameter(f.ALIASED_POINT_SIZE_RANGE).join(" - ")],["Line Width Range","ALIASED_LINE_WIDTH_RANGE",f.getParameter(f.ALIASED_LINE_WIDTH_RANGE).join(" - ")],["Max Viewport Dimensions","MAX_VIEWPORT_DIMS",f.getParameter(f.MAX_VIEWPORT_DIMS).join(" - ")],["Max Renderbuffer Size","MAX_RENDERBUFFER_SIZE",f.getParameter(f.MAX_RENDERBUFFER_SIZE)],["Framebuffer Red Bits","RED_BITS",f.getParameter(f.RED_BITS)],["Framebuffer Green Bits","GREEN_BITS",f.getParameter(f.GREEN_BITS)],["Framebuffer Blue Bits","BLUE_BITS",f.getParameter(f.BLUE_BITS)],["Framebuffer Alpha Bits","ALPHA_BITS",f.getParameter(f.ALPHA_BITS)],["Framebuffer Depth Bits","DEPTH_BITS",f.getParameter(f.DEPTH_BITS)],["Framebuffer Stencil Bits","STENCIL_BITS",f.getParameter(f.STENCIL_BITS)],["Framebuffer Subpixel Bits","SUBPIXEL_BITS",f.getParameter(f.SUBPIXEL_BITS)],["MSAA Samples","SAMPLES",f.getParameter(f.SAMPLES)],["MSAA Sample Buffers","SAMPLE_BUFFERS",f.getParameter(f.SAMPLE_BUFFERS)],["Supported Formats for UByte Render Targets     ","UNSIGNED_BYTE RENDER TARGET FORMATS",[l&&at(f,f.RGBA,f.UNSIGNED_BYTE)?"RGBA":"",l&&at(f,f.RGB,f.UNSIGNED_BYTE)?"RGB":"",l&&at(f,f.LUMINANCE,f.UNSIGNED_BYTE)?"LUMINANCE":"",l&&at(f,f.ALPHA,f.UNSIGNED_BYTE)?"ALPHA":"",l&&at(f,f.LUMINANCE_ALPHA,f.UNSIGNED_BYTE)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Half Float Render Targets","HALF FLOAT RENDER TARGET FORMATS",[h&&at(f,f.RGBA,h.HALF_FLOAT_OES)?"RGBA":"",h&&at(f,f.RGB,h.HALF_FLOAT_OES)?"RGB":"",h&&at(f,f.LUMINANCE,h.HALF_FLOAT_OES)?"LUMINANCE":"",h&&at(f,f.ALPHA,h.HALF_FLOAT_OES)?"ALPHA":"",h&&at(f,f.LUMINANCE_ALPHA,h.HALF_FLOAT_OES)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Full Float Render Targets","FLOAT RENDER TARGET FORMATS",[l&&at(f,f.RGBA,f.FLOAT)?"RGBA":"",l&&at(f,f.RGB,f.FLOAT)?"RGB":"",l&&at(f,f.LUMINANCE,f.FLOAT)?"LUMINANCE":"",l&&at(f,f.ALPHA,f.FLOAT)?"ALPHA":"",l&&at(f,f.LUMINANCE_ALPHA,f.FLOAT)?"LUMINANCE_ALPHA":""].join(" ")],["Max Multiple Render Targets Buffers","MAX_DRAW_BUFFERS_WEBGL",p?f.getParameter(p.MAX_DRAW_BUFFERS_WEBGL):0],["High Float Precision in Vertex Shader","HIGH_FLOAT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Vertex Shader","MEDIUM_FLOAT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Vertex Shader","LOW_FLOAT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Float Precision in Fragment Shader","HIGH_FLOAT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Fragment Shader","MEDIUM_FLOAT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Fragment Shader","LOW_FLOAT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Int Precision in Vertex Shader","HIGH_INT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Vertex Shader","MEDIUM_INT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Vertex Shader","LOW_INT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT).rangeMax,"</sup>)"].join("")],["High Int Precision in Fragment Shader","HIGH_INT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Fragment Shader","MEDIUM_INT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Fragment Shader","LOW_INT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_INT).rangeMax,"</sup>)"].join("")],["Supported Extensions","EXTENSIONS",f.getSupportedExtensions().join("<br/>					    ")],["WebGL Renderer","RENDERER",f.getParameter(f.RENDERER)],["WebGL Vendor","VENDOR",f.getParameter(f.VENDOR)],["WebGL Version","VERSION",f.getParameter(f.VERSION)],["Shading Language Version","SHADING_LANGUAGE_VERSION",f.getParameter(f.SHADING_LANGUAGE_VERSION)],["Unmasked Renderer","UNMASKED_RENDERER",v&&f.getParameter(v.UNMASKED_RENDERER_WEBGL)],["Unmasked Vendor","UNMASKED_VENDOR",v&&f.getParameter(v.UNMASKED_VENDOR_WEBGL)],["WebGL Version","WEBGL_VERSION",e.webgl2?2:1]],S={};for(;y.length;){const[x,T,w]=y.pop();T&&(S[T]={label:x,value:w})}return e._glInformation=S,S},t.traverseAllPasses=()=>{if(e.renderPasses)for(let l=0;l<e.renderPasses.length;++l)e.renderPasses[l].traverse(t,null);t.copyParentContent(),e.notifyStartCaptureImage&&i();const f=e.renderable.getChildRenderWindowsByReference();for(let l=0;l<f.length;++l)t.getViewNodeFor(f[l])?.traverseAllPasses()},t.copyParentContent=()=>{const f=e.rootOpenGLRenderWindow;if(!f||!e.context2D||e.children.some(v=>!!v.getSelector?.()))return;const l=f.getCanvas(),h=e.canvas;e.context2D.drawImage(l,0,l.height-h.height,h.width,h.height,0,0,h.width,h.height)},t.resizeFromChildRenderWindows=()=>{const f=e.renderable.getChildRenderWindowsByReference();if(f.length>0){const l=[0,0];for(let h=0;h<f.length;++h){const v=t.getViewNodeFor(f[h])?.getSize();v&&(l[0]=v[0]>l[0]?v[0]:l[0],l[1]=v[1]>l[1]?v[1]:l[1])}t.setSize(...l)}},t.disableCullFace=()=>{e.cullFaceEnabled&&(e.context.disable(e.context.CULL_FACE),e.cullFaceEnabled=!1)},t.enableCullFace=()=>{e.cullFaceEnabled||(e.context.enable(e.context.CULL_FACE),e.cullFaceEnabled=!0)},t.setViewStream=f=>{if(e.viewStream===f)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=f,e.viewStream){const l=e.renderable.getRenderers()[0];l.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(h=>t.setBackgroundImage(h.image)),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.createSelector=()=>{const f=cd.newInstance();return f.setOpenGLRenderWindow(t),f};function c(){e.canvas.removeEventListener("webglcontextlost",Pg),e.canvas.removeEventListener("webglcontextrestored",t.restoreContext)}t.delete=E.chain(()=>{e.context&&hF(),t.setContainer(),t.setViewStream()},c,t.delete),t.setActiveFramebuffer=f=>{e.activeFramebuffer=f};const u=t.setSize;t.setSize=(f,l)=>{const h=u(f,l);return h&&t.invokeWindowResizeEvent({width:f,height:l}),h},t.registerGraphicsResourceUser=(f,l)=>{e._graphicsResources.has(f)||t.setGraphicsResourceForObject(f,null,null),e._graphicsResources.get(f)?.users.add(l)},t.unregisterGraphicsResourceUser=(f,l)=>{const h=e._graphicsResources.get(f);h&&(h.users.delete(l),h.users.size||(h.oglObject?.releaseGraphicsResources(t),e._graphicsResources.delete(f)))},t.getGraphicsResourceForObject=f=>e._graphicsResources.get(f),t.setGraphicsResourceForObject=(f,l,h)=>{if(!f)return;const v=e._graphicsResources.get(f);v?.oglObject?.releaseGraphicsResources(t),e._graphicsResources.set(f,{coreObject:f,oglObject:l,hash:h,users:v?.users??new Set})},t.getGraphicsMemoryInfo=()=>{let f=0;return e._graphicsResources.forEach(l=>{let{oglObject:h}=l;f+=h.getAllocatedGPUMemoryInBytes()}),f},t.releaseGraphicsResources=()=>{e.shaderCache!==null&&e.shaderCache.releaseGraphicsResources(t),e._graphicsResources.forEach(f=>{let{oglObject:l}=f;l.releaseGraphicsResources(t)}),e._graphicsResources.clear(),e.textureUnitManager!==null&&e.textureUnitManager.freeAll(),e.renderable.getRenderersByReference().forEach(f=>{t.getViewNodeFor(f)?.releaseGraphicsResources()})};const g={...t};gF.forEach(f=>{t[f]=function(){return e.rootOpenGLRenderWindow?e.rootOpenGLRenderWindow[f](...arguments):g[f](...arguments)}})}const dF={cullFaceEnabled:!1,shaderCache:null,initialized:!1,context:null,context2D:null,canvas:null,cursorVisibility:!0,cursor:"pointer",textureUnitManager:null,textureResourceIds:null,containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,webgl2:!1,defaultToWebgl2:!0,activeFramebuffer:null,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1};function vF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dF,n),ld.extend(t,e,n),e.canvas||(e.canvas=document.createElement("canvas"),e.canvas.style.width="100%"),e.selector||(e.selector=cd.newInstance(),e.selector.setOpenGLRenderWindow(t)),e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",e._textureResourceIds=new Map,e._graphicsResources=new Map,e._glInformation=null,e.myFactory=qx.newInstance(),e.shaderCache=Jm.newInstance(),e.shaderCache.setOpenGLRenderWindow(t),e.renderPasses[0]=Vm.newInstance(),E.get(t,e,["shaderCache","textureUnitManager","webgl2","useBackgroundImage","activeFramebuffer","rootOpenGLRenderWindow"]),E.setGet(t,e,["initialized","context","context2D","canvas","renderPasses","notifyStartCaptureImage","defaultToWebgl2","cursor","useOffScreen"]),E.setGetArray(t,e,["size"],2),E.event(t,e,"imageReady"),E.event(t,e,"windowResizeEvent"),pF(t,e)}const pd=E.newInstance(vF,"vtkOpenGLRenderWindow");xf("WebGL",pd);Ft("vtkRenderWindow",pd);const Co=["setBindGroup","setIndexBuffer","setVertexBuffer","draw","drawIndexed"];function yF(t,e){e.classHierarchy.push("vtkWebGPURenderEncoder"),t.begin=n=>{e.drawCallbacks=[],e.handle=n.beginRenderPass(e.description),e.label&&e.handle.pushDebugGroup(e.label)},t.end=()=>{for(let n=0;n<e.drawCallbacks.length;n++){const r=e.drawCallbacks[n],a=r.pipeline;t.setPipeline(a);for(let s=0;s<r.callbacks.length;s++)r.callbacks[s](t)}e.label&&e.handle.popDebugGroup(),e.handle.end(),e.boundPipeline=null},t.setPipeline=n=>{if(e.boundPipeline===n)return;e.handle.setPipeline(n.getHandle());const r=n.getPipelineDescription();if(e.colorTextureViews.length!==r.fragment.targets.length)console.log(`mismatched attachment counts on pipeline ${r.fragment.targets.length} while encoder has ${e.colorTextureViews.length}`),console.trace();else for(let a=0;a<e.colorTextureViews.length;a++){const s=e.colorTextureViews[a].getTexture()?.getFormat();s&&s!==r.fragment.targets[a].format&&(console.log(`mismatched attachments for attachment ${a} on pipeline ${r.fragment.targets[a].format} while encoder has ${s}`),console.trace())}if(!e.depthTextureView!=!("depthStencil"in r))console.log("mismatched depth attachments"),console.trace();else if(e.depthTextureView){const a=e.depthTextureView.getTexture()?.getFormat();a&&a!==r.depthStencil.format&&(console.log(`mismatched depth attachments on pipeline ${r.depthStencil.format} while encoder has ${a}`),console.trace())}e.boundPipeline=n},t.replaceShaderCode=n=>{e.replaceShaderCodeFunction(n)},t.setColorTextureView=(n,r)=>{e.colorTextureViews[n]!==r&&(e.colorTextureViews[n]=r)},t.activateBindGroup=n=>{const r=e.boundPipeline.getDevice(),a=e.boundPipeline.getBindGroupLayoutCount(n.getLabel());e.handle.setBindGroup(a,n.getBindGroup(r));const s=r.getBindGroupLayoutDescription(n.getBindGroupLayout(r)),i=r.getBindGroupLayoutDescription(e.boundPipeline.getBindGroupLayout(a));s!==i&&(console.log(`renderEncoder ${e.pipelineHash} mismatched bind group layouts bind group has
${s}
 versus pipeline
${i}
`),console.trace())},t.attachTextureViews=()=>{for(let n=0;n<e.colorTextureViews.length;n++)e.description.colorAttachments[n]?e.description.colorAttachments[n].view=e.colorTextureViews[n].getHandle():e.description.colorAttachments[n]={view:e.colorTextureViews[n].getHandle()};e.depthTextureView&&(e.description.depthStencilAttachment.view=e.depthTextureView.getHandle())},t.registerDrawCallback=(n,r)=>{for(let a=0;a<e.drawCallbacks.length;a++)if(e.drawCallbacks[a].pipeline===n){e.drawCallbacks[a].callbacks.push(r);return}e.drawCallbacks.push({pipeline:n,callbacks:[r]})};for(let n=0;n<Co.length;n++)t[Co[n]]=function(){return e.handle[Co[n]](...arguments)}}const TF={description:null,handle:null,boundPipeline:null,pipelineHash:null,pipelineSettings:null,replaceShaderCodeFunction:null,depthTextureView:null,label:null};function dd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TF,n),qe(t,e),e.description={colorAttachments:[{view:void 0,loadOp:"load",storeOp:"store"}],depthStencilAttachment:{view:void 0,depthLoadOp:"clear",depthClearValue:0,depthStoreOp:"store"}},e.replaceShaderCodeFunction=r=>{const a=r.getShaderDescription("fragment");a.addOutput("vec4<f32>","outColor");let s=a.getCode();s=ae.substitute(s,"//VTK::RenderEncoder::Impl",["output.outColor = computedColor;"]).result,a.setCode(s)},e.pipelineSettings={primitive:{cullMode:"none"},depthStencil:{depthWriteEnabled:!0,depthCompare:"greater-equal",format:"depth32float"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}},e.colorTextureViews=[],ht(t,e,["boundPipeline","colorTextureViews"]),He(t,e,["depthTextureView","description","handle","label","pipelineHash","pipelineSettings","replaceShaderCodeFunction"]),yF(t,e)}const xF=Ce(dd,"vtkWebGPURenderEncoder");var hn={newInstance:xF,extend:dd};function SF(t,e){e.classHierarchy.push("vtkWebGPUOpaquePass"),t.traverse=(n,r)=>{if(e.deleted)return;e._currentParent=r;const a=r.getDevice();if(e.renderEncoder)e.colorTexture.resize(r.getCanvas().width,r.getCanvas().height),e.depthTexture.resize(r.getCanvas().width,r.getCanvas().height);else{t.createRenderEncoder(),e.colorTexture=en.newInstance({label:"opaquePassColor"}),e.colorTexture.create(a,{width:r.getCanvas().width,height:r.getCanvas().height,format:"rgba16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC});const s=e.colorTexture.createView("opaquePassColorTexture");e.renderEncoder.setColorTextureView(0,s),e.depthFormat="depth32float",e.depthTexture=en.newInstance({label:"opaquePassDepth"}),e.depthTexture.create(a,{width:r.getCanvas().width,height:r.getCanvas().height,format:e.depthFormat,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC});const i=e.depthTexture.createView("opaquePassDepthTexture");e.renderEncoder.setDepthTextureView(i)}e.renderEncoder.attachTextureViews(),t.setCurrentOperation("opaquePass"),n.setRenderEncoder(e.renderEncoder),n.traverse(t)},t.getColorTextureView=()=>e.renderEncoder.getColorTextureViews()[0],t.getDepthTextureView=()=>e.renderEncoder.getDepthTextureView(),t.createRenderEncoder=()=>{e.renderEncoder=hn.newInstance({label:"OpaquePass"}),e.renderEncoder.setPipelineHash("op")}}const CF={renderEncoder:null,colorTexture:null,depthTexture:null};function vd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CF,n),Sn.extend(t,e,n),E.get(t,e,["colorTexture","depthTexture"]),SF(t,e)}const wF=E.newInstance(vd,"vtkWebGPUOpaquePass");var EF={newInstance:wF,extend:vd};const RF=`
//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec2<i32> = vec2<i32>(i32(input.fragPos.x), i32(input.fragPos.y));
  var reveal: f32 = textureLoad(oitpAccumTexture, tcoord, 0).r;
  if (reveal == 1.0) { discard; }
  var tcolor: vec4<f32> = textureLoad(oitpColorTexture, tcoord, 0);
  var total: f32 = max(tcolor.a, 0.01);
  var computedColor: vec4<f32> = vec4<f32>(tcolor.r/total, tcolor.g/total, tcolor.b/total, 1.0 - reveal);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function MF(t,e){e.classHierarchy.push("vtkWebGPUOrderIndependentTranslucentPass"),t.traverse=(n,r)=>{if(e.deleted)return;e._currentParent=r;const a=r.getDevice();if(e.translucentRenderEncoder)e.translucentColorTexture.resizeToMatch(e.colorTextureView.getTexture()),e.translucentAccumulateTexture.resizeToMatch(e.colorTextureView.getTexture());else{t.createRenderEncoder(),t.createFinalEncoder(),e.translucentColorTexture=en.newInstance({label:"translucentPassColor"}),e.translucentColorTexture.create(a,{width:r.getCanvas().width,height:r.getCanvas().height,format:"rgba16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});const s=e.translucentColorTexture.createView("oitpColorTexture");e.translucentRenderEncoder.setColorTextureView(0,s),e.translucentAccumulateTexture=en.newInstance({label:"translucentPassAccumulate"}),e.translucentAccumulateTexture.create(a,{width:r.getCanvas().width,height:r.getCanvas().height,format:"r16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});const i=e.translucentAccumulateTexture.createView("oitpAccumTexture");e.translucentRenderEncoder.setColorTextureView(1,i),e.fullScreenQuad=jr.newInstance(),e.fullScreenQuad.setDevice(r.getDevice()),e.fullScreenQuad.setPipelineHash("oitpfsq"),e.fullScreenQuad.setTextureViews(e.translucentRenderEncoder.getColorTextureViews()),e.fullScreenQuad.setFragmentShaderTemplate(RF)}e.translucentRenderEncoder.setDepthTextureView(e.depthTextureView),e.translucentRenderEncoder.attachTextureViews(),t.setCurrentOperation("translucentPass"),n.setRenderEncoder(e.translucentRenderEncoder),n.traverse(t),t.finalPass(r,n)},t.finalPass=(n,r)=>{e.translucentFinalEncoder.setColorTextureView(0,e.colorTextureView),e.translucentFinalEncoder.attachTextureViews(),e.translucentFinalEncoder.begin(n.getCommandEncoder()),r.scissorAndViewport(e.translucentFinalEncoder),e.fullScreenQuad.prepareAndDraw(e.translucentFinalEncoder),e.translucentFinalEncoder.end()},t.getTextures=()=>[e.translucentColorTexture,e.translucentAccumulateTexture],t.createRenderEncoder=()=>{e.translucentRenderEncoder=hn.newInstance({label:"translucentRender"});const n=e.translucentRenderEncoder.getDescription();n.colorAttachments=[{view:void 0,clearValue:[0,0,0,0],loadOp:"clear",storeOp:"store"},{view:void 0,clearValue:[1,0,0,0],loadOp:"clear",storeOp:"store"}],n.depthStencilAttachment={view:void 0,depthLoadOp:"load",depthStoreOp:"store"},e.translucentRenderEncoder.setReplaceShaderCodeFunction(r=>{const a=r.getShaderDescription("fragment");a.addOutput("vec4<f32>","outColor"),a.addOutput("f32","outAccum"),a.addBuiltinInput("vec4<f32>","@builtin(position) fragPos");let s=a.getCode();s=ae.substitute(s,"//VTK::RenderEncoder::Impl",["var w: f32 = computedColor.a * pow(0.1 + input.fragPos.z, 2.0);","output.outColor = vec4<f32>(computedColor.rgb*w, w);","output.outAccum = computedColor.a;"]).result,a.setCode(s)}),e.translucentRenderEncoder.setPipelineHash("oitpr"),e.translucentRenderEncoder.setPipelineSettings({primitive:{cullMode:"none"},depthStencil:{depthWriteEnabled:!1,depthCompare:"greater",format:"depth32float"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"one",dstFactor:"one"},alpha:{srcFactor:"one",dstFactor:"one"}}},{format:"r16float",blend:{color:{srcFactor:"zero",dstFactor:"one-minus-src"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.createFinalEncoder=()=>{e.translucentFinalEncoder=hn.newInstance({label:"translucentFinal"}),e.translucentFinalEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e.translucentFinalEncoder.setReplaceShaderCodeFunction(n=>{const r=n.getShaderDescription("fragment");r.addOutput("vec4<f32>","outColor"),r.addBuiltinInput("vec4<f32>","@builtin(position) fragPos");let a=r.getCode();a=ae.substitute(a,"//VTK::RenderEncoder::Impl",["output.outColor = vec4<f32>(computedColor.rgb, computedColor.a);"]).result,r.setCode(a)}),e.translucentFinalEncoder.setPipelineHash("oitpf"),e.translucentFinalEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})}}const OF={colorTextureView:null,depthTextureView:null};function yd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,OF,n),Sn.extend(t,e,n),E.setGet(t,e,["colorTextureView","depthTextureView"]),MF(t,e)}const DF=E.newInstance(yd,"vtkWebGPUOrderIndependentTranslucentPass");var LF={newInstance:DF,extend:yd};const Dr={COMPOSITE_BLEND:0,MAXIMUM_INTENSITY_BLEND:1,MINIMUM_INTENSITY_BLEND:2,AVERAGE_INTENSITY_BLEND:3,ADDITIVE_INTENSITY_BLEND:4},VF=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::Volume::TraverseDec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

fn getTextureValue(vTex: texture_3d<f32>, tpos: vec4<f32>) -> f32
{
  // todo multicomponent support
  return textureSampleLevel(vTex, clampSampler, tpos.xyz, 0.0).r;
}

fn getGradient(vTex: texture_3d<f32>, tpos: vec4<f32>, vNum: i32, scalar: f32) -> vec4<f32>
{
  var result: vec4<f32>;

  var tstep: vec4<f32> = volumeSSBO.values[vNum].tstep;
  result.x = getTextureValue(vTex, tpos + vec4<f32>(tstep.x, 0.0, 0.0, 1.0)) - scalar;
  result.y = getTextureValue(vTex, tpos + vec4<f32>(0.0, tstep.y, 0.0, 1.0)) - scalar;
  result.z = getTextureValue(vTex, tpos + vec4<f32>(0.0, 0.0, tstep.z, 1.0)) - scalar;
  result.w = 0.0;

  // divide by spacing as that is our delta
  result = result / volumeSSBO.values[vNum].spacing;
  // now we have a gradient in unit tcoords

  var grad: f32 = length(result.xyz);
  if (grad > 0.0)
  {
    // rotate to View Coords, needed for lighting and shading
    var nMat: mat4x4<f32> = rendererUBO.SCVCMatrix * volumeSSBO.values[vNum].planeNormals;
    result = nMat * result;
    result = result / length(result);
  }

  // store gradient magnitude in .w
  result.w = grad;

  return result;
}

fn processVolume(vTex: texture_3d<f32>, vNum: i32, cNum: i32, posSC: vec4<f32>, tfunRows: f32) -> vec4<f32>
{
  var outColor: vec4<f32> = vec4<f32>(0.0, 0.0, 0.0, 0.0);

  // convert to tcoords and reject if outside the volume
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*posSC;
  if (tpos.x < 0.0 || tpos.y < 0.0 || tpos.z < 0.0 ||
      tpos.x > 1.0 || tpos.y > 1.0 || tpos.z > 1.0) { return outColor; }

  var scalar: f32 = getTextureValue(vTex, tpos);

  var coord: vec2<f32> =
    vec2<f32>(scalar * componentSSBO.values[cNum].cScale + componentSSBO.values[cNum].cShift,
      (0.5 + 2.0 * f32(vNum)) / tfunRows);
  var color: vec4<f32> = textureSampleLevel(tfunTexture, clampSampler, coord, 0.0);

  var gofactor: f32 = 1.0;
  var normal: vec4<f32> = vec4<f32>(0.0,0.0,0.0,0.0);
  if (componentSSBO.values[cNum].gomin <  1.0 || volumeSSBO.values[vNum].shade[0] > 0.0)
  {
    normal = getGradient(vTex, tpos, vNum, scalar);
    if (componentSSBO.values[cNum].gomin <  1.0)
    {
      gofactor = clamp(normal.a*componentSSBO.values[cNum].goScale + componentSSBO.values[cNum].goShift,
      componentSSBO.values[cNum].gomin, componentSSBO.values[cNum].gomax);
    }
  }

  coord.x = (scalar * componentSSBO.values[cNum].oScale + componentSSBO.values[cNum].oShift);
  var opacity: f32 = textureSampleLevel(ofunTexture, clampSampler, coord, 0.0).r;

  if (volumeSSBO.values[vNum].shade[0] > 0.0)
  {
    color = color*abs(normal.z);
  }

  outColor = vec4<f32>(color.rgb, gofactor * opacity);

  return outColor;
}

// adjust the start and end point of a raycast such that it intersects the unit cube.
// This function is used to take a raycast starting point and step vector
// and numSteps and return the startijng and ending steps for intersecting the
// unit cube. Recall for a 3D texture, the unit cube is the range of texture coordsinates
// that have valid values. So this funtion can be used to take a ray in texture coordinates
// and bound it to intersecting the texture.
//
fn adjustBounds(tpos: vec4<f32>, tstep: vec4<f32>, numSteps: f32) -> vec2<f32>
{
  var result: vec2<f32> = vec2<f32>(0.0, numSteps);
  var tpos2: vec4<f32> = tpos + tstep*numSteps;

  // move tpos to the start of the volume
  var adjust: f32 =
    min(
      max(tpos.x/tstep.x, (tpos.x - 1.0)/tstep.x),
      min(
        max((tpos.y - 1.0)/tstep.y, tpos.y/tstep.y),
        max((tpos.z - 1.0)/tstep.z, tpos.z/tstep.z)));
  if (adjust < 0.0)
  {
    result.x = result.x - adjust;
  }

  // adjust length to the end
  adjust =
    max(
      min(tpos2.x/tstep.x, (tpos2.x - 1.0)/tstep.x),
      max(
        min((tpos2.y - 1.0)/tstep.y, tpos2.y/tstep.y),
        min((tpos2.z - 1.0)/tstep.z, tpos2.z/tstep.z)));
  if (adjust > 0.0)
  {
    result.y = result.y - adjust;
  }

  return result;
}

fn getSimpleColor(scalar: f32, vNum: i32, cNum: i32) -> vec4<f32>
{
  // how many rows (tfuns) do we have in our tfunTexture
  var tfunRows: f32 = f32(textureDimensions(tfunTexture).y);

  var coord: vec2<f32> =
    vec2<f32>(scalar * componentSSBO.values[cNum].cScale + componentSSBO.values[cNum].cShift,
      (0.5 + 2.0 * f32(vNum)) / tfunRows);
  var color: vec4<f32> = textureSampleLevel(tfunTexture, clampSampler, coord, 0.0);
  coord.x = (scalar * componentSSBO.values[cNum].oScale + componentSSBO.values[cNum].oShift);
  var opacity: f32 = textureSampleLevel(ofunTexture, clampSampler, coord, 0.0).r;
  return vec4<f32>(color.rgb, opacity);
}

fn traverseMax(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var maxVal: f32 = -1.0e37;
  loop
  {
    var scalar: f32 = getTextureValue(vTex, tpos);
    if (scalar > maxVal)
    {
      maxVal = scalar;
    }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(maxVal, vNum, cNum);
}

fn traverseMin(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var minVal: f32 = 1.0e37;
  loop
  {
    var scalar: f32 = getTextureValue(vTex, tpos);
    if (scalar < minVal)
    {
      minVal = scalar;
    }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(minVal, vNum, cNum);
}

fn traverseAverage(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  let ipRange: vec4<f32> = volumeSSBO.values[vNum].ipScalarRange;
  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var avgVal: f32 = 0.0;
  var sampleCount: f32 = 0.0;
  loop
  {
    var sample: f32 = getTextureValue(vTex, tpos);
    // right now leave filtering off until WebGL changes get merged
    // if (ipRange.z == 0.0 || sample >= ipRange.x && sample <= ipRange.y)
    // {
      avgVal = avgVal + sample;
      sampleCount = sampleCount + 1.0;
    // }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  if (sampleCount <= 0.0)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(avgVal/sampleCount, vNum, cNum);
}

fn traverseAdditive(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  let ipRange: vec4<f32> = volumeSSBO.values[vNum].ipScalarRange;
  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var sumVal: f32 = 0.0;
  loop
  {
    var sample: f32 = getTextureValue(vTex, tpos);
    // right now leave filtering off until WebGL changes get merged
    // if (ipRange.z == 0.0 || sample >= ipRange.x && sample <= ipRange.y)
    // {
      sumVal = sumVal + sample;
    // }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(sumVal, vNum, cNum);
}

fn composite(rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>) -> vec4<f32>
{
  // initial ray position is at the beginning
  var rayPosSC: vec4<f32> = minPosSC;

  // how many rows (tfuns) do we have in our tfunTexture
  var tfunRows: f32 = f32(textureDimensions(tfunTexture).y);

  var curDist: f32 = 0.0;
  var computedColor: vec4<f32> = vec4<f32>(0.0, 0.0, 0.0, 0.0);
  var sampleColor: vec4<f32>;
//VTK::Volume::TraverseCalls

  loop
  {
    // for each volume, sample and accumulate color
//VTK::Volume::CompositeCalls

    // increment position
    curDist = curDist + mapperUBO.SampleDistance;
    rayPosSC = rayPosSC + rayStepSC;

    // check if we have reached a terminating condition
    if (curDist > rayLengthSC) { break; }
    if (computedColor.a > 0.98) { break; }
  }
  return computedColor;
}

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var rayMax: f32 = textureSampleLevel(maxTexture, clampSampler, input.tcoordVS, 0.0).r;
  var rayMin: f32 = textureSampleLevel(minTexture, clampSampler, input.tcoordVS, 0.0).r;

  // discard empty rays
  if (rayMax <= rayMin) { discard; }
  else
  {
    // compute start and end ray positions in view coordinates
    var minPosSC: vec4<f32> = rendererUBO.PCSCMatrix*vec4<f32>(2.0 * input.tcoordVS.x - 1.0, 1.0 - 2.0 * input.tcoordVS.y, rayMax, 1.0);
    minPosSC = minPosSC * (1.0 / minPosSC.w);
    var maxPosSC: vec4<f32> = rendererUBO.PCSCMatrix*vec4<f32>(2.0 * input.tcoordVS.x - 1.0, 1.0 - 2.0 * input.tcoordVS.y, rayMin, 1.0);
    maxPosSC = maxPosSC * (1.0 / maxPosSC.w);

    var rayLengthSC: f32 = distance(minPosSC.xyz, maxPosSC.xyz);
    var rayStepSC: vec4<f32> = (maxPosSC - minPosSC)*(mapperUBO.SampleDistance/rayLengthSC);
    rayStepSC.w = 0.0;

    var computedColor: vec4<f32>;

//VTK::Volume::Loop

//VTK::RenderEncoder::Impl
  }

  return output;
}
`,st=new Float64Array(16),On=new Float64Array(16);function mF(t,e){e.classHierarchy.push("vtkWebGPUVolumePassFSQ"),t.replaceShaderPosition=(a,s,i)=>{const o=s.getShaderDescription("vertex");o.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let c=o.getCode();c=ae.substitute(c,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);"]).result,o.setCode(c),s.getShaderDescription("fragment").addBuiltinInput("vec4<f32>","@builtin(position) fragPos")},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderVolume=(a,s,i)=>{const o=s.getShaderDescription("fragment");let c=o.getCode();const u=[],g=[];for(let l=0;l<e.volumes.length;l++)e.volumes[l].getRenderable().getMapper().getBlendMode()===Dr.COMPOSITE_BLEND?(u.push(`    sampleColor = processVolume(volTexture${l}, ${l}, ${e.rowStarts[l]}, rayPosSC, tfunRows);`),u.push(`    computedColor = vec4<f32>(
          sampleColor.a * sampleColor.rgb * (1.0 - computedColor.a) + computedColor.rgb,
          (1.0 - computedColor.a)*sampleColor.a + computedColor.a);`)):(g.push(`  sampleColor = traverseVals[${l}];`),g.push(`  computedColor = vec4<f32>(
          sampleColor.a * sampleColor.rgb * (1.0 - computedColor.a) + computedColor.rgb,
          (1.0 - computedColor.a)*sampleColor.a + computedColor.a);`));c=ae.substitute(c,"//VTK::Volume::CompositeCalls",u).result,c=ae.substitute(c,"//VTK::Volume::TraverseCalls",g).result,c=ae.substitute(c,"//VTK::Volume::TraverseDec",[`var<private> traverseVals: array<vec4<f32>,${e.volumes.length}>;`]).result;let f=!1;for(let l=0;l<e.volumes.length;l++){const h=e.volumes[l].getRenderable().getMapper().getBlendMode();h===Dr.COMPOSITE_BLEND?f=!0:h===Dr.MAXIMUM_INTENSITY_BLEND?c=ae.substitute(c,"//VTK::Volume::Loop",[`    traverseMax(volTexture${l}, ${l}, ${l}, rayLengthSC, minPosSC, rayStepSC);`,`    computedColor = traverseVals[${l}];`,"//VTK::Volume::Loop"]).result:h===Dr.MINIMUM_INTENSITY_BLEND?c=ae.substitute(c,"//VTK::Volume::Loop",[`    traverseMin(volTexture${l}, ${l}, ${l}, rayLengthSC, minPosSC, rayStepSC);`,`    computedColor = traverseVals[${l}];`,"//VTK::Volume::Loop"]).result:h===Dr.AVERAGE_INTENSITY_BLEND?c=ae.substitute(c,"//VTK::Volume::Loop",[`    traverseAverage(volTexture${l}, ${l}, ${l}, rayLengthSC, minPosSC, rayStepSC);`,`    computedColor = traverseVals[${l}];`,"//VTK::Volume::Loop"]).result:h===Dr.ADDITIVE_INTENSITY_BLEND&&(c=ae.substitute(c,"//VTK::Volume::Loop",[`    traverseAdditive(volTexture${l}, ${l}, ${l}, rayLengthSC, minPosSC, rayStepSC);`,`    computedColor = traverseVals[${l}];`,"//VTK::Volume::Loop"]).result)}f&&(c=ae.substitute(c,"//VTK::Volume::Loop",["    computedColor = composite(rayLengthSC, minPosSC, rayStepSC);"]).result),o.setCode(c)},e.shaderReplacements.set("replaceShaderVolume",t.replaceShaderVolume),t.updateLUTImage=a=>{let s=t.getMTime();for(let f=0;f<e.volumes.length;f++){const l=e.volumes[f].getRenderable(),h=l.getMapper().getInputData();s=Math.max(s,l.getMTime(),h.getMTime())}if(s<e.lutBuildTime.getMTime())return;e.numRows=0,e.rowStarts=[];for(let f=0;f<e.volumes.length;f++){e.rowStarts.push(e.numRows);const h=e.volumes[f].getRenderable(),v=h.getMapper(),p=h.getProperty(),d=v.getInputData(),S=(d.getPointData()&&d.getPointData().getScalars()).getNumberOfComponents(),T=p.getIndependentComponents()?S:1;e.numRows+=T}const i=new Uint8ClampedArray(e.numRows*2*e.rowLength*4),o=new Float32Array(e.numRows*2*e.rowLength);let c=0;const u=new Float32Array(e.rowLength*3),g=e.rowLength;for(let f=0;f<e.volumes.length;f++){const h=e.volumes[f].getRenderable(),v=h.getMapper(),p=h.getProperty(),d=v.getInputData(),S=(d.getPointData()&&d.getPointData().getScalars()).getNumberOfComponents(),T=p.getIndependentComponents()?S:1;for(let w=0;w<T;++w){const C=p.getRGBTransferFunction(w),R=C.getRange();C.getTable(R[0],R[1],g,u,1);let M=c*g*4;for(let F=0;F<g;++F){i[M+F*4]=255*u[F*3],i[M+F*4+1]=255*u[F*3+1],i[M+F*4+2]=255*u[F*3+2],i[M+F*4+3]=255;for(let B=0;B<4;B++)i[M+(g+F)*4+B]=i[M+F*4+B]}const m=p.getScalarOpacity(w),L=e.sampleDist/p.getScalarOpacityUnitDistance(w),V=m.getRange();m.getTable(V[0],V[1],g,u,1),M=c*g;for(let F=0;F<g;++F)o[M+F]=1-(1-u[F])**L,o[M+F+g]=o[M+F];c+=2}}{const f={nativeArray:i,width:e.rowLength,height:e.numRows*2,depth:1,format:"rgba8unorm"},h=a.getTextureManager().getTexture(f).createView("tfunTexture");e.textureViews[2]=h}{const f={nativeArray:o,width:e.rowLength,height:e.numRows*2,depth:1,format:"r16float"},h=a.getTextureManager().getTexture(f).createView("ofunTexture");e.textureViews[3]=h}e.lutBuildTime.modified()},t.updateSSBO=a=>{let s=Math.max(t.getMTime(),e.WebGPURenderer.getStabilizedTime());for(let C=0;C<e.volumes.length;C++){const R=e.volumes[C].getRenderable(),M=R.getMapper(),m=M.getInputData();s=Math.max(s,R.getMTime(),m.getMTime(),M.getMTime())}if(s<e.SSBO.getSendTime())return;const i=e.WebGPURenderer.getStabilizedCenterByReference();e.SSBO.clearData(),e.SSBO.setNumberOfInstances(e.volumes.length);const o=new Float64Array(e.volumes.length*16),c=new Float64Array(e.volumes.length*16),u=new Float64Array(e.volumes.length*4),g=new Float64Array(e.volumes.length*4),f=new Float64Array(e.volumes.length*4),l=new Float64Array(e.volumes.length*4);for(let C=0;C<e.volumes.length;C++){const M=e.volumes[C].getRenderable(),L=M.getMapper().getInputData();ue(st),Ue(st,st,i);const V=M.getMatrix();Oe(On,V),ut(On,On),Ne(st,On,st);const F=L.getWorldToIndex();Ne(st,F,st);const B=L.getDimensions();ue(On),lr(On,On,[1/B[0],1/B[1],1/B[2]]),Ne(st,On,st);for(let A=0;A<16;A++)o[C*16+A]=st[A];ut(st,st);for(let A=0;A<4;A++)c[C*16+A*4]=st[A*4],c[C*16+A*4+1]=st[A*4+1],c[C*16+A*4+2]=st[A*4+2],c[C*16+A*4+3]=0;u[C*4]=1/B[0],u[C*4+1]=1/B[1],u[C*4+2]=1/B[2],u[C*4+3]=1,g[C*4]=M.getProperty().getShade()?1:0;const _=L.getSpacing();f[C*4]=_[0],f[C*4+1]=_[1],f[C*4+2]=_[2],f[C*4+3]=1;const P=e.textureViews[C+4].getTexture().getScale(),z=M.getProperty().getIpScalarRange();l[C*4]=z[0]/P,l[C*4+1]=z[1]/P,l[C*4+2]=M.getProperty().getFilterMode()}e.SSBO.addEntry("SCTCMatrix","mat4x4<f32>"),e.SSBO.addEntry("planeNormals","mat4x4<f32>"),e.SSBO.addEntry("shade","vec4<f32>"),e.SSBO.addEntry("tstep","vec4<f32>"),e.SSBO.addEntry("spacing","vec4<f32>"),e.SSBO.addEntry("ipScalarRange","vec4<f32>"),e.SSBO.setAllInstancesFromArray("SCTCMatrix",o),e.SSBO.setAllInstancesFromArray("planeNormals",c),e.SSBO.setAllInstancesFromArray("shade",g),e.SSBO.setAllInstancesFromArray("tstep",u),e.SSBO.setAllInstancesFromArray("spacing",f),e.SSBO.setAllInstancesFromArray("ipScalarRange",l),e.SSBO.send(a),e.componentSSBO.clearData(),e.componentSSBO.setNumberOfInstances(e.numRows);const h=new Float64Array(e.numRows),v=new Float64Array(e.numRows),p=new Float64Array(e.numRows),d=new Float64Array(e.numRows),y=new Float64Array(e.numRows),S=new Float64Array(e.numRows),x=new Float64Array(e.numRows),T=new Float64Array(e.numRows);let w=0;for(let C=0;C<e.volumes.length;C++){const M=e.volumes[C].getRenderable(),m=M.getMapper(),L=M.getProperty(),V=m.getInputData(),B=(V.getPointData()&&V.getPointData().getScalars()).getNumberOfComponents(),_=L.getIndependentComponents(),P=e.textureViews[C+4].getTexture().getFormat(),z=Xe.getDetailsFromTextureFormat(P),A=z.elementSize===2&&z.sampleType==="float",I={scale:[255],offset:[0]};A&&(I.scale[0]=1);for(let k=0;k<B;k++){const Y=_?k:0,te=I.scale[k],q=L.getScalarOpacity(Y).getRange(),pt=te/(q[1]-q[0]),Ae=(I.offset[k]-q[0])/(q[1]-q[0]);d[w]=Ae,p[w]=pt;const $e=L.getRGBTransferFunction(Y).getRange();if(v[w]=(I.offset[k]-$e[0])/($e[1]-$e[0]),h[w]=te/($e[1]-$e[0]),L.getUseGradientOpacity(Y)){const Je=L.getGradientOpacityMinimumOpacity(Y),je=L.getGradientOpacityMaximumOpacity(Y);y[w]=Je,S[w]=je;const Cn=[L.getGradientOpacityMinimumValue(Y),L.getGradientOpacityMaximumValue(Y)];T[w]=te*(je-Je)/(Cn[1]-Cn[0]),x[w]=-Cn[0]*(je-Je)/(Cn[1]-Cn[0])+Je}else y[w]=1,S[w]=1,T[w]=0,x[w]=1;w++}}e.componentSSBO.addEntry("cScale","f32"),e.componentSSBO.addEntry("cShift","f32"),e.componentSSBO.addEntry("oScale","f32"),e.componentSSBO.addEntry("oShift","f32"),e.componentSSBO.addEntry("goShift","f32"),e.componentSSBO.addEntry("goScale","f32"),e.componentSSBO.addEntry("gomin","f32"),e.componentSSBO.addEntry("gomax","f32"),e.componentSSBO.setAllInstancesFromArray("cScale",h),e.componentSSBO.setAllInstancesFromArray("cShift",v),e.componentSSBO.setAllInstancesFromArray("oScale",p),e.componentSSBO.setAllInstancesFromArray("oShift",d),e.componentSSBO.setAllInstancesFromArray("goScale",T),e.componentSSBO.setAllInstancesFromArray("goShift",x),e.componentSSBO.setAllInstancesFromArray("gomin",y),e.componentSSBO.setAllInstancesFromArray("gomax",S),e.componentSSBO.send(a)};const n=t.updateBuffers;t.updateBuffers=()=>{n();let a=e.volumes[0].getRenderable().getMapper().getSampleDistance();for(let s=0;s<e.volumes.length;s++){const c=e.volumes[s].getRenderable().getMapper().getSampleDistance();c<a&&(a=c)}e.sampleDist!==a&&(e.sampleDist=a,e.UBO.setValue("SampleDistance",a),e.UBO.sendIfNeeded(e.device));for(let s=0;s<e.volumes.length;s++){const u=e.volumes[s].getRenderable().getMapper().getInputData(),g=e.device.getTextureManager().getTextureForImageData(u);if(!e.textureViews[s+4]||e.textureViews[s+4].getTexture()!==g){const f=g.createView(`volTexture${s}`);e.textureViews[s+4]=f}}if(e.volumes.length<e.lastVolumeLength)for(let s=e.volumes.length;s<e.lastVolumeLength;s++)e.textureViews.pop();e.lastVolumeLength=e.volumes.length,t.updateLUTImage(e.device),t.updateSSBO(e.device),e.clampSampler||(e.clampSampler=Tf.newInstance({label:"clampSampler"}),e.clampSampler.create(e.device,{minFilter:"linear",magFilter:"linear"}))},t.computePipelineHash=()=>{e.pipelineHash="volfsq";for(let a=0;a<e.volumes.length;a++){const s=e.volumes[a].getRenderable().getMapper().getBlendMode();e.pipelineHash+=`${s}`}},t.setVolumes=a=>{if(!e.volumes||e.volumes.length!==a.length){e.volumes=[...a],t.modified();return}for(let s=0;s<a.length;s++)if(a[s]!==e.volumes[s]){e.volumes=[...a],t.modified();return}};const r=t.getBindables;t.getBindables=()=>{const a=r();return a.push(e.componentSSBO),a.push(e.clampSampler),a}}const FF={volumes:null,rowLength:1024,lastVolumeLength:0};function Td(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,FF,n),jr.extend(t,e,n),e.fragmentShaderTemplate=VF,e.UBO=gr.newInstance({label:"mapperUBO"}),e.UBO.addEntry("SampleDistance","f32"),e.SSBO=ic.newInstance({label:"volumeSSBO"}),e.componentSSBO=ic.newInstance({label:"componentSSBO"}),e.lutBuildTime={},E.obj(e.lutBuildTime,{mtime:0}),mF(t,e)}const BF=E.newInstance(Td,"vtkWebGPUVolumePassFSQ");var _F={newInstance:BF,extend:Td};const{Representation:UF}=Yr,{BufferUsage:Xg,PrimitiveTypes:NF}=Cr,wo=[[0,4,6],[0,6,2],[1,3,7],[1,7,5],[0,5,4],[0,1,5],[2,6,7],[2,7,3],[0,3,1],[0,2,3],[4,5,7],[4,7,6]],kF=`
//VTK::Renderer::Dec

//VTK::Select::Dec

//VTK::VolumePass::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Select::Impl

  //VTK::TCoord::Impl

  //VTK::VolumePass::Impl

  // use the maximum (closest) of the current value and the zbuffer
  // the blend func will then take the min to find the farthest stop value
  var stopval: f32 = max(input.fragPos.z, textureLoad(opaquePassDepthTexture, vec2<i32>(i32(input.fragPos.x), i32(input.fragPos.y)), 0));

  //VTK::RenderEncoder::Impl
  return output;
}
`,GF=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = textureSample(volumePassColorTexture,
    volumePassColorTextureSampler, mapperUBO.tscale*input.tcoordVS);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function bF(t,e){e.classHierarchy.push("vtkWebGPUVolumePass"),t.initialize=n=>{e._clearEncoder||t.createClearEncoder(n),e._mergeEncoder||t.createMergeEncoder(n),e._copyEncoder||t.createCopyEncoder(n),e._depthRangeEncoder||t.createDepthRangeEncoder(n),e.fullScreenQuad||(e.fullScreenQuad=_F.newInstance(),e.fullScreenQuad.setDevice(n.getDevice()),e.fullScreenQuad.setTextureViews([...e._depthRangeEncoder.getColorTextureViews()])),e._volumeCopyQuad||(e._volumeCopyQuad=jr.newInstance(),e._volumeCopyQuad.setPipelineHash("volpassfsq"),e._volumeCopyQuad.setDevice(n.getDevice()),e._volumeCopyQuad.setFragmentShaderTemplate(GF),e._copyUBO=gr.newInstance({label:"mapperUBO"}),e._copyUBO.addEntry("tscale","vec2<f32>"),e._volumeCopyQuad.setUBO(e._copyUBO),e._volumeCopyQuad.setTextureViews([e._colorTextureView]))},t.traverse=(n,r)=>{if(e.deleted)return;e._currentParent=r,t.initialize(r),t.computeTiming(r),t.renderDepthBounds(n,r),e._firstGroup=!0;const a=r.getDevice(),s=a.getHandle().limits.maxSampledTexturesPerShaderStage-4;if(e.volumes.length>s){const i=n.getRenderable().getActiveCamera().getPosition(),o=[];for(let f=0;f<e.volumes.length;f++){const l=e.volumes[f].getRenderable().getBounds(),h=[.5*(l[1]+l[0]),.5*(l[3]+l[2]),.5*(l[5]+l[4])];o[f]=Tt(h,i)}const c=[...Array(e.volumes.length).keys()];c.sort((f,l)=>o[l]-o[f]);let u=[],g=c.length%s;for(let f=0;f<c.length;f++)u.push(e.volumes[c[f]]),u.length>=g&&(t.rayCastPass(r,n,u),u=[],g=s,e._firstGroup=!1)}else t.rayCastPass(r,n,e.volumes);if(e._volumeCopyQuad.setWebGPURenderer(n),e._useSmallViewport){const i=e._colorTextureView.getTexture().getWidth(),o=e._colorTextureView.getTexture().getHeight();e._copyUBO.setArray("tscale",[e._smallViewportWidth/i,e._smallViewportHeight/o])}else e._copyUBO.setArray("tscale",[1,1]);e._copyUBO.sendIfNeeded(a),e._copyEncoder.setColorTextureView(0,e.colorTextureView),e._copyEncoder.attachTextureViews(),e._copyEncoder.begin(r.getCommandEncoder()),n.scissorAndViewport(e._copyEncoder),e._volumeCopyQuad.prepareAndDraw(e._copyEncoder),e._copyEncoder.end()},t.delete=E.chain(()=>{e._animationRateSubscription&&(e._animationRateSubscription.unsubscribe(),e._animationRateSubscription=null)},t.delete),t.computeTiming=n=>{const r=n.getRenderable().getInteractor();if(e._lastScale==null){const a=e.volumes[0].getRenderable().getMapper();e._lastScale=a.getInitialInteractionScale()||1}e._useSmallViewport=!1,r.isAnimating()&&e._lastScale>1.5&&(e._useSmallViewport=!0),e._colorTexture.resize(n.getCanvas().width,n.getCanvas().height),e._animationRateSubscription||(e._animationRateSubscription=r.onAnimationFrameRateUpdate(()=>{const a=e.volumes[0].getRenderable().getMapper();if(a.getAutoAdjustSampleDistances()){const s=r.getRecentAnimationFrameRate(),i=e._lastScale*r.getDesiredUpdateRate()/s;e._lastScale=i,e._lastScale>400&&(e._lastScale=400)}else e._lastScale=a.getImageSampleDistance()*a.getImageSampleDistance();e._lastScale<1.5&&(e._lastScale=1.5)}))},t.rayCastPass=(n,r,a)=>{const s=e._firstGroup?e._clearEncoder:e._mergeEncoder;s.attachTextureViews(),s.begin(n.getCommandEncoder());let i=e._colorTextureView.getTexture().getWidth(),o=e._colorTextureView.getTexture().getHeight();if(e._useSmallViewport){const c=n.getCanvas(),u=1/Math.sqrt(e._lastScale);e._smallViewportWidth=Math.ceil(u*c.width),e._smallViewportHeight=Math.ceil(u*c.height),i=e._smallViewportWidth,o=e._smallViewportHeight}s.getHandle().setViewport(0,0,i,o,0,1),s.getHandle().setScissorRect(0,0,i,o),e.fullScreenQuad.setWebGPURenderer(r),e.fullScreenQuad.setVolumes(a),e.fullScreenQuad.prepareAndDraw(s),s.end()},t.renderDepthBounds=(n,r)=>{t.updateDepthPolyData(n);const a=e._boundsPoly,s=a.getPoints(),i=a.getPolys();let o={hash:`vp${i.getMTime()}`,usage:Xg.Index,cells:i,numberOfPoints:s.getNumberOfPoints(),primitiveType:NF.Triangles,representation:UF.SURFACE};const c=r.getDevice().getBufferManager().getBuffer(o);e._mapper.getVertexInput().setIndexBuffer(c),o={usage:Xg.PointArray,format:"float32x4",hash:`vp${s.getMTime()}${i.getMTime()}`,dataArray:s,indexBuffer:c,packExtra:!0};const u=r.getDevice().getBufferManager().getBuffer(o);e._mapper.getVertexInput().addBuffer(u,["vertexBC"]),e._mapper.setNumberOfVertices(u.getSizeInBytes()/u.getStrideInBytes()),t.drawDepthRange(n,r)},t.updateDepthPolyData=n=>{let r=!1;for(let g=0;g<e.volumes.length;g++){const f=e.volumes[g].getMTime();(!e._lastMTimes[g]||f!==e._lastMTimes[g])&&(r=!0,e._lastMTimes[g]=f)}const a=n.getStabilizedTime();if((e._lastMTimes.length<=e.volumes.length||a!==e._lastMTimes[e.volumes.length])&&(r=!0,e._lastMTimes[e.volumes.length]=a),!r)return;const s=n.getStabilizedCenterByReference(),i=e.volumes.length*8,o=new Float64Array(i*3),c=e.volumes.length*12,u=new Uint16Array(c*4);for(let g=0;g<e.volumes.length;g++){e.volumes[g].getBoundingCubePoints(o,g*24);let f=g*12*4;const l=g*8;for(let h=0;h<12;h++)u[f++]=3,u[f++]=l+wo[h][0],u[f++]=l+wo[h][1],u[f++]=l+wo[h][2]}for(let g=0;g<o.length;g+=3)o[g]-=s[0],o[g+1]-=s[1],o[g+2]-=s[2];e._boundsPoly.getPoints().setData(o,3),e._boundsPoly.getPoints().modified(),e._boundsPoly.getPolys().setData(u,1),e._boundsPoly.getPolys().modified(),e._boundsPoly.modified()},t.drawDepthRange=(n,r)=>{e._depthRangeTexture.resizeToMatch(e.colorTextureView.getTexture()),e._depthRangeTexture2.resizeToMatch(e.colorTextureView.getTexture()),e._depthRangeEncoder.attachTextureViews(),t.setCurrentOperation("volumeDepthRangePass"),n.setRenderEncoder(e._depthRangeEncoder),n.volumeDepthRangePass(!0),e._mapper.setWebGPURenderer(n),e._mapper.prepareToDraw(e._depthRangeEncoder),e._mapper.registerDrawCallback(e._depthRangeEncoder),n.volumeDepthRangePass(!1)},t.createDepthRangeEncoder=n=>{const r=n.getDevice();e._depthRangeEncoder=hn.newInstance({label:"VolumePass DepthRange"}),e._depthRangeEncoder.setPipelineHash("volr"),e._depthRangeEncoder.setReplaceShaderCodeFunction(i=>{const o=i.getShaderDescription("fragment");o.addOutput("vec4<f32>","outColor1"),o.addOutput("vec4<f32>","outColor2");let c=o.getCode();c=ae.substitute(c,"//VTK::RenderEncoder::Impl",["output.outColor1 = vec4<f32>(input.fragPos.z, 0.0, 0.0, 0.0);","output.outColor2 = vec4<f32>(stopval, 0.0, 0.0, 0.0);"]).result,o.setCode(c)}),e._depthRangeEncoder.setDescription({colorAttachments:[{view:null,clearValue:[0,0,0,0],loadOp:"clear",storeOp:"store"},{view:null,clearValue:[1,1,1,1],loadOp:"clear",storeOp:"store"}]}),e._depthRangeEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"r16float",blend:{color:{srcFactor:"one",dstFactor:"one",operation:"max"},alpha:{srcFactor:"one",dstFactor:"one",operation:"max"}}},{format:"r16float",blend:{color:{srcFactor:"one",dstFactor:"one",operation:"min"},alpha:{srcFactor:"one",dstFactor:"one",operation:"min"}}}]}}),e._depthRangeTexture=en.newInstance({label:"volumePassMaxDepth"}),e._depthRangeTexture.create(r,{width:n.getCanvas().width,height:n.getCanvas().height,format:"r16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});const a=e._depthRangeTexture.createView("maxTexture");e._depthRangeEncoder.setColorTextureView(0,a),e._depthRangeTexture2=en.newInstance({label:"volumePassDepthMin"}),e._depthRangeTexture2.create(r,{width:n.getCanvas().width,height:n.getCanvas().height,format:"r16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});const s=e._depthRangeTexture2.createView("minTexture");e._depthRangeEncoder.setColorTextureView(1,s),e._mapper.setDevice(n.getDevice()),e._mapper.setTextureViews([e.depthTextureView])},t.createClearEncoder=n=>{e._colorTexture=en.newInstance({label:"volumePassColor"}),e._colorTexture.create(n.getDevice(),{width:n.getCanvas().width,height:n.getCanvas().height,format:"bgra8unorm",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC}),e._colorTextureView=e._colorTexture.createView("volumePassColorTexture"),e._colorTextureView.addSampler(n.getDevice(),{minFilter:"linear",magFilter:"linear"}),e._clearEncoder=hn.newInstance({label:"VolumePass Clear"}),e._clearEncoder.setColorTextureView(0,e._colorTextureView),e._clearEncoder.setDescription({colorAttachments:[{view:null,clearValue:[0,0,0,0],loadOp:"clear",storeOp:"store"}]}),e._clearEncoder.setPipelineHash("volpf"),e._clearEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"bgra8unorm",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.createCopyEncoder=n=>{e._copyEncoder=hn.newInstance({label:"volumePassCopy"}),e._copyEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e._copyEncoder.setPipelineHash("volcopypf"),e._copyEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"one",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.createMergeEncoder=n=>{e._mergeEncoder=hn.newInstance({label:"volumePassMerge"}),e._mergeEncoder.setColorTextureView(0,e._colorTextureView),e._mergeEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e._mergeEncoder.setReplaceShaderCodeFunction(r=>{const a=r.getShaderDescription("fragment");a.addOutput("vec4<f32>","outColor");let s=a.getCode();s=ae.substitute(s,"//VTK::RenderEncoder::Impl",["output.outColor = vec4<f32>(computedColor.rgb, computedColor.a);"]).result,a.setCode(s)}),e._mergeEncoder.setPipelineHash("volpf"),e._mergeEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"bgra8unorm",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.setVolumes=n=>{if(!e.volumes||e.volumes.length!==n.length){e.volumes=[...n],t.modified();return}for(let r=0;r<n.length;r++)if(n[r]!==e.volumes[r]){e.volumes=[...n],t.modified();return}}}const $F={colorTextureView:null,depthTextureView:null,volumes:null};function xd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$F,n),Sn.extend(t,e,n),e._mapper=yf.newInstance(),e._mapper.setFragmentShaderTemplate(kF),e._mapper.getShaderReplacements().set("replaceShaderVolumePass",(r,a,s)=>{a.getShaderDescription("fragment").addBuiltinInput("vec4<f32>","@builtin(position) fragPos")}),e._boundsPoly=Tr.newInstance(),e._lastMTimes=[],E.setGet(t,e,["colorTextureView","depthTextureView"]),bF(t,e)}const WF=E.newInstance(xd,"vtkWebGPUVolumePass");var zF={newInstance:WF,extend:xd};const HF=`
//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = clamp(textureSampleLevel(opaquePassColorTexture, finalPassSampler, input.tcoordVS, 0.0),vec4<f32>(0.0),vec4<f32>(1.0));

  //VTK::RenderEncoder::Impl
  return output;
}
`;function AF(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(e.deleted)return;e._currentParent=r,t.setCurrentOperation("buildPass"),n.traverse(t),e.opaquePass||(e.opaquePass=EF.newInstance());const a=n.getRenderable().getNumberOfLayers(),s=n.getChildren();for(let i=0;i<a;i++)for(let o=0;o<s.length;o++){const c=s[o],u=n.getRenderable().getRenderers()[o];u.getDraw()&&u.getLayer()===i&&(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumes=[],t.setCurrentOperation("queryPass"),c.traverse(t),t.setCurrentOperation("cameraPass"),c.traverse(t),e.opaquePass.traverse(c,n),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=LF.newInstance()),e.translucentPass.setColorTextureView(e.opaquePass.getColorTextureView()),e.translucentPass.setDepthTextureView(e.opaquePass.getDepthTextureView()),e.translucentPass.traverse(c,n)),e.volumes.length>0&&(e.volumePass||(e.volumePass=zF.newInstance()),e.volumePass.setColorTextureView(e.opaquePass.getColorTextureView()),e.volumePass.setDepthTextureView(e.opaquePass.getDepthTextureView()),e.volumePass.setVolumes(e.volumes),e.volumePass.traverse(c,n)),t.finalPass(n,c))}},t.finalPass=(n,r)=>{e._finalBlitEncoder||t.createFinalBlitEncoder(n),e._finalBlitOutputTextureView.createFromTextureHandle(n.getCurrentTexture(),{depth:1,format:n.getPresentationFormat()}),e._finalBlitEncoder.attachTextureViews(),e._finalBlitEncoder.begin(n.getCommandEncoder()),r.scissorAndViewport(e._finalBlitEncoder),e._fullScreenQuad.prepareAndDraw(e._finalBlitEncoder),e._finalBlitEncoder.end()},t.createFinalBlitEncoder=n=>{e._finalBlitEncoder=hn.newInstance({label:"forwardPassBlit"}),e._finalBlitEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e._finalBlitEncoder.setPipelineHash("fpf"),e._finalBlitEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:n.getPresentationFormat(),blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha"}}}]}}),e._fsqSampler=Tf.newInstance({label:"finalPassSampler"}),e._fsqSampler.create(n.getDevice(),{minFilter:"linear",magFilter:"linear"}),e._fullScreenQuad=jr.newInstance(),e._fullScreenQuad.setDevice(n.getDevice()),e._fullScreenQuad.setPipelineHash("fpfsq"),e._fullScreenQuad.setTextureViews([e.opaquePass.getColorTextureView()]),e._fullScreenQuad.setAdditionalBindables([e._fsqSampler]),e._fullScreenQuad.setFragmentShaderTemplate(HF),e._finalBlitOutputTextureView=k1.newInstance(),e._finalBlitEncoder.setColorTextureView(0,e._finalBlitOutputTextureView)},t.incrementOpaqueActorCount=()=>e.opaqueActorCount++,t.incrementTranslucentActorCount=()=>e.translucentActorCount++,t.addVolume=n=>{e.volumes.push(n)}}const jF={opaqueActorCount:0,translucentActorCount:0,volumes:null,opaqueRenderEncoder:null,translucentPass:null,volumePass:null};function Sd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jF,n),Sn.extend(t,e,n),E.setGet(t,e,["opaquePass","translucentPass","volumePass"]),AF(t,e)}const KF=E.newInstance(Sd,"vtkForwardPass");var PF={newInstance:KF,extend:Sd};const{VtkDataTypes:tr}=De;function XF(t,e){e.classHierarchy.push("vtkWebGPUTextureManager");function n(a){if(a.imageData){a.dataArray=a.imageData.getPointData().getScalars(),a.time=a.dataArray.getMTime(),a.nativeArray=a.dataArray.getData();const s=a.imageData.getDimensions();switch(a.width=s[0],a.height=s[1],a.depth=s[2],a.dataArray.getNumberOfComponents()){case 1:a.format="r";break;case 2:a.format="rg";break;case 3:case 4:default:a.format="rgba";break}switch(a.dataArray.getDataType()){case tr.UNSIGNED_CHAR:a.format+="8unorm";break;case tr.FLOAT:case tr.UNSIGNED_INT:case tr.INT:case tr.DOUBLE:case tr.UNSIGNED_SHORT:case tr.SHORT:default:a.format+="16float";break}}a.image&&(a.width=a.image.width,a.height=a.image.height,a.depth=1,a.format="rgba8unorm",a.flip=!0,a.usage=GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT),a.jsImageData&&(a.width=a.jsImageData.width,a.height=a.jsImageData.height,a.depth=1,a.format="rgba8unorm",a.flip=!0,a.nativeArray=a.jsImageData.data,a.usage=GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT),a.imageBitmap&&(a.width=a.imageBitmap.width,a.height=a.imageBitmap.height,a.depth=1,a.format="rgba8unorm",a.flip=!0,a.usage=GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT),a.canvas&&(a.width=a.canvas.width,a.height=a.canvas.height,a.depth=1,a.format="rgba8unorm",a.flip=!0,a.usage=GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT)}function r(a){const s=en.newInstance({label:a.label});return s.create(e.device,{width:a.width,height:a.height,depth:a.depth,format:a.format,usage:a.usage,mipLevel:a.mipLevel}),(a.nativeArray||a.image||a.canvas||a.imageBitmap)&&s.writeImageData(a),s}t.getTexture=a=>a.hash?e.device.getCachedObject(a.hash,r,a):r(a),t.getTextureForImageData=a=>{const s={time:a.getMTime()};return s.imageData=a,n(s),s.hash=s.time+s.format+s.mipLevel,e.device.getTextureManager().getTexture(s)},t.getTextureForVTKTexture=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const i={time:a.getMTime(),label:s};return a.getInputData()?i.imageData=a.getInputData():a.getImage()?i.image=a.getImage():a.getJsImageData()?i.jsImageData=a.getJsImageData():a.getImageBitmap()?i.imageBitmap=a.getImageBitmap():a.getCanvas()&&(i.canvas=a.getCanvas()),n(i),i.mipLevel=a.getMipLevel(),i.hash=i.time+i.format+i.mipLevel,e.device.getTextureManager().getTexture(i)}}const IF={handle:null,device:null};function Cd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IF,n),E.obj(t,e),E.setGet(t,e,["device"]),XF(t,e)}const YF=E.newInstance(Cd);var qF={newInstance:YF,extend:Cd};class QF extends Map{constructor(){super(),this.registry=new FinalizationRegistry(e=>{const n=super.get(e);n&&n.deref&&n.deref()===void 0&&super.delete(e)})}getValue(e){const n=super.get(e);if(n){const r=n.deref();if(r!==void 0)return r;super.delete(e)}}setValue(e,n){let r;return n&&typeof n=="object"&&(r=new WeakRef(n),this.registry.register(n,e),super.set(e,r)),r}}function ZF(t,e){e.classHierarchy.push("vtkWebGPUDevice"),t.initialize=n=>{e.handle=n},t.createCommandEncoder=()=>e.handle.createCommandEncoder(),t.submitCommandEncoder=n=>{e.handle.queue.submit([n.finish()])},t.getShaderModule=n=>e.shaderCache.getShaderModule(n),t.getBindGroupLayout=n=>{if(!n.entries)return null;for(let s=0;s<n.entries.length;s++){const i=n.entries[s];i.binding=i.binding||0,i.visibility=i.visibility||GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT}const r=JSON.stringify(n);for(let s=0;s<e.bindGroupLayouts.length;s++)if(e.bindGroupLayouts[s].sval===r)return e.bindGroupLayouts[s].layout;const a=e.handle.createBindGroupLayout(n);return e.bindGroupLayouts.push({sval:r,layout:a}),a},t.getBindGroupLayoutDescription=n=>{for(let r=0;r<e.bindGroupLayouts.length;r++)if(e.bindGroupLayouts[r].layout===n)return e.bindGroupLayouts[r].sval;return vtkErrorMacro("layout not found"),console.trace(),null},t.getPipeline=n=>n in e.pipelines?e.pipelines[n]:null,t.createPipeline=(n,r)=>{r.initialize(t,n),e.pipelines[n]=r},t.onSubmittedWorkDone=()=>e.handle.queue.onSubmittedWorkDone(),t.hasCachedObject=n=>e.objectCache.getValue(n),t.getCachedObject=function(n,r){if(!n)return vtkErrorMacro("attempt to cache an object without a hash"),null;const a=e.objectCache.getValue(n);if(a)return a;for(var s=arguments.length,i=new Array(s>2?s-2:0),o=2;o<s;o++)i[o-2]=arguments[o];const c=r(...i);return e.objectCache.setValue(n,c),c}}const JF={handle:null,pipelines:null,shaderCache:null,bindGroupLayouts:null,bufferManager:null,textureManager:null};function wd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,JF,n),qe(t,e),He(t,e,["handle"]),ht(t,e,["bufferManager","shaderCache","textureManager"]),e.objectCache=new QF,e.shaderCache=ae.newInstance(),e.shaderCache.setDevice(t),e.bindGroupLayouts=[],e.bufferManager=Cr.newInstance(),e.bufferManager.setDevice(t),e.textureManager=qF.newInstance(),e.textureManager.setDevice(t),e.pipelines={},ZF(t,e)}const eB=Ce(wd,"vtkWebGPUDevice");var tB={newInstance:eB,extend:wd};function nB(t,e){e.classHierarchy.push("vtkWebGPUHardwareSelectionPass"),t.traverse=(n,r)=>{if(e.deleted)return;e._currentParent=null,t.setCurrentOperation("buildPass"),n.traverse(t);const a=n.getDevice();if(e.selectionRenderEncoder)e.colorTexture.resize(n.getCanvas().width,n.getCanvas().height),e.depthTexture.resizeToMatch(e.colorTexture);else{t.createRenderEncoder(),e.colorTexture=en.newInstance({label:"hardwareSelectorColor"}),e.colorTexture.create(a,{width:n.getCanvas().width,height:n.getCanvas().height,format:"rgba32uint",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC});const s=e.colorTexture.createView("hardwareSelectColorTexture");e.selectionRenderEncoder.setColorTextureView(0,s),e.depthTexture=en.newInstance({label:"hardwareSelectorDepth"}),e.depthTexture.create(a,{width:n.getCanvas().width,height:n.getCanvas().height,format:"depth32float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC});const i=e.depthTexture.createView("hardwareSelectDepthTexture");e.selectionRenderEncoder.setDepthTextureView(i)}e.selectionRenderEncoder.attachTextureViews(),r.setRenderEncoder(e.selectionRenderEncoder),t.setCurrentOperation("cameraPass"),r.traverse(t),t.setCurrentOperation("opaquePass"),r.traverse(t)},t.createRenderEncoder=()=>{e.selectionRenderEncoder=hn.newInstance({label:"HardwareSelectionPass"}),e.selectionRenderEncoder.setPipelineHash("sel"),e.selectionRenderEncoder.setReplaceShaderCodeFunction(r=>{const a=r.getShaderDescription("fragment");a.addOutput("vec4<u32>","outColor");let s=a.getCode();s=ae.substitute(s,"//VTK::RenderEncoder::Impl",["output.outColor = vec4<u32>(mapperUBO.PropID, compositeID, 0u, 0u);"]).result,a.setCode(s)});const n=e.selectionRenderEncoder.getDescription();n.colorAttachments[0].clearValue=[0,0,0,0],e.selectionRenderEncoder.setPipelineSettings({primitive:{cullMode:"none"},depthStencil:{depthWriteEnabled:!0,depthCompare:"greater",format:"depth32float"},fragment:{targets:[{format:"rgba32uint",blend:void 0}]}})}}const rB={selectionRenderEncoder:null,colorTexture:null,depthTexture:null};function Ed(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rB,n),Sn.extend(t,e,n),E.get(t,e,["colorTexture","depthTexture"]),nB(t,e)}const aB=E.newInstance(Ed,"vtkWebGPUHardwareSelectionPass");var sB={newInstance:aB,extend:Ed};const{SelectionContent:iB,SelectionField:Ig}=Vi,{FieldAssociations:Yg}=Sr,{vtkErrorMacro:Rd}=E;function oB(t){return`${t.propID} ${t.compositeID}`}function qg(t,e,n,r){const a=((n.height-e-1)*n.colorBufferWidth+t)*4+r;return n.colorValues[a]}function cB(t,e,n,r){{if(r[0]=e[0],r[1]=e[1],e[0]<0||e[0]>=t.width||e[1]<0||e[1]>=t.height)return null;const a=qg(e[0],e[1],t,0);if(a<=0)return null;const s={};s.propID=a;let i=qg(e[0],e[1],t,1);if((i<0||i>16777215)&&(i=0),s.compositeID=i,t.captureZValues){const o=(t.height-e[1]-1)*t.zbufferBufferWidth+e[0];s.zValue=t.depthValues[o],s.zValue=t.webGPURenderer.convertToOpenGLDepth(s.zValue),s.displayPosition=e}return s}}function fB(t,e,n){const r=[];let a=0;return e.forEach((s,i)=>{const o=Vi.newInstance();switch(o.setContentType(iB.INDICES),t){case Yg.FIELD_ASSOCIATION_CELLS:o.setFieldType(Ig.CELL);break;case Yg.FIELD_ASSOCIATION_POINTS:o.setFieldType(Ig.POINT);break;default:Rd("Unknown field association")}o.getProperties().propID=s.info.propID;const c=n.webGPURenderer.getPropFromID(s.info.propID);o.getProperties().prop=c.getRenderable(),o.getProperties().compositeID=s.info.compositeID,o.getProperties().pixelCount=s.pixelCount,n.captureZValues&&(o.getProperties().displayPosition=[s.info.displayPosition[0],s.info.displayPosition[1],s.info.zValue],o.getProperties().worldPosition=n.webGPURenderWindow.displayToWorld(s.info.displayPosition[0],s.info.displayPosition[1],s.info.zValue,n.renderer)),o.setSelectionList(s.attributeIDs),r[a]=o,a++}),r}function uB(t,e,n,r,a){const s=Math.floor(e),i=Math.floor(n),o=Math.floor(r),c=Math.floor(a),u=new Map,g=[0,0];for(let f=i;f<=c;f++)for(let l=s;l<=o;l++){const v=cB(t,[l,f],0,g);if(v){const p=oB(v);if(!u.has(p))u.set(p,{info:v,pixelCount:1,attributeIDs:[v.attributeID]});else{const d=u.get(p);d.pixelCount++,t.captureZValues&&v.zValue<d.info.zValue&&(d.info=v),d.attributeIDs.indexOf(v.attributeID)===-1&&d.attributeIDs.push(v.attributeID)}}}return fB(t.fieldAssociation,u,t)}function gB(t,e){e.classHierarchy.push("vtkWebGPUHardwareSelector"),t.endSelection=()=>{e.WebGPURenderer.setSelector(null)},t.getSourceDataAsync=async n=>{if(!n||!e._WebGPURenderWindow)return Rd("Renderer and view must be set before calling Select."),!1;e._WebGPURenderWindow.getRenderable().preRender(),e._WebGPURenderWindow.getInitialized()||(e._WebGPURenderWindow.initialize(),await new Promise(h=>{e._WebGPURenderWindow.onInitialized(h)}));const r=e._WebGPURenderWindow.getViewNodeFor(n);if(!r)return!1;const a=r.getSuppressClear();r.setSuppressClear(!0),e._selectionPass.traverse(e._WebGPURenderWindow,r),r.setSuppressClear(a);const s=e._WebGPURenderWindow.getDevice(),i=e._selectionPass.getColorTexture(),o=e._selectionPass.getDepthTexture(),c={area:[0,0,i.getWidth()-1,i.getHeight()-1],captureZValues:e.captureZValues,fieldAssociation:e.fieldAssociation,renderer:n,webGPURenderer:r,webGPURenderWindow:e._WebGPURenderWindow,width:i.getWidth(),height:i.getHeight()};c.colorBufferWidth=16*Math.floor((c.width+15)/16),c.colorBufferSizeInBytes=c.colorBufferWidth*c.height*4*4;const u=Kr.newInstance({label:"hardwareSelectColorBuffer"});u.setDevice(s),u.create(c.colorBufferSizeInBytes,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);const g=e._WebGPURenderWindow.getCommandEncoder();g.copyTextureToBuffer({texture:i.getHandle()},{buffer:u.getHandle(),bytesPerRow:16*c.colorBufferWidth,rowsPerImage:c.height},{width:c.width,height:c.height,depthOrArrayLayers:1});let f;e.captureZValues&&(c.zbufferBufferWidth=64*Math.floor((c.width+63)/64),f=Kr.newInstance({label:"hardwareSelectDepthBuffer"}),f.setDevice(s),c.zbufferSizeInBytes=c.height*c.zbufferBufferWidth*4,f.create(c.zbufferSizeInBytes,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST),g.copyTextureToBuffer({texture:o.getHandle(),aspect:"depth-only"},{buffer:f.getHandle(),bytesPerRow:4*c.zbufferBufferWidth,rowsPerImage:c.height},{width:c.width,height:c.height,depthOrArrayLayers:1})),s.submitCommandEncoder(g);const l=u.mapAsync(GPUMapMode.READ);if(e.captureZValues){const h=f.mapAsync(GPUMapMode.READ);await Promise.all([l,h]),c.depthValues=new Float32Array(f.getMappedRange().slice()),f.unmap()}else await l;return c.colorValues=new Uint32Array(u.getMappedRange().slice()),u.unmap(),c.generateSelection=(h,v,p,d)=>uB(c,h,v,p,d),c}}const lB={};function Md(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lB,n),ed.extend(t,e,n),e._selectionPass=sB.newInstance(),E.setGet(t,e,["_WebGPURenderWindow"]),E.moveToProtected(t,e,["WebGPURenderWindow"]),gB(t,e)}const hB=E.newInstance(Md,"vtkWebGPUHardwareSelector");var Od={newInstance:hB,extend:Md};const{vtkErrorMacro:Qg}=E,pB={position:"absolute",top:0,left:0,width:"100%",height:"100%"};function dB(t,e){e.classHierarchy.push("vtkWebGPURenderWindow"),t.getViewNodeFactory=()=>e.myFactory;const n=[0,0];function r(){e.renderable&&(e.size[0]!==n[0]||e.size[1]!==n[1])&&(n[0]=e.size[0],n[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1]),t.recreateSwapChain()),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(r),t.recreateSwapChain=()=>{e.context&&(e.context.unconfigure(),e.presentationFormat=navigator.gpu.getPreferredCanvasFormat(e.adapter),e.context.configure({device:e.device.getHandle(),format:e.presentationFormat,alphaMode:"premultiplied",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,width:e.size[0],height:e.size[1]}),e._configured=!0)},t.getCurrentTexture=()=>e.context.getCurrentTexture(),t.buildPass=i=>{if(i){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.removeUnusedNodes(),t.initialize()}else e.initialized&&(e._configured||t.recreateSwapChain(),e.commandEncoder=e.device.createCommandEncoder())},t.initialize=()=>{if(!e.initializing){if(e.initializing=!0,!navigator.gpu){Qg("WebGPU is not enabled.");return}t.create3DContextAsync().then(()=>{e.initialized=!0,!e.deleted&&t.invokeInitialized()})}},t.setContainer=i=>{e.el&&e.el!==i&&(e.canvas.parentNode!==e.el&&Qg("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==i&&(e.el=i,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=()=>e.el,t.getContainerSize=()=>{if(!e.containerSize&&e.el){const{width:i,height:o}=e.el.getBoundingClientRect();e.containerSize=[i,o]}return e.containerSize||e.size},t.getFramebufferSize=()=>e.size,t.create3DContextAsync=async()=>{if(e.adapter=await navigator.gpu.requestAdapter({powerPreference:"high-performance"}),!e.deleted){if(e.device=tB.newInstance(),e.device.initialize(await e.adapter.requestDevice()),e.deleted){e.device=null;return}e.context=e.canvas.getContext("webgpu")}},t.releaseGraphicsResources=()=>{const i=Sn.newInstance();i.setCurrentOperation("Release"),i.traverse(t,null),e.adapter=null,e.device=null,e.context=null,e.initialized=!1,e.initializing=!1},t.setBackgroundImage=i=>{e.bgImage.src=i.src},t.setUseBackgroundImage=i=>{e.useBackgroundImage=i,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};async function a(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.imageFormat;const o=document.createElement("canvas"),c=o.getContext("2d");o.width=e.canvas.width,o.height=e.canvas.height;const u=await t.getPixelsAsync(),g=new ImageData(u.colorValues,u.width,u.height);c.putImageData(g,0,0);const f=e.canvas.getBoundingClientRect();e.renderable.getRenderers().forEach(p=>{p.getViewProps().forEach(y=>{if(y.getContainer){const x=y.getContainer().getElementsByTagName("canvas");for(let T=0;T<x.length;T++){const w=x[T],C=w.getBoundingClientRect(),R=C.x-f.x,M=C.y-f.y;c.drawImage(w,R,M)}}})});const v=o.toDataURL(i);o.remove(),t.invokeImageReady(v)}t.captureNextImage=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",{resetCamera:o=!1,size:c=null,scale:u=1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.deleted)return null;e.imageFormat=i;const g=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:c||u!==1?c||e.size.map(f=>f*u):null},new Promise((f,l)=>{const h=t.onImageReady(v=>{if(e._screenshot.size===null)e.notifyStartCaptureImage=g,h.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(p=>{let{restoreParamsFn:d,arg:y}=p;return d(y)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),f(v);else{const p=document.createElement("img");if(p.style=pB,p.src=v,e._screenshot.placeHolder=e.el.appendChild(p),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e._screenshot.size=null,t.modified(),o){const d=o!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(y=>{const S=y.getActiveCamera(),x=S.get("focalPoint","position","parallelScale");return{resetCameraArgs:d?{renderer:y}:void 0,resetCameraFn:d?o:y.resetCamera,restoreParamsFn:S.set,arg:JSON.parse(JSON.stringify(x))}}),e._screenshot.cameras.forEach(y=>{let{resetCameraFn:S,resetCameraArgs:x}=y;return S(x)})}t.traverseAllPasses()}})})},t.traverseAllPasses=()=>{if(!e.deleted)if(e.initialized){if(e.renderPasses)for(let i=0;i<e.renderPasses.length;++i)e.renderPasses[i].traverse(t,null);e.commandEncoder&&(e.device.submitCommandEncoder(e.commandEncoder),e.commandEncoder=null,e.notifyStartCaptureImage&&e.device.onSubmittedWorkDone().then(()=>{a()}))}else{t.initialize();const i=t.onInitialized(()=>{i.unsubscribe(),t.traverseAllPasses()})}},t.setViewStream=i=>{if(e.viewStream===i)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=i,e.viewStream){const o=e.renderable.getRenderers()[0];o.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(c=>t.setBackgroundImage(c.image)),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.getUniquePropID=()=>e.nextPropID++,t.getPropFromID=i=>{for(let o=0;o<e.children.length;o++){const c=e.children[o].getPropFromID(i);if(c!==null)return c}return null},t.getPixelsAsync=async()=>{const i=e.device,o=e.renderPasses[0].getOpaquePass().getColorTexture(),c={width:o.getWidth(),height:o.getHeight()};c.colorBufferWidth=32*Math.floor((c.width+31)/32),c.colorBufferSizeInBytes=c.colorBufferWidth*c.height*8;const u=Kr.newInstance();u.setDevice(i),u.create(c.colorBufferSizeInBytes,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);const g=e.device.createCommandEncoder();g.copyTextureToBuffer({texture:o.getHandle()},{buffer:u.getHandle(),bytesPerRow:8*c.colorBufferWidth,rowsPerImage:c.height},{width:c.width,height:c.height,depthOrArrayLayers:1}),i.submitCommandEncoder(g),await u.mapAsync(GPUMapMode.READ),c.colorValues=new Uint16Array(u.getMappedRange().slice()),u.unmap();const l=new Uint8ClampedArray(c.height*c.width*4);for(let h=0;h<c.height;h++)for(let v=0;v<c.width;v++){const p=(h*c.width+v)*4,d=(h*c.colorBufferWidth+v)*4;l[p]=255*kt.fromHalf(c.colorValues[d]),l[p+1]=255*kt.fromHalf(c.colorValues[d+1]),l[p+2]=255*kt.fromHalf(c.colorValues[d+2]),l[p+3]=255*kt.fromHalf(c.colorValues[d+3])}return c.colorValues=l,c},t.createSelector=()=>{const i=Od.newInstance();return i.setWebGPURenderWindow(t),i};const s=t.setSize;t.setSize=(i,o)=>{const c=s(i,o);return c&&t.invokeWindowResizeEvent({width:i,height:o}),c},t.delete=E.chain(t.delete,t.setViewStream)}const vB={initialized:!1,context:null,adapter:null,device:null,canvas:null,cursorVisibility:!0,cursor:"pointer",containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1,nextPropID:1,xrSupported:!1,presentationFormat:null};function yB(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vB,n),e.canvas=document.createElement("canvas"),e.canvas.style.width="100%",e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",ld.extend(t,e,n),e.myFactory=YO.newInstance(),e.renderPasses[0]=PF.newInstance(),e.selector||(e.selector=Od.newInstance(),e.selector.setWebGPURenderWindow(t)),E.event(t,e,"imageReady"),E.event(t,e,"initialized"),E.get(t,e,["commandEncoder","device","presentationFormat","useBackgroundImage","xrSupported"]),E.setGet(t,e,["initialized","context","canvas","device","renderPasses","notifyStartCaptureImage","cursor","useOffScreen"]),E.setGetArray(t,e,["size"],2),E.event(t,e,"windowResizeEvent"),dB(t,e)}const Dd=E.newInstance(yB,"vtkWebGPURenderWindow");xf("WebGPU",Dd);rn("vtkRenderWindow",Dd);const TB=lm.extractURLParameters(),xB={margin:"0",padding:"0",position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden"},SB={position:"absolute",left:"25px",top:"25px",backgroundColor:"white",borderRadius:"5px",listStyle:"none",padding:"5px 10px",margin:"0",display:"block",border:"solid 1px black",maxWidth:"calc(100% - 70px)",maxHeight:"calc(100% - 60px)",overflow:"auto"};function Zg(t,e){Object.keys(e).forEach(n=>{t.style[n]=e[n]})}function CB(t,e){e.classHierarchy.push("vtkFullScreenRenderWindow");const n=document.querySelector("body");e.rootContainer||(e.rootContainer=n),e.container||(e.container=document.createElement("div"),Zg(e.container,e.containerStyle||xB),e.rootContainer.appendChild(e.container)),e.rootContainer===n&&(document.documentElement.style.height="100%",n.style.height="100%",n.style.padding="0",n.style.margin="0"),e.renderWindow=bV.newInstance(),e.renderer=BV.newInstance(),e.renderWindow.addRenderer(e.renderer),e.apiSpecificRenderWindow=e.renderWindow.newAPISpecificView(TB.viewAPI??e.defaultViewAPI),e.apiSpecificRenderWindow.setContainer(e.container),e.renderWindow.addView(e.apiSpecificRenderWindow),e.interactor=K1.newInstance(),e.interactor.setInteractorStyle(fm.newInstance()),e.interactor.setView(e.apiSpecificRenderWindow),e.interactor.initialize(),e.interactor.bindEvents(e.container),t.setBackground=e.renderer.setBackground,t.removeController=()=>{const a=e.controlContainer;a&&a.parentNode.removeChild(a)},t.setControllerVisibility=a=>{e.controllerVisibility=a,e.controlContainer&&(a?e.controlContainer.style.display="block":e.controlContainer.style.display="none")},t.toggleControllerVisibility=()=>{t.setControllerVisibility(!e.controllerVisibility)};function r(a){String.fromCharCode(a.charCode)==="c"&&t.toggleControllerVisibility()}t.addController=a=>{e.controlContainer=document.createElement("div"),Zg(e.controlContainer,e.controlPanelStyle||SB),e.rootContainer.appendChild(e.controlContainer),e.controlContainer.innerHTML=a,t.setControllerVisibility(e.controllerVisibility),e.rootContainer.addEventListener("keypress",r)},t.setBackground(...e.background),t.addRepresentation=a=>{a.getActors().forEach(s=>{e.renderer.addActor(s)})},t.removeRepresentation=a=>{a.getActors().forEach(s=>e.renderer.removeActor(s))},t.delete=E.chain(t.setContainer,e.apiSpecificRenderWindow.delete,()=>{e.rootContainer?.removeEventListener("keypress",r),window.removeEventListener("resize",t.resize)},t.delete),t.resize=()=>{const a=e.container.getBoundingClientRect(),s=window.devicePixelRatio||1;e.apiSpecificRenderWindow.setSize(Math.floor(a.width*s),Math.floor(a.height*s)),e.resizeCallback&&e.resizeCallback(a),e.renderWindow.render()},t.setResizeCallback=a=>{e.resizeCallback=a,t.resize()},e.listenWindowResize&&window.addEventListener("resize",t.resize),t.resize()}const wB={background:[.32,.34,.43],containerStyle:null,controlPanelStyle:null,listenWindowResize:!0,resizeCallback:null,controllerVisibility:!0};function Ld(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wB,n),E.obj(t,e),E.get(t,e,["renderWindow","renderer","apiSpecificRenderWindow","interactor","rootContainer","container","controlContainer"]),CB(t,e)}const EB=E.newInstance(Ld);var RB={newInstance:EB,extend:Ld};const MB=t=>t,Jg=1e-6;class Vd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.matrix=ue(new Float64Array(16)),this.tmp=new Float64Array(3),this.angleConv=e?cT:MB}rotateFromDirections(e,n){const r=new Float64Array(3),a=new Float64Array(3),s=new Float64Array(16);qt(r,e[0],e[1],e[2]),qt(a,n[0],n[1],n[2]),$n(r,r),$n(a,a);const i=kc(r,a);return i>=1?this:(Nr(this.tmp,r,a),bo(this.tmp)<Jg&&(Nr(this.tmp,[1,0,0],e),bo(this.tmp)<Jg&&Nr(this.tmp,[0,1,0],e)),a0(s,Math.acos(i),this.tmp),Ne(this.matrix,this.matrix,s),this)}rotate(e,n){return qt(this.tmp,...n),$n(this.tmp,this.tmp),Bt(this.matrix,this.matrix,this.angleConv(e),this.tmp),this}rotateX(e){return _c(this.matrix,this.matrix,this.angleConv(e)),this}rotateY(e){return Uc(this.matrix,this.matrix,this.angleConv(e)),this}rotateZ(e){return Nc(this.matrix,this.matrix,this.angleConv(e)),this}translate(e,n,r){return qt(this.tmp,e,n,r),Ue(this.matrix,this.matrix,this.tmp),this}scale(e,n,r){return qt(this.tmp,e,n,r),lr(this.matrix,this.matrix,this.tmp),this}multiply(e){return Ne(this.matrix,this.matrix,e),this}multiply3x3(e){return Ne(this.matrix,this.matrix,[e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1]),this}invert(){return ut(this.matrix,this.matrix),this}identity(){return ue(this.matrix),this}apply(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;if(Ar(ah,this.matrix))return this;const a=r===-1?e.length:n+r*3;for(let s=n;s<a;s+=3)qt(this.tmp,e[s],e[s+1],e[s+2]),Te(this.tmp,this.tmp,this.matrix),e[s]=this.tmp[0],e[s+1]=this.tmp[1],e[s+2]=this.tmp[2];return this}getMatrix(){return this.matrix}setMatrix(e){return e&&e.length===16&&Qe(this.matrix,e),this}}function OB(){return new Vd(!0)}function DB(){return new Vd(!1)}var LB={buildFromDegree:OB,buildFromRadian:DB};function VB(t,e){e.classHierarchy.push("vtkConeSource"),t.requestData=(n,r)=>{const a=2*Math.PI/e.resolution,s=-e.height/2,i=e.resolution+1,o=4*e.resolution+1+e.resolution;let c=0;const u=E.newTypedArray(e.pointType,i*3);let g=0;const f=new Uint32Array(o);u[0]=e.height/2,u[1]=0,u[2]=0,e.capping&&(f[g++]=e.resolution);for(let h=0;h<e.resolution;h++)c++,u[c*3+0]=s,u[c*3+1]=e.radius*Math.cos(h*a),u[c*3+2]=e.radius*Math.sin(h*a),e.capping&&(f[e.resolution-g+++1]=c);for(let h=0;h<e.resolution;h++)f[g++]=3,f[g++]=0,f[g++]=h+1,f[g++]=h+2>e.resolution?1:h+2;LB.buildFromRadian().translate(...e.center).rotateFromDirections([1,0,0],e.direction).apply(u);const l=r[0]?.initialize()||Tr.newInstance();l.getPoints().setData(u,3),l.getPolys().setData(f,1),r[0]=l}}const mB={height:1,radius:.5,resolution:6,center:[0,0,0],direction:[1,0,0],capping:!0,pointType:"Float64Array"};function md(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mB,n),E.obj(t,e),E.setGet(t,e,["height","radius","resolution","capping"]),E.setGetArray(t,e,["center","direction"],3),E.algo(t,e,0,1),VB(t,e)}const FB=E.newInstance(md,"vtkConeSource");var BB={newInstance:FB,extend:md};const _B=(t,e)=>{const n=t.__vccOpts||t;for(const[r,a]of e)n[r]=a;return n},UB={name:"HelloWorld",setup(){const t=Ja(null),e=Ja(null),n=Ja(6),r=Ja(2);function a(i){n.value=Number(i)}function s(i){r.value=Number(i)}return qv(()=>{const i=Lo(n),o=Lo(r);if(e.value){const{actor:c,coneSource:u,renderWindow:g}=e.value;u.setResolution(i),c.getProperty().setRepresentation(o),g.render()}}),Ll(()=>{if(!e.value){const i=RB.newInstance({rootContainer:t.value}),o=BB.newInstance({height:1}),c=vr.newInstance();c.setInputConnection(o.getOutputPort());const u=dr.newInstance();u.setMapper(c);const g=i.getRenderer(),f=i.getRenderWindow();g.addActor(u),g.resetCamera(),f.render(),e.value={fullScreenRenderer:i,renderWindow:f,renderer:g,coneSource:o,actor:u,mapper:c}}}),Vl(()=>{if(e.value){const{fullScreenRenderer:i,coneSource:o,actor:c,mapper:u}=e.value;c.delete(),u.delete(),o.delete(),i.delete(),e.value=null}}),{vtkContainer:t,setRepresentation:s,setConeResolution:a,coneResolution:n,representation:r}}},NB={class:"app-container"},kB={class:"main-layout"},GB={ref:"vtkContainer",class:"vtk-canvas"},bB={class:"controls"},$B=["value"],WB=["value"];function zB(t,e,n,r,a,s){return vy(),xy("div",NB,[e[6]||(e[6]=Ge("h1",{class:"title"},"My VTK Application",-1)),Ge("div",kB,[Ge("div",GB,null,512),e[2]||(e[2]=Ey('<div class="info-panel" data-v-a125ef83><h2 data-v-a125ef83>3D Cone Visualization</h2><p data-v-a125ef83> This is an interactive 3D visualization of a cone model using VTK.js. The cone is rendered in real-time with adjustable parameters. </p><h3 data-v-a125ef83>Features:</h3><ul data-v-a125ef83><li data-v-a125ef83>Interactive 3D rotation and zoom</li><li data-v-a125ef83>Real-time rendering updates</li><li data-v-a125ef83>Customizable cone resolution</li><li data-v-a125ef83>Multiple rendering modes</li></ul><h3 data-v-a125ef83>How to Use:</h3><ul data-v-a125ef83><li data-v-a125ef83>Drag to rotate the view</li><li data-v-a125ef83>Scroll to zoom in/out</li><li data-v-a125ef83>Use controls to adjust parameters</li></ul></div>',1))]),Ge("table",bB,[Ge("tbody",null,[Ge("tr",null,[e[4]||(e[4]=Ge("td",null,[Ge("label",null,"Representation:")],-1)),Ge("td",null,[Ge("select",{value:r.representation,onChange:e[0]||(e[0]=i=>r.setRepresentation(i.target.value))},[...e[3]||(e[3]=[Ge("option",{value:"0"},"Points",-1),Ge("option",{value:"1"},"Wireframe",-1),Ge("option",{value:"2"},"Surface",-1)])],40,$B)])]),Ge("tr",null,[e[5]||(e[5]=Ge("td",null,[Ge("label",null,"Resolution:")],-1)),Ge("td",null,[Ge("input",{type:"range",min:"4",max:"80",value:r.coneResolution,onInput:e[1]||(e[1]=i=>r.setConeResolution(i.target.value))},null,40,WB)])])])])])}const HB=_B(UB,[["render",zB],["__scopeId","data-v-a125ef83"]]);aT(HB).mount("#app");
